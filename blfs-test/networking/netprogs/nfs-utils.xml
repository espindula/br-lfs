<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
    "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
   <!ENTITY % general-entities SYSTEM "../../general.ent">
   %general-entities;
   
   <!ENTITY nfs-utils-download-http "&sourceforge-repo;/nfs/nfs-utils-&nfs-utils-version;.tar.bz2">
   <!ENTITY nfs-utils-download-ftp  " ">
   <!ENTITY nfs-utils-md5sum        "8395ac770720b83c5c469f88306d7765">
   <!ENTITY nfs-utils-size          "688 Kio">
   <!ENTITY nfs-utils-buildsize     "14 Mio">
   <!ENTITY nfs-utils-time          "0.2 SBU">
   
]>
<sect1 id="nfs-utils" xreflabel="NFS Utilities-&nfs-utils-version;">
   <?dbhtml filename="nfs-utils.html"?>
   
   <sect1info>
      <othername>$LastChangedBy: krejzi $</othername>
      <date>$Date: 2012-04-06 14:13:40 +0200 (ven. 06 avril 2012) $</date>
   </sect1info>
   
   <title>NFS Utilities-&nfs-utils-version;</title> 
   
   <indexterm zone="nfs-utils">
      <primary sortas="a-Nfs-utils"> NFS Utilities </primary>
   </indexterm>
   
   <sect2 role="package">
      <title>Introduction à NFS Utilities</title> 
      
      <para>
         Le paquet <application>NFS Utilities</application> contient le serveur utilisateur et le
         client nécessaires pour utiliser les possibilités NFS du noyau. NFS est un protocole qui
         permet le partage de systèmes de fichiers sur un réseau. 
      </para> 
      
      &lfs70_checked;
      
      <bridgehead renderas="sect3"> Package information </bridgehead>
      <itemizedlist spacing='compact'>
         <listitem>
            <para>
               Téléchargement (HTTP): <ulink url="&nfs-utils-download-http;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Téléchargement (FTP): <ulink url="&nfs-utils-download-ftp;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Somme de contrôle MD5 du téléchargement: &nfs-utils-md5sum; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Taille du téléchargement: &nfs-utils-size; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation de l'espace disque requis: &nfs-utils-buildsize; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation du temps de construction: &nfs-utils-time; 
            </para> 
         </listitem>
      </itemizedlist>
      
      <bridgehead renderas="sect3"> Dépendances de NFS Utilities </bridgehead>
      
      <bridgehead renderas="sect4"> Requises </bridgehead>
      
      <para role="required">
         <xref linkend="libtirpc"/>et <xref linkend="pkgconfig"/>
      </para> 
      
      <para role="required">
         <xref linkend="rpcbind"/>(dépendance au moment de l'exécution) 
      </para> 
      
      <bridgehead renderas="sect4"> Facultatives </bridgehead>
      
      <para role="optional">
         <xref linkend="tcpwrappers"/>
      </para> 
      
      <bridgehead renderas="sect4"> Facultatives for NFSv4 Support </bridgehead>
      
      <para role="optional">
         <ulink url="http://www.monkey.org/~provos/libevent/"> libevent </ulink>
         et <ulink url="http://www.citi.umich.edu/projects/nfsv4/linux/"> libnfsidmap </ulink>
      </para> 
      
      <bridgehead renderas="sect4"> Facultatives pour GSS (support de Sécurité RPC) </bridgehead>
      
      <para role="optional">
         <xref linkend="mitkrb"/>ou <ulink url="http://www.citi.umich.edu/projects/nfsv4/linux/">
         libgssapi </ulink>
         , et <ulink url="http://www.citi.umich.edu/projects/nfsv4/linux/"> librpcsecgss </ulink>
      </para> 
      
      <bridgehead renderas="sect4"> Facultatives pour le Support SPKM-3 </bridgehead>
      
      <para>
         <ulink url="http://www.citi.umich.edu/projects/nfsv4/linux/"> SPKM-3 </ulink>
      </para> 
      
      <para condition="html" role="usernotes">
         Notes utilisateur: <ulink url="&blfs-wiki;/nfs-utils"/> 
      </para> 
      
   </sect2>
   
   <sect2 role="kernel" id='nfs-utils-kernel'>
      <title>Configuration du noyau</title> 
      
      <para>
         Activez les options suivantes dans la configuration du noyau et recompilez le noyau si
         nécessaire: 
      </para> 
      
<screen><literal>
PORT="2049" -PROCESSES="8" -QUOTAS="no" -KILLDELAY="10"
</literal>
</screen>
      
      <para>
         Sélectionnez les sous-options adéquates qui apparaissent quand les options ci-dessus sont
         sélectionnées. 
      </para> 
      <indexterm zone="nfs-utils nfs-utils-kernel">
         <primary sortas="d-nfs-utils"> NFS Utilities </primary>
      </indexterm>
      
   </sect2>
   
   <sect2 role="installation" id='nfs-utils-install' xreflabel='NFS Utilities Installation'>
      <title>Installation des outils NFS</title> 
      
      <para>
         Avant de compiler le programme, assurez-vous que l'utilisateur <systemitem
         class="username"> nobody </systemitem>et le groupe <systemitem class="groupname"> nogroup
         </systemitem>ont été créés. Vous pouvez les ajouter en lançant les commandes suivantes en
         tant qu'utilisateur <systemitem class="username">
         root </systemitem>&nbsp;: 
      </para> 
      
<screen role="root">
<userinput>groupadd -g 99 nogroup &amp;&amp;
useradd -c "Unprivileged Nobody" -d /dev/null -g nogroup \
    -s /bin/false -u 99 nobody</userinput></screen>
      
      <note> 
         <para>
            Les valeurs d'uid et de gid classiques sont 65534, ce qui signifie -2 interprété en
            nombre 16 bits signé. Ces valeurs affectent d'autres fichiers sur quelques systèmes de
            fichiers qui ne supportent pas les fichiers éparpillés. Les valeurs <systemitem
            class="username"> nobody </systemitem>et <systemitem class="groupname"> nogroup
            </systemitem>sont relativement arbitraires. L'impact sur un serveur est nul si le
            fichier <filename>exports</filename> est configuré correctement. S'il est mal configuré,
            un listage par <command>ls -l</command> or <command>ps</command> affichera un numéro
            d'uid ou de gid de 65534 à la place d'un nom. Le client n'utilise <systemitem
            class="username">
            nobody </systemitem>qu'en tant qu'utilisateur qui lance <command>rpc.statd</command> . 
         </para> 
      </note>
      
      <para>
         Installez <application>NFS Utilities</application> en lançant les commandes suivantes: 
      </para> 
      
<screen><userinput>LIBS=-lpthread ./configure --prefix=/usr          \
                           --sysconfdir=/etc      \
                           --without-tcp-wrappers \
                           --disable-nfsv4        \
                           --disable-nfsv41       \
                           --disable-gss &amp;&amp;
make</userinput></screen>
      
      <para>
         Si votre répertoire <filename class="directory">/usr</filename> est monté en NFS, vous
         devriez installer les exécutables dans <filename class="directory">
         /sbin</filename> en passant un paramètre supplémentaire <option>
         --sbindir=/sbin </option>
         à la commande <command>./configure</command> ci-dessus. 
      </para> 
      
      <para>
         Ce paquet n'est pas fourni avec une suite de tests. 
      </para> 
      
      <para>
         Maintenant, en tant qu'utilisateur <systemitem class="username"> root </systemitem>&nbsp;: 
         
      </para> 
      
<screen role='root'>
<userinput>make install</userinput></screen>
      
   </sect2>
   
   <sect2 role="commands">
      <title>Explication des commandes</title> 
      
      <para>
      <parameter>--disable-nfsv4 </parameter> et <parameter>--disable-nfsv41 </parameter>&nbsp;:
      Désactive le support des versions 4 et 4.1 de NFS. 
      </para> 
      
      <para>
      <parameter>--disable-gss </parameter>&nbsp;: Désactive le support de RPCSEC GSS (RPC
      Security). 
      </para> 
      
      <para>
      <parameter>--without-tcp-wrappers </parameter>&nbsp;: Cette option n'est nécessaire que si
      vous n'avez pas installé la dépendance facultative <xref linkend="tcpwrappers"/>. 
      </para> 
      
   </sect2>
   
   <sect2 role="configuration">
      <title>Configuration de NFS Utilities</title> 
      
      <sect3 id='nfs-utils-server-config'>
         <title>Configuration du serveur</title> 
         
         <para>
            <filename>/etc/exports</filename> contient les répertoires exportés sur des serveurs
            NFS. Reportez-vous à la page de manuel <filename>exports.5</filename> pour la syntaxe de
            ce fichier. Reportez-vous aussi au "guide pratique NFS" disponible sur <ulink
            url="http://nfs.sourceforge.net/nfs-howto/"/> pour des information ons sur la manière de
            configurer les serveurs et les clients de façon sécurisée. Par exemple, pour partager le
            répertoire <filename class="directory">/home</filename> via le réseau local, vous pouvez
            ajouter la ligne suivante: 
         </para> 
         
<screen role="root">
<userinput>/home<replaceable>-&lt;192.168.0.0/24&gt;</replaceable>-(rw,subtree_check,anonuid=99,anongid=99)</userinput></screen>
         <indexterm zone="nfs-utils nfs-utils-server-config">
            <primary sortas="e-etc-exportfs"> /etc/exportfs </primary>
         </indexterm>
         
         <sect4 id="nfs-utils-server-init">
            <title>Script de démarrage</title> 
            
            <para>
               Installez le script de démarrage <filename>/etc/rc.d/init.d/nfs-server</filename>
               fourni dans le paquet <xref linkend="bootscripts"/>pour lancer le serveur au
               démarrage. 
            </para> 
            
<screen role="root">
<userinput>make install-nfs-server</userinput></screen>
            <indexterm zone="nfs-utils nfs-utils-server-init">
               <primary sortas="f-nfs-server"> nfs-server </primary>
            </indexterm>
            
            <para>
               Maintenant créez le fichier de configuration
               <filename>/etc/sysconfig/nfs-server</filename>&nbsp;: 
            </para> 
            
<screen role="root">
<userinput>cat &gt; /etc/sysconfig/nfs-server &lt;&lt; "EOF"
<literal>
</literal>
EOF</userinput></screen>
            
            <note> 
               <para>
                  Les paramètres ci-dessus peuvent être mis, éventuellement, dans
                  <filename>/etc/sysconfig/rc.site</filename> . 
               </para> 
            </note>
            <indexterm zone="nfs-utils nfs-utils-server-init">
               <primary sortas="e-etc-sysconfig-nfs-server"> /etc/sysconfig/nfs-server </primary>
            </indexterm>
            
         </sect4>
         
         <sect4 id="nfs-utils-server-wrappers-support">
            <title>Configuration de tcpwrappers</title> 
            
            <para>
               Sf vous avez installé <xref linkend="tcpwrappers"/>et s'il y a un fichier
               <filename>/etc/hosts.deny</filename> correspondant, assurez-vous d'avoir une entrée
               dans le fichier <filename>/etc/hosts.allow</filename> pour un accès à partir du démon
               rpcbind. Voir la page de man dans la section 5 pour hosts_access pour des détails sur
               la création de règles adaptées. 
            </para> 
            
         </sect4>
         
      </sect3>
      
      <sect3 id='nfs-utils-client-config'>
         <title>Configuration du client</title> 
         
         <para>
            <filename>/etc/fstab</filename> contient les répertoires qui doivent être montés sur le
            client. Les partitions peuvent aussi être montées par l'utilisation de
            <command>mount</command> command avec les bonnes options. Pour monter les partitions
            <filename class="directory">/home</filename> et <filename class="directory">
            /usr</filename> , ajoutez ce qui suit au fichier <filename>/etc/fstab</filename>&nbsp;: 
         </para> 
         
<screen role="root">
<userinput><replaceable>-&lt;server-name&gt;</replaceable>-:/home  /home nfs  
rw,_netdev,rsize=8192,wsize=8192 0 0<replaceable>-&lt;server-name&gt;
</replaceable>-:/usr   /usr  nfs   ro,_netdev,rsize=8192            0 0</userinput></screen>
         <indexterm zone="nfs-utils nfs-utils-client-config">
            <primary sortas="e-etc-fstab"> /etc/fstab </primary>
         </indexterm>
         
         <sect4  id="nfs-utils-client-init">
            <title>Script de démarrage</title> 
            
            <note> 
               <para>
                  Le script de démarrage suivant n'est pas requis si vous avez installé le script
                  nfs-server. 
               </para> 
            </note>
            
            <para>
               Installez le script de démarrage <filename>/etc/rc.d/init.d/nfs-client</filename>
               fourni dans le paquet <xref linkend="bootscripts"/>pour lancer les services clients
               au démarrage. 
            </para> 
            
<screen role="root">
<userinput>make install-nfs-client</userinput></screen>
            <indexterm zone="nfs-utils nfs-utils-client-config">
               <primary sortas="f-nfs-client"> nfs-client </primary>
            </indexterm>
            
            <para>
            Pour monter automatiquement des systèmes de fichiers <systemitem class="filesystem"> nfs
            </systemitem>, les clients devront également installer le script de démarrage the
            <filename>netfs</filename> comme décrit au chapitre <xref
            linkend="postlfs-config-netfs"/> . </para> 
            <indexterm zone="nfs-utils nfs-utils-client-config">
               <primary sortas="f-netfs"> netfs </primary>
            </indexterm>
            
         </sect4>
         
      </sect3>
      
   </sect2>
   
   <sect2 role="content">
      <title>Contenu</title> 
      
      <segmentedlist>
         <segtitle>Programmes installés</segtitle>
         <segtitle>Bibliothèques installées</segtitle>
         <segtitle>Répertoires installés</segtitle>
         
         <seglistitem>
            <seg>
               exportfs, mountstats, mount.nfs, mount.nfs4 (link to mount.nfs), nfsiostat, nfsstat,
               rpc.mountd, rpc.nfsd, rpc.statd, rpcdebug, showmount, sm-notify, start-statd,
               umount.nfs (lien vers mount.nfs), et umount.nfs4  (lien vers mount.nfs)
            </seg>
            <seg>
               Aucune
            </seg>
            <seg>
               /var/lib/nfs
            </seg>
         </seglistitem>
      </segmentedlist>
      <variablelist>
      
      <bridgehead renderas="sect3"> Descriptions courtes </bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      
      <varlistentry id="exportfs">
         <term><command>exportfs</command> </term>
         <listitem>
            <para>
               maintient une liste des systèmes de fichiers exportés par NFS. 
            </para> 
            <indexterm zone="nfs-utils exportfs">
               <primary sortas="b-exportfs"> exportfs </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="mountstats">
         <term><command>mountstats</command> </term>
         <listitem>
            <para>
               affiche des statistiques par montage des clients NFS. 
            </para> 
            <indexterm zone="nfs-utils mountstats">
               <primary sortas="b-mountstats"> mountstats </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="mountnfs">
         <term><command>mount.nfs</command> </term>
         <listitem>
            <para>
               Utilisé pour monter un partage réseau en utilisant NFS 
            </para> 
            <indexterm zone="nfs-utils mountnfs">
               <primary sortas="b-mountnfs"> mount.nfs </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="mountnfs4">
         <term><command>mount.nfs4</command> </term>
         <listitem>
            <para>
               Utilisé pour monter un partage réseau en utilisant NFSv4 
            </para> 
            <indexterm zone="nfs-utils mountnfs4">
               <primary sortas="b-mountnfs4"> mount.nfs4 </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="nfsiostat-nfs-utils">
         <term><command>nfsiostat</command> </term>
         <listitem>
            <para>
               Signale les statistiques d'entrée/sortie des systèmes de fichiers réseaux. 
            </para> 
            <indexterm zone="nfs-utils nfsiostat-nfs-utils">
               <primary sortas="b-nfsiostat-nfs-utils"> nfsiostat </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="nfsstat">
         <term><command>nfsstat</command> </term>
         <listitem>
            <para>
               affiche des statistiques sur le client NFS et l'activité du serveur. 
            </para> 
            <indexterm zone="nfs-utils nfsstat">
               <primary sortas="b-nfsstat"> nfsstat </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="rpcmountd">
         <term><command>rpc.mountd</command> </term>
         <listitem>
            <para>
               implémente le protocole de montage NFS sur un serveur NFS. 
            </para> 
            <indexterm zone="nfs-utils rpcmountd">
               <primary sortas="b-rpcmountd"> rpc.mountd </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="rpcnfsd">
         <term><command>rpc.nfsd</command> </term>
         <listitem>
            <para>
               implémente la partie du serveur niveau utilisateur du service ou du serveur NFS. 
            </para> 
            <indexterm zone="nfs-utils rpcnfsd">
               <primary sortas="b-rpcnfsd"> rpc.nfsd </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="rpcstatd">
         <term><command>rpc.statd</command> </term>
         <listitem>
            <para>
               est utilisé par le service de verrouillage de fichier NFS. Lancé des deux côtés, côté
               client et serveur, quand vous voulez activer le verrouillage de fichier. 
            </para> 
            <indexterm zone="nfs-utils rpcstatd">
               <primary sortas="b-rpcstatd"> rpc.statd </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="rpcdebug">
         <term><command>rpcdebug</command> </term>
         <listitem>
            <para>
               paramètre ou vide les drapeaux de débogage du client et du serveur NFS. 
            </para> 
            <indexterm zone="nfs-utils rpcdebug">
               <primary sortas="b-rpcdebug"> rpcdebug </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="showmount">
         <term><command>showmount</command> </term>
         <listitem>
            <para>
               affiche des informations de montage d'un serveur NFS. 
            </para> 
            <indexterm zone="nfs-utils showmount">
               <primary sortas="b-showmount"> showmount </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="sm-notify">
         <term><command>sm-notify</command> </term>
         <listitem>
            <para>
               est utilisé pour envoyer des messages de redémarrage au <foreignphrase>Network Status
               Monitor</foreignphrase>. 
            </para> 
            <indexterm zone="nfs-utils sm-notify">
               <primary sortas="b-sm-notify"> sm-notify </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="start-statd">
         <term><command>start-statd</command> </term>
         <listitem>
            <para>
               est un script appelé par nfsmount lors du montage d'un système de fichiers avec le
               verrouillage activé, si statd ne semble pas fonctionner. On peut l'automatiser avec
               n'importe quel drapeau approprié à la situation. 
            </para> 
            <indexterm zone="nfs-utils start-statd">
               <primary sortas="b-start-statd"> start-statd </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="umountnfs">
         <term><command>umount.nfs</command> </term>
         <listitem>
            <para>
               Utilisé pour démonter un partage réseau utilisant NFS 
            </para> 
            <indexterm zone="nfs-utils umountnfs">
               <primary sortas="b-umountnfs"> umount.nfs </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="umountnfs4">
         <term><command>umount.nfs4</command> </term>
         <listitem>
            <para>
               Utilisé pour démonter un partage réseau utilisant NFSv4 
            </para> 
            <indexterm zone="nfs-utils umountnfs4">
               <primary sortas="b-umountnfs4"> umount.nfs4 </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      </variablelist>
      
   </sect2>
   
</sect1>
