<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

    <!-- Inserted as a reminder to do this. The mention of a test suite
         is usually right before the root user installation commands. Please
         delete these 12 (including one blank) lines after you are done.-->

    <!-- Use one of the two mentions below about a test suite,
         delete the line that is not applicable. Of course, if the
         test suite uses syntax other than "make check", revise the
         line to reflect the actual syntax to run the test suite -->

    <!-- <para>Ce paquet n'est pas fourni avec une suite de tests.</para> -->
    <!-- <para>Pour tester les résultats, lancez&nbsp;: <command>make check</command>.</para> -->
<!-- Dead link
  <!ENTITY proftpd-download-http "http://ftp.proftpd.org/distrib/source/proftpd-&proftpd-version;.tar.bz2">
-->
  <!ENTITY proftpd-download-http " ">
  <!ENTITY proftpd-download-ftp  "ftp://ftp.proftpd.org/distrib/source/proftpd-&proftpd-version;.tar.bz2">
  <!ENTITY proftpd-md5sum        "fae47d01b52e035eb6b7190e74c17722">
  <!ENTITY proftpd-size          "1.3 Mio">
  <!ENTITY proftpd-buildsize     "12.2 Mio">
  <!ENTITY proftpd-time          "0.3 SBU">
]>

<sect1 id="proftpd" xreflabel="ProFTPD-&proftpd-version;">
  <?dbhtml filename="proftpd.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: bdubbs $</othername>
    <date>$Date&nbsp;: 2012-02-12 05:47:30 +0100 (dim. 12 févr. 2012) $</date>
  </sect1info>

  <title>ProFTPD-&proftpd-version;</title>

  <indexterm zone="proftpd">
    <primary sortas="a-proftpd">Proftpd</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à ProFTPD</title>

    <para>Le paquet <application>ProFTPD</application> contient un démon FTP
    sécurisé et hautement configurable. C'est utile pour donner de grosses archives de
    fichiers sur un réseau.</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&proftpd-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&proftpd-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &proftpd-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &proftpd-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &proftpd-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &proftpd-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de ProFTPD</bridgehead>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="linux-pam"/></para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/proftpd"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de ProFTPD</title>

    <para>Pour des raisons de sécurité, vous devriez installer
    <application>ProFTPD</application> en utilisant un utilisateur et un groupe
    non privilégiés. En tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 46 proftpd &amp;&amp;
useradd -c proftpd -d /srv/ftp -g proftpd \
        -s /usr/bin/proftpdshell -u 46 proftpd &amp;&amp;
install -v -d -m775 -o proftpd -g proftpd /srv/ftp &amp;&amp;
ln -v -s /bin/false /usr/bin/proftpdshell &amp;&amp;
echo /usr/bin/proftpdshell &gt;&gt; /etc/shells</userinput></screen>

    <para>Installez <application>ProFTPD</application> en tant qu'utilisateur
    non privilégié en lançant les commandes suivantes&nbsp;:</para>

<screen><userinput>./configure --prefix=/usr --sysconfdir=/etc \
    --localstatedir=/var/run &amp;&amp;
make</userinput></screen>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><command>install -v -d -m775 -o proftpd -g proftpd
    /srv/ftp</command>&nbsp;: Crée le répertoire home de
    <application>ProFTPD</application>.</para>

    <para><command>ln -v -s /bin/false /usr/bin/proftpdshell</command>&nbsp;:
    Règle le shell par défaut comme un lien vers un shell invalide.</para>

    <para><command>echo /usr/bin/proftpdshell &gt;&gt;
    /etc/shells</command>&nbsp;: Fait croire à un shell valide pour des raisons
    de compatibilité.</para>

    <note>
      <para>Vous pouvez vous passer des deux commandes ci-dessus si vous mettez
      la ligne suivante dans le fichier de configuration&nbsp;:</para>

<screen><literal>RequireValidShell off</literal></screen>

      <para>Par défaut, proftpd exigera que les utilisateurs qui se connectent 
      aient des shells valides. La ligne RequireValidShell désactive cette
      exigence. Ce n'est recommandé que si vous paramétrez votre serveur FTP 
      exclusivement pour des téléchargements anonymes.</para>
    </note>

    <para><parameter>--sysconfdir=/etc</parameter>&nbsp;: Ceci empêche les
    fichiers de configuration d'aller dans
    <filename class="directory">/usr/etc</filename>.</para>

    <para><parameter>--localstatedir=/var/run</parameter>&nbsp;: Ceci utilise
    <filename class="directory">/var/run</filename> plutôt que
    <filename class="directory">/usr/var</filename> pour verrouiller des
    fichiers.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de ProFTPD</title>

    <sect3 id='proftpd-config'>
      <title>Fichiers de configuration</title>

      <para><filename>/etc/proftpd.conf</filename></para>

      <indexterm zone="proftpd proftpd-config">
        <primary sortas="e-etc-proftpd">/etc/proftpd.conf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>C'est une configuration simple, un modèle pour téléchargement 
      uniquement. Voir la documentation de
      <application>ProFTPD</application> dans
      <filename class="directory">/usr/share/doc/proftpd</filename> et
      consultez le site Internet sur <ulink url="http://www.proftpd.org/"/> pour
      des configurations d'exemple.</para>

<screen role="root"><?dbfo keep-together="auto"?><userinput>cat &gt; /etc/proftpd.conf &lt;&lt; "EOF"
<literal># Ceci est un fichier de configuration ProFTPD de base
# Il met en place un serveur et une connexion anonyme uniques.

ServerName                      "ProFTPD Default Installation"
ServerType                      standalone
DefaultServer                   on

# Le port 21 est le port FTP standard.
Port                            21
# Umask 022 est un bon umask standard pour empêcher les nouveaux répertoires et
# les nouveaux fichiers d'être inscriptibles par les membres du groupe et par 
# tout le monde.
Umask                           022

# Pour empêcher les attaques DoS, paramétrez le nombre maximum de processus fils
# à 30. Si vous avez besoin d'autoriser plus de 30 connexions simultanées,
# augmentez tout simplement cette valeur. Remarquez que cela ne fonctionne qu'en
# mode autonome, en mode inetd, vous devriez utiliser un serveur inetd qui vous
# autorise à limiter le nombre maximum de processus par service <!-- (tel que xinetd)-->
MaxInstances                    30

# Réglez l'utilisateur et le groupe sous lesquels le serveur fonctionne
# en principe.
User                            proftpd
Group                           proftpd

# En principe, on devrait pouvoir remplacer les fichiers.
&lt;Directory /*&gt;
  AllowOverwrite                on
&lt;/Directory&gt;

# Une configuration pour un anonyme de base, pas de dossiers de dépôt.
&lt;Anonymous ~proftpd&gt;
  User                          proftpd
  Group                         proftpd
  # Les clients devraient pouvoir se connecter avec "anonymous" ou "proftpd"
  UserAlias                     anonymous proftpd

  # Limitez le nombre maximum de connexions anonymes
  MaxClients                    10

  # 'welcome.msg' devrait s'afficher à la connexion et '.message' devrait
  # s'afficher dans chaque répertoire où l'on se rend.
  DisplayLogin                  welcome.msg
  DisplayFirstChdir             .message

  # Limiter WRITE (écriture) partout dans le chroot anonyme
  &lt;Limit WRITE&gt;
    DenyAll
  &lt;/Limit&gt;
&lt;/Anonymous&gt;</literal>
EOF</userinput></screen>

    </sect3>

    <sect3  id="proftpd-init">
      <title>Script de démarrage</title>

      <para>Installez le script de démarrage <filename>/etc/rc.d/init.d/proftpd</filename> 
      fourni avec le paquet <xref linkend="bootscripts"/>.</para>

      <indexterm zone="proftpd proftpd-init">
        <primary sortas="f-proftpd">proftpd</primary>
      </indexterm>

<screen role="root"><userinput>make install-proftpd</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>ftpcount, ftpdctl, ftptop, ftpwho, ftpshut, proftpd</seg>
        <seg>Aucune</seg>
        <seg>/var/run/proftpd</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="proftpd-prog">
        <term><command>proftpd</command></term>
        <listitem>
          <para>est le démon FTP.</para>
          <indexterm zone="proftpd proftpd-prog">
            <primary sortas="b-proftpd">proftpd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpcount">
        <term><command>ftpcount</command></term>
        <listitem>
          <para>affiche le nombre actuel de connexions.</para>
          <indexterm zone="proftpd ftpcount">
            <primary sortas="b-ftpcount">ftpcount</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpshut">
        <term><command>ftpshut</command></term>
        <listitem>
          <para>arrête tous les serveurs <application>proftpd</application> à
          une heure donnée.</para>
          <indexterm zone="proftpd ftpshut">
            <primary sortas="b-ftpshut">ftpshut</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftptop">
        <term><command>ftptop</command></term>
        <listitem>
          <para>affiche le statut d'exécution des connexions.</para>
          <indexterm zone="proftpd ftptop">
            <primary sortas="b-ftptop">ftptop</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpwho">
        <term><command>ftpwho</command></term>
        <listitem>
          <para>affiche des informations sur le processus actuel pour chaque
          session.</para>
          <indexterm zone="proftpd ftpwho">
            <primary sortas="b-ftpwho">ftpwho</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
