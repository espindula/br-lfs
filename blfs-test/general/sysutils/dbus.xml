<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
    "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
   <!ENTITY % general-entities SYSTEM "../../general.ent">
   %general-entities;
   
   <!ENTITY dbus-download-http "http://dbus.freedesktop.org/releases/dbus/dbus-&dbus-version;.tar.gz">
   <!ENTITY dbus-download-ftp  " ">
   <!ENTITY dbus-md5sum        "79eca2f2c1894ac347acce128314428b">
   <!ENTITY dbus-size          "1.8 Mio">
   <!ENTITY dbus-buildsize     "100 Mio">
   <!ENTITY dbus-time          "0.5 SBU">
   
]>
<sect1 id="dbus" xreflabel="D-BUS-&dbus-version;">
   <?dbhtml filename="dbus.html"?>
   
   <sect1info>
      <othername>$LastChangedBy: krejzi $</othername>
      <date>$Date: 2012-03-31 23:16:07 +0200 (sam. 31 mars 2012) $</date>
   </sect1info>
   
   <title>D-BUS-&dbus-version;</title> 
   
   <indexterm zone="dbus">
      <primary sortas="a-D-BUS"> D-BUS </primary>
   </indexterm>
   
   <sect2 role="package">
      <title>Introduction à D-BUS</title> 
      
      <para>
         <application>D-BUS</application> est un système bus de message, une manière simple pour les
         applications de parler entre elles. <application>D-BUS</application> fournit un démon
         système (pour des événements tels que <quote>nouveau périphérique ajouté </quote> ou
         <quote>queue de l'imprimante modifiée </quote> ) et un démon aligné sur la session de
         l'utilisateur (pour les besoins IPC généraux des applications de l'utilisateur). Le bus de
         message est aussi construit au sommet d'un environnement de passagede message entre
         éléments général, qui peut être utilisé par  deux applications pour communiquer directement
         (sans passer par le démon de bus de message). 
      </para> 
      
      &lfs71_checked;
      
      <bridgehead renderas="sect3"> Informations sur le paquet </bridgehead>
      <itemizedlist spacing="compact">
         <listitem>
            <para>
               Téléchargement (HTTP): <ulink url="&dbus-download-http;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Téléchargement (FTP): <ulink url="&dbus-download-ftp;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Somme de contrôle MD5 du téléchargement: &dbus-md5sum; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Taille du téléchargement: &dbus-size; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation de l'espace disque requis: &dbus-buildsize; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation du temps de construction: &dbus-time; 
            </para> 
         </listitem>
      </itemizedlist>
      
      <bridgehead renderas="sect3"> Dépendances de D-BUS </bridgehead>
      
      <bridgehead renderas="sect4"> Requises </bridgehead>
      
      <para role="required">
         <xref linkend="expat"/>(préferé) ou <xref linkend="libxml2"/>
      </para> 
      
      <bridgehead renderas="sect4"> Recommandées </bridgehead>
      
      <para role="recommended">
         <xref linkend="xorg7-lib"/>(pour <command>dbus-launch</command> program) 
      </para> 
      
      <bridgehead renderas="sect4"> Facultatives </bridgehead>
      
      <para role="optional">
         <xref linkend="dbus-glib"/>(pour lancer les tests), <xref linkend="python2"/>
         (pour lancer les tests) et <xref linkend="doxygen"/>(pour générer la documentation API) 
      </para> 
      
      <para>
         Notez que le script <command>configure</command> regardera dans <xref linkend="xmlto"/>mais
         il ne fait rien car la documentation XML/HTML est déjà incluse dans l'arborescence des
         sources. 
      </para> 
      
      <para condition="html" role="usernotes">
         Notes utilisateur: <ulink url="&blfs-wiki;/dbus"/> 
      </para> 
      
   </sect2>
   
   <sect2 role="kernel" id='dbus-kernel'>
      <title>Configuration du noyau</title> 
      
      <para>
         Assurez-vous que l'option suivante est activée dans la configuration du noyau et recompilez
         le noyau si nécessaire: 
      </para> 
      
<screen><literal>
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN" -
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd"&gt;
</literal>
</screen>
      <indexterm zone="dbus dbus-kernel">
         <primary sortas="d-dbus"> dbus </primary>
      </indexterm>
      
   </sect2>
   
   <sect2 role="installation">
      <title>Installation de D-BUS</title> 
      
      <para>
         En tant qu'utilisateur <systemitem class="username"> root </systemitem>, créez un
         utilisateur et un groupe systèmes pour gérer l'activité du bus de messages système:  
      </para> 
      
<screen role="root">
<userinput>groupadd -g 18 messagebus &amp;&amp;
useradd -c "D-BUS Message Daemon User" -d /var/run/dbus \
        -u 18 -g messagebus -s /bin/false messagebus</userinput></screen>
      
      <para>
         Installez <application>D-BUS</application> en lançant les commandes suivantes (vous pouvez
         d'abord souhaiter observer la sortie de <command>./configure --help</command> et ajouter
         des paramètres désirés à la commande <command>configure</command> affichée ci-dessous): 
      </para> 
      
<screen><userinput>./configure --prefix=/usr                   \
            --sysconfdir=/etc               \
            --libexecdir=/usr/lib/dbus-1.0  \
            --localstatedir=/var &amp;&amp;
make</userinput></screen>
      
      <para>
         Voir ci-dessous pour les instructions de test. 
      </para> 
      
      <para>
         Maintenant, en tant qu'utilisateur <systemitem class="username"> root </systemitem>&nbsp;: 
         
      </para> 
      
<screen role="root">
<userinput>make install &amp;&amp;
mv -v /usr/share/doc/dbus /usr/share/doc/dbus-&dbus-version;</userinput></screen>
      
      <para>
         Les tests dbus ne peuvent pas être lancé après que <xref linkend="dbus-glib"/>est été
         installé. Les tests requierent de passer des paramètres supplémentaires à
         <command>configure</command> et d'avoir des fonctionnalités supplémentaires dans les
         fichiers binaires. Ces interfaces ne sont pas destinés à être utilisées dans une
         construction de production de <application>D-BUS</application> . Si vous souhaitez lancer
         la suite de tests, tapez les commandes suivantes: 
      </para> 
      
<screen><userinput>make distclean &amp;&amp;
./configure --enable-tests --enable-asserts &amp;&amp;
make &amp;&amp;
make check &amp;&amp;
make distclean</userinput></screen>
      
      <para>
         Notez qu'il y a un rapport indiquant que les tests peuvent échouer s'ils sont lancés depuis
         un shell Midnight Commander. Il se peut vous vous ayez des messages d'erreur de dépassement
         de mémoire lors des tests. Ils sont normaux et vous pouvez sans problème les ignorer. 
      </para> 
      
   </sect2>
   
   <sect2 role="commands">
      <title>Explication des commandes</title> 
      
      <para>
      <parameter>--libexecdir=/usr/lib/dbus-1.0 </parameter>&nbsp;: Ceci installera des binaires
      conçus pour n'être utilisés qu'en interne par <application>D-BUS</application> et le
      répertoire <filename class="directory">dbus-1</filename> dans <filename class="directory">
         /usr/lib/dbus-1.0</filename> au lieu de <filename class="directory">/usr/libexec</filename>
         . 
      </para> 
      
      <para>
      <parameter>--localstatedir=/var </parameter>&nbsp;: Il résulte de ce paramètre que le fichier
      PID du démon, le socket du bus système et le fichier uuid de la machine, seront créés dans le
      répertoire <filename class="directory">/var</filename> plutôt que dans le répertoire <filename
      class="directory">
         /usr/var</filename> . 
      </para> 
      
      <para>
      <parameter>--enable-tests </parameter>&nbsp;: Construit des parties supplémentaires du code
      pour supporter le test. Configure se finira avec un avertissement NOTE concernant cela. 
      </para> 
      
      <para>
      <parameter>--enable-asserts </parameter>&nbsp;: Active le code de débogage pour exécuter des
      déclarations d'éléments supposées normalement vraies. Cela empêche un avertissement selon
      lequel ' <parameter>--enable-tests </parameter> ' n'est utile en lui-même que pour le
      profilage et il pourrait ne pas donner de bon résultats pour tous les tests, mais il ajoute sa
      propre remarque selon laquelle cela ne devrait pas être utilisé dans une construction de
      production. 
      </para> 
      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/static-libraries.xml"/>
      
   </sect2>
   
   <sect2 role="configuration">
      <title>Configuration de dbus</title> 
      
      <sect3 id="dbus-config">
         <title>Fichiers de configuration</title> 
         
         <para>
            <filename>/etc/dbus-1/session.conf</filename> ,
            <filename>/etc/dbus-1/system.conf</filename> et
            <filename>/etc/dbus-1/system.d/avahi-dbus.conf</filename> 
         </para> 
         <indexterm zone="dbus dbus-config">
            <primary sortas="e-etc-dbus-1-session.conf"> /etc/dbus-1/session.conf </primary>
         </indexterm>
         <indexterm zone="dbus dbus-config">
            <primary sortas="e-etc-dbus-1/system.conf"> /etc/dbus-1/system.conf </primary>
         </indexterm>
         <indexterm zone="dbus dbus-config">
            <primary sortas="e-etc-dbus-1-system.d-star"> /etc/dbus-1/system.d/avahi-dbus.conf
            /etc/dbus-1/system.d/com.hp.hplip.conf
            /etc/dbus-1/system.d/com.redhat.NewPrinterNotification.conf
            /etc/dbus-1/system.d/com.redhat.PrinterDriversInstaller.conf
            /etc/dbus-1/system.d/ConsoleKit.conf
            /etc/dbus-1/system.d/kerneloops.dbus
            /etc/dbus-1/system.d/NetworkManager.conf
            /etc/dbus-1/system.d/nm-avahi-autoipd.conf
            /etc/dbus-1/system.d/nm-dhcp-client.conf
            /etc/dbus-1/system.d/nm-dispatcher.conf
            /etc/dbus-1/system.d/nm-openvpn-service.conf
            /etc/dbus-1/system.d/nm-pptp-service.conf
            /etc/dbus-1/system.d/nm-vpnc-service.conf
            /etc/dbus-1/system.d/org.freedesktop.ColorManager.conf
            /etc/dbus-1/system.d/org.freedesktop.ModemManager.conf
            /etc/dbus-1/system.d/org.freedesktop.PolicyKit1.conf
            /etc/dbus-1/system.d/org.freedesktop.RealtimeKit1.conf
            /etc/dbus-1/system.d/org.freedesktop.UDisks.conf
            /etc/dbus-1/system.d/org.freedesktop.UPower.conf
            /etc/dbus-1/system.d/org.kde.auth.conf
            /etc/dbus-1/system.d/org.kde.fontinst.conf
            /etc/dbus-1/system.d/org.kde.kcontrol.k3bsetup.conf
            /etc/dbus-1/system.d/org.kde.kcontrol.kcmclock.conf
            /etc/dbus-1/system.d/org.kde.kcontrol.kcmkdm.conf
            /etc/dbus-1/system.d/org.kde.kcontrol.kcmremotewidgets.conf
            /etc/dbus-1/system.d/org.kde.ksysguard.processlisthelper.conf
            /etc/dbus-1/system.d/org.kde.powerdevil.backlighthelper.conf
            /etc/dbus-1/system.d/org.opensuse.CupsPkHelper.Mechanism.conf
            /etc/dbus-1/system.d/pulseaudio-system.conf
            /etc/dbus-1/system.d/wpa_supplicant.conf
            </primary>
         </indexterm>
         
      </sect3>
      
      <sect3 id="dbus-session-config" xreflabel="D-Bus custom services directory">
         <title>Informations de configuration</title> 
         
         <para>
            On ne devrait probablement pas modifier les fichiers de configuration listés ci-dessus.
            Si des modifications sont requises, vous devriez créer
            <filename>/etc/dbus-1/system.d/com.hp.hplip.conf</filename> et/ou
            <filename>/etc/dbus-1/system.d/com.redhat.NewPrinterNotification.conf</filename> et
            faire les changements désirés à ces fichiers. 
         </para> 
         
         <para>
            Si un paquet installe un fichier <application>D-Bus</application> de
            <filename>/etc/dbus-1/system.d/com.redhat.PrinterDriversInstaller.conf</filename> hors
            du répertoire <filename
            class="directory">/etc/dbus-1/system.d/ConsoleKit.conf</filename> standard, vous devriez
            ajouter ce répertoire à la configuration de la session locale. Par exemple, <filename
            class="directory">
            /etc/dbus-1/system.d/kerneloops.dbus</filename> peut être ajouté en effectuant les
            commandes suivantes en tant qu'utilisateur <systemitem class="username"> root
            </systemitem>&nbsp;:  
         </para> 
         
<screen role="root">
<userinput>cat &gt; /etc/dbus-1/session-local.conf &lt;&lt; "EOF"
<literal>
</literal>
EOF</userinput></screen>
         
      </sect3>
      
      <sect3  id="dbus-init">
         <title>Script de démarrage</title> 
         
         <para>
            Pour démarrer automatiquement <command>dbus-daemon</command> quand on redémarre le
            système, installez le script de démarrage
            <filename>/etc/dbus-1/system.d/NetworkManager.conf</filename> depuis le paquet <xref
            linkend="bootscripts"/>. 
         </para> 
         <indexterm zone="dbus dbus-init">
            <primary sortas="f-dbus"> dbus </primary>
         </indexterm>
         
<screen role="root">
<userinput>make install-dbus</userinput></screen>
         
         <para>
            Remarquez que ce script de démarrage ne démarre que démon
            <application>D-BUS</application> de tout le système. Chaque utilisateur ayant besoin
            d'un accès aux services de <application>D-BUS</application> devront exécuter en plus un
            démon de session. Il y a beaucoup de méthodes utilisables pour démarrer un démon de
            session en utilisant la commande <command>dbus-launch</command> . Revoyez la page de man
            de <command>dbus-launch</command> pour des détails sur les paramètres et les options
            disponibles. Voici quelques suggestions et exemples: 
         </para> 
         <itemizedlist spacing="compact">
            <listitem>
               <para>
                  Ajouter <command>dbus-launch</command> à la ligne dans le fichier
                  <filename>/etc/dbus-1/system.d/nm-avahi-autoipd.conf</filename> qui démarre votre
                  environnement graphique comme décrit au <xref linkend="gnome-config"/>. 
               </para> 
            </listitem>
            <listitem>
               <para>
                  Si vous utilisez <command>xdm</command> ou un autre gestionnaire d'affichage qui
                  appelle le fichier <filename>/etc/dbus-1/system.d/nm-dhcp-client.conf</filename> ,
                  vous pouvez ajouter <command>dbus-launch</command> à la ligne dans votre fichier
                  <filename>/etc/dbus-1/system.d/nm-dispatcher.conf</filename> qui démarre votre
                  environnement graphique. La syntaxe ressemblerait à celle de l'exemple dans le
                  fichier <filename>/etc/dbus-1/system.d/nm-openvpn-service.conf</filename> . 
               </para> 
            </listitem>
            <listitem>
               <para>
                  Si vous utilisez <command>gdm</command> ou un autre gestionnaire d'affichage qui
                  utilise des fichiers personnalisés pour ouvrir des sessions, utilisez l'exemple
                  dans <xref linkend="gdm-config-dbus"/>des instructions de
                  <application>GDM</application> pour créer un fichier contenant
                  <command>dbus-launch</command> . 
               </para> 
            </listitem>
            <listitem>
               <para>
                  Les exemples décrits précédemment utilisent <command>dbus-launch</command> pour
                  dire à un programme de se lancer. Ceci a l'avantage (lorsqu'on utilise aussi le
                  paramètre 
               <parameter>--exit-with-session </parameter> ) d'arrêter le démon de session quand le
               programme spécifié est arrêté. Vous pouvez aussi démarrer le démon de session dans
               votre système ou par vos scripts de démarrage personnels en ajoutant les lignes
               suivantes: 
               </para> 
<screen><userinput><literal>
</literal></userinput></screen>
               <para>
                  Cette méthode n'arrêtera pas le démon de session quand vous quittez votre shell,
                  donc vous devriez ajouter la ligne suivante à votre fichier
                  <filename>/etc/dbus-1/system.d/nm-pptp-service.conf</filename>&nbsp;: 
               </para> 
<screen><userinput><literal>
</literal></userinput></screen>
            </listitem>
            <listitem>
               <para>
                  Une astuce a été écrite offrant des moyens de démarrer des scripts utilisant le
                  gestionnaire de sessions KDM de KDE. Les concepts de cette astuce pourraient être
                  éventuellement utilisés aussi avec d'autres gestionnaires de session. L'astuce se
                  trouve sur <ulink
                  url="&hints-root;/downloads/files/execute-session-scripts-using-kdm.txt"/> . 
               </para> 
            </listitem>
         </itemizedlist>
         
      </sect3>
      
   </sect2>
   
   <sect2 role="content">
      <title>Contenu</title> 
      
      <segmentedlist>
         <segtitle>Programmes installés</segtitle>
         <segtitle>Bibliothèque installée</segtitle>
         <segtitle>Répertoires installés</segtitle>
         
         <seglistitem>
            <seg>
               dbus-cleanup-sockets, dbus-daemon, dbus-daemon-launch-helper, dbus-launch,
               dbus-monitor, dbus-send et dbus-uuidgen
            </seg>
            <seg>
               libdbus-1.{so,a}
            </seg>
            <seg>
               /etc/dbus-1/{session.d,system.d}, /usr/{include/dbus-1.0/dbus,
               lib/{dbus-1.0/include/dbus,dbus/dbus-1},share/dbus-1/{services, system-services}},
               /var/{lib/dbus,run/dbus}
            </seg>
         </seglistitem>
      </segmentedlist>
      <variablelist>
      
      <bridgehead renderas="sect3"> Descriptions courtes </bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      
      <varlistentry id="dbus-cleanup-sockets">
         <term><command>dbus-cleanup-sockets</command> </term>
         <listitem>
            <para>
               nettoie les sockets superflus dans un répertoire. 
            </para> 
            <indexterm zone="dbus dbus-cleanup-sockets">
               <primary sortas="b-dbus-cleanup-sockets"> dbus-cleanup-sockets </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="dbus-daemon">
         <term><command>dbus-daemon</command> </term>
         <listitem>
            <para>
               est le démon de bus de messages <application>D-BUS</application> . 
            </para> 
            <indexterm zone="dbus dbus-daemon">
               <primary sortas="b-dbus-daemon"> dbus-daemon </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="dbus-launch">
         <term><command>dbus-launch</command> </term>
         <listitem>
            <para>
               est utilisé pour démarrer <command>dbus-daemon</command> depuis un script shell. Il
               est en principe appelé par des scripts de connexion d'un utilisateur. 
            </para> 
            <indexterm zone="dbus dbus-launch">
               <primary sortas="b-dbus-launch"> dbus-launch </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="dbus-monitor">
         <term><command>dbus-monitor</command> </term>
         <listitem>
            <para>
               est utilisé pour surveiller les messages à travers un bus de messages
               <application>D-BUS</application> . 
            </para> 
            <indexterm zone="dbus dbus-monitor">
               <primary sortas="b-dbus-monitor"> dbus-monitor </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="dbus-send">
         <term><command>dbus-send</command> </term>
         <listitem>
            <para>
               est utilisé pour envoyer un message à un bus de messages
               <application>D-BUS</application> . 
            </para> 
            <indexterm zone="dbus dbus-send">
               <primary sortas="b-dbus-send"> dbus-send </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="dbus-uuidgen">
         <term><command>dbus-uuidgen</command> </term>
         <listitem>
            <para>
               est utilisé pour générer ou lire un ID gunique universel. 
            </para> 
            <indexterm zone="dbus dbus-uuidgen">
               <primary sortas="b-dbus-uuidgen"> dbus-uuidgen </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      
      <varlistentry id="libdbus-1">
         <term><filename class='libraryfile'>/etc/dbus-1/system.d/nm-vpnc-service.conf</filename>
         </term>
         <listitem>
            <para>
               contient les fonctions de l'API utilisées par le démon de messages
               <application>D-BUS</application> . <application>D-BUS</application> est d'abord une
               bibliothèque qui fournit une communication directe entre deux applications;
               <command>dbus-daemon</command> est une application qui utilise cette bibliothèque
               pour implémenter un démon de bus de messages. 
            </para> 
            <indexterm zone="dbus libdbus-1">
               <primary sortas="c-libdbus-1"> libdbus-1.{so,a} </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      </variablelist>
      
   </sect2>
   
</sect1>
