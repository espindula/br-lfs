<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
    "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
   <!ENTITY % general-entities SYSTEM "../../general.ent">
   %general-entities;
   
   <!ENTITY autofs-patch-dir     "http://ftp.kernel.org/pub/linux/daemons/autofs/v5">
   <!ENTITY autofs-download-http "http://ftp.kernel.org/pub/linux/daemons/autofs/v5/autofs-&autofs-version;.tar.bz2">
   <!ENTITY autofs-download-ftp  "ftp://ftp.kernel.org/pub/linux/daemons/autofs/v5/autofs-&autofs-version;.tar.bz2">
   <!ENTITY autofs-md5sum        "a1d262cb6ebef0c2dd0fe22232fb3d5a">
   <!ENTITY autofs-size          "295 Kio">
   <!ENTITY autofs-buildsize     "5.3 Mio">
   <!ENTITY autofs-time          "0.1 SBU">
   
]>
<sect1 id="autofs" xreflabel="Autofs-&autofs-version;">
   <?dbhtml filename="autofs.html"?>
   
   <sect1info>
      <othername>$LastChangedBy: bdubbs $</othername>
      <date>$Date: 2012-03-07 21:24:17 +0100 (mer. 07 mars 2012) $</date>
   </sect1info>
   
   <title>Montage automatique des systèmes de fichiers</title> 
   
   <indexterm zone="autofs">
      <primary sortas="a-Autofs"> Autofs </primary>
   </indexterm>
   
   <sect2 role="package">
      <title>Introduction à Autofs</title> 
      
      <para>
         Le paquet <application>Autofs</application> contient des outils pour les utilisateurs
         fonctionnant avec le noyau pour monter et démonter des systèmes de fichiers amovibles. Son
         utilisation première consiste dans le montage de systèmes de fichiers réseaux externes
         comme NFS (voir <xref linkend="nfs-utils"/>) ou Samba (voir <xref linkend="samba3"/>
         ) à la demande. 
      </para> 
      
      <para>
         Il peut aussi être utile pour permettre aux utilisateurs de monter des disquettes, des
         cdroms et d'autres périphériques de stockage amovibles sans devoir faire appel à
         l'administrateur système pour monter les périphériques. 
      </para> 
      
      <bridgehead renderas="sect3"> Informations sur le paquet </bridgehead>
      <itemizedlist spacing="compact">
         <listitem>
            <para>
               Téléchargement (HTTP): <ulink url="&autofs-download-http;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Téléchargement (FTP): <ulink url="&autofs-download-ftp;"/> 
            </para> 
         </listitem>
         <listitem>
            <para>
               Somme de contrôle MD5 du téléchargement: &autofs-md5sum; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Taille du téléchargement: &autofs-size; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation de l'espace disque requis: &autofs-buildsize; 
            </para> 
         </listitem>
         <listitem>
            <para>
               Estimation du temps de construction: &autofs-time; 
            </para> 
         </listitem>
      </itemizedlist>
      
      <bridgehead renderas="sect3"> Téléchargements supplémentaires </bridgehead>
      
      <para>
         Correctifs recommandés: Il y a des correctifs fréquents appliqués à
         <application>Autofs</application> . Une des méthodes que vous pouvez utiliser pour
         récupérer les correctifs actuels exige d'installer préalablement le paquet <xref
         linkend="wget"/>. Après vous être assuré que la commande <command>wget</command> est
         installée dans un répertoire identifié dans la variable <envar>PATH </envar>, placez-vous
         dans le même répertoire que le fichier tar principal et lancez les commandes suivantes:  
      </para> 
      
<screen><userinput>wget &autofs-patch-dir;/patch_order-&autofs-version; &amp;&amp;
sed 's;autofs;&autofs-patch-dir;/autofs;' \
    patch_order-&autofs-version; | grep -v ^# &gt; wget-list &amp;&amp;
wget -i wget-list</userinput></screen>
      
      <note> 
         <para>
            A ce jour, la liste de correctifs contient un patch étiquetés comme étant issus de la
            série de patchs 5.0.4. 
         </para> 
      </note>
      
      <bridgehead renderas="sect3"> Dépendances d'Autofs </bridgehead>
      
      <bridgehead renderas="sect4"> Facultatives </bridgehead>
      
      <para role="optional">
         <xref linkend="openldap"/>et <xref linkend="cyrus-sasl"/>
      </para> 
      
      <para condition="html" role="usernotes">
         Notes utilisateur: <ulink url="&blfs-wiki;/autofs"/> 
      </para> 
      
   </sect2>
   
   <sect2 role="kernel" id="autofs-kernel">
      <title>Configuration du noyau</title> 
      
      <indexterm zone="autofs autofs-kernel">
         <primary sortas="d-Automounter"> Automounter </primary>
      </indexterm>
      
      <para>
         Vérifiez que le support du noyau a été construit en dur ou en module dans les endroits
         suivants: 
      </para> 
      
<screen><literal>
</literal>
</screen>
      
      <para>
         Recompilez et installez le nouveau noyau si nécessaire. 
      </para> 
      
   </sect2>
   
   <sect2 role="installation">
      <title>Installation d'Autofs</title> 
      
      <para>
         Installez <application>Autofs</application> en lançant les commandes suivantes: 
      </para> 
      
<screen><userinput>for f in `cat ../patch_order-&autofs-version;`; do
  patch -Np1 -i ../$f
done &amp;&amp;
./configure --prefix=/ --mandir=/usr/share/man &amp;&amp;
make</userinput></screen>
      
      <para>
         Ce paquet n'est pas fourni avec une suite de tests. 
      </para> 
      
      <para>
         Maintenant, en tant qu'utilisateur <systemitem class="username"> root </systemitem>&nbsp;: 
         
      </para> 
      
<screen role="root">
<userinput>make install &amp;&amp;
ln -sf  ../init.d/autofs /etc/rc.d/rcsysinit.d/S52autofs</userinput></screen>
      
   </sect2>
   
   <sect2 role="commands">
      <title>Explication des commandes</title> 
      
      <para>
         <command>for f in `cat ../patch_order-&autofs-version;`; do patch -Np1 -i ../$f; 
         done</command> >&nbsp;:nbsp;: Cette commande applique tous les correctifs téléchargés plus
         haut dans le bon ordre. 
      </para> 
      
      <para>
         <command>ln -sf  ../init.d/autofs /etc/rc.d/rcsysinit.d/S52autofs</command> >&nbsp;:nbsp;:
         Cette commande règle le lien pour démarrer correctement autofs au démarrage. 
      </para> 
      
   </sect2>
   
   <sect2 role="configuration">
      <title>Configuration d'Autofs</title> 
      
      <sect3 id="autofs-config">
         <title>Fichiers de configuration</title> 
         
         <para>
            <filename>/etc/sysconfig/autofs.conf</filename> , <filename>/etc/auto.master</filename>
            , <filename>/etc/auto.misc</filename> et <filename>/etc/auto.net</filename> 
         </para> 
         <indexterm zone="autofs autofs-config">
            <primary sortas="e-etc-sysconfig-autofs.conf"> /etc/sysconfig/autofs.conf </primary>
         </indexterm>
         <indexterm zone="autofs autofs-config">
            <primary sortas="e-etc-auto.master"> /etc/auto.master </primary>
         </indexterm>
         <indexterm zone="autofs autofs-config">
            <primary sortas="e-etc-auto.misc"> /etc/auto.misc </primary>
         </indexterm>
         <indexterm zone="autofs autofs-config">
            <primary sortas="e-etc-auto.net"> /etc/auto.net </primary>
         </indexterm>
         
      </sect3>
      
      <sect3>
         <title>Informations de configuration</title> 
         
         <para>
            Le processus d'installation crée <filename>auto.master</filename> ,
            <filename>auto.misc</filename> , <filename>auto.smb</filename> et
            <filename>auto.net</filename> . Remplace thez le fichier
            <filename>auto.master</filename> avec les commandes suivantes: 
         </para> 
         
<screen role="root">
<userinput>mv /etc/auto.master /etc/auto.master.bak &amp;&amp;
cat &gt; /etc/auto.master &lt;&lt; "EOF"
<literal>
</literal>
EOF</userinput></screen>
         
         <para>
            Ce fichier crée un nouveau répertoire de médias, <filename>/media/auto</filename> qui
            englobera tous les répertoires existants du même nom. Dans l'exemple, le fichier
            <filename>/etc/auto.misc</filename> , contient une ligne: 
         </para> 
         
<screen>-cd   -fstype=iso9660,ro,nosuid,nodev&nbsp;:/dev/cdrom
</screen>
         
         <para>
            ce qui montera un cdrom en tant que <filename>/media/auto/cd</filename> si ce répertoire
            est accessible. L'option <option>
            --ghost </option>
            dit à l'automounteur de créer des versions <quote>fantômes </quote> (c'est-à-dire des
            répertoires vides) de tous les points de montage listés dans le fichier de
            configuration, que les systèmes de fichiers soient effectivement montés ou pas. C'est
            très pratique et fortement recommandé car cela vous affichera les systèmes de fichiers
            qu'on peut monter automatiquement comme des répertoires existants, même quand leur
            système de fichiers n'est pas actuellement monté. Sans l'option <option>
            --ghost </option>
            , vous devrez vous souvenir des noms des répertoires. Dès que vous essaierez d'accéder à
            l'un d'entre eux, le répertoire sera créé et le système de fichiers sera monté. Quand le
            système de fichiers est de nouveau démonté, le répertoire est lui aussi détruit, sauf si
            on a donné l'option <option>
            --ghost </option>
            . 
         </para> 
         
         <note> 
            <para>
               Une méthode alternative serait de spécifier un autre emplacement d'automontage tel
               que <filename class='directory'>/var/lib/auto/cdrom</filename> et de créar un lien
               symbolique de <filename class='directory'>
               /media/cdrom</filename> vers l'emplacement de l'automontage. 
            </para> 
         </note>
         
         <para>
            Le fichier <filename>auto.misc</filename> doit être configuré pour votre matériel. Le
            fichier de configuration chargé chargerait votre cdrom si
            <filename>/dev/cdrom</filename> est actif ou s'il peut être édité pour s'adapter à votre
            configuration de périphériques. Des exemples pour les disquettes sont disponibles dans
            le fichier et facilement activables. La documentation de ce fichier est disponible en
            utilisant la commande <command>man 5 autofs</command> . 
         </para> 
         
         <para>
            Sur la deuxième ligne, s'il est activé, un répertoire home pour l'utilisateur serait
            monté via NFS lors de la connexion.  Le <filename>/etc/home.auto</filename> devrait
            exister et contenir une entrée du genre: 
         </para> 
         
<screen>-joe  example.org:/export/home/joe
</screen>
         
         <para>
            où le répertoire <filename>/export/home/joe</filename> est exporté via NFS à partir du
            système example.org. Les partages NFS sont traités à la page suivante. 
         </para> 
         
         <para>
            On pourrait aussi utiliser ce paquet pour monter des partages SMB mais cette
            fonctionnalité n'est pas configurée dans ces instructions. Pour des informations de
            configuration supplémentaires, voir les pages de man d'auto.master(5).  Il y a aussi des
            ressources Internet telles que celle disponible sur <ulink
            url='http://en.gentoo-wiki.com/wiki/Autofs'> AUTOFS HOWTO </ulink>
            . 
         </para> 
         
      </sect3>
      
   </sect2>
   
   <sect2 role="content">
      <title>Contenu</title> 
      
      <segmentedlist>
         <segtitle>Programme installé</segtitle>
         <segtitle>Bibliothèques installées</segtitle>
         <segtitle>Répertoires installés</segtitle>
         
         <seglistitem>
            <seg>
               automount
            </seg>
            <seg>
               lookup_file.so, lookup_hosts.so, lookup_multi.so, lookup_nisplus.so,
               lookup_program.so, lookup_userhome.so, lookup_yp.so, mount_afs.so, mount_autofs.so,
               mount_bind.so, mount_changer.so, mount_ext2.so, mount_generic.so, mount_nfs.so,
               parse_sun.so
            </seg>
            <seg>
               /lib/autofs et /var/run/autofs
            </seg>
         </seglistitem>
      </segmentedlist>
      <variablelist>
      
      <bridgehead renderas="sect3"> Descriptions courtes </bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      
      <varlistentry id="automount">
         <term><command>automount</command> </term>
         <listitem>
            <para>
               est le démon qui effectue un montage quand on sollicite un périphérique. 
            </para> 
            <indexterm zone="autofs automount">
               <primary sortas="b-automount"> automount </primary>
            </indexterm>
         </listitem>
      </varlistentry>
      </variablelist>
      
   </sect2>
   
</sect1>
