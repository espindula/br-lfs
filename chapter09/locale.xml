<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-config-locale" revision="systemd">
  <?dbhtml filename="locale.html"?>

  <title>Configurando o Locale do Sistema</title>

  <indexterm zone="ch-config-locale">
    <primary sortas="e-etc-locale-conf">/etc/locale.conf</primary>
  </indexterm>

  <para>O arquivo <filename>/etc/locale.conf</filename> abaixo configura algumas
variáveis de ambiente necessárias para suporte ao idioma
nativo. Configurá-las adequadamente resulta em:</para>

  <itemizedlist>
    <listitem>
      <para>A saída gerada de aplicativos sendo traduzida para seu idioma nativo</para>
    </listitem>
    <listitem>
      <para>A classificação correta dos caracteres em letras, dígitos e outras
classes. Isso é necessário para o <command>bash</command> aceitar
adequadamente caracteres não ASCII em linhas de comando em locales não
ingleses</para>
    </listitem>
    <listitem>
      <para>A sequência de ordenação alfabética correta para o país</para>
    </listitem>
    <listitem>
      <para>O apropriado tamanho padrão de papel</para>
    </listitem>
    <listitem>
      <para>A formatação correta dos valores monetário, hora e data</para>
    </listitem>
  </itemizedlist>

  <para>Substitua <replaceable>&lt;ll&gt;</replaceable> abaixo pelo código de duas
letras para seu idioma desejado (por exemplo, <quote>en</quote>) e
<replaceable>&lt;CC&gt;</replaceable> pelo código de duas letras para o país
apropriado (por exemplo,
<quote>GB</quote>). <replaceable>&lt;charmap&gt;</replaceable> deveria ser
substituído pelo mapa de caracteres canônico para seu locale
escolhido. Modificadores opcionais, tais como <quote>@euro</quote>,
possivelmente também estejam presentes.</para>

  <para>A lista de todos os locales suportados pela Glibc pode ser obtida
executando-se o seguinte comando:</para>

<screen role="nodump"><userinput>locale -a</userinput></screen>

  <para>Mapas de caracteres podem ter um número de apelidos, por exemplo,
<quote>ISO-8859-1</quote> também é referenciado como
<quote>iso8859-1</quote> e <quote>iso88591</quote>. Alguns aplicativos não
conseguem lidar com os vários sinônimos corretamente (por exemplo, exigem
que <quote>UTF-8</quote> seja escrito como <quote>UTF-8</quote>, não
<quote>utf8</quote>), de forma que é mais seguro, na maioria dos casos,
escolher o nome canônico para um locale específico. Para determinar o nome
canônico, execute o seguinte comando, onde <replaceable>&lt;nome do
locale&gt;</replaceable> é a saída gerada dada por <command>locale
-a</command> para seu locale preferido (<quote>en_GB.iso88591</quote> no
nosso exemplo).</para>

<screen role="nodump"><userinput>LC_ALL=<replaceable>&lt;nome do locale&gt;</replaceable> mapa de caracteres do locale</userinput></screen>

  <para>Para o locale <quote>en_GB.iso88591</quote>, o comando acima imprimirá:</para>

<screen><computeroutput>ISO-8859-1</computeroutput></screen>

  <para>Isso resulta em uma configuração final de "locale" de
<quote>en_GB.ISO-8859-1</quote>. É importante que o "locale" encontrado
usando-se a heurística acima seja testado antes que ele seja adicionado aos
arquivos de inicialização do Bash:</para>

<screen role="nodump"><userinput>LC_ALL=&lt;nome do locale&gt; locale language
LC_ALL=&lt;nome do locale&gt; locale charmap
LC_ALL=&lt;nome do locale&gt; locale int_curr_symbol
LC_ALL=&lt;nome do locale&gt; locale int_prefix</userinput></screen>

  <para>Os comandos acima deveriam imprimir o nome do idioma, a codificação de
caracteres usada pelo locale, a moeda local, e o prefixo para discar antes
do número de telefone para a finalidade de se alcançar o país. Se quaisquer
dos comandos acima falhar com uma mensagem similar àquela mostrada abaixo,
[então] isso significa que seu locale ou não foi instalado no
Capítulo&nbsp;8 ou não é suportado pela instalação padrão da Glibc.</para>

<screen><computeroutput>locale: Cannot set LC_* to default locale: No such file or directory</computeroutput></screen>

  <para>Se isso acontecer, [então] você deveria ou instalar o locale desejado usando
o comando <command>localedef</command>, ou considerar escolher um locale
diferente. As instruções posteriores assumem que não existem tais mensagens
de erro originárias da Glibc.</para>

  
  <!-- FIXME: the xlib example will become obsolete in the future.-->
<para>Alguns pacotes além do LFS também possivelmente careçam de suporte para seu
locale escolhido. Um exemplo é a biblioteca do X (parte do X Window System),
a qual externaliza a seguinte mensagem de erro se o locale não corresponder
exatamente a um dos nomes de mapa de carácter nos arquivos internos dela:</para>

<screen><computeroutput>Warning: locale not supported by Xlib, locale set to C</computeroutput></screen>

  <para>Em vários casos, a Xlib espera que o mapa de carácter será listado em
notação de letras maiúsculas com hifens canônicos. Por exemplo, "ISO-8859-1"
em vez de "iso88591". Também é possível encontrar uma especificação
apropriada removendo-se a parte do mapa de carácter da especificação de
locale. Isso pode ser verificado executando-se o comando <command>locale
charmap</command> em ambos os locales. Por exemplo, alguém poderia ter que
mudar "de_DE.ISO-8859-15@euro" para "de_DE@euro" para a finalidade de
conseguir que esse locale fosse reconhecido pela Xlib.</para>

  <para>Outros pacotes também podem funcionar incorretamente (mas, possivelmente não
necessariamente exibam quaisquer mensagens de erro) se o nome do locale não
corresponder às expectativas deles. Nesses casos, investigar-se como outras
distribuições do Linux suportam seu locale poderia fornecer alguma
informação útil.</para>

  <para>Uma vez que as configurações adequadas de locale tenham sido determinadas,
crie o arquivo <filename>/etc/locale.conf</filename>:</para>

<screen><userinput>cat &gt; /etc/locale.conf &lt;&lt; "EOF"
<literal>LANG=<replaceable>&lt;ll&gt;_&lt;CC&gt;.&lt;mapa_caracteres&gt;&lt;@modificadores&gt;</replaceable></literal>
EOF</userinput></screen>

  <para>Observe que você consegue modificar o <filename>/etc/locale.conf</filename>
com o utilitário <command>localectl</command> do systemd. Para usar o
<command>localectl</command> para o exemplo acima, execute:</para>

<screen role="nodump"><userinput>localectl set-locale LANG="<replaceable>&lt;ll&gt;_&lt;CC&gt;.&lt;mapa_caracteres&gt;&lt;@modificadores&gt;</replaceable>"</userinput></screen>

  <para>Você também pode especificar outras variáveis de ambiente específicas de
idioma, tais como <envar>LANG</envar>; <envar>LC_CTYPE</envar>;
<envar>LC_NUMERIC</envar>; ou qualquer outra variável de ambiente oriunda da
saída gerada de <command>locale</command>. Apenas separe-as com um
espaço. Um exemplo onde <envar>LANG</envar> é configurada como en_US.UTF-8,
porém <envar>LC_CTYPE</envar> é configurada apenas como en_US é:</para>

<screen role="nodump"><userinput>localectl set-locale LANG="en_US.UTF-8" LC_CTYPE="en_US"</userinput></screen>

  <note><para>Por favor, observe que o comando <command>localectl</command> não funciona
no ambiente chroot. Ele somente pode ser usado depois que o sistema LFS for
inicializado com o systemd.</para></note>

  <para>Os locales <quote>C</quote> (padrão) e <quote>en_US</quote> (aquele
recomendado para usuários(as) do inglês dos Estados Unidos da América do
Norte) são diferentes. <quote>C</quote> usa o conjunto de caracteres de 7
bits US-ASCII e trata bytes com o bit de ordem alta configurado como
caracteres inválidos. Esse é o porquê, por exemplo, do comando
<command>ls</command> substitui-los por pontos de interrogação nesse
locale. Também, uma tentativa de enviar correio com tais caracteres a partir
do Mutt ou do Pine resulta em mensagens de não conformidade com RFC sendo
enviadas (o conjunto de caracteres no correio de saída é indicado como
<quote>unknown 8-bit</quote>). É sugerido que você use o locale
<quote>C</quote> somente se tiver certeza de que nunca precisará de
caracteres de 8 bits.</para>



<!--
  <para>
UTF-8 based locales are not supported well by many programs.
  Work is in progress to document and, if possible, fix such problems, see
  <ulink url="&blfs-book;introduction/locale-issues.html"/>.</para>
-->
</sect1>
