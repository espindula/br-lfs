<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-systemd-network">
  <?dbhtml filename="systemd-network.html"?>

  <title>Configuration du réseau avec Systemd-networkd</title>

  <sect2 role="interface-config">
    <title>Configuration de l'interface réseau</title>

    <note><para>Udev peut assigner des noms d'interface réseau pour quelques cartes comme
    enp2s1. SI vous n'êtes pas sur du nom de votre interface réseau, vous pouvez toujours lancer
    <command>ip l</command> après avoir démarré votre système. Il est important que la variable
    <envar>Name</envar> dans
    <filename>/etc/systemd/network</filename> contient le bon nom d'interface réseau (par exemple
    <envar>Name=enp2s1</envar>ou
    <envar>Name=eth0</envar>) ou systemd échouera à monter votre interface réseau.</para></note>

    <sect3 role="static">
      <title>Configuration statique de l'interface réseau</title>

      <para><command>systemd-networkd</command> utilise
      <filename>/etc/system/network</filename> pour les fichiers de configuration. Réferez vous à
      systemd.network(5) et systemd.netdev(5). Configurez une interface réseau avec un fichier de config.
      Ajustez le Name= comme requis:</para>

  <screen role="nodump"><userinput>cd /etc/systemd/network &amp;&amp;
cat &gt; static.network &lt;&lt; "EOF"
[Match]
Name=enp2s0

[Network]
Address=192.168.1.1/24
Gateway=192.168.1.2
EOF</userinput></screen>

      <para os="var-ob">Les valeurs de ses variables doivent être changée dans chaque fichier pour correspondre
      à votre initialisation propre.
      </para>

      <para os="var-i">La variable <envar>Name</envar> défini le nom de l'interface, par exemple
      eth0. C'est requis par tous les fichiers de configuration des périphériques réseau.
      </para>

      <para>La variable <envar>Gateway</envar> doit contenir l'adresse IP de la passerelle par défaut, si une est présente.
      Sinon, alors commenter la variable.
      </para>

      <para>Pour plus d'information regardez la page de man <command>systemd.netdev</command>.</para>

    </sect3>

    <sect3 role="dhcp">
      <title>Connexion à un réseau avec DHCP</title>

    <para><command>systemd-networkd</command> utilise
    <filename>/etc/systemd/network</filename> pour les fichiers de configuration. Référez vous à 
    <filename>systemd.network(5)</filename> et
    <filename>systemd.netdev(5)</filename>. Configurez une interface réseau avec un fichier de config. Ajustez
     Name= comme requis:</para>

<screen role="nodump"><userinput>cd /etc/systemd/network &amp;&amp;
cat &gt; dhcp.network &lt;&lt; "EOF"
[Match]
Name=enp2s0

[Network]
DHCP=yes
EOF</userinput></screen>

    <para><command>systemd-networkd</command> configurera automatiquement
    <filename>/run/systemd/network/resolv.conf</filename> en utilisant DHCP.
    Si vous n'avez pas créé manuellement <filename>/etc/resolv.conf</filename>,
    créez un lien symbolique:</para>

<screen role="nodump"><userinput>ln -sv /run/systemd/network/resolv.conf /etc</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="timesyncd">
    <title>Utilisation de Timesyncd</title>

    <para>Systemd inclu un démon client NTP simple,
    <command>systemd-timesyncd</command>, qui est désactivé par défaut. Si vous voulez l'activer, 
    vous devrez en premier ajouter un groupe et un utilisateur requis:
    </para>

<screen role="nodump"><userinput>groupadd -g &gid-systemd-timesync; systemd-timesync
useradd -g systemd-timesync -u &uid-systemd-timesync; -d /dev/null -s /bin/false systemd-timesync</userinput></screen>

    <para>Ensuite, activez <command>systemd-timesyncd</command> pour qu'il soit lancé au démarrage du système:
    </para>

<screen role="nodump"><userinput>systemctl enable systemd-timesyncd</userinput></screen>

    <para>Vous pouvez configurer <command>systemd-timesyncd</command> en éditant
    <filename>/etc/systemd/timesyncd.conf</filename>.</para>

  <para>Continuez avec <xref linkend="chapter-bootable"/>.</para>

  </sect2>

</sect1>
