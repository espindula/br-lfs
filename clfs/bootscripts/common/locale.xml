<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-scripts-locale">
  <title>Paramétrer les informations de locale</title>
  <?dbhtml filename="locale.html"?>

  <indexterm zone="ch-scripts-locale">
    <primary sortas="e-/etc/profile">/etc/profile</primary>
  </indexterm>

  <para>Le <filename>/etc/profile</filename> de base ci-dessous paramètre certaines variables d'environnement nécessaires pour le 
  paramétrage de la langue maternelle. Il résulte de leur paramétrage correct que&nbsp;:</para>

  <itemizedlist>
    <listitem>
      <para>La sortie des programmes est traduite dans la langue maternelle</para>
    </listitem>
    <listitem>
      <para>Les caractères sont correctement rangés en lettres, chiffres et autres classes. C'est nécessaire pour que
      <command>bash</command> accepte correctement les caractères non ASCII sur les lignes de commande dans des locales non anglaises</para>
    </listitem>
    <listitem>
      <para>L'ordre alphabétique est correct pour le pays</para>
    </listitem>
    <listitem>
      <para>La taille du papier par défaut est correcte</para>
    </listitem>
    <listitem>
      <para>Le format des monnaies, date et heure est correct</para>
    </listitem>
  </itemizedlist>

  <para>Ce script paramètre aussi la variable d'environnement <envar>INPUTRC</envar> qui fait utiliser à Bash et Readline le fichier 
  <filename>/etc/inputrc</filename> créé plus tôt.</para>

  <para>Remplacez <replaceable>[ll]</replaceable> ci-dessous par le code à deux lettres de la langue désirée (e.g., <quote>en</quote>) et
  <replaceable>[CC]</replaceable> par le code à deux lettres pour le pays approprié (e.g., <quote>GB</quote>).
  Vous devriez remplacer <replaceable>[charmap]</replaceable> par le plan de caractère canonique pour la locale que vous avez choisie.</para>

  <para>Vous pouvez obtenir la liste de toutes les locales supportées par Glibc en lançant la commande suivante&nbsp;:</para>

<screen role="nodump"><userinput>locale -a</userinput></screen>

  <para>Les locales peuvent avoir un certain nombre de synonymes, e.g. <quote>ISO-8859-1</quote> est aussi référencé en tant que
  <quote>iso8859-1</quote> et <quote>iso88591</quote>. Certaines applications ne peuvent pas gérer correctement les divers synonymes, donc 
  il est plus prudent de choisir le nom canonique pour une locale particulière. Pour déterminer le nom canonique, lancez la commande 
  suivante, où <replaceable>[nom_locale]</replaceable> est la sortie donnée par <command>locale -a</command> pour votre locale
  préférée (<quote>en_US.utf8</quote> dans notre exemple).</para>

<screen role="nodump"><userinput>LC_ALL=<replaceable>[nom_locale]</replaceable> locale charmap</userinput></screen>

  <para>Pour la locale <quote>en_US.utf8</quote>, la commande ci-dessus affichera&nbsp;:</para>

<screen><computeroutput>UTF-8</computeroutput></screen>

  <para>Cela donne un paramétrage final de la locale de <quote>en_US.UTF-8</quote>. Il est important que la locale trouvée en utilisant la
  méthode ci-dessus soit testé en priorité puis ajoutée au fichiers de démarrage de Bash&nbsp;:</para>

<screen role="nodump"><userinput>LC_ALL=[nom_locale] locale country
LC_ALL=[no_locale] locale language
LC_ALL=[nom_locale] locale charmap
LC_ALL=[nom_locale] locale int_curr_symbol
LC_ALL=[nom_locale] locale int_prefix</userinput></screen>

  <para>Les commandes ci-dessus devraient afficher le nom de la langue, l'encodage utilisé par la locale, la locale actuelle et le préfixe
  téléphonique à mettre devant le numéro du pays. Si une commande ci-dessus échoue avec un message similaire à celui montré ci-dessous, cela 
  signifie que votre locale soit n'a pas été installée au chapitre 10, soit n'est pas supportée par l'installation par défaut de 
  Glibc.</para>

<screen><computeroutput>locale: Cannot set LC_* to default locale: No such file or directory</computeroutput></screen>

  <para>Si cela se produit, soit vous devriez installer la locale désirée en utilisant la commande 
  <command>localedef</command>, soit vous devriez envisager d'utiliser une autre locale. Les instructions ci-après supposent qu'il n'y a pas 
  un tel message d'erreur de Glibc.</para>

  <para>Certains paquets au-delà de CLFS peuvent ne pas supporter la locale que vous avez choisie. Un exemple réside dans la bibliothèque X 
  (partie du X Window System), qui sort le message d'erreur suivant&nbsp;:</para>

<screen><computeroutput>Warning: locale not supported by Xlib, locale set to C</computeroutput></screen>

  <para>Il est parfois possible de corriger cela en supprimant la partie charmap de la spécification de la locale, tant que cela ne change 
  pas le plan de codage associé par Glibc à la locale (vous pouvez le vérifier en lançant la commande
  <command>locale charmap</command> dans les deux locales). Par exemple, vous pourriez devoir changer &quot;de_DE.ISO-8859-15@euro&quot; en
  &quot;de_DE@euro&quot; pour que cette locale soit reconnue par Xlib.</para>

  <para>D'autres paquets peuvent mal fonctionner (mais ils n'affichent pas nécessairement de messages d'erreur) si le nom de la locale ne 
  correspond pas à ce qu'ils attendent. Dans de tels cas, en enquêtant sur la manière dont d'autres distributions Linux supportent votre 
  locale, vous pourriez obtenir quelques renseignements utiles.</para>

  <para>Une fois que vous avez déterminé les bons paramètres de locale, créez le fichier
  <filename>/etc/profile</filename>&nbsp;:</para>

<screen><userinput>cat &gt; /etc/profile &lt;&lt; "EOF"
<literal># Begin /etc/profile

export LANG=<replaceable>[ll]</replaceable>_<replaceable>[CC]</replaceable>.<replaceable>[charmap]</replaceable>
export INPUTRC=/etc/inputrc

# End /etc/profile</literal>
EOF</userinput></screen>

  <para>Le paramétrage du plan de clavier, de la police d'écran et des variables d'environnement liées à la locale est la seule étape 
  d'internationalisation nécessaire pour supporter les locales qui utilisent des encodages unicodes ordinaires et l'écriture de gauche à 
  droite. L'UTF-8 a été testé sur les locales anglaises, françaises, allemandes, italiennes et espagnoles. Toutes les autres locales n'ont 
  pas été testées. Si vous rencontrez des problèmes avec une autre locale, merci d'ouvrir un ticket sur notre système de trac.</para>

  <para>Certaines locales ont besoin de programmes et d'un support supplémentaires. CLFS ne supportera pas ces locales dans son livre. Les 
  ajouts de support pour ces locales sont bienvenues sur <ulink url="&cblfs-root;"/>.</para>

</sect1>
