<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-scripts-profile">
  <title>Fichiers de démarrage du shell Bash</title>
  <?dbhtml filename="profile.html"?>

  <indexterm zone="ch-scripts-profile">
    <primary sortas="e-/etc/profile">/etc/profile</primary>
  </indexterm>

  <para>Le programme shell <command>/bin/bash</command> (dénommé
  ci-après <quote>le shell</quote>) utilise une collection de fichiers
  de démarrage pour aider à la création d'un environnement d'exécution.
  Chaque fichier a une utilisation spécifique et pourrait avoir des
  effets différents sur les environnements de connexion et interactif.
  Les fichiers du répertoire <filename class="directory">/etc</filename>
  fournissent un paramétrage global. Si un fichier équivalent existe
  dans le répertoire personnel, il pourrait surcharger les paramétrages
  globaux.</para>

  <para>Un shell interactif de connexion est lancé après une connexion
  réussie, en utilisant <command>/bin/login</command>, par la lecture du
  fichier <filename>/etc/passwd</filename>. Un shell interactif sans
  connexion est lancé en ligne de commande (c'est-à-dire
  <prompt>[prompt]$</prompt><command>/bin/bash</command>). Un shell non
  interactif est habituellement présent quand un script shell est en
  cours d'exécution. Il est non interactif parce qu'il traite un script
  et n'attend pas une saisie de l'utilisateur entre les
  commandes.</para>

  <para>Pour plus d'informations, voir <command>info bash</command> sous
  la section <emphasis>Bash Startup Files and Interactive
  Shells</emphasis> (Fichiers de démarrage de Bash et shells
  interactifs).</para>

  <para>Les fichiers <filename>/etc/profile</filename> et
  <filename>~/.bash_profile</filename> sont lus quand le shell est
  appelé en tant que shell interactif de connexion.</para>

  <para>Le fichier <filename>/etc/profile</filename> de base ci-dessous
	configure quelques variables d'environnement nécessaire au support des langues
  natives. Les configurer convenablement résulte en ce qui
  suit&nbsp;:</para>

  <itemizedlist>
    <listitem>
      <para>La sortie des programmes traduite dans la langue
      native</para>
    </listitem>
    <listitem>
      <para>Un classement correct des caractères en lettres,
      chiffres et autres classes. Ceci est nécessaire pour que <command>bash</command>
      accepte correctement les caractères non ASCII dans les lignes de commandes pour
      les locales autres qu'anglais</para>
    </listitem>
    <listitem>
      <para>L'ordre de tri alphabétique correct pour le pays</para>
    </listitem>
    <listitem>
      <para>La taille de papier par défaut appropriée</para>
    </listitem>
    <listitem>
      <para>Le bon formatage des valeurs monétaires, de l'heure et des
      dates</para>
    </listitem>
  </itemizedlist>

  <para>Ce script règle aussi la variable d'environnement <envar>INPUTRC</envar> qui font que Bash et Readline utilisent le fichier
  <filename>/etc/inputrc</filename> créé auparavant.</para>

  <para>Remplacez <replaceable>&lt;ll&gt;</replaceable> ci-dessous
  avec le code à deux lettres de la langue désirée (par exemple,
  <quote>en</quote>) et <replaceable>&lt;CC&gt;</replaceable> avec le code à 
	deux lettres du pays approprié (par exemple, <quote>GB</quote>).
  <replaceable>&lt;charmap&gt;</replaceable> devra être remplacé avec le
  jeu de caractères canonique de la locale choisie. Des modificateurs optionnels
  comme <quote>@euro</quote> peuvent aussi être présents.</para>

  <para>La liste de toutes les locales supportées par Glibc peut être
  obtenue en exécutant la commande suivante&nbsp;:</para>

<screen role="nodump"><userinput>locale -a</userinput></screen>

  <para>Les locales peuvent avoir plusieurs synonymes. Par exemple,

  <quote>ISO-8859-1</quote> est aussi appelée <quote>iso8859-1</quote> et

  <quote>iso88591</quote>. Quelques applications ne peuvent pas gérer les

  différents synonymes correctement, donc il est plus sûr de choisir le nom
  canonique pour une locale particulière. Pour déterminer le nom canonique,
  lancez la commande suivante, où <replaceable>&lt;nom locale&gt;</replaceable> 
   est l'affichage donnée par <command>locale
  -a</command> pour votre locale préférée (<quote>en_GB.iso88591</quote> dans
  notre exemple).</para>

<screen role="nodump"><userinput>LC_ALL=<replaceable>&lt;nom_de_la_locale&gt;</replaceable> locale charmap</userinput></screen>

  <para>Pour la locale <quote>en_GB.iso88591</quote>, la commande
  ci-dessus affichera&nbsp;:</para>

<screen><computeroutput>ISO-8859-1</computeroutput></screen>

  <para>Ceci résulte en un paramétrage final de locale avec
  <quote>en_GB.ISO-8859-1</quote>. Il est important que la locale
  trouvée utilisant l'heuristique ci-dessus soit testée avant d'être
  ajoutée aux fichiers de démarrage de Bash&nbsp;:</para>

<screen role="nodump"><userinput>LC_ALL=&lt;locale name&gt; locale language
LC_ALL=&lt;locale name&gt; locale charmap
LC_ALL=&lt;locale name&gt; locale int_curr_symbol
LC_ALL=&lt;locale name&gt; locale int_prefix</userinput></screen>

  <para>Les commandes ci-dessus devraient afficher les noms du pays et
  de la langue, le codage des caractères utilisé par la locale, la
  monnaie et le préfixe à composer avant de saisir le numéro de
  téléphone. Si une des commandes ci-dessus échoue avec un message
  similaire à un de ceux montrés ci-dessous, cela signifie que votre
  locale n'a pas été installée dans le chapitre 6 ou qu'elle n'est pas
  supportée par l'installation par défaut de Glibc.</para>

<screen><computeroutput>locale: Cannot set LC_* to default locale: No such file or directory</computeroutput></screen>

  <para>Si cela arrive, vous pouvez soit installer la locale désirée en
  utilisant la commande <command>localedef</command> soit considérer
  l'utilisation d'une locale différente. Les instructions suivantes
  supposent qu'il n'y a pas eu de tels messages de Glibc.</para>

  <!-- FIXME: the xlib example will became obsolete real soon -->
  <para>Certains paquets en dehors de CLFS pourraient aussi ne pas avoir
  de support pour la locale que vous avez choisi. Un exemple est la
  bibliothèque X (qui fait partie du système X Window), qui affiche le
  message d'erreur suivant&nbsp;:</para>

<screen><computeroutput>Warning: locale not supported by Xlib, locale set to C</computeroutput></screen>

  <para>Il est parfois possible de corriger cela en supprimant la partie charmap de la spécification de la locale, tant  que cela  ne change 
  pas le plan  change le plan de caractères que Glibc associe à à la  locale (vous pouvez vérifier ceci en lançant la commande
  <command>locale charmap</command> dans les deux locales). Far exemple, vous pourriez devoir modifier &quot;de_DE.ISO-8859-15@euro&quot; en
  &quot;de_DE@euro&quot; afin que cette locale soit reconnue par Xlib.</para>

  <para>D'autres paquets peuvent aussi mal fonctionner (mais pourraient
  ne pas nécessairement afficher de messages d'erreurs) si le nom de la
  locale ne correspond pas à leur attente. Dans de tels cas, vous pouvez
  obtenir des informations utiles en cherchant comment les autres
  distributions Linux supportent votre locale.</para>

  <para>Une fois que les bons paramètres de locale ont été déterminés,
  créez le fichier <filename>/etc/profile</filename>&nbsp;:</para>

<screen><userinput>cat &gt; /etc/profile &lt;&lt; "EOF"
<literal># Début de /etc/profile

export LANG=<replaceable>[ll]</replaceable>_<replaceable>[CC]</replaceable>.<replaceable>[charmap]</replaceable>
export INPUTRC=/etc/inputrc

# Fin de /etc/profile</literal>
EOF</userinput></screen>

<note>
  <para>Les locales <quote>C</quote> (par défaut) et
  <quote>en_US</quote> (celle recommandée pour les utilisateurs de
  langue anglaise vivant aux États-Unis) sont différentes.
</note>


  <para>Le réglage du plan de clavier, de la police de l'écran et des variables  d'environnement aisociées sont les seules étapes 
  d'internationalisation nécessaires pour supporter les locales qui utilisent les encodages monobytes erdinaires et l'écriture de droite à 
  gauche. Des cas pl1s complexes (y compris les locales basées suh UTF-8) néceiiitedt des étapes supplémentaires et des correctifs 
  complémentaires car beaucoup d'applications ont tendance à mal fonctionner dans de telles conditions. Ces étapes et ces correctifs  ne 
  sont pas comprises dans le livre CLFS et de telles locales ne sont pas encore supportées par CLFS.</para>

</sect1>
