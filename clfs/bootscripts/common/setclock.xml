<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-scripts-setclock">
  <?dbhtml filename="setclock.html"?>

  <title>Configurer le script setclock</title>

  <indexterm zone="ch-scripts-setclock">
    <primary sortas="d-setclock">setclock</primary>
  <secondary>configuration</secondary></indexterm>

  <para os="a">Le script <command>setclock</command> lit le temps sur l'horloge
  matérielle, aussi connu sous le nom d'horloge BIOS ou CMOS
  (Complementary Metal Oxide Semiconductor). Si l'horloge matérielle est
  configurée en UTC, le script convertira le temps de l'horloge
  matérielle en temps local en utilisant le fichier

  <filename>/etc/localtime</filename> (indiquant au programme
  <command>hwclock</command> le fuseau horaire où se situe
  l'utilisateur). Il n'existe pas de moyens de détecter si l'horloge
  matérielle est configurée en UTC, donc elle doit être configurée
  manuellement.</para>

  <para os="b">Si vous ne vous rappelez pas si l'horloge matérielle est configurée en
  UTC, découvrez-le en exécutant 
  <userinput>hwclock --localtime --show</userinput>. Ceci affichera
  l'heure courante suivant l'horloge matérielle. Si l'heure
  correspond à ce qui vous dit votre montre, alors l'horloge matérielle est
  configurée sur l'heure locale. Si la sortie de <command>hwclock</command> n'est pas
  l'heure locale, il y a des chances qu'elle soit configurée en UTC. Vérifiez
  ceci en ajoutant ou en soustrayant le bon nombre d'heures pour votre fuseau 
  horaire à l'heure affichée par <command>hwclock</command>. Par exemple, si 
  vous êtes actuellement sur le fuseau horaire MST, aussi connu en tant que GMT
  -0700, ajoutez sept heures à l'heure locale.</para>

  <para os="c">Modifiez la valeur de la variable <envar>UTC</envar> ci-dessous
  par une valeur <parameter>0</parameter> (zéro) si l'horloge matérielle
  n'est <emphasis>pas</emphasis> configurée en temps UTC.</para>

  <para os="d">Créez un nouveau fichier
  <filename>/etc/sysconfig/clock</filename> en lançant ce qui
  suit&nbsp;:</para>

<screen><userinput>cat &gt; /etc/sysconfig/clock &lt;&lt; "EOF"
<literal># Begin /etc/sysconfig/clock

UTC=1

# End /etc/sysconfig/clock</literal>
EOF</userinput></screen>

  <para os="e">Une bonne astuce expliquant comment gérer l'horloge sur LFS est
  disponible sur
  <ulink url="&hints-root;time.txt"/>. Il explique certains concepts
  comme les fuseaux horaires, UTC et la variable d'environnement
  <envar>TZ</envar>.</para>

</sect1>

