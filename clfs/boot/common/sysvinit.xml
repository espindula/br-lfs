<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-boot-sysvinit" role="wrap">
  <?dbhtml filename="sysvinit.html"?>

  <title>Sysvinit-&sysvinit-version;</title>

  <indexterm zone="ch-boot-sysvinit">
    <primary sortas="a-Sysvinit">Sysvinit</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet Sysvinit contient des programmes de contrôle du
    démarrage, de l'exécution et de l'arrêt de votre système.</para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Sysvinit</title>

    <para os="p1">Appliquez un correctif pour empêcher l'installation de programmes
    inutiles et permettre à Sysvinit de s'installer dans
    <filename class="directory">/tools</filename>&nbsp;:</para>

<screen os="p2"><userinput>patch -Np1 -i ../sysvinit-&sysvinit-version;-tools_updates-1.patch</userinput></screen>

    <para os="c">Compilez le paquet&nbsp;:</para>

<screen os="d"><userinput>make -C src clobber
make -C src</userinput></screen>

    <para os="e">Installez le paquet&nbsp;:</para>

<screen os="ad"><userinput>make -C src ROOT=/tools install</userinput></screen>

  </sect2>

  <sect2 id="conf-sysvinit" role="configuration">
    <title>Configurer Sysvinit</title>

    <indexterm zone="conf-sysvinit">
      <primary sortas="a-Sysvinit">Sysvinit</primary>
    <secondary>configuration</secondary></indexterm>

    <indexterm zone="conf-sysvinit">
      <primary sortas="e-/etc/inittab">/etc/inittab</primary>
    </indexterm>

    <para>Créez un nouveau fichier <filename>/tools/etc/inittab</filename> en lançant ce qui suit&nbsp;:</para>

<screen><userinput>cat &gt; /tools/etc/inittab &lt;&lt; "EOF"
<literal># Début de /tools/etc/inittab

id:3:initdefault:

si::sysinit:/tools/etc/rc.d/init.d/rc sysinit

l0:0:wait:/tools/etc/rc.d/init.d/rc 0
l1:S1:wait:/tools/etc/rc.d/init.d/rc 1
l2:2:wait:/tools/etc/rc.d/init.d/rc 2
l3:3:wait:/tools/etc/rc.d/init.d/rc 3
l4:4:wait:/tools/etc/rc.d/init.d/rc 4
l5:5:wait:/tools/etc/rc.d/init.d/rc 5
l6:6:wait:/tools/etc/rc.d/init.d/rc 6

ca:12345:ctrlaltdel:/tools/sbin/shutdown -t1 -a -r now

su:S016:once:/tools/sbin/sulogin
</literal>
EOF</userinput></screen>

    <para>La commande suivante ajoute les terminaux virtuels standards à
    <filename>/tools/etc/inittab</filename>. Si votre système n'a qu'une console série,
    passez la commande suivante&nbsp;:</para>

<screen><userinput>cat &gt;&gt; /tools/etc/inittab &lt;&lt; "EOF"
<literal>1:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty1 9600
2:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty2 9600
3:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty3 9600
4:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty4 9600
5:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty5 9600
6:2345:respawn:/tools/sbin/agetty --noclear -I '\033(K' tty6 9600
</literal>
EOF</userinput></screen>

    <para>Si votre système a une console série, lancez la commande suivante
    pour ajouter l'entrée à <filename>/tools/etc/inittab</filename>&nbsp;:</para>

<screen><userinput>cat &gt;&gt; /tools/etc/inittab &lt;&lt; "EOF"
<literal>c0:12345:respawn:/tools/sbin/agetty --noclear 115200 ttyS0 vt100
</literal>
EOF</userinput></screen>

   <para>Enfin, ajoutez la ligne de fin à <filename>/tools/etc/inittab</filename>&nbsp;:</para>

<screen><userinput>cat &gt;&gt; /tools/etc/inittab &lt;&lt; "EOF"
<literal># Fin de /tools/etc/inittab</literal>
EOF</userinput></screen>

    <para>L'option <parameter>-I '\033(K'</parameter> dit à 
    <command>agetty</command> d'envoyer cette séquence d'échappement au terminal avant de faire quoique ce soit. Cette 
    séquence d'échappement bascule l'encodage de la console défini par l'utilisateur, qui peut $tre modifié en lançant 
    le programme <command>setfont</command>. Le script de démarrage <command>console</command>
    du paquet CLFS-Bootscripts appelle le programme 
    <command>setfont</command> pendant le démarrage du système. L'envoi de cette séquence d'échappement est nécessaire pour 
    les gens qui utilisent des polices d'écran non ISO 8859-1,
    mais il n'affecte pas les anglophones d'origine.</para>

  </sect2>

  <sect2 id="contents-sysvinit" role="content">
    <title>Contenu de Sysvinit</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>

      <seglistitem>
        <seg>bootlogd, fstab-decode, halt, init, killall5,
        poweroff (link to halt), reboot (link to halt), runlevel,
        shutdown, et telinit (link to init)</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="bootlogd">
        <term><command>bootlogd</command></term>
        <listitem>
          <para>Trace les messages de démarrage dans le journal</para>
          <indexterm zone="ch-system-sysvinit bootlogd">
            <primary sortas="b-bootlogd">bootlogd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="fstab-decode">
        <term><command>fstab-decode</command></term>
        <listitem>
          <para>Lance une commande avec des arguments encodés fstab</para>
          <indexterm zone="ch-system-sysvinit fstab-decode">
            <primary sortas="b-fstab-decode">fstab-decode</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="halt-sysv">
        <term><command>halt</command></term>
        <listitem>
          <para>Lance normalement <command>shutdown</command> avec l'option
          <parameter>-h</parameter>, sauf s'il est déjà au niveau d'exécution 0, puis il
          demande au noyau d'arrêter le système. Mais, tout d'abord, il note dans le
          fichier <filename>/var/log/wtmp</filename> que le système est en cours d'arrêt</para>
          <indexterm zone="ch-system-sysvinit halt-sysv">
            <primary sortas="b-halt-sysv">halt</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="init-sysv">
        <term><command>init</command></term>
        <listitem>
          <para>Le premier processus à être exécuté lorsque le noyau a initialisé le
          matériel et qui prend la main sur le processus de démarrage et démarre 
          tous les processus qui lui ont été indiqués</para>
          <indexterm zone="ch-system-sysvinit init-sysv">
            <primary sortas="b-init-sysv">init</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="killall5">
        <term><command>killall5</command></term>
        <listitem>
          <para>Envoie un signal à tous les processus sauf les processus de sa propre
          session, de façon à ne pas tuer le shell ayant lancé le script qui l'a appelé</para>
          <indexterm zone="ch-system-sysvinit killall5">
            <primary sortas="b-killall5">killall5</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="poweroff-sysv">
        <term><command>poweroff</command></term>
        <listitem>
          <para>Indique au noyau d'arrêter le système et de couper l'ordinateur (voir
          <command>halt</command>)</para>
          <indexterm zone="ch-system-sysvinit poweroff-sysv">
            <primary sortas="b-poweroff-sysv">poweroff</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="reboot-sysv">
        <term><command>reboot</command></term>
        <listitem>
          <para>Indique au noyau de redémarrer le système (voir
          <command>halt</command>)</para>
          <indexterm zone="ch-system-sysvinit reboot-sysv">
            <primary sortas="b-reboot-sysv">reboot</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="runlevel-sysv">
        <term><command>runlevel</command></term>
        <listitem>
          <para>Indique le niveau d'exécution actuel et précédent comme précisé dans
          l'enregistrement du dernier niveau d'exécution dans <filename>/var/run/utmp</filename></para>
          <indexterm zone="ch-system-sysvinit runlevel-sysv">
            <primary sortas="b-runlevel-sysv">runlevel</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="shutdown-sysv">
        <term><command>shutdown</command></term>
        <listitem>
          <para>Arrête proprement le système en le signalant à tous les processus et à
          tous les utilisateurs connectés</para>
          <indexterm zone="ch-system-sysvinit shutdown-sysv">
            <primary sortas="b-shutdown-sysv">shutdown</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="telinit-sysv">
        <term><command>telinit</command></term>
        <listitem>
          <para>Indique à <command>init</command> dans quel niveau d'exécution
          entrer</para>
          <indexterm zone="ch-system-sysvinit telinit-sysv">
            <primary sortas="b-telinit-sysv">telinit</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
