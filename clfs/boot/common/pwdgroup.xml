<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-boot-pwdgroup">
  <?dbhtml filename="pwdgroup.html"?>

  <title>Créer les fichiers de mot de passe, des groupes et des journaux</title>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/etc/passwd">/etc/passwd</primary>
  </indexterm>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/etc/group">/etc/group</primary>
  </indexterm>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/var/run/utmp">/var/run/utmp</primary>
  </indexterm>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/var/log/btmp">/var/log/btmp</primary>
  </indexterm>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/var/log/lastlog">/var/log/lastlog</primary>
  </indexterm>

  <indexterm zone="ch-boot-pwdgroup">
    <primary sortas="e-/var/log/wtmp">/var/log/wtmp</primary>
  </indexterm>

  <para os="a">Afin que l'utilisateur <systemitem class="username">root</systemitem> puisse se connecter et pour que le nom 
  <quote>root</quote> soit reconnu, il doit y avoir des entrées adéquates dans les fichiers <filename>/etc/passwd</filename>
  et <filename>/etc/group</filename>.</para>

  <para>Créez le fichier <filename>${CLFS}/etc/passwd</filename> en lançant la commande suivante&nbsp;:</para>

<screen><userinput>cat &gt; ${CLFS}/etc/passwd &lt;&lt; "EOF"
<literal>root::&uid-root;:&gid-root;:root:/root:/bin/bash</literal>
EOF</userinput></screen>

  <para os="b">Le mot de passe pour <systemitem class="username">root</systemitem>(le <quote>::</quote> utilisé ici n'est qu'un
  paramètre fictif et vous permet de vous connecter sans mot de passe) sera défini plus tard.</para>

  <variablelist os="c">

    <title>Utilisateurs supplémentaires que vous pourriez vouloir ajouter&nbsp;:</title>

    <varlistentry>
      <term><literal>bin:x:&uid-bin;:&gid-bin;:bin:/bin:/bin/false</literal></term>
      <listitem>
        <para>Peut être utile pour la compatibilité avec des applications 
        héritées.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>daemon:x:&uid-daemon;:&gid-daemon;:daemon:/sbin:/bin/false</literal></term>
      <listitem>
        <para>Il est souvent recommandé d'utiliser l'ID d'un groupe ou d'un utilisateur non privilégiés pour l'exécution de démons, afin de 
        limiter leur accès au système.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>adm:x:&uid-adm;:&gid-adm;:adm:/var/adm:/bin/false</literal></term>
      <listitem>
        <para>Était utilisé pour des programmes qui effectuaient des tâches d'administration.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>lp:x:&uid-lp;:&gid-lp;:lp:/var/spool/lp:/bin/false</literal></term>
      <listitem>
        <para>Utilisé par des programmes pour l'impression</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>mail:x:&uid-mail;:&gid-mail;:mail:/var/mail:/bin/false</literal></term>
      <listitem>
        <para>Souvent utilisé par des programmes de messagerie</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>news:x:&uid-news;:&gid-news;:news:/var/spool/news:/bin/false</literal></term>
      <listitem>
        <para>Souvent utilisé pour un réseau de serveurs de nouvelles (<foreignphrase>news</foreignphrase>)</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>operator:x:&uid-operator;:&gid-root;:operator:/root:/bin/bash</literal></term>
      <listitem>
        <para>Souvent utilisé pour permettre aux opérateurs du système d'accéder au système</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>postmaster:x:&uid-postmaster;:&gid-mail;:postmaster:/var/spool/mail:/bin/false</literal></term>
      <listitem>
        <para>Utilisé généralement comme compte qui reçoit toutes les
        informations de problèmes avec le serveur de messagerie</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nobody:x:&uid-nobody;:&gid-nobody;:nobody:/:/bin/false</literal></term>
      <listitem>
        <para>Utilisé par NFS</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <para>Créez le fichier <filename>${CLFS}/etc/group</filename> en lançant la commande suivante&nbsp;:</para>

<screen><userinput>cat &gt; ${CLFS}/etc/group &lt;&lt; "EOF"
<literal>root:x:0:
bin:x:&gid-bin;:
sys:x:&gid-sys;:
kmem:x:&gid-kmem;:
tty:x:&gid-tty;:
tape:x:&gid-tape;:
daemon:x:&gid-daemon;:
floppy:x:&gid-floppy;:
disk:x:&gid-disk;:
lp:x:&gid-lp;:
dialout:x:&gid-dialout;:
audio:x:&gid-audio;:
video:x:&gid-video;:
utmp:x:&gid-utmp;:
usb:x:&gid-usb;:
cdrom:x:&gid-cdrom;:</literal>
EOF</userinput></screen>

  <variablelist os="d">

    <title>Groupes supplémentaires que vous pourriez vouloir ajouter</title>

    <varlistentry>
      <term><literal>adm:x:&gid-adm;:root,adm,daemon</literal></term>
      <listitem>
        <para>Tous les utilisateurs de ce groupe ont le droit de faire des tâches d'administration</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>console:x:&gid-console;:</literal></term>
      <listitem>
        <para>Ce groupe a un accès direct à la console</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>cdrw:x:&gid-cdrw;:</literal></term>
      <listitem>
        <para>Ce groupe est autorisé à utiliser le lecteur CDRW</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>mail:x:&gid-mail;:mail</literal></term>
      <listitem>
        <para>Utilisé par MTAs (Mail Transport Agents)</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>news:x:&gid-news;:news</literal></term>
      <listitem>
        <para>Utilisé par le réseau de serveurs de nouvelles</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>users:x:&gid-users;:</literal></term>
      <listitem>
        <para>Le GID utilisé par défaut par shadow pour les nouveaux utilisateurs</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nogroup:x:&gid-nogroup;:</literal></term>
      <listitem>
        <para>C'est le groupe par défaut utilisé par certains programmes qui n'ont pas besoin d'un groupe</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nobody:x:&gid-nobody;:</literal></term>
      <listitem>
        <para>C'est utilisé par NFS</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <para os="e">Les groupes créés ne font partie d'aucun standard&mdash;ce sont  des groupes  décidés  d'une part par les exigences  de la 
  configuration d'Eudev dans le système final, d'autre part par la convention couramment utilisée par un grand nombre de distributiods Linux 
  existantes. La <foreignphrase>Linux Standard Base</foreignphrase> (LSB, disponible sur <ulink url="http://www.linuxbase.org"/>) recommande 
  uniquement que, après le groupe <quote>root</quote> ayant l'identifieur de groupe (GID) 0, un groupe <quote>bin</quote> avec un GID de 1 
  soit présent. L'administrateur système peut choisir librement tout autre noms de groupe et GIDs, vu que les programmes bien écrits ne
  dépendent pas des numéros GID mais utilisent plutôt le nom d'un groupe.</para>

  <para os="f">Les programmes <command>login</command>, <command>agetty</command> et <command>init</command> (et d'autres) utilisent un
  certain nombre de fichiers journal pour enregistrer des informations telles que ceux qui se sont connectés au système et quand. Néanmoins, ces
  programmes n'écriront pas dans les fichiers journal s'ils n'existent pas déjà. Initialisez les fichiers journal et donnez-leur les bons
  droits&nbsp;:</para>

<screen><userinput>touch ${CLFS}/var/run/utmp ${CLFS}/var/log/{btmp,lastlog,wtmp}
chmod -v 664 ${CLFS}/var/run/utmp ${CLFS}/var/log/lastlog
chmod -v 600 ${CLFS}/var/log/btmp</userinput></screen>

  <para>Le fichier <filename>/var/run/utmp</filename> enregistre les utilisateurs actuellement connectés. Le fichier
  <filename>/var/log/wtmp</filename> enregistre toutes les connexions et les déconnexions. Le fichier
  <filename>/var/log/lastlog</filename> enregistre le moment où chaque utilisateur s'est connecté pour la dernière fois. Le
  fichier <filename>/var/log/btmp</filename> enregistre les tentatives de connexion erronnées.</para>

</sect1>
