<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-rsyslog" xreflabel="rsyslog" role="wrap">
  <?dbhtml filename="rsyslog.html"?>

  <title>Rsyslog-&rsyslog-version;</title>

  <indexterm zone="ch-system-rsyslog">
    <primary sortas="a-rsyslog">rsyslog</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet rsyslog contient des programmes pour les messages du système de fichier journal, tels que ceux fournis par le noyau 
    lorsque des choses inhabituelles se produisent.</para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Rsyslog</title>

    <para os="a">Préparez la compilation de Rsyslog&nbsp;:</para>

<screen os="b"><userinput>./configure --prefix=/usr</userinput></screen>

    <para os="c">Compilez le paquet&nbsp;:</para>

<screen os="d"><userinput>make</userinput></screen>

    <para os="e">Pour tester les résultats, lancez&nbsp;:</para>

<screen os="e2"><userinput remap="test">make check</userinput></screen>

    <para os="f">Installez le paquet&nbsp;:</para>

<screen os="g"><userinput>make install</userinput></screen>

    <para os="h">Créez un répertoire pour les expansion snippets&nbsp;:</para>

<screen os="i"><userinput>install -dv /etc/rsyslog.d</userinput></screen>

  </sect2>

  <sect2 id="conf-rsyslog" role="configuration">
    <title>Configuration de rsyslog</title>

    <indexterm zone="conf-rsyslog">
      <primary sortas="a-rsyslog">rsyslog</primary>
    <secondary>configuration</secondary></indexterm>

    <indexterm zone="conf-rsyslog">
      <primary sortas="e-/etc/rsyslog.conf">/etc/rsyslog.conf</primary>
    </indexterm>

    <para>Créez un nouveau fichier <filename>/etc/rsyslog.conf</filename> en lançant ce qui suit&nbsp;:</para>

<screen><userinput>cat &gt; /etc/rsyslog.conf &lt;&lt; "EOF"
<literal># Début de /etc/rsyslog.conf

# Configuration CLFS de rsyslog. Pour plus d'info utilisez man rsyslog.conf

#######################################################################
# Modules Rsyslog

# Support pour le système journal du système local
$ModLoad imuxsock.so

# Support pour la journalisation du noyau
$ModLoad imklog.so

#######################################################################
# Options globales

# Utiliser le format traditionel d'horodateur.
$ActionFileDefaultTemplate RSYSLOG_TraditionalFileFormat

# Réglage des droits par défaut pour tous les fichiers journaux
$FileOwner root
$FileGroup root
$FileCreateMode 0640
$DirCreateMode 0755

# Fournit la réception UDP 
$ModLoad imudp
$UDPServerRun 514

# Désactive la répétition des entrées
$RepeatedMsgReduction on

#######################################################################
# Inclut les snippets de config de Rsyslog

$IncludeConfig /etc/rsyslog.d/*.conf

#######################################################################
# Fichiers journaux standard

auth,authpriv.*			/var/log/auth.log
*.*;auth,authpriv.none		-/var/log/syslog
daemon.*			-/var/log/daemon.log
kern.*				-/var/log/kern.log
lpr.*				-/var/log/lpr.log
mail.*				-/var/log/mail.log
user.*				-/var/log/user.log

# Récupérer tous les journaux
*.=debug;\
	auth,authpriv.none;\
	news.none;mail.none	-/var/log/debug
*.=info;*.=notice;*.=warn;\
	auth,authpriv.none;\
	cron,daemon.none;\
	mail,news.none		-/var/log/messages

# On montre les urgences à tout le monde
*.emerg				*

# Fin de /etc/rsyslog.conf</literal>
EOF</userinput></screen>

  </sect2>

  <sect2 id="contents-rsyslog" role="content">
    <title>Contenu de rsyslog</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>rsyslogd</seg>
        <seg>/usr/lib/rsyslog</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="rsyslogd">
        <term><command>rsyslogd</command></term>
        <listitem>
          <para>Enregistre les messages que le système donne à journaliser. Tout message enregistré contient au moins une date et un nom 
          d'hôte et en principe également le nom du programme, mais cela dépend de lu niveau de vigilence dont vous avez dit au démon de
          journal de faire preuve.</para>
          <indexterm zone="ch-system-rsyslog rsyslogd">
            <primary sortas="b-rsyslogd">rsyslogd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
