<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-stripping">
  <?dbhtml filename="stripping.html"?>

  <title>Supprimer de nouveau les symboles des fichiers objets</title>

  <para os="a">Si l'utilisateur initial n'est pas un développeur et ne pense
  pas faire de débogage sur les logiciels du système, la taille du
  système peut être diminué d'environ 200&nbsp;Mo en supprimant les
  symboles de débogage contenus dans les binaires et dans les
  bibliothèques. Ceci ne pose pas de problème autre que le fait de ne
  plus pouvoir les déboguer.</para>

  <para os="b">La plupart des personnes qui utilisent la commande mentionnée
  ci-dessous ne rencontrent aucune difficulté. Néanmoins, il est facile
  de faire une erreur de saisie et rendre le nouveau système
  complètement inutilisable, donc avant d'exécuter la commande
  <command>strip</command>, il est recommandé de faire une sauvegarde de
  l'état actuel.</para>

  <para os="c">Avant d'exécuter la suppression de ces symboles, faites
  particulièrement attention qu'aucun des binaires concernés ne sont en cours
  d'exécution. Si vous n'êtes pas sûr que l'utilisateur est entré dans chroot avec la
  commande donnée dans <xref linkend="chapter-chroot" role=","/>
  quittez le chroot&nbsp;:</para>

<screen os="d" role="nodump"><userinput>logout</userinput></screen>

  <para os="e">Puis, retournez-y avec&nbsp;:</para>

<screen os="f" role="nodump"><userinput>chroot ${CLFS} /tools/bin/env -i \
    HOME=/root TERM=${TERM} PS1='\u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /tools/bin/bash --login</userinput></screen>

  <para os="g">Maintenant, les binaires et les bibliothèques peuvent être
  traitées en toute sécurité&nbsp;:</para>

<screen os="h"><userinput>/tools/bin/find /{,usr/}{bin,lib,sbin} -type f \
   -exec /tools/bin/strip --strip-debug '{}' ';'</userinput></screen>

  <para os="i">Un grand nombre de fichiers seront rapportés comme ayant un
  format non reconnu. Ces messages d'avertissement indiquent que ces
  fichiers sont des scripts et non pas des binaires.</para>

  <para os="j">Si l'espace disque devient très restreint, l'option
  <parameter>--strip-all</parameter> peut être utilisée sur les binaires
  compris dans <filename class="directory">/{,usr/}{bin,sbin}</filename>
  pour gagner quelques mégaoctets de plus. N'utilisez pas cette option
  sur les bibliothèques &mdash;cela les détruirait.</para>

</sect1>

