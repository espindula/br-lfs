<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY lua-download-http "https://www.lua.org/ftp/lua-&lua-version;.tar.gz">
  <!ENTITY lua-download-ftp  "">
  <!ENTITY lua-md5sum        "bd8ce7069ff99a400efd14cf339a727b">
  <!ENTITY lua-size          "356&nbsp;Ko">
  <!ENTITY lua-buildsize     "5,8 Mo (avec les tests Basic)">
  <!ENTITY lua-time          "moins de 0,1&nbsp;SBU (avec les tests Basic)">

  <!ENTITY lua-tests-download-http "https://www.lua.org/tests/lua-&lua-version;-tests.tar.gz">
  <!ENTITY lua-tests-download-ftp  "">
  <!ENTITY lua-tests-md5sum        "0e28a9b48b3596d6b12989d04ae403c4">
  <!ENTITY lua-tests-size          "132&nbsp;Ko">
]>

<sect1 id="lua" xreflabel="Lua-&lua-version;">
  <?dbhtml filename="lua.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>Lua-&lua-version;</title>

  <indexterm zone="lua">
    <primary sortas="a-Lua">Lua</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Lua</title>

    <para>
      <application>Lua</application> est un langage de programmation puissant et
assez léger conçu pour les extensions d'applications. Il est aussi souvent
utilisé de façon plus générale en langage utilisé
seul. <application>Lua</application> est implémenté comme une petite
bibliothèque de fonction C, écrite en C ANSI, et compilé sans modification
sur toutes les plate-formes connues. Les buts de l'implémentation sont
simplicité, efficacité, portabilité, et coût d'embarquement faible. Le
résultat est un moteur de langage rapide avec de petites empreinte, le
rendant idéal pour les systèmes embarqués.
    </para>

    &lfs112_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&lua-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&lua-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &lua-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &lua-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &lua-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &lua-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Correctif requis&nbsp;: <ulink
url="&patch-root;/lua-&lua-version;-shared_library-2.patch"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement de la suite de tests facultative (HTTP)&nbsp;: <ulink
url="&lua-tests-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement de la suite de tests facultative (FTP)&nbsp;: <ulink
url="&lua-tests-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme MD5 de la suite de tests facultative&nbsp;: &lua-tests-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille de la suite de tests facultative&nbsp;: &lua-tests-size;
        </para>
      </listitem>
    </itemizedlist>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/lua"/>
    </para>
  </sect2>

  <sect2 role="installation">
    <title>Installation de Lua</title>

    <para>
      Quelques paquets vérifient le fichier <application>pkg-config</application>
pour <application>Lua</application>, qui est créé avec&nbsp;:
    </para>

<screen><userinput>cat &gt; lua.pc &lt;&lt; "EOF"
<literal>V=5.4
R=&lua-version;

prefix=/usr
INSTALL_BIN=${prefix}/bin
INSTALL_INC=${prefix}/include
INSTALL_LIB=${prefix}/lib
INSTALL_MAN=${prefix}/share/man/man1
INSTALL_LMOD=${prefix}/share/lua/${V}
INSTALL_CMOD=${prefix}/lib/lua/${V}
exec_prefix=${prefix}
libdir=${exec_prefix}/lib
includedir=${prefix}/include

Name: Lua
Description: An Extensible Extension Language
Version: ${R}
Requires:
Libs: -L${libdir} -llua -lm -ldl
Cflags: -I${includedir}</literal>
EOF</userinput></screen>

    <para>
      Installez <application>Lua</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<!-- make MYCFLAGS="-DLUA_COMPAT_5_2 -DLUA_COMPAT_5_1" linux
     The MYCFLAGS="" part was brought into the patch since optimization had to
     be turned off.
     The LUA_ROOT change also has been merged into the patch.-->
<screen><userinput>patch -Np1 -i ../lua-&lua-version;-shared_library-1.patch &amp;&amp;
make linux</userinput></screen>


    <para>
      Pour tester les résultats, lancez&nbsp;: <command>make
test</command>. <quote>Cela lancera l'interpréteur et affichera sa
version.</quote> Des tests plus amples peuvent être lancés si vous avez
téléchargé l'archive de suite de tests. Ces tests doivent être exécutés
après que le paquet est installé, aussi nous reportons le détail des
instructions plus bas.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make INSTALL_TOP=/usr                \
     INSTALL_DATA="cp -d"            \
     INSTALL_MAN=/usr/share/man/man1 \
     TO_LIB="liblua.so liblua.so.5.4 liblua.so.&lua-version;" \
     install &amp;&amp;

mkdir -pv                      /usr/share/doc/lua-&lua-version; &amp;&amp;
cp -v doc/*.{html,css,gif,png} /usr/share/doc/lua-&lua-version; &amp;&amp;

install -v -m644 -D lua.pc /usr/lib/pkgconfig/lua.pc</userinput></screen>

    <para>
      Nous n'allons décrire que les «&nbsp;tests Basic&nbsp;». Décompressez
l'archive et changez de répertoire pour <filename
class="directory">lua-5.3.4-tests</filename>, puis lancez <command>lua -e
"_U=true" all.lua</command>. Si les tests finissent sans erreur, vous verrez
un message contenant la chaîne «&nbsp;final OK&nbsp;» à la fin.
    </para>

    
  <!-- The optimization problem fixed in the patch was identified by running
         the test suite, and ultimately culminated in a SIGBUS error. -->
</sect2>

  

  <!-- Brought into the patch, unneeded
  <sect2 role="commands">

    <title>Command Explanations</title>

    <para>
      <command>sed -i ... src/luaconf.h</command>: This command changes the
      <application>Lua</application> search path to match the install path.
    </para>

    <para>
      <envar>MYCFLAGS="-DLUA_COMPAT_5_2 -DLUA_COMPAT_5_1"</envar>: This
      environment variable includes compatibility layers with Lua 5.1 and 5.2
      in the build.
    </para>

  </sect2>
  -->
<sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèque installée</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          lua et luac
        </seg>
        <seg>
          liblua.so
        </seg>
        <seg>
          /usr/{lib,share}/lua et /usr/share/doc/lua-&lua-version;
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="lua-prog">
        <term><command>lua</command></term>
        <listitem>
          <para>
            est l'interpréteur Lua indépendant
          </para>
          <indexterm zone="lua lua-prog">
            <primary sortas="b-lua">lua</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="luac">
        <term><command>luac</command></term>
        <listitem>
          <para>
            est le compilateur Lua
          </para>
          <indexterm zone="lua luac">
            <primary sortas="b-luac">luac</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="liblua">
        <term><filename class="libraryfile">liblua.so</filename></term>
        <listitem>
          <para>
            contient les fonctions de l'API de <application>Lua</application>
          </para>
          <indexterm zone="lua liblua">
            <primary sortas="c-liblua">liblua.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
