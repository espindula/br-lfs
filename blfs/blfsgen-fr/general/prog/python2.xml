<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY python2-download-http
     "https://www.python.org/ftp/python/&python2-version;/Python-&python2-version;.tar.xz">
  <!ENTITY python2-download-ftp  "">
  <!ENTITY python2-md5sum        "fd6cc8ec0a78c44036f825e739f36e5a">
  <!ENTITY python2-size          "12.2&nbsp;Mo">
  <!ENTITY python2-buildsize     "228&nbsp;Mo (plus 17&nbsp;Mo pour les tests)">
  <!ENTITY python2-time          "0,5&nbsp;SBU (avec parallélisme = 4&nbsp; plus 5,9&nbsp;SBU pour les tests)">

  <!ENTITY python2htmldoc-download-http
     "https://www.python.org/ftp/python/doc/&python2-version;/python-&python2-version;-docs-html.tar.bz2">
]>

<sect1 id="python2" xreflabel="Python-&python2-version;">
  <?dbhtml filename="python2.html" ?>


  <title>Python-&python2-version;</title>

  <indexterm zone="python2">
    <primary sortas="a-Python2">Python2</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Python 2</title>

    <para>
      Le paquet <application>Python 2</application> contient l'environnement de
développement <application>Python</application>. C'est utile pour faire de
la programmation orientée objet, écrire des scripts, faire des prototypes de
gros programmes, ou développer des applications entières. Cette version est
là pour des questions de rétro-compatibilité avec d'autres paquets qui en
dépendent.
    </para>

    <note>
      <para>
        Python2 est obsolète pour les développeurs en amont. La prise en charge de
Python2 est terminée depuis le 1er janvier 2020.
      </para>

      <para>
        BLFS essaye d'utiliser Python3 le plus possible, mais certains paquets n'ont
pas jamais été mis à jour pour prendre en charge Python3.
      </para>
    </note>

    &lfs113_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&python2-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&python2-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &python2-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &python2-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &python2-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &python2-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>

    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Correctif requis&nbsp;: <ulink
url="&patch-root;/Python-&python2-version;-security_fixes-1.patch"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Documentation HTML facultative&nbsp;: <ulink
url="&python2htmldoc-download-http;"/>
        </para>
      </listitem>
    </itemizedlist>


    <bridgehead renderas="sect3">Dépendances de Python 2</bridgehead>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="sqlite"/> (pour un module supplémentaire)
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref linkend="bluez"/> et <xref linkend="valgrind"/>
    </para>

    <bridgehead renderas="sect4">Facultatif (pour des modules supplémentaires)</bridgehead>
    <para role="optional">
      <xref linkend="libnsl"/> et <xref linkend="tk"/>
    </para>

    <para condition="html" role="usernotes">
      Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/Python"/>
    </para>
  </sect2>

  <sect2 role="installation">
    <title>Installation de Python 2</title>

    <para>
      Tout d'abord, désactive l'installation d'un script qui remplace un script
plus récent&nbsp;:
    </para>

<screen><userinput>sed -i '/2to3/d' ./setup.py</userinput></screen>

    <para>
      Installez <application>Python 2</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>patch -Np1 -i ../Python-&python2-version;-security_fixes-1.patch &amp;&amp;
./configure --prefix=/usr                              \
            --enable-shared                            \
            --with-system-expat                        \
            --with-system-ffi                          \
            --enable-unicode=ucs4                     &amp;&amp;
make</userinput></screen>

    <para>
      <!-- https://bugs.python.org/issue46811 -->
Si vous invoquez les tests, ils tourneront deux fois. Pour tester les
résultats, exécutez&nbsp;: <command>make -k test</command>. Plusieurs tests
sont connus pour échouer, dont <literal>test_ftplib</literal>,
<literal>test_ssl</literal>, <literal>test_urllib2_localnet</literal>,
<literal>test_xml_etree</literal>, <literal>test_xml_etree_c</literal> et
<literal>test_minidom</literal>. Ces échecs sont dus à OpenSSL-3 et
Expat-2.4.6.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make altinstall                                &amp;&amp;
ln -s python2.7        /usr/bin/python2        &amp;&amp;
ln -s python2.7-config /usr/bin/python2-config &amp;&amp;
chmod -v 755 /usr/lib/libpython&python2-majorver;.so.1.0</userinput></screen>

    <para>
      Puisque <application>Python 2</application> est en mode maintenance, et que
<application>Python 3</application> est recommandé en amont pour le
développement, vous n'avez probablement pas besoin d'installer la
documentation. Cependant, si vous voulez installer la documentation pour les
deux versions de <application>Python</application>, soyez certain de définir
la variable <envar>PYTHONDOCS</envar> pour la version que vous voulez
utiliser, chaque fois que vous avez besoin de consulter la documentation. Si
vous avez téléchargé la documentation depuis <ulink
url="https://docs.python.org/download.html"/>, installez-la en tant
qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>install -v -dm755 /usr/share/doc/python-&python2-version; &amp;&amp;

tar --strip-components=1                     \
    --no-same-owner                          \
    --directory /usr/share/doc/python-&python2-version; \
    -xvf ../python-&python2-version;-docs-html.tar.bz2 &amp;&amp;

find /usr/share/doc/python-&python2-version; -type d -exec chmod 0755 {} \; &amp;&amp;
find /usr/share/doc/python-&python2-version; -type f -exec chmod 0644 {} \;</userinput></screen>
  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <parameter>--with-system-expat</parameter>&nbsp;: Ce paramètre active
l'édition de liens contre la version système de
<application>Expat</application>.
    </para>

    <para>
      <parameter>--with-system-ffi</parameter>&nbsp;: Ce paramètre active
l'édition de liens contre la version système de
<application>libffi</application>.
    </para>

    <para>
      <parameter>--enable-unicode=ucs4</parameter>&nbsp;: ce paramètre active la
prise en charge de l'Unicode 32&nbsp;bits dans
<application>Python</application>.
    </para>

    <para>
      <option>--with-ensurepip=yes</option>&nbsp;: ce paramètre active la
construction des programmes de gestion de paquets <command>pip</command> et
<command>setuptools</command>. <command>setuptools</command> est requis pour
construire certains modules Python. Ce paramètre n'est pas recommandé parce
que cette version de Python n'est plus maintenue.
    </para>

    <para>
      <option>--with-dbmliborder=bdb:gdbm:ndbm</option>&nbsp;:  Utilisez ce
paramètre si vous voulez lier le module <application>Python</application>
DBM à <application>Berkeley DB</application> au lieu de
<application>GDBM</application>.
    </para>

    <para>
      <command>make altinstall</command>&nbsp;: cette cible make omet certains
liens symboliques par défaut qui pourraient interférer avec Python 3.
    </para>

    <para>
      <command>chmod ...</command>&nbsp;:  Corrige les permissions pour que les
bibliothèques soient cohérent avec les autres bibliothèques.
    </para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de Python 2</title>

    <para>
      Pour que <command>python</command> trouve la documentation installée, vous
devez ajouter la variable d'environnement suivante au profil individuel de
l'utilisateur ou du système global&nbsp;:
    </para>

<screen role="root"><userinput>export PYTHONDOCS=/usr/share/doc/python-&python2-version;</userinput></screen>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèque installée</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          pydoc, python2 (lien symbolique), python2-config (lien symbolique),
python&python2-majorver;, python&python2-majorver;-config, smtpd.py et idle
        </seg>
        <seg>
          libpython&python2-majorver;.so
        </seg>
        <seg>
          /usr/{include,lib}/python&python2-majorver; et
/usr/share/doc/python-&python2-version;
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="idle">
        <term><command>idle</command></term>
        <listitem>
          <para>
            est un script enveloppe ouvrant un éditeur graphique de
<application>Python</application>. Pour que ce script fonctionne, vous devez
installer <application>Tk</application> avant Python afin que le module
Python Tkinter soit construit
          </para>
          <indexterm zone="python2 idle">
            <primary sortas="b-idle">idle</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="pydoc2">
        <term><command>pydoc</command></term>
        <listitem>
          <para>
            est l'outil de documentation de <application>Python</application>
          </para>
          <indexterm zone="python2 pydoc2">
            <primary sortas="b-pydoc2">pydoc</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="python">
        <term><command>python2</command></term>
        <listitem>
          <para>
            est un langage de programmation interprété, interactif et orienté objet
          </para>
          <indexterm zone="python2 python">
            <primary sortas="b-python2">python</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="python2-ver">
        <term><command>python&python2-majorver;</command></term>
        <listitem>
          <para>
            est un nom spécifique à la version du programme <command>python</command>
          </para>
          <indexterm zone="python2 python2-ver">
            <primary sortas="b-python&python2-majorver;">python&python2-majorver;</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="smtpd.py">
        <term><command>smtpd.py</command></term>
        <listitem>
          <para>
            est une implémentation de proxy SMTP en <application>Python</application>
          </para>
          <indexterm zone="python2 smtpd.py">
            <primary sortas="b-smtpd.py">smtpd.py</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
