<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY libblockdev-download-http
    "https://github.com/storaged-project/libblockdev/releases/download/&libblockdev-version;-1/libblockdev-&libblockdev-version;.tar.gz">
  <!ENTITY libblockdev-download-ftp "">
  <!ENTITY libblockdev-md5sum        "b03d1b4def6962aa2e3eb93b50c22163">
  <!ENTITY libblockdev-size          "1,0&nbsp;Mo">
  <!ENTITY libblockdev-buildsize     "14 Mo">
  <!ENTITY libblockdev-time          "0,1&nbsp;SBU">
]>

<sect1 id="libblockdev" xreflabel="libblockdev-&libblockdev-version;">
  <?dbhtml filename="libblockdev.html"?>


  <title>libblockdev-&libblockdev-version;</title>

  <indexterm zone="libblockdev">
    <primary sortas="a-libblockdev">libblockdev</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à libblockdev</title>

    <para>
      libblockdev est une bibliothèque C qui supporte l'introspection GObject pour
manipuler des périphériques blocs. Elle a une architecture basée sur des
extensions où chaque technologie (comme LVM, Btrfs, MD RAID, Swap, …) est
implémentée dans un greffon séparé, éventuellement avec plusieurs
implémentations (par exemple avec LVM CLI ou la nouvelle API LVM DBus).
    </para>

    &lfs113_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&libblockdev-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&libblockdev-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &libblockdev-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &libblockdev-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &libblockdev-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &libblockdev-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de libblockdev</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="glib2"/>
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="cryptsetup"/>, <xref linkend="gobject-introspection"/>
(required for GNOME), <xref linkend="keyutils"/>, <xref
linkend="libbytesize"/>, <xref linkend="libnvme"/>, and <xref
linkend="lvm2"/>
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <!--      <ulink url="https://people.redhat.com/~heinzm/sw/dmraid/">
dmraid</ulink>, -->
<!--      <ulink url="https://bcachefs.org/">
bcachefs</ulink>, -->
<xref linkend="btrfs-progs"/>, <xref linkend="gtk-doc"/>, <xref
linkend="mdadm"/>, <xref linkend="parted"/>, <xref linkend="volume_key"/>,
<ulink url="https://github.com/pmem/ndctl">ndctl</ulink>, and <ulink
url="https://github.com/Datera/targetcli">targetcli</ulink> (for tests)
    </para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de libblockdev</title>

    <!--
    <para>

      Fix the usage of a glib function deprecated for security:
    </para>

<screen><userinput>sed 's/g_memdup/&amp;2/' -i             \
    src/lib/plugin_apis/vdo.{c,api} \
    src/plugins/vdo.c</userinput></screen>
-->
<para>
      Installez <application>libblockdev</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>./configure --prefix=/usr      \
            --sysconfdir=/etc  \
            --with-python3     \
            --without-escrow   \
            --without-gtk-doc  \
            --without-lvm      \
            --without-lvm_dbus \
            --without-nvdimm   \
            --without-tools    &amp;&amp;
make</userinput></screen>

    <para>
      La suite de tests nécessite <application>targetcli</application>, qui ne
fait pas partie de BLFS.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <parameter>--without-escrow</parameter>&nbsp;: ce paramètre permet de
construire <application>libblockdev</application> sans installer <xref
linkend="volume_key"/>. Supprimez-le si vous avez installé <xref
linkend="volume_key"/>.
    </para>

    <para>
      <parameter>--without-lvm --without-lvm_dbus
--without-tools</parameter>&nbsp;: la combinaison de ces paramètres permet
de construire <application>libblockdev</application> sans avoir installé
<xref linkend="parted"/>. Supprimez-les si vous avez installé <xref
linkend="parted"/> et souhaitez construire les utilitaires
<command>lvm-cache-stats</command> ou <command>vfat-resize</command> ou
souhaitez que <application>libblockdev</application> prenne en charge les
volumes logiques.
    </para>

    <para>
      <option>--without-btrfs --without-mdraid --without-tools</option>&nbsp;: la
combinaison de ces paramètres permet de construire
<application>libblockdev</application> sans installer <xref
linkend="libbytesize"/>. L'option <option>--without-mdraid</option> cassera
<xref linkend="udisks2"/>, donc ne l'utilisez pas à moins de vraiment savoir
ce que vous faites.
    </para>

    <para>
      <option>--without-crypto</option>&nbsp;: ce paramètre permet de construire
<application>libblockdev</application> sans installer <xref
linkend="cryptsetup"/> ou <xref linkend="keyutils"/>. Ce paramètre cassera
<xref linkend="udisks2"/>, donc ne l'utilisez pas à moins de savoir ce que
vous faites.
    </para>

    <para>
      <option>--without-dm --without-lvm --without-lvm_dbus
--without-mpath</option>&nbsp;: la combinaison de ces paramètre permet de
construire <application>libblockdev</application> sans installer <xref
linkend="lvm2"/>. Les options <option>--without-drm</option> et
<option>--without-mpath</option> ne sont pas dans les instructions fournies
par le livre car <xref linkend="lvm2"/> est requis pour <xref
linkend="cryptsetup"/> et que <xref linkend="cryptsetup"/> est de toutes
façons une dépendance recommandée de <application>libblockdev</application>.
    </para>

    <para>
      <option>--without-nvme</option>: This switch allows building
<application>libblockdev</application> without <xref linkend="libnvme"/>
installed.  This switch will break <xref linkend="udisks2"/>, so don't use
it unless you really know what you are doing.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          lvm-cache-stats and vfat-resize (both optional)
        </seg>
        <seg>
          libbd_btrfs.so, libbd_crypto.so, libbd_dm.so, libbd_fs.so, libbd_loop.so,
libbd_lvm.so (optional), libbd_lvm-dbus.so (optional), libbd_mdraid.so,
libbd_mpath.so, libbd_nvme.so, libbd_part.so, libbd_swap.so, libbd_utils.so,
and libblockdev.so
        </seg>
        <seg>
          /etc/libblockdev, /usr/include/blockdev, and
/usr/share/gtk-doc/html/libblockdev (optional)
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="lvm-cache-stats">
        <term><command>lvm-cache-stats</command></term>
        <listitem>
          <para>
            affiche des statistiques sur les cache des volumes logiques LVM
          </para>
          <indexterm zone="libblockdev lvm-cache-stats">
            <primary sortas="b-lvm-cache-stats">lvm-cache-stats</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="vfat-resize">
        <term><command>vfat-resize</command></term>
        <listitem>
          <para>
            resizes <systemitem class="filesystem">vfat</systemitem> file systems
          </para>
          <indexterm zone="libblockdev vfat-resize">
            <primary sortas="b-vfat-resize">vfat-resize</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>

  </sect2>

</sect1>
