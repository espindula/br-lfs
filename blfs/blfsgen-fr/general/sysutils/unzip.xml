<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY unzip-download-http "&sourceforge-dl;/infozip/unzip60.tar.gz">
  <!ENTITY unzip-download-ftp  "ftp://ftp.info-zip.org/pub/infozip/src/unzip60.tgz">
  <!ENTITY unzip-md5sum        "62b490407489521db863b523a7f86375">
  <!ENTITY unzip-size          "1.3 Mo">
  <!ENTITY unzip-buildsize     "9 Mo">
  <!ENTITY unzip-time          "moins de 0.1 SBU">
]>

<sect1 id="unzip" xreflabel="UnZip-&unzip-version;">
  <?dbhtml filename="unzip.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>UnZip-&unzip-version;</title>

  <indexterm zone="unzip">
    <primary sortas="a-UnZip">UnZip</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à UnZip</title>

    <para>
      Le paquet <application>UnZip</application> contient des outils d'extraction
<filename>ZIP</filename>. Ils sont utiles pour extraire des fichiers à
partir d'archives <filename>ZIP</filename>. Les archives
<filename>ZIP</filename> sont créées avec les outils
<application>PKZIP</application> ou <application>Info-ZIP</application>,
surtout dans un environnement DOS.
    </para>

    &lfs111_checked;

    <caution>
      <para>
        La version précédente du paquet <application>UnZip</application> avait des
problèmes liés aux paramètres régionaux. Aucun éditeur de BLFS n'est
actuellement capable de tester ces problèmes. On a donc laissé sur cette
page les informations liées aux paramètres régionaux mais elles n'ont pas
été testées. Vous pouvez trouver une approche plus générale de ces problèmes
dans la section <xref linkend="locale-assumed-encoding"/> de la page <xref
linkend="locale-issues"/>.
      </para>
    </caution>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&unzip-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&unzip-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &unzip-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &unzip-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &unzip-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &unzip-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing='compact'>
      <listitem>
        <para>
          Correctif requis&nbsp;: <ulink
url="&patch-root;/unzip-&unzip-version;-consolidated_fixes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/unzip"/></para>

  </sect2>

  <sect2 id="unzip-locale-issues">
    <title>Problèmes de locale d'UnZip</title>

    <note>
      <para>
        L'utilisation de <application>UnZip</application> dans l'installation de
<application>JDK</application>, <application>Mozilla</application>,
<application>DocBook</application> ou tout autre paquet BLFS n'est pas un
problème vu que les instructions de BLFS n'utilisent jamais
<application>UnZip</application> pour extraire un fichier ayant dans son nom
des caractères non-ASCII.
      </para>
    </note>

    <para>
      Ces problèmes devraient être corrigés dans le correctif. Mais comme aucun
éditeur n'a de données pour le tester, les contournements suivants sont
gardés au cas où ils seraient nécessaires.
    </para>

    <para>
      Le paquet <application>UnZip</application> suppose que les noms des fichiers
stockés dans les archives ZIP créées sur des systèmes non Unix sont encodés
en CP850, et qu'ils devraient être convertis en ISO-8859-1 lors de
l'écriture des fichiers sur le système de fichiers. De telles suppositions
ne sont pas toujours valides. En fait, dans l'archive ZIP, les noms de
fichiers sont encodés en codepage du DOS utilisé dans le pays concerné et
les noms de fichier sur le disque devraient être dans l'encodage de la
locale. Dans MS Windows, la fonction C OemToChar() (de
<filename>User32.DLL</filename>) effectue la bonne conversion (qui est
effectivement la conversion de CP850 vers une couche d'ISO-8859-1 si MS
Windows est paramétré pour utiliser la langue anglaise américaine), mais il
n'y a pas d'équivalent sur Linux.
    </para>

    <para>
      Lors de l'utilisation de <command>unzip</command> pour déballer une archive
ZIP contenant des noms de fichiers non-ASCII, les noms de fichiers sont
endommagés car <command>unzip</command> utilise une mauvaise conversion
quand une de ses suppositions d'encodage n'est pas bonne. Par exemple, dans
la locale ru_RU.KOI8-R, la conversion des noms de fichiers de CP866 en
KOI8-R est nécessaire, mais la conversion de CP850 en ISO-8859-1 se fait, ce
qui donne des noms de fichiers composés de caractères indéchiffrables au
lieu de mots (l'exemple équivalent le plus parlant pour des utilisateurs
anglophones est rot13). Il y a plusieurs manières de contourner cette
limitation&nbsp;:
    </para>

    <para>
      1) Pour déballer des archives ZIP ayant des noms de fichiers contenant des
caractères non-ASCII, utilisez <ulink
url="http://www.winzip.com/">WinZip</ulink> en lançant l'émulateur Windows
<ulink url="http://www.winehq.com/">Wine</ulink>.
    </para>

    <para>
      2) Utilisez <command>bsdtar -xf</command> de <xref role="nodep"
linkend="libarchive"/> pour extraire l'archive ZIP. Ensuite, réparez les
dommages sur les noms de fichiers en utilisant l'outil
<command>convmv</command> (<ulink url="http://j3e.de/linux/convmv/"/>). Ce
qui suit est un exemple pour le paramètre régional ru_RU.KOI8-R&nbsp;:
    </para>

<!--
    <para>

      3) Apply the optional
      <filename>unzip-5.50-alt-iconv-v1.1.patch</filename> patch to
      <application>UnZip</application>. It will apply with some offsets.
    </para>

    <para>
      It allows to specify the assumed filename encoding in the ZIP
      archive using the <option>-O charset_name</option> option and the
      on-disk filename encoding using the <option>-I charset_name</option>
      option. Defaults: the on-disk filename encoding is the locale encoding,
      the encoding inside the ZIP archive is guessed according to the builtin
      table based on the locale encoding. For US English users, this still
      means that unzip converts from CP850 to ISO-8859-1 by default.
    </para>

    <para>
      Caveat: this method works only with 8-bit locale encodings, not
      with UTF-8. Attempting to use a patched <command>unzip</command> in UTF-8
      locales may result in a segmentation fault and is probably a security
      risk.
    </para>
-->
<screen><userinput>convmv -f cp936 -t utf-8 -r --nosmart --notest \
    <replaceable>&lt;/path/to/unzipped/files&gt;</replaceable></userinput></screen>

  </sect2>

  <sect2 role="installation">
    <title>Installation de UnZip</title>

    <para>
      Tout d'abord appliquez le correctif&nbsp;:
    </para>

<screen><userinput remap="pre">patch -Np1 -i ../unzip-&unzip-version;-consolidated_fixes-1.patch</userinput></screen>

    <para>
      Maintenant compilez le paquet&nbsp;:
    </para>

<screen><userinput>make -f unix/Makefile generic</userinput></screen>

    <para>
      La suite de tests ne fonctionne pas avec la cible <quote>generic</quote>.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make prefix=/usr MANDIR=/usr/share/man/man1 \
 -f unix/Makefile install</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <command>make -f unix/Makefile generic</command>&nbsp;: Cette cible commence
par lancer un script de configuration (pas comme les anciennes cibles comme
linux et linux_noasm) qui crée un fichier de drapeaux qui est ensuite
utilisé dans la construction. Cela permet que les constructions x86 32 bits
reçoivent les bons drapeaux pour dézipper les fichiers qui sont plus gros
que 2Go une fois extrait.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>funzip, unzip, unzipfsx, zipgrep et zipinfo</seg>
        <seg>Aucune</seg>
        <seg>Aucune</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="funzip">
        <term><command>funzip</command></term>
        <listitem>
          <para>
            permet à la sortie des commandes <command>unzip</command> d'être redirigées
          </para>
          <indexterm zone="unzip funzip">
            <primary sortas="b-funzip">funzip</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="unzip-prog">
        <term><command>unzip</command></term>
        <listitem>
          <para>
            liste, teste ou extrait des fichiers d'une archive <filename>ZIP</filename>
          </para>
          <indexterm zone="unzip unzip-prog">
            <primary sortas="b-unzip">unzip</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="unzipfsx">
        <term><command>unzipfsx</command></term>
        <listitem>
          <para>
            est un stub auto-extrait qui peut être ajouté au début de l'archive
<filename>ZIP</filename>. Des fichiers dans ce format permettent au
destinataire de décompresser l'archive sans installer
<application>UnZip</application>
          </para>
          <indexterm zone="unzip unzipfsx">
            <primary sortas="b-unzipfsx">unzipfsx</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="zipgrep">
        <term><command>zipgrep</command></term>
        <listitem>
          <para>
            cherche dans des fichiers d'une archive<filename>ZIP</filename> des lignes
correspondant à un modèle
          </para>
          <indexterm zone="unzip zipgrep">
            <primary sortas="b-zipgrep">zipgrep</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="zipinfo">
        <term><command>zipinfo</command></term>
        <listitem>
          <para>
            produit des informations techniques sur des fichiers d'une archive
<filename>ZIP</filename>, dont les droits d'accès au fichier, le statut du
chiffrement, le type de compression, etc
          </para>
          <indexterm zone="unzip zipinfo">
            <primary sortas="b-zipinfo">zipinfo</primary>
          </indexterm>
        </listitem>
      </varlistentry>
<!--
      <varlistentry id="libunzip">

        <term><filename class='libraryfile'>libunzip.so</filename></term>
        <listitem>
          <para>
            contains the API functions required by the
            <application>UnZip</application> programs.
          </para>
          <indexterm zone="unzip libunzip">
            <primary sortas="c-libunzip">libunzip.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>
-->

    </variablelist>

  </sect2>

</sect1>
