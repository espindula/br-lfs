<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY usbutils-download-http "https://github.com/gregkh/usbutils/archive/v&usbutils-version;/usbutils-&usbutils-version;.tar.gz">
  <!ENTITY usbutils-download-ftp  "">
  <!ENTITY usbutils-md5sum        "112eafa991e55229b9f48b90c290a0e2">
  <!ENTITY usbutils-size          "120&nbsp;Ko">
  <!ENTITY usbutils-buildsize     "4,3&nbsp;Mo">
  <!ENTITY usbutils-time          "0,1&nbsp;SBU">
]>

<sect1 id="usbutils" xreflabel="usbutils-&usbutils-version;">
  <?dbhtml filename="usbutils.html"?>


  <title>usbutils-&usbutils-version;</title>

  <indexterm zone="usbutils">
    <primary sortas="a-usbutils">usbutils</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à USB Utils</title>

    <para>
      Le paquet <application>usbutils</application> contient des outils utilisés
pour afficher des informations sur les bus USB du système et sur les
périphériques qui y sont connectés.
    </para>

    &lfs113_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&usbutils-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&usbutils-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &usbutils-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &usbutils-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &usbutils-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &usbutils-time;
        </para>
      </listitem>
    </itemizedlist>

    <!--
    <bridgehead renderas="sect3">
Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Required patch:
          <ulink url="&patch-root;/usbutils-&usbutils-version;-lsusb_bugfixes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
-->
<bridgehead renderas="sect3">Dépendances de USB Utils</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="libusb"/>
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">

      <!-- git is required by autogen.sh. If using the tarball on kernel.org,
     autogen.sh does not need to be run. If using the github source,
     autogen.sh needs to be run, and git is used to pull the usbhid-dump
     submodule. -->
<!-- In the systemd book, a unit/timer is installed to update the
     usb.ids file automatically. wget is used in the instructions below. -->
<xref linkend="git"/> and <xref linkend="wget"/>

    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/usbutils"/>
    </para>
  </sect2>

  <sect2 role="installation">
    <title>Installation de USB Utils</title>

    <para>
      Installez <application>USB Utils</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>autoreconf -fiv &amp;&amp;

./configure --prefix=/usr --datadir=/usr/share/hwdata &amp;&amp;
make</userinput></screen>

    <para>
      Ce paquet n'a pas de suite de tests.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install</userinput></screen>

    <para>
      Pour installer le fichier de données <filename>usb.ids</filename>, en
utilisant <xref linkend="wget"/>, lancez, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>install -dm755 /usr/share/hwdata/ &amp;&amp;
wget http://www.linux-usb.org/usb.ids -O /usr/share/hwdata/usb.ids</userinput></screen>

    <para>
      Le script <command>lsusb.py</command> affiche des informations dans une
forme plus facilement lisible que <command>lsusb</command>. Pour trouver les
options, utilisez <command>lsusb.py -h</command>. Une utilisation
recommandée par le développeur est <command>lsusb.py -ciu</command>.
    </para>

  </sect2>

  <!-- No longer needed
  <sect2 role="commands">

    <title>Command Explanations</title>

    <para>
      <command>sed ... lsusb.py</command>: Instructs lsusb.py where to search
      <filename>usb.ids</filename>.
    </para>

  </sect2>
-->
<sect2 role="configuration">
    <title>Configuration de usbutils</title>

    <para revision="sysv">
      Le fichier <filename>usb.ids</filename> est mis à jour en permanence. Pour
obtenir une version actuelle de ce fichier, en utilisant <xref
linkend="wget"/>, lancez périodiquement en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root" revision="sysv"><userinput>wget http://www.linux-usb.org/usb.ids -O /usr/share/hwdata/usb.ids</userinput></screen>

    <para>
      Vous devriez mettre à jour le fichier
<filename>/usr/share/hwdata/usb.ids</filename> régulièrement. <phrase
revision="sysv">Si vous avez intsallé <xref linkend="fcron"/> et complété la
section sur les travaux périodiques, exécutez</phrase><phrase
revision="systemd">Exécutez</phrase> les commandes suivantes en tant
qu'utilisateur <systemitem class="username">root</systemitem> pour créer
<phrase revision="sysv">une tache cron hebdomadaire&nbsp;:</phrase><phrase
revision="systemd">un timer systemd pour le mettre à jour chaque semaine le
dimanche à 2h30 du matin (heure locale)&nbsp;:</phrase>
    </para>

<screen role="nodump" revision="sysv"><userinput>cat &gt; /etc/cron.weekly/update-usbids.sh &lt;&lt; "EOF" &amp;&amp;
<literal>#!/bin/bash
/usr/bin/wget http://www.linux-usb.org/usb.ids -O /usr/share/hwdata/usb.ids</literal>
EOF
chmod 754 /etc/cron.weekly/update-usbids.sh</userinput></screen>

<screen role="root" revision="systemd"><userinput>cat &gt; /usr/lib/systemd/system/update-usbids.service &lt;&lt; "EOF" &amp;&amp;
<literal>[Unit]
Description=Update usb.ids file
Documentation=man:lsusb(8)
DefaultDependencies=no
After=local-fs.target network-online.target
Before=shutdown.target

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/usr/bin/wget http://www.linux-usb.org/usb.ids -O /usr/share/hwdata/usb.ids</literal>
EOF
cat &gt; /usr/lib/systemd/system/update-usbids.timer &lt;&lt; "EOF" &amp;&amp;
<literal>[Unit]
Description=Update usb.ids file weekly

[Timer]
OnCalendar=Sun 03:00:00
Persistent=true

[Install]
WantedBy=timers.target</literal>
EOF
systemctl enable update-usbids.timer</userinput></screen>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          lsusb, lsusb.py, usb-devices et usbhid-dump
        </seg>
        <seg>
          Aucune
        </seg>
        <seg>
          Aucune
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="lsusb">
        <term><command>lsusb</command></term>
        <listitem>
          <para>
            est un outil pour afficher des informations sur tous les bus USB du système
et sur tous les périphériques qui y sont connectés, mais pas selon une
présentation humainement lisible
          </para>
          <indexterm zone="usbutils lsusb">
            <primary sortas="b-lsusb">lsusb</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lsusb.py">
        <term><command>lsusb.py</command></term>
        <listitem>
          <para>
            affiche des informations sur tous les bus USB du système et tous les
périphériques connectés selon une présentation raisonnablement lisible
          </para>
          <indexterm zone="usbutils lsusb.py">
            <primary sortas="b-lsusb.py">lsusb.py</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="usb-devices">
        <term><command>usb-devices</command></term>
        <listitem>
          <para>
            est un script shell qui affiche des détails sur les bus USB et les
périphériques qui y sont connectés. Il est conçu pour être utilisé si
/proc/bus/usb/devices n'est pas disponible sur votre système
          </para>
          <indexterm zone="usbutils usb-devices">
            <primary sortas="b-usb-devices">usb-devices</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="usbhid-dump">
        <term><command>usbhid-dump</command></term>
        <listitem>
          <para>
            est utilisé pour générer des descripteurs et des flux de rapports des
interfaces HID (human interface device) des périphériques USB
          </para>
          <indexterm zone="usbutils usbhid-dump">
            <primary sortas="b-usbhid-dump">usbhid-dump</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
