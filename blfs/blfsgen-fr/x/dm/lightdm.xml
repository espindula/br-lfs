<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

<!-- lightdm -->
  <!ENTITY lightdm-download-http "https://github.com/CanonicalLtd/lightdm/releases/download/&lightdm-version;/lightdm-&lightdm-version;.tar.xz">
  <!ENTITY lightdm-download-ftp  "">
  <!ENTITY lightdm-md5sum        "e62a5da6c35f612e4d9575eda5c8d467">
  <!ENTITY lightdm-size          "508 Ko">
  <!ENTITY lightdm-buildsize     "20&nbsp;Mo">
  <!ENTITY lightdm-time          "0.2 SBU">

<!-- lightdm-gtk-greeter -->
  <!ENTITY lightdm-gtk-greeter-download-http "https://github.com/Xubuntu/lightdm-gtk-greeter/releases/download/lightdm-gtk-greeter-&lightdm-gtk-greeter-version;/lightdm-gtk-greeter-&lightdm-gtk-greeter-version;.tar.gz">
  <!ENTITY lightdm-gtk-greeter-download-ftp  "">
  <!ENTITY lightdm-gtk-greeter-md5sum        "373c73c67367df511eb544e09a2da281">
  <!ENTITY lightdm-gtk-greeter-size          "569.7&nbsp;Ko">
  <!ENTITY lightdm-gtk-greeter-buildsize     "5.5&nbsp;Mo">
  <!ENTITY lightdm-gtk-greeter-time          "moins de 0.1 SBU">
]>

<sect1 id="lightdm" xreflabel="lightdm-&lightdm-version;">
  <?dbhtml filename="lightdm.html"?>


  <title>lightdm-&lightdm-version;</title>

  <indexterm zone="lightdm">
    <primary sortas="a-lightdm">lightdm</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Lightdm</title>

    <para>
      Le paquet <application>libghtdm</application> contient un gestionnaire
d'affichage léger basé sur GTK.
    </para>

    &lfs113_checked;

    <bridgehead renderas="sect3">Information sur le paquet Lightdm</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&lightdm-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&lightdm-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &lightdm-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &lightdm-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &lightdm-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &lightdm-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargement supplémentaire</bridgehead>

    <note>
      <para>
        Le «&nbsp;greeter&nbsp;» est un programme qui présente un écran de connexion
graphique. Il y a plusieurs apparences possibles, mais le paquet gtk+ est
l'implémentation de référence. Pour une liste d'autres apparences, voir
<ulink url="https://en.wikipedia.org/wiki/LightDM"/>.
      </para>
    </note>

    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink
url="&lightdm-gtk-greeter-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink
url="&lightdm-gtk-greeter-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &lightdm-gtk-greeter-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &lightdm-gtk-greeter-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &lightdm-gtk-greeter-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &lightdm-gtk-greeter-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de Lightdm</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <!-- required by exo      <xref linkend="gtk3"/>
, -->
<!-- Neither lightdm-1.30.0 nor lightdm-gtk-greeter-2.0.8
     mention pcre in their configure scripts
      <xref linkend="pcre"/>
-->
<xref linkend="exo"/> (for the greeter), <xref linkend="libgcrypt"/>, <xref
linkend="itstool"/>, <xref linkend="linux-pam"/>, and <xref role='runtime'
linkend='xorg-server'/> (Runtime)
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="gobject-introspection"/>, <xref linkend="libxklavier"/> et
<xref linkend="vala"/>
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref role="runtime" linkend="accountsservice"/> (à l'exécution), <xref
linkend="at-spi2-core"/>, <xref linkend="gtk-doc"/>, <xref linkend="qt5"/>,
<ulink url="https://launchpad.net/ido">libido</ulink> et <ulink
url="https://launchpad.net/libindicator">libindicator</ulink>

    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/lightdm"/>
    </para>
  </sect2>

  <sect2 role="installation">
    <title>Installation de Lightdm</title>

    <para>
      Tout d'abord, créez un utilisateur et un groupe dédiés pour contrôler le
démon <command>libghtdm</command> après son démarrage. Lancez les commandes
suivantes en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>groupadd -g 65 lightdm       &amp;&amp;
useradd  -c "Lightdm Daemon" \
         -d /var/lib/lightdm \
         -u 65 -g lightdm    \
         -s /bin/false lightdm</userinput></screen>

    <para revision="sysv">
      Ensuite, changez les fichiers de configuration
<application>Linux-PAM</application> pour
qu'<application>elogind</application> puisse être utilisé&nbsp;:
    </para>

<screen revision="sysv"><userinput>sed -i s/systemd/elogind/ data/pam/*</userinput></screen>

    <para>
      Installez <application>lightdm</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>./configure --prefix=/usr                 \
            --libexecdir=/usr/lib/lightdm \
            --localstatedir=/var          \
            --sbindir=/usr/bin            \
            --sysconfdir=/etc             \
            --disable-static              \
            --disable-tests               \
            --with-greeter-user=lightdm   \
            --with-greeter-session=lightdm-gtk-greeter \
            --docdir=/usr/share/doc/lightdm-&lightdm-version; &amp;&amp;
make</userinput></screen>

    <para>
      Ce paquet n'a pas de suite de tests.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install                                                  &amp;&amp;
cp tests/src/lightdm-session /usr/bin                         &amp;&amp;
sed -i '1 s/sh/bash --login/' /usr/bin/lightdm-session        &amp;&amp;
rm -rf /etc/init                                              &amp;&amp;
install -v -dm755 -o lightdm -g lightdm /var/lib/lightdm      &amp;&amp;
install -v -dm755 -o lightdm -g lightdm /var/lib/lightdm-data &amp;&amp;
install -v -dm755 -o lightdm -g lightdm /var/cache/lightdm    &amp;&amp;
install -v -dm770 -o lightdm -g lightdm /var/log/lightdm</userinput></screen>

     <para>
       Maintenant construisez le greeter&nbsp;:
     </para>

<screen><userinput>tar -xf ../lightdm-gtk-greeter-&lightdm-gtk-greeter-version;.tar.gz &amp;&amp;
cd lightdm-gtk-greeter-&lightdm-gtk-greeter-version; &amp;&amp;

./configure --prefix=/usr                 \
            --libexecdir=/usr/lib/lightdm \
            --sbindir=/usr/bin            \
            --sysconfdir=/etc             \
            --with-libxklavier            \
            --enable-kill-on-sigterm      \
            --disable-libido              \
            --disable-libindicator        \
            --disable-static              \
            --disable-maintainer-mode     \
            --docdir=/usr/share/doc/lightdm-gtk-greeter-&lightdm-gtk-greeter-version; &amp;&amp;
make</userinput></screen>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install</userinput></screen>

  <note>
    <para>
      Si vous avez installé Xorg dans /opt, vous devrez créer un lien symbolique
pour que lightdm puisse trouver le serveur Xorg. En tant qu'utilisateur
<systemitem class="username">root</systemitem>&nbsp;:
    </para>

    <screen role="nodump"><userinput>ln -sf /opt/xorg/bin/Xorg /usr/bin/X</userinput></screen>
  </note>


  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>
    <para>

      <command>sed ... /usr/bin/lightdm-session</command>&nbsp;: Cette commande
s'assure que la connexion initiale via l'écran d'accueil récupère les
valeurs de /etc/profile et ~/.bash_profile. Sans cela, les commandes qui
dépendent de certaines variables d'environnement pourraient ne pas
fonctionner comme il faudrait.
    </para>

  <!--
    <para>

      <parameter>ITSTOOL=/bin/true</parameter>: although
      <xref linkend="itstool"/> is not needed in a normal build,
      <command>configure</command> throws an error if it is not found on the
      system. This parameter prevents the error.
    </para>

    <para>
      <parameter>HAVE_EXO_CSOURCE=yes</parameter>: although
      <command>exo-csource</command> is not needed in a normal build,
      <command>configure</command> throws an error if it is not found on the
      system. This parameter prevents the error.
    </para>
-->
</sect2>

  <sect2 role="configuration">
    <title>Configuration de lightdm</title>

    <sect3 id="lightdm-config">
      <title>Fichiers de configuration</title>

      <para>
        /etc/lightdm/{lightdm,users,keys}.conf
      </para>

      <indexterm zone="lightdm lightdm-config">
        <primary sortas="e-etc-lightdm-lightdm.conf">/etc/lightdm/lightdm.conf</primary>
      </indexterm>

      <indexterm zone="lightdm lightdm-config">
        <primary sortas="e-users.conf">/etc/lightdm/users.conf</primary>
      </indexterm>

      <indexterm zone="lightdm lightdm-config">
        <primary sortas="e-keys.conf">/etc/lightdm/keys.conf</primary>
      </indexterm>

      <indexterm zone="lightdm lightdm-config">
        <primary sortas="e-lightdm-gtk-greeter.conf">
          /etc/lightdm/lightdm-gtk-greeter.conf</primary>
      </indexterm>

   </sect3>

    <sect3 id="lightdm-bootscript">
      <title><phrase revision="sysv">Script de démarrage</phrase> <phrase
revision="systemd">Unité Systemd</phrase></title>

      <indexterm zone="lightdm lightdm-bootscript">
        <primary sortas="f-lightdm">lightdm</primary>
      </indexterm>

      <para revision="sysv">
        Pour démarrer <command>lightdm</command> automatiquement quand le système
passe au niveau d'exécution 5, installez le script
<filename>/etc/rc.d/init.d/xdm</filename> et le fichier de configuration
<filename>/etc/sysconfig/xdm</filename> inclus dans le paquet <xref
linkend="bootscripts"/> et ajustez <filename>/etc/inittab</filename> en
lançant en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
      </para>

<screen role="root" revision="sysv"><userinput>make install-lightdm</userinput></screen>

      <para revision="systemd">
        Installez l'unité <filename>lightdm.service</filename> incluse dans le
paquet <xref linkend="systemd-units"/>&nbsp;:
      </para>

<screen role="root" revision="systemd"><userinput>make install-lightdm</userinput></screen>

    </sect3>
    <sect3 id="lightdm-init" revision="sysv">
      <title>Démarrage de lightdm</title>

      <para>
        L'écran <command>lightdm</command> peut être démarré à partir de la ligne de
commande en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
      </para>

<!-- "make install-lightdm already does this already
      <para>
        Alternatively the runlevel can be permanently set to 5, starting the
        <command>lightdm</command> greeter screen automatically, by modifying
        <filename>/etc/inittab</filename>.  As the <systemitem
        class="username">
root</systemitem> user:
      </para>

<screen role="root"><userinput>cp -v /etc/inittab{,-orig} &amp;&amp;
sed -i '/initdefault/ s/3/5/' /etc/inittab</userinput></screen>
-->
<screen role="nodump"><userinput>telinit 5</userinput></screen>


    </sect3>

    <sect3 id="lightdm-sessions">
      <title>Sessions disponibles</title>

      <para>
        Le greeter offre une liste de sessions disponibles en fonction des
gestionnaires de fenêtres et des environnements de bureaux installés. La
liste contient les sessions qui ont un fichier <filename>.desktop</filename>
correspondant dans <filename
class="directory">/usr/share/xsessions</filename>. La plupart des
gestionnaires de fenêtres et des environnements de bureaux fournissent
automatiquement ces fichiers, mais si nécessaire, vous pouvez en inclure un
personnel.
      </para>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          dm-tool, lightdm et lightdm-gtk-greeter
        </seg>
        <seg>
          liblightdm-gobject-1.so
        </seg>
        <seg>
          /etc/lightdm, /etc/apparmor.d, /usr/lib/lightdm,
/usr/include/lightdm-gobject-1, /usr/share/help/C/lightdm
/usr/share/gtk-doc/html/lightdm-gobject-1,
/usr/share/doc/lightdm-gtk-greeter-&lightdm-gtk-greeter-version;,
/var/lib/lightdm, /var/lib/lightdm-data, /var/cache/lightdm et
/var/log/lightdm
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="lightdm-prog">
        <term><command>lightdm</command></term>
        <listitem>
          <para>
            est un gestionnaire d'affichage et de connexion
          </para>
          <indexterm zone="lightdm lightdm-prog">
            <primary sortas="b-lightdm">lightdm</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lightdm-gtk-greeter">
        <term><command>lightdm-gtk-greeter</command></term>
        <listitem>
          <para>
            est un processus auxiliaire qui affiche l'écran d'accueil, une interface
utilisateur graphique qui effectue l'authentification de l'utilisateur et
initialise le gestionnaire de fenêtres ou l'environnement de bureau
sélectionné
          </para>
          <indexterm zone="lightdm lightdm-gtk-greeter">
            <primary sortas="b-lightdm-gtk-greeter">lightdm-gtk-greeter</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
