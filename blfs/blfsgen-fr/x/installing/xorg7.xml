<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="xorg7" xreflabel="Xorg-&xorg-version;">
  <?dbhtml filename="xorg7.html"?>


  <title>Introduction à Xorg-&xorg-version;</title>

  <indexterm zone="xorg7">
    <primary sortas="a-xorg7">Xorg</primary>
  </indexterm>


  <para>
    <application>Xorg</application> est une implémentation librement
distribuable et open source du système de fenêtrage
<application>X</application>. Ce système offre une interface client/serveur
entre le matériel d'affichage (la souris, le clavier et les afficheurs
graphiques) et l'environnement de bureau, tout en fournissant aussi à la
fois l'infrastructure de fenêtres et une interface d'applications
standardisée (API).
  </para>

  <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url='&blfs-wiki;/Xorg7'/></para>

  <bridgehead renderas="sect3">Instructions de téléchargement et installation de Xorg</bridgehead>

  <para>
    Xorg-7.0 a introduit un système de construction utilisant complètement les
auto-tools et modulaire. Avec le nouveau système de construction modulaire,
il n'est plus possible de télécharger tout le paquet dans un seul
fichier. En fait, il peut y avoir plus de 1000 paquets à récupérer sur le
lieu du téléchargement. Pour vous aider pour une tâche si importante,
l'installation de <xref linkend="wget"/> est fortement recommandée pour
télécharger les fichiers nécessaires. On fournit une liste complète des
fichiers <application>wget</application> pour chaque page incluant plusieurs
paquets.
  </para>

  <para>
    Étant donné le nombre de paquets disponibles, la décision des paquets à
installer selon votre configuration particulière peut paraître de prime
abord écrasante. Jetez un œil sur <ulink url=
"https://wiki.x.org/wiki/ModuleDescriptions">cette page</ulink> et <ulink
url=
"https://lists.x.org/archives/xorg-modular/2005-November/000801.html">ce
fil</ulink> pour vous faire une idée de ce dont vous aurez besoin. Si vous
n'êtes pas sûr, vous devriez installer tous les paquets, au prix d'un espace
disque supplémentaire.
  </para>

  <note>
    <para>
      Même si vous ne voulez télécharger que les paquets nécessaires, vous devriez
télécharger les listes de fichiers wget. La liste des fichiers est rangée
par dépendances et les versions des paquets listés dans les fichiers sont
connues pour bien fonctionner ensembles. En outre, les listes de fichiers
wget contiennent des commentaires pour des paquets spécifiques obsolètes ou
dont on ne recommande pas l'installation. Les paquets plus récents sont
probablement prévus pour la prochaine version de
<application>Xorg</application> et ils ont déjà prouvé leur incompatibilité
avec les versions actuelles des logiciels installés dans BLFS. La taille du
<application>Xorg</application> installé peut être réduite considérablement
en n'installant que les paquets dont vous avez besoin et que vous
utiliserez, mais le livre BLFS ne peut pas tenir compte de toutes les
dépendances et de toutes les options de construction des paquets
<application>Xorg</application> individuels. Les instructions supposent que
tous les paquets ont été construits. Une page <ulink
url="&blfs-wiki;/Xorg7">wiki</ulink> contenant des informations de
dépendances est en développement. On vous encourage à compléter ces pages si
vous trouvez des informations supplémentaires qui peuvent aider les autres
utilisateurs qui installent de manière sélective les paquets individuels.
    </para>
  </note>

  <para>
    De plus, du fait du grand nombre de commandes répétitives, on vous invite à
automatiser partiellement la construction. On vous donne ici des
instructions qui utilisent le paquet <xref linkend="sudo"/>. Il est
recommandé à l'utilisateur qui va construire les paquets de xorg d'utiliser
l'option de configuration <parameter>:NOPASSWD</parameter>.
  </para>

  <sect2 id="xorg-env" xreflabel="Environnement de construction de Xorg">
    <title>Paramétrer l'environnement de construction de Xorg</title>

    <note>
      <para>
        Les instructions suivantes considèrent que les fichiers de démarrage du
shell sont configurés comme décrit dans <xref
linkend="postlfs-config-profile" />.
      </para>
    </note>

    <para>
      Comme avec les versions précédentes du système X Window, il peut être
souhaitable d'installer <application>Xorg</application> dans un préfixe
alternatif. Ce n'est plus une pratique courante dans les distributions
Linux. Le préfixe d'installation habituelle de
<application>Xorg</application> sur Linux est <filename
class="directory">/usr</filename>. Il n'y a pas de préfixe alternatif
standard, ni d'exception dans la révision actuelle du standard de hiérarchie
des systèmes de fichiers (FHS) pour la version 7 du système X Window. Alan
Coopersmith de Sun Microsystems, a déclaré récemment «&nbsp;Chez Sun, nous
utilisions <filename class="directory">/usr/X11</filename> et nous
envisageons de continuer comme ça&nbsp;». Seul le préfixe <filename
class="directory">/opt/*</filename> ou le préfixe <filename
class="directory">/usr</filename> correspondent aux lignes directrices
actuelles du FHS.
    </para>

    <para>
      Les éditeurs de BLFS recommandent d'utiliser le préfixe <filename
class="directory">/usr</filename>.
    </para>

    <para>
      Choisissez votre préfixe d'installation et réglez la variable
<envar>XORG_PREFIX</envar> avec la commande suivante&nbsp;:
    </para>

<screen><userinput>export XORG_PREFIX="<replaceable>&lt;PREFIX&gt;</replaceable>"</userinput></screen>

    <para>
      Tout au long de ces instructions, vous utiliserez les paramètres
<command>configure</command> suivants pour tous les paquets. Créez la
variable <envar>XORG_CONFIG</envar> à utiliser en remplacement de ce
paramètre&nbsp;:
    </para>

<screen><userinput>export XORG_CONFIG="--prefix=$XORG_PREFIX --sysconfdir=/etc \
    --localstatedir=/var --disable-static"</userinput></screen>

    <para>
      Créez un fichier de configuration
<filename>/etc/profile.d/xorg.sh</filename> contenant ces variables en tant
que <systemitem class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>cat &gt; /etc/profile.d/xorg.sh &lt;&lt; EOF
<literal>XORG_PREFIX="$XORG_PREFIX"
XORG_CONFIG="--prefix=\$XORG_PREFIX --sysconfdir=/etc --localstatedir=/var --disable-static"
export XORG_PREFIX XORG_CONFIG</literal>
EOF
chmod 644 /etc/profile.d/xorg.sh</userinput></screen>

    <note>
      <para>
        Il y a beaucoup de confusion sur le document en ligne ci-dessus. L'antislash
devant le signe dollar est correct. Bash le supprimera en créant
/etc/profile.d/xorg.sh. Cependant, si vous créez le fichier avec un éditeur,
un copier-coller ne supprimera par l'antislash. Il doit être supprimé
manuellement.
      </para>
    </note>

    <para>
      Si vous avez installé <xref linkend="sudo"/>, assurez-vous que
<envar>XORG_PREFIX</envar> et <envar>XORG_CONFIG</envar> sont disponibles
dans l'environnement <application>sudo</application>. En tant qu'utilisateur
<systemitem class="username">root</systemitem>, lancez la commande
suivante&nbsp;:
    </para>

<screen role="root"><userinput>cat &gt; /etc/sudoers.d/xorg &lt;&lt; EOF
<literal>Defaults env_keep += XORG_PREFIX
Defaults env_keep += XORG_CONFIG</literal>
EOF</userinput></screen>

<bridgehead renderas="sect2">Si vous n'utilisez pas le préfixe Xorg standard…</bridgehead>

    <warning>
      <para>
        Si vous décidez d'utiliser le préfixe standard <filename
class="directory">/usr</filename>, vous pouvez omettre le reste de cette
page et continuer avec <xref linkend="util-macros"/>.
      </para>
    </warning>

    <para>
      Si vous décidez de <emphasis>ne pas</emphasis> utiliser le préfixe standard,
soyez certain d'ajouter <filename
class="directory">$XORG_PREFIX/bin</filename> à votre variable
d'environnement <envar>PATH</envar> et <filename
class="directory">$XORG_PREFIX/lib/pkgconfig</filename> et <filename
class="directory">$XORG_PREFIX/share/pkgconfig</filename> à votre variable
<envar>PKG_CONFIG_PATH</envar>. Il est également utile de spécifier un
répertoire de recherche supplémentaire pour <command>gcc</command> et un
répertoire d'"include" pour le programme <command>aclocal</command>. Tapez
les commandes suivantes en tant que <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>cat &gt;&gt; /etc/profile.d/xorg.sh &lt;&lt; "EOF"
<literal>
pathappend $XORG_PREFIX/bin             PATH
pathappend $XORG_PREFIX/lib/pkgconfig   PKG_CONFIG_PATH
pathappend $XORG_PREFIX/share/pkgconfig PKG_CONFIG_PATH

pathappend $XORG_PREFIX/lib             LIBRARY_PATH
pathappend $XORG_PREFIX/include         C_INCLUDE_PATH
pathappend $XORG_PREFIX/include         CPLUS_INCLUDE_PATH

ACLOCAL="aclocal -I $XORG_PREFIX/share/aclocal"

export PATH PKG_CONFIG_PATH ACLOCAL LIBRARY_PATH C_INCLUDE_PATH CPLUS_INCLUDE_PATH</literal>
EOF</userinput></screen>

    <para>
      Le script ci-dessus doit être activé. Normalement cela est fait
automatiquement à la connexion, mais pour l'activer maintenant en tant
qu'utilisateur normal, lancez&nbsp;:
    </para>

<screen><userinput>source /etc/profile.d/xorg.sh</userinput></screen>

    <para>
      Vous pouvez aussi ajouter <filename
class="directory">$XORG_PREFIX/lib</filename> dans le fichier
<filename>/etc/ld.so.conf</filename>. De nouveau, en tant que <systemitem
class="username">root</systemitem>&nbsp;, tapez la commande suivante&nbsp;:
    </para>

<screen role="root"><userinput>echo "$XORG_PREFIX/lib" >> /etc/ld.so.conf</userinput></screen>

    <para>
      Vous pouvez aussi modifier <filename>/etc/man_db.conf</filename>, en
ajoutant les entrées appropriées MANDATORY_MANPATH, MANPATH_MAP, et
MANDB_MAP comme le montrent les exemples de <filename
class="directory">/usr/X11R6</filename>. Tapez la commande suivante en tant
qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>sed -e "s@<replaceable>X11R6/man</replaceable>@X11R6/share/man@g" \
    -e "s@<replaceable>/usr/X11R6</replaceable>@$XORG_PREFIX@g"   \
    -i /etc/man_db.conf</userinput></screen>

    <para>
      Quelques applications cherchent les fichiers partagés dans <filename
class="directory">/usr/share/X11</filename>. Créez un lien symbolique vers
le bon endroit en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>ln -svf $XORG_PREFIX/share/X11 /usr/share/X11</userinput></screen>

    <para>
      Si vous construisez KDE, certains fichiers cmake cherchent Xorg à des
endroits autres que $XORG_PREFIX. Permettez à cmake de trouver Xorg
avec&nbsp;:
    </para>

<!--
    <para>

      Finally, if building on x86_64, you will need to create the
      <filename class="directory">$XORG_PREFIX/lib</filename> directory and the
      <filename>$XORG_PREFIX/lib64</filename> symlink. Again, as the
      <systemitem class="username">root</systemitem> user, issue the following
      commands:
    </para>

<screen role="root"><userinput>install -v -m755 -d $XORG_PREFIX &amp;&amp;
install -v -m755 -d $XORG_PREFIX/lib &amp;&amp;
ln -sf lib $XORG_PREFIX/lib64</userinput></screen>
-->
<screen role="root"><userinput>ln -svf $XORG_PREFIX /usr/X11R6</userinput></screen>

  </sect2>

</sect1>
