<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="tuning-fontconfig">
  <?dbhtml filename="tuning-fontconfig.html"?>


  <title>Réglages de Fontconfig</title>

  <indexterm zone="tuning-fontconfig">
    <primary sortas="g-tuning-fontconfig">Réglages de Fontconfig</primary>
  </indexterm>

    <sect2 id='fontconfig-overview' xreflabel="Aperçu de Fontconfig">
    <title>Aperçu de Fontconfig</title>



    <!-- do not add individual indexterm entries for items within this page, they
 all belong in section G (others) and not only do they add noise in longindex,
 the links all point to the top of the page. -->
<para>
      Si vous lisez des textes seulement en anglais et êtes contents avec les
polices libres génériques listés dans la page suivante, vous pourriez
n'avoir jamais besoin de vous occuper des détails de fonctionnement de
<application>fontconfig</application>. Mais il y a plein de choses qui
peuvent être modifiées si elles ne vous conviennent pas.
    </para>

    <para>
      Bien que cette page soit longue, elle ne fait qu'effleurer la surface et
vous pourrez trouver plein d'alternatives sur le web (mais rappelez-vous que
certaines choses changent au fil des ans, par exemple l'autohinter n'est
plus utilisé par défaut). Le but est ici de vous donner assez d'information
pour comprendre les changements que vous faîtes.
    </para>

    </sect2>

    <sect2 role="configuration" id="xft-font-protocol" xreflabel="Le Protocole de Police Xft">
    <title>Le Protocole de Police Xft</title>

    <para>
      Le protocole de police Xft fournit un rendu de polices anti-crénelé à
travers <application>freetype</application> et les polices sont contrôlées
depuis le côté client avec <application>fontconfig</application> (sauf pour
<xref linkend="rxvt-unicode"/> qui peut utiliser les polices listées dans
<filename>~/.Xresources</filename> et <xref linkend="abiword"/> qui
n'utilise que les polices spécifiées). Le chemin de recherche par défaut est
<filename class="directory">/usr/share/fonts</filename> et <filename
class="directory">~/.local/share/fonts</filename> bien que pour le moment le
vieil emplacement obsolète <filename class="directory">~/.fonts</filename>
fonctionne toujours. <application>Fontconfig</application> recherche
récursivement dans ces répertoires et maintient un cache des
caractéristiques des polices dans chaque répertoire. Si le cache a l'air
périmé, il est ignoré et les informations sont retrouvées depuis les polices
elles-mêmes (ce qui peut prendre quelques secondes si vous avez installé
beaucoup de polices).
    </para>

    <para>
      <!-- fonts-misc-ethiopic installs an OTF directory ! -->
Si vous avez installé <application>Xorg</application> dans un autre préfixe
que <filename class="directory">/usr</filename>, les polices
<application>X</application> n'ont pas été installées dans un répertoire
connu de <application>Fontconfig</application>. Des liens symboliques ont
été créés entre les répertoires de polices <filename
class="directory">OTF</filename> et <filename
class="directory">TTF</filename> de <application>X</application> et
<filename class="directory">/usr/share/fonts/X11-{OTF,TTF}</filename>. Cela
permet à <application>Fontconfig</application> d'utiliser les polices
OpenType et TrueType fournies par <application>X</application>, même si
beaucoup de monde préférera utiliser des polices plus modernes.
    </para>

    <para>
      <application>Fontconfig</application> utilise les noms pour définir les
polices. Les applications utilisent en général des noms de polices
génériques comme «&nbsp;Monospace&nbsp;», «&nbsp;Sans&nbsp;» et
«&nbsp;Serif&nbsp;». <application>Fontconfig</application> résout ces noms
en une police dont les caractères couvrent toutes les possibilités de la
langue indiquée par les paramètres régionaux.
    </para>

    </sect2>

    <sect2 role="configuration" id="useful-commands" xreflabel="Commandes utiles">
    <title>Commandes utiles</title>

    <para>
      Les commandes suivantes peuvent être utiles lorsque vous travaillez avec
fontconfig&nbsp;:
    </para>

    <para>
      <command>fc-list | less</command>&nbsp;: montre la liste des polices
disponible (/chemin/vers/fichier&nbsp;: Nom de la police:style). Si vous
avez installé une police il y a plus de 30 secondes mais qu'elle n'apparaît
pas, alors elle ou l'un de ses répertoires n'est pas lisible par votre
utilisateur.
    </para>

    <para>
      <command>fc-match 'Font Name'</command>&nbsp;: indique quelle police sera
utilisée si la police de ce nom est demandée. Généralement vous l'utiliserez
pour voir ce qui arrive si une police non-installée est demandée, mais vous
pouvez aussi l'utiliser si le système utilise une police différente de ce à
quoi vous vous attendiez (peut-être parce que
<application>fontconfig</application> ne pense pas que la police supporte
votre langue).
    </para>

    <para>
      <command>fc-match -a 'Type' | less</command>&nbsp;: fournit une liste de
toutes les polices qui peuvent être utilisée pour ce type (Monospace, Sans,
Serif). Remarquez que parfois <application>fontconfig</application> prendra
un glyphe d'une autre police disponible, même si elle n'est pas du type
spécifiée, et à moins qu'il ne connaisse le type de la police, il supposera
que c'est Sans.
    </para>

    <para>
      Si vous souhaitez connaître quelle police sera utilisée pour une chaîne de
caractères (c'est-à-dire un ou plusieurs glyphes, séparés par un espace),
copiez la commande suivante et remplacez <literal>xyz</literal> par le texte
qui vous préoccupe.
    </para>

    <para>
      <command>FC_DEBUG=4 pango-view --font=monospace -t xyz | grep
family</command> : ceci requiert <xref linkend="pango"/> et <xref
linkend="imagemagick"/> - qui va invoquer <xref linkend="display"/>  pour
afficher le texte dans une petite fenêtre, et à la fermeture, la dernière
ligne de la sortie montrera quelle police d'écriture a été utilisée. C'est
particulièrement pratique pour les langues CJK, et vous pouvez également
passer un langage, ex: PANGO_LANGUAGE=en;ja (Anglais, puis présume Japonais)
ou simplement zh-cn (ou d'autres variantes - 'zh' seul n'est pas valide).
    </para>

    </sect2>

    <sect2 role="configuration" id="the-various-files" xreflabel="Les divers fichiers">
    <title>Les divers fichiers</title>

    <para>
      Les fichiers principaux sont dans <filename
class="directory">/etc/fonts/conf.d/</filename>. C'est un répertoire prévu
pour être rempli de liens symboliques vers des fichiers dans <filename
class="directory">/usr/share/fontconfig/conf.avail/</filename>, mais de
nombreuses personnes, et quelques paquets, créent les fichiers
directement. Chaque fichier doit être nommé comme suit&nbsp;: deux chiffres,
un tiret, nom.conf et ils sont lus séquentiellement.
    </para>

    <para>
      Par convention, les nombres sont assignés comme suit&nbsp;:
    </para>

    <itemizedlist>
      <listitem>
        <para>
          00-09 répertoires de polices supplémentaires
        </para>
      </listitem>
      <listitem>
        <para>
          10-19 rendus systèmes par défaut (comme l'anti-crénelage)
        </para>
      </listitem>
      <listitem>
        <para>
          20-29 options de rendu des polices
        </para>
      </listitem>
      <listitem>
        <para>
          30-39 substitution par famille
        </para>
      </listitem>
      <listitem>
        <para>
          40-49 correspondance entre famille et type générique
        </para>
      </listitem>
      <listitem>
        <para>
          50-59 chargement des fichiers de configuration alternatifs
        </para>
      </listitem>
      <listitem>
        <para>
          60-69 alias génériques, fait correspondre les noms générique à la famille
        </para>
      </listitem>
      <listitem>
        <para>
          70-79 adapte quelles polices sont disponibles
        </para>
      </listitem>
      <listitem>
        <para>
          80-89 correspond aux numérisations (modification des modèles numérisés)
        </para>
      </listitem>
      <listitem>
        <para>
          90-99 synthèse de police
        </para>
      </listitem>
    </itemizedlist>

    <para>
      Vous pouvez avoir aussi un fichier <filename>fonts.conf</filename> personnel
dans $XDG_CONFIG_HOME (c'est-à-dire <filename
class="directory">~/.config/fontconfig/</filename>).
    </para>

  </sect2>

  <sect2 role="configuration" id="rules-to-choose-a-font" xreflabel="Les règles de choix d'une police">
  <title>Les règles de choix d'une police</title>

    <para>
      Si la police demandée est installée, et à condition qu'elle contienne le
point de code <emphasis>requis</emphasis> pour la langue actuelle (dans les
sources, voir les fichiers .orth dans le répertoire <filename
class="directory">fc-lang/</filename>), elle sera utilisée.
    </para>

    <para>
      Cependant, si le document ou la page demande une police qui n'est pas
installée (ou, parfois, ne contient pas tous les points de codes requis) les
règles suivantes sont appliquées&nbsp;: en premier,
<filename>30-metric-aliases.conf</filename> est utilisé pour assigner des
alias à certaines polices avec la même métrique (même taille, etc). Après
cela, une police inconnue sera recherchée dans
<filename>45-latin.conf</filename> – si elle est trouvée elle sera assignée
en tant que Serif ou Monospace ou Sans, sinon elle sera considérée comme
étant Sans. Ensuite <filename>50-latin.conf</filename> fournit les listes
ordonnées des solutions de repli – <xref linkend="dejavu-fonts"/> seront
utilisées si vous les avez installées. Le cyrillique et le grec semblent
être traités de la même manière. Il y a des fichiers similaires avec un
préfixe 65- pour le persan et d'autres systèmes d'écriture non latines. Tous
ces fichiers préfèrent les polices commerciales si elles sont présentes,
bien que les polices libres modernes soient souvent au moins égales.
    </para>

    <para>
      Depuis fontconfig-2.12.5, il y a aussi des règles de familles génériques
pour certaines polices d'emoji et de maths, consultez {45,60}-generic.conf.
    </para>

    <para>
      Dans les rares cas ou une police ne contient pas tous les points de codes
attendus, voir 'Essayez en premier&nbsp;:' dans <xref
linkend="I-stared-into-the-fontconfig"/> pour plus de détails.
    </para>

  </sect2>

  <sect2 role="configuration" id="hinting-and-antialiasing" xreflabel="Hinting et Anticrénelage">
  <title>Hinting et Anticrénelage</title>

    <para>
      Il est possible de changer la façon dont, ou si, les polices sont
hintées. L'exemple de fichier suivant contient les paramètres par défaut,
mais avec des commentaires. Les paramètres sont laissées aux préférences de
l'utilisateur et au choix de police, de sorte qu'un changement qui améliore
certaines pages peut en aggraver d'autres. L'endroit préférable pour ce
fichier est&nbsp;: <filename>~/.config/fontconfig/fonts.conf</filename>
    </para>

    <para>
      Pour tester différents paramétrages, vous aurez peut être besoin de sortir
de Xorg et ensuite relancer <command>startx</command> pour que toutes les
applications utilisent le nouveau paramétrage. Si vous utilisez GNOME, KDE
ou LXQt, leurs bureaux peuvent écraser ces modifications. Pour explorer les
possibilités, créez un fichier pour votre utilisateur&nbsp;:
    </para>

<screen><userinput>mkdir -pv ~/.config/fontconfig &amp;&amp;
cat > ~/.config/fontconfig/fonts.conf &lt;&lt; "EOF"
<literal>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;
&lt;fontconfig&gt;

  &lt;match target="font" &gt;
    &lt;!-- autohint was the old automatic hinter when hinting was patent
    protected, so turn it off to ensure any hinting information in the font
    itself is used, this is the default --&gt;
    &lt;edit mode="assign" name="autohint"&gt;  &lt;bool&gt;false&lt;/bool&gt;&lt;/edit&gt;

    &lt;!-- hinting is enabled by default --&gt;
    &lt;edit mode="assign" name="hinting"&gt;   &lt;bool&gt;true&lt;/bool&gt;&lt;/edit&gt;

    &lt;!-- for the lcdfilter see https://www.spasche.net/files/lcdfiltering/ --&gt;
    &lt;edit mode="assign" name="lcdfilter"&gt; &lt;const&gt;lcddefault&lt;/const&gt;&lt;/edit&gt;

    &lt;!-- options for hintstyle:
    hintfull: is supposed to give a crisp font that aligns well to the
    character-cell grid but at the cost of its proper shape.

    hintmedium: poorly documented, maybe a synonym for hintfull.
    hintslight is the default: - supposed to be more fuzzy but retains shape.

    hintnone: seems to turn hinting off.
    The variations are marginal and results vary with different fonts --&gt;
    &lt;edit mode="assign" name="hintstyle"&gt; &lt;const&gt;hintslight&lt;/const&gt;&lt;/edit&gt;

    &lt;!-- antialiasing is on by default and really helps for faint characters
    and also for 'xft:' fonts used in rxvt-unicode --&gt;
    &lt;edit mode="assign" name="antialias"&gt; &lt;bool&gt;true&lt;/bool&gt;&lt;/edit&gt;

    &lt;!-- subpixels are usually rgb, see
    http://www.lagom.nl/lcd-test/subpixel.php --&gt;
    &lt;edit mode="assign" name="rgba"&gt;      &lt;const&gt;rgb&lt;/const&gt;&lt;/edit&gt;

    &lt;!-- thanks to the Arch wiki for the lcd and subpixel links --&gt;
  &lt;/match&gt;

&lt;/fontconfig&gt;</literal>
EOF</userinput></screen>

    <para>
      Vous devrez maintenant éditer le fichier avec votre éditeur préféré.
    </para>

    <para>
      Pour plus d'exemples, voir les fils de discussion de blfs-support qui ont
débuté le <ulink
url="https://lists.linuxfromscratch.org/sympa/arc/blfs-support/2016-09/msg00128.html">2016-09/00128</ulink>,
en particulier <ulink
url="https://lists.linuxfromscratch.org/sympa/arc/blfs-support/2016-09/msg00137.html">2016-09/00137</ulink>,
et la solution préférée de l'auteur du message initial <ulink
url="https://lists.linuxfromscratch.org/sympa/arc/blfs-support/2016-09/msg00147.html">2016-09/00147</ulink>.
Il y a d'autres exemples dans <xref linkend="arch-fontconfig"/> et <xref
linkend="gentoo-fontconfig"/>.
    </para>

  </sect2>

  <sect2 role="configuration" id="disabling-bitmap-fonts" xreflabel="Désactivation des polices bitmaps">
  <title>Désactivation des polices Bitmaps</title>

    <para>
      Dans les versions précédentes de BLFS, les vieilles polices laides de Xorg
étaient installées. Maintenant, beaucoup de personnes n'ont plus besoin
d'installer aucune d'entre elles. Mais si pour une raison ou une autre vous
avez installé une ou plusieurs polices bitmap, vous pouvez empêcher leur
utilisation par <application>fontconfig</application> en créant le fichier
suivant en tant qu'utilisateur &root;&nbsp;:
    </para>

<screen role="root"><userinput>cat > /etc/fonts/conf.d/70-no-bitmaps.conf &lt;&lt; "EOF"
<literal>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;
&lt;fontconfig&gt;
&lt;!-- Reject bitmap fonts --&gt;
 &lt;selectfont&gt;
  &lt;rejectfont&gt;
   &lt;pattern&gt;
     &lt;patelt name="scalable"&gt;&lt;bool&gt;false&lt;/bool&gt;&lt;/patelt&gt;
   &lt;/pattern&gt;
  &lt;/rejectfont&gt;
 &lt;/selectfont&gt;
&lt;/fontconfig&gt;</literal>
EOF</userinput></screen>

  </sect2>

  <sect2 role="configuration" id="adding-extra-directories" xreflabel="Ajout des répertoires de polices supplémentaires">
  <title>Ajout des répertoires de polices supplémentaires</title>

    <para>
      Normalement, les polices du système et les polices de l'utilisateur sont
installées dans les répertoires spécifiés dans <xref
linkend="xft-font-protocol"/> et il n'y a pas de raison de les mettre
ailleurs. Cependant, une installation BLFS complète de <xref
linkend="texlive"/> place beaucoup de polices dans <filename
class="directory">/opt/texlive/&texlive-year;/texmf-dist/fonts/</filename>
dans les sous-répertoires <filename class="directory">opentype/</filename>
et <filename class="directory">truetype/</filename>. Bien que l'extraction
de tous ces fichiers puisse sembler utile (cela permet de les utiliser dans
des programmes non <application>TeX</application>), il y a plusieurs
problèmes avec une telle approche&nbsp;:
    </para>

    <orderedlist>
      <listitem>
        <para>
          Il y a des centaines de fichiers, ce qui complexifie la sélection d'une
police.
        </para>
      </listitem>
      <listitem>
        <para>
          Certains des fichiers font des choses bizarres, comme l'affichage de
drapeaux sémaphore au lieu de lettres ASCII, ou le mappage de codes
cyrilliques vers des formes de caractères appropriés à la vieille église
slave au lieu des formes actuelles attendues&nbsp;: bien si c'est ce dont
vous avez besoin, mais pénible pour une utilisation normale .
        </para>
      </listitem>
      <listitem>
        <para>
          De nombreuses polices ont des tailles multiples et des noms courts obscurs,
qui rendent la sélection de la bonne police encore plus difficile.
        </para>
      </listitem>
      <listitem>
        <para>
          Quand une police est ajoutée à CTAN, elle est accompagnée par un paquet TeX
à utiliser dans les anciens moteurs (<application>xelatex</application> n'a
normalement pas besoin de cela), et ensuite la version est souvent gelée
tandis que la police est maintenue séparément. Certaines de ces polices
comme <xref linkend="dejavu-fonts"/> sont déjà probablement installées dans
votre système BLFS dans une version plus récente, et si vous avez plusieurs
versions d'une police on ne sait pas laquelle sera utilisée par
<application>fontconfig</application>.
        </para>
      </listitem>
    </orderedlist>

    <para>
      Cependant, il est parfois utile de regarder ces polices dans des
applications non-TeX, seulement pour voir si vous voulez installer une
version récente. Si vous avez tout installé de
<application>texlive</application>, l'exemple suivant rendra une des polices
OpenType Arkandis disponible pour d'autres applications, ainsi que les trois
polices TrueType de ParaType. Modifiez ou répétez les lignes comme vous le
souhaitez, pour soit rendre toutes les polices <filename
class="directory">opentype/</filename> ou <filename
class="directory">truetype</filename> disponibles, ou pour sélectionner
différents répertoires de polices. En tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>cat > /etc/fonts/conf.d/09-texlive.conf &lt;&lt; "EOF"
<literal>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;
&lt;fontconfig&gt;
  &lt;dir&gt;/opt/texlive/&texlive-year;/texmf-dist/fonts/opentype/arkandis/berenisadf&lt;/dir&gt;
  &lt;dir&gt;/opt/texlive/&texlive-year;/texmf-dist/fonts/truetype/paratype&lt;/dir&gt;
&lt;/fontconfig&gt;</literal>
EOF</userinput></screen>

    <para>
      SI vous faites cela, pensez à changer toutes les instances de l'année dans
ce fichier quand vous mettez à jour <application>texlive</application> à la
dernière version.
    </para>

  </sect2>

  <sect2 role="configuration" id="preferring-certain-fonts" xreflabel="Choix de certaines polices">
  <title>Choix de certaines polices</title>

    <para>
      Il y a beaucoup de raisons pour qu'une personne veuille avoir des pages qui
spécifient une police particulière et qui utilisent une police différente,
ou préfèrent des polices spécifiques dans Monospace ou Sans ou Serif. Comme
vous pouvez vous y attendre, il y a de nombreuses façons de faire cela.
    </para>

    <bridgehead renderas="sect3" id="fontconfig-user-docs"
    xreflabel="fontconfig-user-docs">Documentation utilisateur de Fontconfig</bridgehead>

      <para>
        <application>Fontconfig</application> installe une documentation utilisateur
contenant un exemple de «&nbsp;fichier de configuration utilisateur&nbsp;»
qui, entre autres, préfère <xref linkend="wenquanyi-zenhei"/> (une police
Sans) si une police <emphasis>Serif</emphasis> est demandée pour le chinois
(cette partie pourrait être anachronique à moins que vous ayez des polices
chinoises non-libres, car dans <filename>65-nonlatin.conf</filename> cette
police est déjà parmi les polices préférées lorsque Serif est spécifiée pour
le chinois) et préfère la police moderne <xref linkend="VLGothic"/> si une
police Sans est spécifiée dans une page japonaise (cependant quelques autres
polices pourront être préférées si elles ont été installées).
      </para>

      <para>
        Si vous avez installé la dernière version, la documentation utilisateur est
disponible en HTML, PDF et texte dans <filename
class="directory">/usr/share/doc/fontconfig-&fontconfig-version;/</filename>&nbsp;:
changez la version si vous en avez installée une autre.
      </para>

    <bridgehead renderas="sect3" id="prefer-a-specific-font"
    xreflabel="fontconfig-prefer-specific-font">Choisissez une police spécifique</bridgehead>

      <para>
        Par exemple, si pour une raison ou une autre vous souhaitiez utiliser la
police <ulink
url="https://www.fontsquirrel.com/fonts/nimbus-roman-no9-l">Nimbus Roman No9
L</ulink> alors que Times New Roman est référencée (elles ont des métriques
identiques, et préférable pour Times Roman, mais la police Serif de <xref
linkend="liberation-fonts"/> sera préférable pour la police Times
<emphasis>New</emphasis> Roman si elle est installée), en tant
qu'utilisateur individuel vous pouvez installer la police et ensuite créer
le fichier suivant&nbsp;:
      </para>

<screen><userinput>mkdir -pv ~/.config/fontconfig/conf.d &amp;&amp;
cat >  ~/.config/fontconfig/conf.d/35-prefer-nimbus-for-timesnew.conf &lt;&lt; "EOF"
<literal>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;
&lt;fontconfig&gt;
&lt;!-- prefer Nimbus Roman No9 L for Times New Roman as well as for Times,
 without this Tinos and Liberation Serif take precedence for Times New Roman
 before fontconfig falls back to whatever matches Times --&gt;
    &lt;alias binding="same"&gt;
        &lt;family&gt;Times New Roman&lt;/family&gt;
        &lt;accept&gt;
            &lt;family&gt;Nimbus Roman No9 L&lt;/family&gt;
        &lt;/accept&gt;
    &lt;/alias&gt;
&lt;/fontconfig&gt;</literal>
EOF</userinput></screen>

      <para>
        C'est quelque chose que vous feriez normalement pour les paramètres d'un
utilisateur individuel, mais le dossier dans ce cas aura été préfixé '35 - '
alors qu'il peut, si vous le souhaitez, être utilisé à l'échelle du système
dans <filename class="directory">/etc/fonts/conf.d/</filename>.
      </para>

    <bridgehead renderas="sect3" id="prefer-chosen-CJK-fonts"
    xreflabel="Choisissez les polices CJK préférées">Choisissez les polices CJK préférées</bridgehead>

      <para>
        L'exemple suivant d'une configuration locale (c'est-à-dire applicable à tous
les utilisateurs de la machine) fait plusieurs choses&nbsp;:
      </para>

      <orderedlist>
        <listitem>
          <para>
            Si une police Serif est spécifiée, elle préférera les variantes <xref
linkend="UMing"/>, pour que dans les langues zh-cn, zh-hk et zh-tw les
choses semblent correctes (aussi pour zh-sq qui utilise en fait le même
paramétrage que zh-cn) <emphasis>sans</emphasis> affecter le japonais.
          </para>
        </listitem>
        <listitem>
          <para>
            Il préfère le japonais <xref linkend="IPAex"/> s'il a été installé (bien que
<xref linkend="VLGothic"/> aura la priorité sur Sans (japonais) s'il a été
aussi installé).
          </para>
        </listitem>
        <listitem>
          <para>
            Comme <xref linkend="wenquanyi-zenhei"/> couvre les glyphes coréens Hangul
et est également préféré pour Serif dans
<filename>65-nonlatin.conf</filename>, s'il est installé, il sera utilisé
par défaut pour le Serif coréen. Pour obtenir une police Serif appropriée,
la police UnBatang est spécifiée ici – changez cette ligne si vous avez
installé une police Serif différente dans le choix de <xref
linkend="Korean-fonts"/>.
          </para>
        </listitem>
        <listitem>
          <para>
            Les polices Monospace sont forcées par rapport aux polices Sans
préférées. Si le texte est en Coréen alors <xref
linkend="wenquanyi-zenhei"/> sera utilisée.
          </para>
        </listitem>
      </orderedlist>

      <para>
        Dans une locale non-CJK, le résultat est que les polices appropriées seront
utilisées pour toutes les variantes de chinois, japonais et coréen
Hangul. Toutes les autres langues doivent déjà fonctionner si une police est
présente. En tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
      </para>

<screen role="root"><userinput>cat > /etc/fonts/local.conf &lt;&lt; "EOF"
<literal>&lt;?xml version='1.0'?&gt;
&lt;!DOCTYPE fontconfig SYSTEM 'fonts.dtd'&gt;
&lt;fontconfig&gt;
    &lt;alias&gt;
        &lt;family&gt;serif&lt;/family&gt;
        &lt;prefer&gt;
            &lt;family&gt;AR PL UMing&lt;/family&gt;
            &lt;family&gt;IPAexMincho&lt;/family&gt;
            &lt;!-- WenQuanYi is preferred as Serif in 65-nonlatin.conf,
            override that so a real Korean font can be used for Serif --&gt;
            &lt;family&gt;UnBatang&lt;/family&gt;
        &lt;/prefer&gt;
    &lt;/alias&gt;
    &lt;alias&gt;
         &lt;family&gt;sans-serif&lt;/family&gt;
         &lt;prefer&gt;
             &lt;family&gt;WenQuanYi Zen Hei&lt;/family&gt;
             &lt;family&gt;VL Gothic&lt;/family&gt;
             &lt;family&gt;IPAexGothic&lt;/family&gt;
         &lt;/prefer&gt;
    &lt;/alias&gt;
    &lt;alias&gt;
         &lt;family&gt;monospace&lt;/family&gt;
         &lt;prefer&gt;
             &lt;family&gt;VL Gothic&lt;/family&gt;
             &lt;family&gt;IPAexGothic&lt;/family&gt;
             &lt;family&gt;WenQuanYi Zen Hei&lt;/family&gt;
         &lt;/prefer&gt;
    &lt;/alias&gt;
&lt;/fontconfig&gt;</literal>
EOF</userinput></screen>

  </sect2>


  <sect2 role="configuration" id="editing-old-style-conf-files"
  xreflabel="Modification des fichiers de configuration de style ancien">
  <title>Modification des fichiers de configuration de style ancien</title>

    <para>
      Certaines polices, particulièrement les polices chinoises, viennent avec des
fichiers de configuration qui peuvent être installés dans <filename
class="directory">/etc/fonts/conf.d</filename>. Cependant, si vous faites
cela et ensuite utilisez un terminal pour lancer n'importe quelle commande
qui utilise <application>fontconfig</application>, vous devrez voir des
messages d'erreurs comme&nbsp;:
    </para>

    <para>
      <literal>Fontconfig warning: "/etc/fonts/conf.d/69-odofonts.conf", line 14:
Having multiple &lt;family&gt; in &lt;alias&gt; isn't supported and may not
work as expected</literal>.
    </para>

    <para>
      En pratique, ces anciennes règles ne fonctionnent pas. Pour les utilisateurs
non-CJK, <application>fontconfig</application> fonctionnera bien
<emphasis>sans</emphasis> ces règles. Leur origine remonte à l'époque où les
utilisateurs de CJK avaient besoin de bitmaps fabriqués à la main pour être
lisibles dans les petites tailles, et ils semblaient laids à côté des
glyphes latins anti-crénelés - ils ont préféré utiliser la même police CJK
pour les glyphes latins. Il y a un effet secondaire à faire cela&nbsp;: la
police (Serif) est souvent aussi utilisée pour Sans, et dans une telle
situation le texte (anglais) dans les menus de
<application>Gtk</application> utilisera cette police - par rapport aux
polices du système, en plus d'être serif, elle est à la fois pâle et plutôt
petite. Cela peut rendre la lecture inconfortable.
    </para>

    <para>
      Néanmoins, ces anciens fichiers de configuration peuvent être corrigés si
vous souhaitez les utiliser. L'exemple suivant est la première partie de
<filename>64-arphic-uming.conf</filename> de <xref linkend="UMing" /> – il y
a beaucoup plus d'éléments similaires qui ont aussi besoin d'être
changés&nbsp;:
    </para>

    <para>
      <literallayout>
   &lt;match target="pattern"&gt;
       &lt;test qual="any" name="lang" compare="contains"&gt;
           &lt;string&gt;zh-cn&lt;/string&gt;
           &lt;string&gt;zh-sg&lt;/string&gt;
       &lt;/test&gt;
       &lt;test qual="any" name="family"&gt;
           &lt;string&gt;serif&lt;/string&gt;
       &lt;/test&gt;
       &lt;edit name="family" mode="prepend" binding="strong"&gt;
           &lt;string&gt;AR PL UMing CN&lt;/string&gt;
       &lt;/edit&gt;
    &lt;/match&gt;</literallayout>
    </para>

    <para>
      Le processus pour corriger cela est simple mais fastidieux – pour chaque
élément qui produit un message d'erreur, à l'aide de votre éditeur (en tant
qu'utilisateur &root;) éditez le fichier installé pour répéter le bloc
entier autant de fois qu'il y a de variables, puis réduire chaque exemple
pour n'en avoir qu'un seul. Vous pouvez travailler sur une erreur à la fois,
enregistrer le fichier après chaque correction et, à partir d'un terminal
séparé, exécuter une commande telle que <command>fc-list 2>&amp;1 | less
</command> pour voir si le correctif a fonctionné. Pour le bloc ci-dessus,
la version corrigée sera&nbsp;:
    </para>

    <para>
      <literallayout>
   &lt;match target="pattern"&gt;
       &lt;test qual="any" name="lang" compare="contains"&gt;
           &lt;string&gt;zh-cn&lt;/string&gt;
       &lt;/test&gt;
       &lt;test qual="any" name="family"&gt;
           &lt;string&gt;serif&lt;/string&gt;
       &lt;/test&gt;
       &lt;edit name="family" mode="prepend" binding="strong"&gt;
           &lt;string&gt;AR PL UMing CN&lt;/string&gt;
       &lt;/edit&gt;
    &lt;/match&gt;
   &lt;match target="pattern"&gt;
       &lt;test qual="any" name="lang" compare="contains"&gt;
           &lt;string&gt;zh-sg&lt;/string&gt;
       &lt;/test&gt;
       &lt;test qual="any" name="family"&gt;
           &lt;string&gt;serif&lt;/string&gt;
       &lt;/test&gt;
       &lt;edit name="family" mode="prepend" binding="strong"&gt;
           &lt;string&gt;AR PL UMing CN&lt;/string&gt;
       &lt;/edit&gt;
    &lt;/match&gt;</literallayout>
    </para>

  </sect2>


  <sect2 role="configuration" id="see-also" xreflabel="Voir également">
  <title>Voir également</title>

    <bridgehead renderas="sect3" id="I-stared-into-the-fontconfig"
    xreflabel="I stared into the fontconfig">I stared into the fontconfig ...</bridgehead>

    <para>
      Les entrées du blog d'<ulink
url="https://eev.ee/blog/2015/05/20/i-stared-into-the-fontconfig-and-the-fontconfig-stared-back-at-me/">Eevee</ulink>
sont particulièrement utiles si <application>fontconfig</application> ne
pense pas que votre police choisie prenne en charge votre langue, et pour
préférer certaines polices japonaises non-MS quand une police laide MS est
déjà installée.
    </para>

    <bridgehead renderas="sect3" id="arch-fontconfig"
    xreflabel="Fontconfig dans le wiki Arch">Fontconfig dans le wiki Arch</bridgehead>

    <para>
      Arch a beaucoup d'informations sur leur wiki dans <ulink
url="https://wiki.archlinux.org/index.php/font_configuration">font_configuration</ulink>.
    </para>

    <bridgehead renderas="sect3" id="gentoo-fontconfig"
    xreflabel="Fontconfig dans le wiki Gentoo">Fontconfig dans le wiki Gentoo</bridgehead>

    <para>
      Gentoo a quelques informations dans son wiki à <ulink
url="https://wiki.gentoo.org/wiki/Fontconfig">Fontconfig</ulink> bien que
beaucoup des détails (quoi activer et Infinality) sont spécifiques à Gentoo.
    </para>

  </sect2>

</sect1>
