<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY libinput-version "1.21.0">

<!--  <!ENTITY libinput-download-http "https://www.freedesktop.org/software/libinput/libinput-&libinput-version;.tar.xz">-->
  <!ENTITY libinput-download-http "https://gitlab.freedesktop.org/libinput/libinput/-/archive/&libinput-version;/libinput-&libinput-version;.tar.gz"
>
  <!ENTITY libinput-download-ftp  "">
  <!ENTITY libinput-md5sum        "3d8f0561b83fafc187bbc2d5bd0fe217">
  <!ENTITY libinput-size          "968&nbsp;Ko">
  <!ENTITY libinput-buildsize     "11 MB (add 17 MB for documentation)">
  <!ENTITY libinput-time          "0,1 SBU (plus 0,1 SBU pour la documentation)">
]>

  <sect2 id="libinput" xreflabel="libinput-&libinput-version;">
    <?dbhtml filename="libinput.html"?>

    <sect2info>
<date>$Date$</date></sect2info>

    <title>libinput-&libinput-version;</title>

    <indexterm zone="libinput">
      <primary sortas="a-libinput">libinput</primary>
    </indexterm>

    <sect3 role="package">
      <title>Introduction à libinput</title>

      <para>
        <application>libinput</application> est une bibliothèque qui prend en charge
les périphériques d'entrée pour les serveurs d'affichage et d'autres
applications qui ont besoin de traiter directement avec les périphériques
d'entrée.
      </para>

      &lfs111_checked;

      <bridgehead renderas="sect4">Informations sur le paquet</bridgehead>
      <itemizedlist spacing="compact">
        <listitem>
          <para>
            Téléchargement (HTTP)&nbsp;: <ulink url="&libinput-download-http;"/>
          </para>
        </listitem>
        <listitem>
          <para>
            Téléchargement (FTP)&nbsp;: <ulink url="&libinput-download-ftp;"/>
          </para>
        </listitem>
        <listitem>
          <para>
            Somme de contrôle MD5&nbsp;: &libinput-md5sum;
          </para>
        </listitem>
        <listitem>
          <para>
            Taille du téléchargement&nbsp;: &libinput-size;
          </para>
        </listitem>
        <listitem>
          <para>
            Estimation de l'espace disque requis&nbsp;: &libinput-buildsize;
          </para>
        </listitem>
        <listitem>
          <para>
            Estimation du temps de construction&nbsp;: &libinput-time;
          </para>
        </listitem>
      </itemizedlist>

      <bridgehead renderas="sect4">Dépendances de libinput</bridgehead>

      <bridgehead renderas="sect5">Requises</bridgehead>
      <para role="required">
        <xref linkend="libevdev"/> et <xref linkend="mtdev"/>
      </para>

      <bridgehead renderas="sect5">Facultatives</bridgehead>
      <para role="optional">
        <xref linkend="valgrind"/> (to run the tests), <xref linkend="gtk3"/> (to
build the GUI event viewer), <xref linkend="libunwind"/> (required for
tests), <xref linkend="libwacom"/>, and <ulink
url="http://sphinx-doc.org/">Sphinx</ulink> (required to build
documentation), <ulink
url="https://pypi.org/project/pyparsing/">PyParsing</ulink> (for one
non-root test)
      </para>

      <para condition="html" role="usernotes">
        Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/libinput"/>
      </para>
    </sect3>

    <sect3 role="kernel" id="libinput-kernel">
      <title>configuration du noyau pour lancer la suite de tests de libinput</title>

      <para>
        Although libinput works with the same kernel configuration used by <xref
linkend="libevdev"/>, its extensive testsuite requires the presence of
<filename>/dev/uinput</filename> (as well as both <xref linkend="valgrind"/>
and <xref linkend="libunwind"/>).
      </para>

      <para>
        Si vous souhaitez lancer tous les tests, activez l'option suivante dans la
configuration du noyau et recompilez-le si nécessaire&nbsp;:
      </para>

<screen><literal>Device Drivers ---&gt;
  Input device support ---&gt;
    Miscellaneous Devices ---&gt;
    &lt;*/M&gt;   User level driver support        [CONFIG_INPUT_UINPUT]</literal></screen>

      <para>
        Si vous construisez cela en tant que module, il doit être inséré avant de
lancer la suite de tests.
      </para>

      <para>
        Sur un système Xorg vous aurez aussi besoin d'éviter que les événements
générés pendant la suite de tests n'interfèrent avec votre bureau. Copiez le
fichier <filename>test/50-litest.conf</filename> dans <filename
class="directory">${XORG_PREFIX}/share/X11/xorg.conf.d</filename> et
redémarrez le serveur X. Pour plus d'informations, voyez <ulink
url="https://wayland.freedesktop.org/libinput/doc/&libinput-version;/test-suite.html">la
suite de tests de libinput</ulink>
      </para>

      <indexterm zone="libinput libinput-kernel">
        <primary sortas="d-libinput">libinput</primary>
      </indexterm>
    </sect3>

    <sect3 role="installation">
      <title>Installation de libinput</title>

      <para>
        Installez <application>libinput</application> en exécutant les commandes
suivantes&nbsp;:
      </para>

<screen><userinput>mkdir build &amp;&amp;
cd    build &amp;&amp;

meson --prefix=$XORG_PREFIX    \
      --buildtype=release      \
      -Ddebug-gui=false        \
      -Dtests=false            \
      -Dlibwacom=false         \
      -Dudev-dir=/usr/lib/udev \
      ..                    &amp;&amp;
ninja</userinput></screen>

      <note>
        <para>
          Si vous voulez lancer les tests complets, supprimez -Dtests des options de
<command>meson</command> ci-dessus. Veuillez lire la section
«&nbsp;configuration du noyau pour lancer la suite de tests de
libinput&nbsp;» ci-dessus.
        </para>

        <para>
          Si vous avez activé la suite complète des tests, vous pouvez lancer les
tests principaux <emphasis>en tant qu'utilisateur root</emphasis> en
exécutant <command>ninja test</command>. Un grand nombre de tests seront
lancés, avec environ 20 échecs (au moins sur un système Xorg).
        </para>
      </note>

      <para>
        Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
      </para>

<screen role="root"><userinput>ninja install</userinput></screen>

      <para>
        Si vous avez passé l'option <option>-Ddocumentation=true</option> à
<command>meson</command>, vous pouvez installer la documentation générée en
lançant les commandes suivantes en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
      </para>


<screen role="root"
        remap="doc"><!-- seems the api doc is not generated because the directory is not a git
     repository... -->
<userinput>install -v -dm755      /usr/share/doc/libinput-&libinput-version;/html &amp;&amp;
cp -rv Documentation/* /usr/share/doc/libinput-&libinput-version;/html</userinput></screen>

    </sect3>

    <sect3 role="commands">
      <title>Explication des commandes</title>

      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
        href="../../xincludes/meson-buildtype-release.xml"/>

      <para>
        <parameter>-Ddebug-gui=false</parameter>&nbsp;: Ce paramètre désactive la
création d'un utilitaire de débogage visuel pour libinput. Supprimez-le si
vous le voulez et si vous avez installé <xref linkend="gtk3"/>.
      </para>

      <para>
        <parameter>-Dtests=false</parameter>&nbsp;: Ce paramètre désactive la
compilation des tests principaux. Même si tests est défini à faux, vous
pouvez toujours lancer les quatre premiers tests mineurs, en tant
qu'utilisateur normal, mais l'un d'entre eux sera sauté si <ulink
url="https://pypi.org/project/pyparsing">PyParsing</ulink> n'est pas
installé.
      </para>

      <para>
        <parameter>-Dlibwacom=false</parameter>&nbsp;: Enlevez ce paramètre si vous
avez installé<xref linkend="libwacom"/> ou si vous installez GNOME.
      </para>

      <para>
        <parameter>-Dudev-dir=/usr/lib/udev</parameter>: In case that the value of
<envar>XORG_PREFIX</envar> is not set to <filename
class='directory'>/usr</filename>, this option prevents the package from
installing Udev rules and helpers into <filename
class='directory'>$XORG_PREFIX/lib/udev</filename> which is not searched by
Udev daemon.  This option is not needed for systems with
<envar>XORG_PREFIX</envar> set to <filename
class='directory'>/usr</filename>, but does no harm.
      </para>

      <para>
        <option>-Ddocumentation=true</option>&nbsp;: ce paramètre active la
génération de la documentation. Ajoutez-le si vous voulez la générer et que
vous avez installé <xref linkend="doxygen"/> et <xref linkend="graphviz"/>.
      </para>

    </sect3>

    <sect3 role="content">
      <title>Contenu</title>

      <segmentedlist>
        <segtitle>Programmes installés</segtitle>
        <segtitle>Bibliothèques installées</segtitle>
        <segtitle>Répertoires installés</segtitle>

        <seglistitem>
          <seg>
            <!-- libinput-debug-events, libinput-list-devices, libinput-measure*,
            libinput-record, libinput-replay Library Executables -->
libinput
            
          </seg>
          <seg>
            libinput.so
          </seg>
          <seg>
            /etc/libinput, $XORG_PREFIX/libexec/libinput,
$XORG_PREFIX/usr/share/libinput, and (optionally)
$XORG_PREFIX/share/doc/libinput-&libinput-version;
          </seg>
        </seglistitem>
      </segmentedlist>

      <variablelist>
        <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
        <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

        <varlistentry id="libinput-prog">
          <term><command>libinput</command></term>
          <listitem>
            <para>
              est un outil d'aide au débogage pour la bibliothèque
<application>libinput</application>
            </para>
            <indexterm zone="libinput libinput-prog">
              <primary sortas="b-libinput-prog">libinput</primary>
            </indexterm>
          </listitem>
        </varlistentry>

        <varlistentry id="libinput-lib">
          <term><filename class="libraryfile">libinput.so</filename></term>
          <listitem>
            <para>
              contient les fonctions de l'API pour gérer les périphériques d'entrée
            </para>
            <indexterm zone="libinput libinput-lib">
              <primary sortas="c-libinput-lib">libinput.so</primary>
            </indexterm>
          </listitem>
        </varlistentry>

      </variablelist>

    </sect3>

  </sect2>
