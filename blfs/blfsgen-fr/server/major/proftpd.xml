<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY proftpd-download-http "">
  <!ENTITY proftpd-download-ftp  "ftp://ftp.proftpd.org/distrib/source/proftpd-&proftpd-version;.tar.gz">
  <!ENTITY proftpd-md5sum        "8be8ce773bb4abbd1921cb03e58157b4">
  <!ENTITY proftpd-size          "19 Mo">
  <!ENTITY proftpd-buildsize     "66&nbsp;Mo">
  <!ENTITY proftpd-time          "0.3 SBU">
]>

<sect1 id="proftpd" xreflabel="ProFTPD-&proftpd-version;">
  <?dbhtml filename="proftpd.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>ProFTPD-&proftpd-version;</title>

  <indexterm zone="proftpd">
    <primary sortas="a-proftpd">Proftpd</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à ProFTPD</title>

    <para>
      Le paquet <application>ProFTPD</application> contient un démon FTP sécurisé
et hautement configurable. C'est utile pour donner de grosses archives de
fichiers sur un réseau.
    </para>

    &lfs112_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&proftpd-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&proftpd-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &proftpd-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &proftpd-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &proftpd-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &proftpd-time;
        </para>
      </listitem>
    </itemizedlist>

    <!--
    <bridgehead renderas="sect3">
Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Required patch:
          <ulink url="&patch-root;/proftpd-&proftpd-version;-consolidated_fixes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
-->
<bridgehead renderas="sect3">Dépendances de ProFTPD</bridgehead>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref linkend="libcap-pam"/>, <xref linkend="libssh2"/>, <xref
linkend="linux-pam"/>, <xref linkend="mariadb"/> ou <ulink
url="https://www.mysql.com/">MySQL</ulink>, <xref linkend="pcre"/>, <xref
linkend="postgresql"/> et <ulink
url="https://metacpan.org/pod/Net::SSH2">Net::SSH2</ulink>
    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/proftpd"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de ProFTPD</title>

    <para>
      Pour des raisons de sécurité, vous devriez installer
<application>ProFTPD</application> en utilisant un utilisateur et un groupe
non privilégiés. En tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<!--
    <para>

      First, apply a patch containing various security fixes from
      the upstream developers:
    </para>

<screen><userinput remap="pre">patch -Np1 -i ../proftpd-&proftpd-version;-consolidated_fixes-1.patch</userinput></screen>
-->
<screen role="root"><userinput>groupadd -g 46 proftpd                             &amp;&amp;
useradd -c proftpd -d /srv/ftp -g proftpd \
        -s /usr/bin/proftpdshell -u 46 proftpd     &amp;&amp;

install -v -d -m775 -o proftpd -g proftpd /srv/ftp &amp;&amp;
ln -v -s /usr/bin/false /usr/bin/proftpdshell      &amp;&amp;
echo /usr/bin/proftpdshell &gt;&gt; /etc/shells</userinput></screen>

    <para>
      Installez <application>ProFTPD</application> as an unprivileged user en
lançant les commandes suivantes&nbsp;:
    </para>

<screen><userinput>./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/run &amp;&amp;
make</userinput></screen>

    <para>
      Ce paquet ne contient pas de suite de tests utilisable.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install                                   &amp;&amp;
install -d -m755 /usr/share/doc/proftpd-&proftpd-version; &amp;&amp;
cp -Rv doc/*     /usr/share/doc/proftpd-&proftpd-version;</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <command>install -v -d -m775 -o proftpd -g proftpd /srv/ftp</command>&nbsp;:
Crée le répertoire home de <application>ProFTPD</application>.
    </para>

    <para>
      <command>ln -v -s /usr/bin/false /usr/bin/proftpdshell</command>&nbsp;:
règle le shell par défaut comme un lien vers un shell invalide.
    </para>

    <para>
      <command>echo /usr/bin/proftpdshell &gt;&gt; /etc/shells</command>&nbsp;:
Fait croire à un shell valide pour des raisons de compatibilité.
    </para>

    <note>
      <para>
        Vous pouvez vous passer des deux commandes ci-dessus si vous mettez la ligne
suivante dans le fichier de configuration&nbsp;:
      </para>

<screen><literal>RequireValidShell off</literal></screen>

      <para>
        Par défaut, proftpd exigera que les utilisateurs qui se connectent aient des
shells valides. La ligne RequireValidShell désactive cette exigence. Ce
n'est recommandé que si vous paramétrez votre serveur FTP exclusivement pour
des téléchargements anonymes.
      </para>
    </note>

    <note>
      <para>
        Le support de la plupart des paquets dont il dépend demande d'utiliser des
options passées au script <command>configure</command>. Regardez la sortie
de <command>./configure --help</command> pour des informations complètes sur
comment activer les paquets dont il dépend.
      </para>
    </note>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de ProFTPD</title>

    <sect3 id='proftpd-config'>
      <title>Fichiers de configuration</title>

      <para>
        <filename>/etc/proftpd.conf</filename>
      </para>

      <indexterm zone="proftpd proftpd-config">
        <primary sortas="e-etc-proftpd">/etc/proftpd.conf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations sur la configuration</title>

      <para>
        Voici une configuration simple, un modèle seulement pour du
téléchargement. Regardez la documentation de
<application>ProFTPD</application> dans <filename
class="directory">/usr/share/doc/proftpd</filename> et consultez le site
Internet sur <ulink url="http://www.proftpd.org/"/> pour des exemples de
configurations.
      </para>

<screen role="root"><!--# (such as xinetd)-->
<?dbfo keep-together="auto"?><userinput>cat &gt; /etc/proftpd.conf &lt;&lt; "EOF"
<literal># This is a basic ProFTPD configuration file
# It establishes a single server and a single anonymous login.

ServerName                      "ProFTPD Default Installation"
ServerType                      standalone
DefaultServer                   on

# Port 21 is the standard FTP port.
Port                            21
# Umask 022 is a good standard umask to prevent new dirs and files
# from being group and world writable.
Umask                           022

# To prevent DoS attacks, set the maximum number of child processes
# to 30.  If you need to allow more than 30 concurrent connections
# at once, simply increase this value.  Note that this ONLY works
# in standalone mode, in inetd mode you should use an inetd server
# that allows you to limit maximum number of processes per service

MaxInstances                    30

# Set the user and group that the server normally runs at.
User                            proftpd
Group                           proftpd

# To cause every FTP user to be "jailed" (chrooted) into their home
# directory, uncomment this line.
#DefaultRoot ~


# Normally, files should be overwritable.
&lt;Directory /*&gt;
  AllowOverwrite                on
&lt;/Directory&gt;

# A basic anonymous configuration, no upload directories.
&lt;Anonymous ~proftpd&gt;
  User                          proftpd
  Group                         proftpd
  # Clients should be able to login with "anonymous" as well as "proftpd"
  UserAlias                     anonymous proftpd

  # Limit the maximum number of anonymous logins
  MaxClients                    10

  # 'welcome.msg' should be displayed at login, and '.message' displayed
  # in each newly chdired directory.
  DisplayLogin                  welcome.msg
  DisplayChdir                  .message

  # Limit WRITE everywhere in the anonymous chroot
  &lt;Limit WRITE&gt;
    DenyAll
  &lt;/Limit&gt;
&lt;/Anonymous&gt;</literal>
EOF</userinput></screen>

    </sect3>

    <sect3  id="proftpd-init">
      <title><phrase revision="sysv">Script de démarrage</phrase> <phrase
revision="systemd">Unité Systemd</phrase></title>

      <para>
        Installez <phrase revision="sysv">le script d'initialisation
<filename>/etc/rc.d/init.d/proftpd</filename> inclus</phrase><phrase
revision="systemd">l'unité <filename>proftpd.service</filename>
incluse</phrase> dans le paquet <xref linkend="bootscripts"
revision="sysv"/><xref linkend="systemd-units" revision="systemd"/>&nbsp;:
      </para>

      <indexterm zone="proftpd proftpd-init">
        <primary sortas="f-proftpd">proftpd</primary>
      </indexterm>

<screen role="root"><userinput>make install-proftpd</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>
          ftpasswd, ftpcount, ftpdctl, ftpmail, ftpquota, ftpscrub, ftpshut, ftptop,
ftpwho, in.proftpd (symlink to proftpd), proftpd et prxs
        </seg>
        <seg>
          Aucune
        </seg>
        <seg>
          /usr/{include,lib}/proftpd, /usr/share/doc/proftpd-&proftpd-version; et
/srv/ftp
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="proftpd-prog">
        <term><command>proftpd</command></term>
        <listitem>
          <para>
            est le démon FTP
          </para>
          <indexterm zone="proftpd proftpd-prog">
            <primary sortas="b-proftpd">proftpd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpcount">
        <term><command>ftpcount</command></term>
        <listitem>
          <para>
            affiche le nombre actuel de connexions
          </para>
          <indexterm zone="proftpd ftpcount">
            <primary sortas="b-ftpcount">ftpcount</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpdctl">
        <term><command>ftpdctl</command></term>
        <listitem>
          <para>
            est utilisé pour contrôler le démon proftpd pendant qu'il est lancé
          </para>
          <indexterm zone="proftpd ftpdctl">
            <primary sortas="b-ftpdctl">ftpdctl</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpasswd">
        <term><command>ftpasswd</command></term>
        <listitem>
          <para>
            est un script perl conçu pour créer et gérer les fichiers AuthUserFiles et
AuthGroupFiles dans le bon format pour proftpd
          </para>
          <indexterm zone="proftpd ftpasswd">
            <primary sortas="b-ftpasswd">ftpasswd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpmail">
        <term><command>ftpmail</command></term>
        <listitem>
          <para>
            est un script perl pour envoyer des messages électroniques basés sur le
TransferLog de proftpd
          </para>
          <indexterm zone="proftpd ftpmail">
            <primary sortas="b-ftpmail">ftpmail</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpquota">
        <term><command>ftpquota</command></term>
        <listitem>
          <para>
            est un script Perl conçu pour créer et gérer l'association des modules
mod_quotatab + mod_quotatab_file de proftpd des fichiers limits et tally
          </para>
          <indexterm zone="proftpd ftpquota">
            <primary sortas="b-ftpquota">ftpquota</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpscrub">
        <term><command>ftpscrub</command></term>
        <listitem>
          <para>
            fournit une manière de nettoyer le fichier tableau de bord (scoreboard) à la
demande
          </para>
          <indexterm zone="proftpd ftpscrub">
            <primary sortas="b-ftpscrub">ftpscrub</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpshut">
        <term><command>ftpshut</command></term>
        <listitem>
          <para>
            arrête tous les serveurs <application>proftpd</application> à une heure
donnée
          </para>
          <indexterm zone="proftpd ftpshut">
            <primary sortas="b-ftpshut">ftpshut</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftptop">
        <term><command>ftptop</command></term>
        <listitem>
          <para>
            affiche le statut d'exécution des connexions
          </para>
          <indexterm zone="proftpd ftptop">
            <primary sortas="b-ftptop">ftptop</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ftpwho">
        <term><command>ftpwho</command></term>
        <listitem>
          <para>
            affiche des informations sur le processus actuel pour chaque session
          </para>
          <indexterm zone="proftpd ftpwho">
            <primary sortas="b-ftpwho">ftpwho</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="prxs">
        <term><command>prxs</command></term>
        <listitem>
          <para>
            est un script Perl conçu pour compiler et installer les modules tiers,
depuis le code source, comme modules DSO pour le proftpd installé
          </para>
          <indexterm zone="proftpd prxs">
            <primary sortas="b-prxs">prxs</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
