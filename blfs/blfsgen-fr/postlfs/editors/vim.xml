<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!-- only for initial releases of a new version
  <!ENTITY vim-download-http "http://ftp.vim.org/vim/unix/vim-&vim-version;.tar.bz2">-->
  <!ENTITY vim-download-http "&sources-anduin-http;/vim/vim-&vim-version;.tar.gz">
  <!ENTITY vim-download-ftp  "">
  <!ENTITY vim-md5sum        "a26555c8919cf40938d2428d834bf913">
  <!ENTITY vim-size          "15&nbsp;Mo">
  <!ENTITY vim-buildsize     "110&nbsp;Mo (plus 71&nbsp;Mo pour les tests)">
  <!ENTITY vim-time          "0,4 SBU (avec parallélisme = 4&nbsp;; plus 1,4 SBU pour les tests)">
]>

<sect1 id="vim" xreflabel="Vim-&vim-version;">
  <?dbhtml filename="vim.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>Vim-&vim-version;</title>

  <indexterm zone="vim">
    <primary sortas="a-Vim">Vim</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Vim</title>

    <para>
      Le paquet <application>Vim</application>, qui est l'abréviation de VI
IMproved (amélioré), contient un clone de <command>vi</command> ayant des
fonctionnalités supplémentaires par rapport au <command>vi</command>
d'origine.
    </para>

    <para>
      Les instructions par défaut de LFS installent <application>vim</application>
comme composant du système de base. Si vous préférez lier
<application>vim</application> à <application>X</application>, vous devriez
recompiler <application>vim</application> pour activer le mode GUI. Aucune
instruction spéciale n'est nécessaire puisque le support de
<application>X</application> est détecté automatiquement.
    </para>

    <note>
      <para>
        La version de vim change tous les jours. Pour récupérer la dernière version,
visitez <ulink url="https://github.com/vim/vim/releases">
https://github.com/vim/vim/releases</ulink>.
      </para>
    </note>

    &lfs101_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&vim-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&vim-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5 du téléchargement&nbsp;: &vim-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &vim-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &vim-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &vim-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de Vim</bridgehead>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="x-window-system"/> et <xref linkend="gtk3"/>
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <!-- can use python3: don't advertise python2
      <xref linkend="python2"/>,
-->
<xref linkend="gpm"/>, <xref linkend="lua"/>, <xref linkend="rsync"/>, and
<xref linkend="ruby"/>
    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/vim"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Vim</title>

    <note>
      <para>
        Si vous recompilez <application>Vim</application> pour le lier à
<application>X</application> et si vos bibliothèques
<application>X</application> ne sont pas sur la partition racine, vous
n'aurez plus d'éditeur en cas d'utilisation en urgence. Vous pouvez choisir
d'installer un éditeur supplémentaire, de ne pas lier
<application>Vim</application> à <application>X</application>, ou de
déplacer l'exécutable <command>vim</command> actuel vers le répertoire
<filename class="directory">/bin</filename> sous un nom différent tel que
<filename>vi</filename>.
      </para>
    </note>

    <!--
    <para>

      First, if you are building the Lua interpreter for VIM, adapt it to an
      API change in lua-5.4.0:
    </para>

<screen><userinput remap="pre">sed -i '461 s/static int/int/' src/if_lua.c</userinput>
</screen>
-->
<para>
      Installez <application>Vim</application> en lançant les commandes
suivantes&nbsp;:
    </para>

    <note>
      <para>
        If you intend to run the tests and have not installed Xorg in /usr, append
LDFLAGS='-L$XORG_PREFIX/lib' to the configure line below.
      </para>
    </note>

<screen><userinput>echo '#define SYS_VIMRC_FILE  "/etc/vimrc"' &gt;&gt;  src/feature.h &amp;&amp;
echo '#define SYS_GVIMRC_FILE "/etc/gvimrc"' &gt;&gt; src/feature.h &amp;&amp;

./configure --prefix=/usr        \
            --with-features=huge \
            --enable-gui=gtk3    \
            --with-tlib=ncursesw &amp;&amp;
make</userinput></screen>

    <note>
      <para>
        Si le fichier de configuration global <filename>/etc/vimrc</filename>
utilise la variable d'environnement <envar>VIMRUNTIME</envar>, certains
tests peuvent se plaindre de ne pas trouver le répertoire correspondant et
attendre une saisie de l'utilisateur. Si c'est le cas, vous devriez
sauvegarder et supprimer le fichier avant de lancer les tests.
      </para>
    </note>

    <para>
      Pour tester les résultats, lancez&nbsp;: <command>make -j1
test</command>. Même si un des tests ne parvient pas à produire le fichier
<filename>test.out</filename> dans <filename
class="directory">src/testdir</filename>, le reste des tests sera quand même
exécuté. Si tout se passe bien, le journal rapportera <literal>ALL
DONE</literal>. Certains tests marqués <quote>flaky</quote> peuvent
éventuellement échouer et peuvent être ignorés. Les tests sont connus pour
échouer si la sortie est redirigée vers un fichier.
    </para>

    <note>
      <para>
        Certains tests de couleurs s'attendent à être exécutés dans l'émulateur de
terminal <command>xterm</command>.
      </para>
    </note>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install</userinput></screen>

    <para>
      Par défaut, la documentation de Vim est installée dans /<filename
class="directory">usr/share/vim</filename>. Le lien symbolique suivant
permet un accès à la documentation via <filename
class="directory">/usr/share/doc/vim-&vim-version;</filename>, ce qui est
cohérent avec l'emplacement de la documentation d'autres paquets&nbsp;:
    </para>



<screen role="root"><!-- When updating, be sure to change the vim-majmin entity for the 
     proper 'vimxx' unpacked directory -->
<userinput>ln -snfv ../vim/vim&vim-majmin;/doc /usr/share/doc/vim-&vim-version;</userinput></screen>

    <para>
      Si vous souhaitez mettre à jour les fichiers au moment de l'exécution,
lancez la commande suivante (exige <xref linkend="rsync"/>)&nbsp;:
    </para>

<screen><userinput>rsync -avzcP --exclude="/dos/" --exclude="/spell/" \
    ftp.nluug.nl::Vim/runtime/ ./runtime/</userinput></screen>

    <para>
      Pour installer les fichiers au moment du lancement et régénérer le fichier
<filename>tags</filename>, en tant qu'utilisateur <systemitem
class="username">root</systemitem>, lancez&nbsp;:
    </para>

<screen role="root"><userinput>make -C src installruntime &amp;&amp;
vim -c ":helptags /usr/share/doc/vim-&vim-version;" -c ":q"</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <parameter>--with-features=huge</parameter>&nbsp;: Ce correctif active
toutes les fonctionnalités supplémentaires disponibles dans
<application>Vim</application>, incluant le support pour les caractères
multi-octets.
    </para>

    <para>
      <parameter>--with-tlib=ncursesw</parameter>&nbsp;: Ce paramètre force Vim à
se lier avec la bibliothèque <filename
class="libraryfile">libncursesw</filename>.
    </para>

    <para>
      <option>--enable-gui=no</option>&nbsp;: Cela empêchera la compilation de
l'interface graphique. <application>Vim</application> se liera toujours à
<application>X</application>, pour que des fonctionnalités telles que le
modèle client-serveur ou la sélection x11 (presse-papier) soient
disponibles.
    </para>

    <para>
      <option>--without-x</option>&nbsp;: Si vous préférez ne pas lier
<application>Vim</application> à <application>X</application>, utilisez ce
paramètre.
    </para>

    <para>
      <option>--enable-luainterp</option>, <option>--enable-perlinterp</option>,
<option>--enable-python3interp=dynamic</option>, <option>--enable-tclinterp
--with-tclsh=tclsh</option>, <option>--enable-rubyinterp</option>: These
options include the Lua, Perl, Python3, Tcl, or Ruby interpreters that allow
using other application code in <application>vim</application> scripts. All
the <option>--enable-...</option> options can accept
<option>=dynamic</option> to dynamically load the interpreter when
needed. This is required for <application>Python 3</application> to prevent
segmentation faults. For <application>tcl</application>, it is necessary to
indicate the name of the <command>tclsh</command> executable, since
<command>configure</command> only searches versioned names with old
versions.
    </para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de Vim</title>

    <sect3 id='vim-config'>
      <title>Fichiers de configuration</title>

      <para>
        <filename>/etc/vimrc</filename> et <filename>~/.vimrc</filename>
      </para>

      <indexterm zone="vim vim-config">
        <primary sortas="e-etc-vimrc">/etc/vimrc</primary>
      </indexterm>

      <indexterm zone="vim vim-config">
        <primary sortas="e-AA.vimrc">~/.vimrc</primary>
      </indexterm>

    </sect3>

    <!-- there are now desktop files shipped with the package
    <sect3 id='vim-desktop'>

      <title>Desktop File</title>

      <para>
        If desired, create a menu entry for graphical vim,
        <filename>gvim.desktop</filename>, as the <systemitem
        class="username">root</systemitem> user
      </para>

<screen role="root"><userinput>cat &gt; /usr/share/applications/gvim.desktop &lt;&lt; "EOF"
<literal>[Desktop Entry]
Name=GVim Text Editor
Comment=Edit text files
Comment[pt_BR]=Edite arquivos de texto
TryExec=gvim
Exec=gvim -f %F
Terminal=false
Type=Application
Icon=gvim.png
Categories=Utility;TextEditor;
StartupNotify=true
MimeType=text/plain;</literal>
EOF</userinput></screen>

    </sect3>
-->
<sect3 id='vim-init'>
      <title>Informations sur la configuration</title>

      <para>
        <application>Vim</application> a un vérificateur d'orthographe intégré que
vous pouvez activer si vous lancez ce qui suit dans une fenêtre vim&nbsp;:
      </para>

<screen><literal>:setlocal spell spelllang=ru</literal></screen>

      <para>
        Ce paramètre activera la vérification de l'orthographe pour le russe pour la
session actuelle.
      </para>

      <para>
        Par défaut, <application>Vim</application> n'installe que des dictionnaires
pour l'anglais. Si aucun dictionnaire n'est disponible pour une langue,
<application>Vim</application> appellera le greffon
<filename>$VIMRUNTIME/plugin/spellfile.vim</filename> et essaiera d'obtenir
les *.spl et éventuellement les *.sug depuis le serveur ftp de vim, en
utilisant le greffon
<filename>$VIMRUNTIME/plugin/netrwPlugin.vim</filename>.
      </para>


      <!-- When updating, be sure to change the line below for the proper 'vimxx'
     unpacked directory -->
<para>
        Sinon, vous pouvez télécharger à la main les fichiers *.spl et *.sug à
partir de&nbsp;: <ulink url="ftp://ftp.vim.org/pub/vim/runtime/spell/"/> et
les enregistrer dans <filename class="directory">~/.vim/spell</filename> ou
dans <filename
class="directory">/usr/share/vim/vim&vim-majmin;/spell/</filename>.
      </para>

      <para>
        Pour trouver les nouveautés dans
<application>Vim-&vim-version;</application> lancez la commande
suivante&nbsp;:
      </para>

<screen><literal>:help version-&vim-version;</literal></screen>

      <para>
        Pour des informations supplémentaires sur le paramétrage des fichiers de
configuration de <application>Vim</application>, voir <xref
linkend="postlfs-config-vimrc"/> et <ulink
url='http://vim.wikia.com/wiki/Example_vimrc'/>.
      </para>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <para>
      Vous pouvez trouver une liste des fichiers réinstallés et de leurs
descriptions courtes dans les <ulink
url="&lfs-root;/chapter08/vim.html#contents-vim">instructions de LFS
d'installation de Vim</ulink>.
    </para>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>gview, gvim, gvimdiff, gvimtutor, rgview et rgvim</seg>
        <seg>Aucune</seg>
        <seg>/usr/share/vim</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="gview">
        <term><command>gview</command></term>
        <listitem>
          <para>
            lance <command>gvim</command> en mode lecture seule
          </para>
          <indexterm zone="vim gview">
            <primary sortas="b-gview">gview</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gvim">
        <term><command>gvim</command></term>
        <listitem>
          <para>
            est l'éditeur fonctionnant sous <application>X</application> et incluant une
interface graphique
          </para>
          <indexterm zone="vim gvim">
            <primary sortas="b-gvim">gvim</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gvimdiff">
        <term><command>gvimdiff</command></term>
        <listitem>
          <para>
            édite deux ou trois versions d'un fichier avec <command>gvim</command> et
affiche les différences
          </para>
          <indexterm zone="vim gvimdiff">
            <primary sortas="b-gvimdiff">gvimdiff</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gvimtutor">
        <term><command>gvimtutor</command></term>
        <listitem>
          <para>
            enseigne les touches et les commandes de base de <command>gvim</command>
          </para>
          <indexterm zone="vim gvimtutor">
            <primary sortas="b-gvimtutor">gvimtutor</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="rgview">
        <term><command>rgview</command></term>
        <listitem>
          <para>
            est une version restreinte de <command>gview</command>
          </para>
          <indexterm zone="vim rgview">
            <primary sortas="b-rgview">rgview</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="rgvim">
        <term><command>rgvim</command></term>
        <listitem>
          <para>
            est une version restreinte de <command>gvim</command>
          </para>
          <indexterm zone="vim gvim">
            <primary sortas="b-gvim">gvim</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
