<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="postlfs-console-fonts" xreflabel="À propos des polices de console">
  <?dbhtml filename="console-fonts.html"?>


  <title>À propos des polices de console</title>

  <indexterm zone="postlfs-console-fonts">
    <primary sortas="a-console-fonts">console-fonts</primary>
  </indexterm>

  <para>
    Un système LFS peut être utilisé sans bureau graphique, et à moins ou
jusqu'à avoir installé <xref linkend="x-window-system"/> vous devrez
travailler dans la console. La plupart, sinon tous, des PC démarrent avec
une police 8x16 - quelle que soit la taille de l'écran. Il y a plusieurs
choses que vous pouvez faire pour modifier l'affichage en console. La
plupart implique de changer la police, mais les premiers changent la ligne
de commande utilisée par grub.
  </para>

  <sect2 id="grub-video">
    <title>Paramétrer une taille d'écran plus petite dans grub</title>

    <indexterm zone="postlfs-console-fonts grub-video">
      <primary sortas="e-boot-grub-grub-cfg">/boot/grub/grub.cfg</primary>
    </indexterm>

    <para>
      Les écrans modernes ont souvent beaucoup plus de pixels que les écrans
utilisés par le passé. Si votre écran fait 1600 pixels de largeur, un police
8x16 vous donnera 200 colonnes de texte - à moins que votre moniteur ne soit
énorme, le texte sera petit. Une manière de contourner ceci est de dire à
grub d'utiliser une taille plus petite, comme 1024x768 ou 800x600 ou même
640x480. Même si votre écran n'est pas en 4:3, cela devrait fonctionner.
    </para>

    <para>
      Pour tester cela, vous pouvez redémarrer et modifier la ligne de commande de
grub pour insérer un paramètre «&nbsp;video=&nbsp;» entre
«&nbsp;root=/dev/sdXn&nbsp;» et «&nbsp;ro&nbsp;», par exemple
<literal>root=/dev/sda2 video=1024x768 ro</literal> en fonction des exemples
dans LFS section 10.4.4&nbsp;: <ulink
url="&lfs-root;/chapter10/grub.html"/>.
    </para>

    <para>
      Si vous décidez que vous souhaitez le faire, vous pouvez ensuite (en tant
qu'utilisateur <systemitem class="username">root</systemitem>) modifier
<filename>/boot/grub/grub.cfg</filename>.
    </para>

  </sect2>

  <sect2 id="psf-fonts">
    <title>Utiliser les polices psf standard</title>

    <indexterm zone="postlfs-console-fonts psf-fonts">
      <primary sortas="g-usr-share-consolefonts">/usr/share/consolefonts</primary>
    </indexterm>

    <para>
      Le paquet <application>kbd</application> est utilisé dans LFS. Les polices
qu'il fournit sont des polices d'écran PC, habituellement appelées PSF, et
sont installées dans <filename
class="directory">/usr/share/consolefonts</filename>. Lorsque celles-ci ont
une table de correspondance unicode, le suffixe du fichier est souvent
changé en <literal>.psfu</literal> bien que les paquets comme
<application>terminus-font</application> (voir plus bas) n'ajoutent pas le
'u'. Ces polices sont généralement compressées avec gzip pour préserver
l'espace, mais ce n'est pas nécessaire.
    </para>

    <para>
      Les premiers écrans textes des PC avaient 8 couleurs, ou 16 couleurs si les
versions claires des 8 couleurs originales étaient utilisées. Une police PSF
peut inclure jusqu'à 256 caractères (techniquement, glyphes) en permettant
16 couleurs, ou jusqu'à 512 caractères (auquel cas la versions claire des
couleurs n'est plus disponible). Clairement ces polices ne peuvent pas être
utilisées pour afficher des textes CJK - qui auraient besoin de milliers de
glyphes.
    </para>

    <para>
      Some fonts in <application>kbd</application> can cover more than 512
codepoints ('characters'), with varying degrees of fidelity: unicode
contains several whitespace codepoints which can all be mapped to a space,
varieties of dashes can be mapped to a minus sign, smart quotes can map to
the regular ASCII quotes rather than to whatever is used for "codepoint not
present or invalid", and those cyrillic or greek letters which look like
latin letters can be mapped onto them, so 'A' can also do duty for cyrillic
A and greek Alpha, and 'P' can also do duty for cyrillic ER and greek
RHO. Unfortunately, where a font has been created from a BDF file (the
method in terminus and Debian's <ulink
url="https://packages.debian.org/jessie/utils/console-setup">console-setup
</ulink>) such mapping of additional codepoints onto an existing glyph is
not always done, although the terminus ter-vXXn fonts do this well.
    </para>

    <para>
      Il y a plus de 120 combinaisons de polices et de tailles dans
<application>kbd</application>&nbsp;: en général, une police est fournie
avec plusieurs tailles, et parfois des variétés couvrent différents
sous-ensembles de l'unicode. La plupart sont larges de 8 pixels, en hauteur
de 8 à 16 pixels, mais il y en a un peu qui font 9 pixels de larges,
certaines qui font 12x22 et même une
(<filename>latarcyrheb-sun32.psfu</filename>) qui a été dimensionnée en
16x32. Utiliser une police plus grande est un autre moyen de rendre le texte
plus facile à lire sur de grands écrans.
    </para>

  </sect2>

  <sect2 id="testing-fonts">
    <title>Tester différentes polices</title>

    <para>
      Vous pouvez tester les polices en tant qu'utilisateur normal. Si vous avez
une police qui n'a pas été installée, vous pouvez la charger avec&nbsp;:
    </para>

<screen><userinput>setfont /path/to/yourfont.ext</userinput></screen>

    <para>
      Pour les polices déjà installées, vous n'avez besoin que du nom, donc pour
<filename>gr737a-9x16.psfu.gz</filename> par exemple&nbsp;:
    </para>

<screen><userinput>setfont gr737a-9x16</userinput></screen>

    <para>
      Pour voir les glyphes dans la police, utilisez&nbsp;:
    </para>

<screen><userinput>showconsolefont</userinput></screen>

    <para>
      Si la police a l'air d'être utilisable, vous pouvez ensuite la tester plus
complètement.
    </para>

    <para>
      Lorsque vous trouvez une police que vous souhaitez utiliser, en tant
qu'utilisateur <systemitem class="username">root</systemitem>, modifiez
<phrase revision="sysv"><filename>/etc/sysconfig/console</filename> comme
décrit dans LFS section 9.6.5 <ulink
url="&lfs-root;/chapter09/usage.html"/>.</phrase><phrase
revision="systemd"><filename>/etc/vconsole.conf</filename> comme décrit dans
LFS section 9.6<ulink url="&lfs-root;/chapter09/console.html"/>.</phrase>
    </para>

    <para>
      Pour les polices qui ne sont pas fournies par le paquet
<application>kbd</application> vous devrez éventuellement la compresser avec
<command>gzip</command> puis l'installer en tant qu'utilisateur <systemitem
class="username">root</systemitem>.
    </para>

  </sect2>



  <!-- after that, psf-tools -->
<sect2 id="psf-tools">
    <title>Modification des polices avec psf-tools</title>

    <indexterm zone="postlfs-console-fonts psf-tools">
      <primary sortas="a-psftools">psftools</primary>
    </indexterm>

    <para>
      Bien que certaines polices de console soient créées depuis des fichiers BDF,
qui sont un format texte avec des valeurs hexadécimales pour les pixels dans
chaque ligne du caractère, il y a des outils plus modernes utilisables pour
éditer des polices psf. Le paquet <ulink
url="https://www.seasip.info/Unix/PSF/">psftools</ulink> vous permet de
décharger une police en une représentation textuelle avec un tiret pour un
pixel éteint (noir) et un dièse pour un pixel qui est allumé (blanc). Vous
peuvez ensuite éditer le fichier texte et ajouter plus de caractères,
changer leur forme ou leur lier plus de codes de points, puis créer une
nouvelle police psf avec vos changements.
    </para>

  </sect2>


  <!-- finally, link to terminus and link to it from above -->
<sect2 id="terminus-font">
    <title>Utiliser des polices de Terminus-font</title>

    <indexterm zone="postlfs-console-fonts terminus-font">
      <primary sortas="a-terminus-font">terminus-font</primary>
    </indexterm>

    <para>
      Le paquet <ulink url="https://terminus-font.sourceforge.net/">Terminus
Font</ulink> fournit des polices bitmap à largeur fixe destinées aux longs
(8 heures ou plus par jour) travaux avec des ordinateurs. Dans 'Character
variants' sur cette page se trouve une liste de correctifs (dans le
répertoire <filename class="directory">alt/</filename>). Si vous utilisez un
navigateur graphique pour regarder cette page, vous peuvez voir ce que les
correctifs font, par exemple «&nbsp;ll2&nbsp;» rend «&nbsp;l&nbsp;»
visiblement différent de «&nbsp;i&nbsp;» et «&nbsp;1&nbsp;».
    </para>

    <para>
      Par défaut, <application>terminus-font</application> essaiera de créer
différents types de polices, et cela échouera si <command>bdftopcf</command>
de <xref linkend="xorg7-app"/> n'est pas installé. Le script configure n'est
seulement vraiment utile que si vous installez <emphasis>toutes</emphasis>
les polices (bitmaps console et X11) dans les bons répertoires, comme dans
une distribution. Pour construire uniquement les polices PSF et leur
dépendances, lancez&nbsp;:
    </para>

<screen><userinput>make psf</userinput></screen>

    <para>
      Cela créera plus de 240 polices ter-*.psf. Le suffixe 'b' indique clair, 'n'
indique normal. Vous pouvez ensuite les tester pour voir si elles
remplissent vos exigences. À moins de créer une distribution, il est peu
utile de les installer toutes.
    </para>

    <para>
      Par exemple, pour installer la dernière de ces police, vous pouvez la gziper
et ensuite l'installer en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen><userinput>install -v -m644 ter-v32n.psf.gz /usr/share/consolefonts</userinput></screen>

  </sect2>



<!-- then svn up, add changelog, do the propsets, create wiki page -->
</sect1>
