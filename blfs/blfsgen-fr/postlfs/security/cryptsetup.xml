<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY cryptsetup-download-http "&kernel-dl;/linux/utils/cryptsetup/v&cryptsetup-minor;/cryptsetup-&cryptsetup-version;.tar.xz">
  <!ENTITY cryptsetup-download-ftp  "">
  <!ENTITY cryptsetup-md5sum        "504d1ab22cbc4d1a59a8d8c7ee5ed3bf">
  <!ENTITY cryptsetup-size          "11&nbsp;Mo">
  <!ENTITY cryptsetup-buildsize     "29&nbsp;Mo (plus 113&nbsp;Mo pour les tests)">
  <!ENTITY cryptsetup-time          "0.2&nbsp;SBU (plus 14&nbsp;SBU pour les tests)">
]>

<sect1 id="cryptsetup" xreflabel="cryptsetup-&cryptsetup-version;">
  <?dbhtml filename="cryptsetup.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>cryptsetup-&cryptsetup-version;</title>

  <indexterm zone="cryptsetup">
    <primary sortas="a-cryptsetup">cryptsetup</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à cryptsetup</title>

    <para>
      cryptsetup est utilisé pour mettre en place le chiffrement transparent de
périphériques blocs avec l'API cryptographique du noyau. 
    </para>

    &lfs110a_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&cryptsetup-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&cryptsetup-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5 du téléchargement&nbsp;: &cryptsetup-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &cryptsetup-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &cryptsetup-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &cryptsetup-time;
        </para>
      </listitem>
    </itemizedlist>



    <!-- No longer needed with 2.3.2.
    <bridgehead renderas="sect3">
Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Required patch:
          <ulink url="&patch-root;/cryptsetup-&cryptsetup-version;-upstream_fixes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
-->
<bridgehead renderas="sect3">Dépendances de cryptsetup</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="json-c"/>, <xref linkend="lvm2"/> et <xref linkend="popt"/>
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref linkend="libpwquality"/>, <ulink
url="https://github.com/P-H-C/phc-winner-argon2">argon2</ulink> et <ulink
url="http://www.openwall.com/passwdqc/">passwdqc</ulink>
    </para>


    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/cryptsetup"/>
    </para>
  </sect2>

  <sect2 role="kernel" id="cryptsetup-kernel">
    <title>Configuration du noyau</title>

    <para>
      Les périphériques blocs chiffrés requièrent le support du noyau. Pour les
utiliser, les paramètres appropriés doivent être utilisés&nbsp;:
    </para>

<screen><literal>Device Drivers  ---&gt;          
  [*] Multiple devices driver support (RAID and LVM) ---&gt; [CONFIG_MD]
       &lt;*/M&gt; Device mapper support                        [CONFIG_BLK_DEV_DM]
       &lt;*/M&gt; Crypt target support                         [CONFIG_DM_CRYPT]

Cryptographic API  ---&gt;                                    
  &lt;*/M&gt; XTS support                                       [CONFIG_CRYPTO_XTS]
  &lt;*/M&gt; SHA224 and SHA256 digest algorithm                [CONFIG_CRYPTO_SHA256]
  &lt;*/M&gt; AES cipher algorithms                             [CONFIG_CRYPTO_AES]
  &lt;*/M&gt; User-space interface for symmetric key cipher algorithms
                                                          [CONFIG_CRYPTO_USER_API_SKCIPHER]
  For tests:
  &lt;*/M&gt; Twofish cipher algorithm                          [CONFIG_CRYPTO_TWOFISH]</literal></screen>

    <indexterm zone="cryptsetup cryptsetup-kernel">
      <primary sortas="d-cryptsetup">cryptsetup</primary>
    </indexterm>

  </sect2>

    <sect2 role="installation">
      <title>Installation de cryptsetup</title>



    <!-- No longer needed with 2.3.2
    <para>

      First, apply a patch to fix a build problem caused by API changes in 
      <xref role="nodep" linkend="json-c"/>:
    </para>

<screen><userinput remap="pre">patch -Np1 -i ../cryptsetup-&cryptsetup-version;-upstream_fixes-1.patch</userinput></screen>
-->
<para>
      Installez <application>cryptsetup</application> en lançant les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>./configure --prefix=/usr &amp;&amp;
make</userinput></screen>

    <para>
      <!--I still had 5 of 19 tests fail after adding the above crypto options in the 
      kernel.  bdubbs -->
Pour tester les résultats, lancez en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;: <command>make check</command>.
Certains tests échoueront si les options du noyau appropriées ne sont pas
activées. Certaines des options supplémentaires requises pour les tests
sont&nbsp;: CONFIG_SCSI_LOWLEVEL, CONFIG_SCSI_DEBUG,
CONFIG_BLK_DEV_DM_BUILTIN, CONFIG_CRYPTO_USER, CONFIG_CRYPTO_CRYPTD,
CONFIG_CRYPTO_LRW, CONFIG_CRYPTO_XTS, CONFIG_CRYPTO_ESSIV,
CONFIG_CRYPTO_CRCT10DIF, CONFIG_CRYPTO_AES_TI, CONFIG_CRYPTO_AES_NI_INTEL,
CONFIG_CRYPTO_BLOWFISH, CONFIG_CRYPTO_CAST5, CONFIG_CRYPTO_SERPENT,
CONFIG_CRYPTO_SERPENT_SSE2_X86_64, CONFIG_CRYPTO_SERPENT_AVX_X86_64,
CONFIG_CRYPTO_SERPENT_AVX2_X86_64 et CONFIG_CRYPTO_TWOFISH_X86_64.  
      
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install</userinput></screen>

  </sect2>

  

  <!--sect2 role="commands">

    <title>Command Explanations</title>

  </sect2-->
<sect2 role="configuration">
    <title>Configuration de cryptsetup</title>

    <para>
      À cause du nombre de configurations possibles, la mise en place de volumes
chiffrés va au delà de la portée du livre BLFS. Merci de regarder le guide
de configuration dans la <ulink
url="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions#2-setup">FAQ</ulink>
de cryptsetup.
    </para>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          cryptsetup, cryptsetup-reencrypt, integritysetup et veritysetup
        </seg>
        <seg>
          libcryptsetup.so
        </seg>
        <seg>
          None          
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="cryptsetup-prog">
        <term><command>cryptsetup</command></term>
        <listitem>
          <para>
             est utilisé pour mettre en place des liaisons device-mapper gérées par
dm-crypt
          </para>
          <indexterm zone="cryptsetup cryptsetup-prog">
            <primary sortas="b-cryptsetup">cryptsetup</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="cryptsetup-reencrypt">
        <term><command>cryptsetup-reencrypt</command></term>
        <listitem>
          <para>
             est un outil pour le re-chiffrement LUKS hors-ligne
          </para>
          <indexterm zone="cryptsetup cryptsetup-reencrypt">
            <primary sortas="b-cryptsetup-reencrypt">cryptsetup-reencrypt</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="integritysetup">
        <term><command>integritysetup</command></term>
        <listitem>
          <para>
             est un outil pour gérer les volumes dm-integrity (intégrité au niveau du
bloc)
          </para>
          <indexterm zone="cryptsetup integritysetup">
            <primary sortas="b-integritysetup">integritysetup</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="veritysetup">
        <term><command>veritysetup</command></term>
        <listitem>
          <para>
             est utilisé pour configurer les liaisons device-mapper gérées par
dm-verity. Les cibles device-mapper verity fournissent une vérification
d’intégrité transparente en lecture-seule des périphériques blocs avec l'API
cryptographique du noyau
          </para>
          <indexterm zone="cryptsetup veritysetup">
            <primary sortas="b-veritysetup">veritysetup</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
