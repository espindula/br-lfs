<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../../general.ent">
  %general-entities;

  <!ENTITY grub-efi-download-http "https://ftp.gnu.org/gnu/grub/grub-&grub-version;.tar.xz">
  <!ENTITY grub-efi-download-ftp  "">
  <!ENTITY grub-efi-md5sum        "cf0fd928b1e5479c8108ee52cb114363">
  <!ENTITY grub-efi-size          "6.3&nbsp;Mo">
  <!ENTITY grub-efi-buildsize     "185&nbsp;Mo">
  <!ENTITY grub-efi-time          "0.9&nbsp;SBU">

  <!ENTITY unifont-download-http  "https://unifoundry.com/pub/unifont/unifont-&unifont-version;/font-builds/unifont-&unifont-version;.pcf.gz">
  <!ENTITY unifont-md5sum         "4fbc33c8d8d25985f1bcdd4d28bc2420">
  <!ENTITY unifont-size           "1.3&nbsp;Mo">
]>

<sect1 id="grub-efi" xreflabel="GRUB-&grub-version; for EFI">
  <?dbhtml filename="grub-efi.html"?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>GRUB-&grub-version; pour EFI</title>

  <indexterm zone="grub-efi">
    <primary sortas="a-grub-efi">grub-efi</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à GRUB</title>

    <para>
      Le paquet <application>Grub</application> contient un chargeur de démarrage,
le <foreignphrase>GRand Unified Bootloader</foreignphrase>. Dans cette page
il sera construit avec la prise en charge d'UEFI, qui n'était pas activée
dans le GRUB construit dans LFS.
    </para>

    &lfs110_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&grub-efi-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&grub-efi-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5 du téléchargement&nbsp;: &grub-efi-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &grub-efi-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &grub-efi-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &grub-efi-time;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>

    <itemizedlist spacing="compact">
      <title>Données de polices unicode utilisées pour afficher le menu de GRUB</title>
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&unifont-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5 du téléchargement&nbsp;: &unifont-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &unifont-size;
        </para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de GRUB</bridgehead>

    <bridgehead renderas="sect4">Requis (à l'exécution)</bridgehead>
    <para role="runtime">
      <xref linkend="efibootmgr"/>
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="freetype2"/>
    </para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref linkend="lvm2"/>
    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/grub-efi"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de GRUB</title>

    <para>
      Tout d'abord, installez les données de police en tant qu'utilisateur
<systemitem class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>mkdir -pv /usr/share/fonts/unifont &amp;&amp;
gunzip -c ../unifont-&unifont-version;.pcf.gz > /usr/share/fonts/unifont/unifont.pcf</userinput></screen>

    <warning>
      <para>Nettoyez les variables d'environnement qui peuvent affecter la
construction&nbsp;:</para>

      <screen><userinput>unset {C,CPP,CXX,LD}FLAGS</userinput></screen>

      <para>N'essayez pas de <quote>régler</quote> ce paquet avec des drapeaux de
compilation personnalisés&nbsp;: ce paquet est un chargeur d'amorçage, avec
des opérations de bas-niveau dans le code source qui seront sans doute
cassées par certaines optimisations agressives.</para>
    </warning>

    <para>
      Construisez <application>GRUB</application> avec les commandes
suivantes&nbsp;:
    </para>

<screen><userinput>./configure --prefix=/usr        \
            --sysconfdir=/etc    \
            --disable-efiemu     \
            --enable-grub-mkfont \
            --with-platform=efi  \
            --disable-werror     &amp;&amp;
make</userinput></screen>

    <para>
      Ce paquet n'a pas de suite de tests qui fournisse des résultats
intéressants.
    </para>

    <para>
      Maintenant, en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>make install &amp;&amp;
mv -v /etc/bash_completion.d/grub /usr/share/bash-completion/completions</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <parameter>--enable-grub-mkfont</parameter>&nbsp;: construit l'outil
<command>grub-mkfont</command> pour générer le fichier de polices pour le
chargeur d'amorçage à partir des données de police qu'on a installées.
    </para>

    <warning>
      <para>Si vous n'avez pas installé la dépendance recommandée <xref
linkend="freetype2"/>, il est possible d'omettre cette option et de
construire GRUB. Cependant, si <command>grub-mkfont</command> n'est pas
construit ou que les données de police ne sont pas disponibles quand GRUB
est construit, GRUB n'installera aucune police pour le chargeur
d'amorçage. Le menu de démarrage de GRUB sera affiché avec une police
grossière et les premières étapes d'initialisation du noyau se feront en
<quote>mode aveugle</quote> &mdash; vous ne pourrez pas voir les messages du
noyau avant l'initialisation du pilote de carte graphique. Il sera compliqué
de diagnostiquer certains problèmes de démarrage, surtout si le pilote
graphique est construit en tant que module.</para>
    </warning>

    <para>
      <parameter>--with-platform=efi</parameter>&nbsp;: s'assure de construire
GRUB avec EFI activé.
    </para>

  </sect2>

  <sect2>
    <title>Configuration de GRUB</title>

    <para>
      On discute de comment utiliser GRUB pour rendre le système LFS amorçable sur
une plateforme UEFI sur <xref linkend="grub-setup"/>.
    </para>
  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <para>See the page for GRUB in LFS book.</para>
  </sect2>

</sect1>
