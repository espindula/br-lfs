<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY thunderbird-download-http "&mozilla-http;/thunderbird/releases/&thunderbird-version;/source/thunderbird-&thunderbird-version;.source.tar.xz">
  <!ENTITY thunderbird-download-ftp  "">
  <!ENTITY thunderbird-md5sum        "1fccb7eee986bb176361075acfe96715">
  <!ENTITY thunderbird-size          "386&nbsp;Mo">
  <!ENTITY thunderbird-buildsize     "6.8 GB (201 MB installed)">
  <!ENTITY thunderbird-time          "28 SBU (on a 4-core machine)">
  <!-- Removed the -j1 time because python and rust do not obey it, although
       the C/C++ code appears to obey it -->
]>

<sect1 id="thunderbird" xreflabel="Thunderbird-&thunderbird-version;">
  <?dbhtml filename="thunderbird.html" ?>

  <sect1info>
<date>$Date$</date></sect1info>

  <title>Thunderbird-&thunderbird-version;</title>

  <indexterm zone="thunderbird">
    <primary sortas="a-Thunderbird">Thunderbird</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Thunderbird</title>

    <para>
      <application>Thunderbird</application> est un client autonome de mail/news
basé sur le code source de <application>Mozilla</application>. Il utilise le
moteur de rendement Gecko afin d'afficher et d'écrire des courriels HTML
    </para>

    &lfs111_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&thunderbird-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&thunderbird-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &thunderbird-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &thunderbird-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &thunderbird-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &thunderbird-time;
        </para>
      </listitem>
    </itemizedlist>



    <!--
    <bridgehead renderas="sect3">
Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Required patch:
          <ulink url="&patch-root;/thunderbird-&thunderbird-version;-buildfix-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
-->
<bridgehead renderas="sect3">Dépendances de Thunderbird</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">

      <!--      <xref linkend="alsa-lib"/>
, no mention in log -->
<!-- Searched for and used a few times -->
<xref linkend="autoconf213"/>, <xref linkend="cbindgen"/>, <xref
linkend="dbus-glib"/>, à la fois <xref linkend="gtk3"/> et <xref
linkend="gtk2"/>, <xref linkend="llvm"/> avec clang, <xref
linkend="nodejs"/>, <xref linkend="pulseaudio"/> (ou <xref
linkend="alsa-lib"/> si vous modifiez le mozconfig&nbsp;; mais mozilla a
rendu alsa-lib obsolète), <xref linkend="python3"/> (reconstruit avec le
module sqlite), <xref linkend="startup-notification"/>, <xref
linkend="zip"/>, <xref linkend="unzip"/> et <xref linkend="yasm"/>
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <!-- Fails to build with version 1.8.0
      <xref linkend="libvpx"/>
,-->
<xref linkend="icu"/>, <xref linkend="libevent"/>, <xref linkend="nasm"/>,
<xref linkend="nspr"/> et <xref linkend="nss"/>
    </para>

    <note>
      <para>
        Si vous n'installez pas les dépendances recommandées, alors des copies
internes de ces paquets seront utilisés. Elles sont certes testées pour
fonctionner, mais elles peuvent être dépassées et contenir des trous de
sécurité.
      </para>
    </note>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      
      <!-- <xref linkend="curl"/>
, not in build log-->
<!--<xref linkend="gst10-plugins-base"/>
 (with
      <xref linkend="gst10-plugins-good"/> and
      <xref linkend="gst10-libav"/> at runtime),-->
<!-- <xref linkend="openjdk"/>
, not in build log -->
<!--<xref linkend="pulseaudio"/>
,-->
<xref linkend="cyrus-sasl"/>, <xref linkend="doxygen"/>, <xref
linkend="GConf"/>, <xref linkend="wget"/>, <xref linkend="wireless_tools"/>
et <ulink url="https://facebook.github.io/watchman/">watchman</ulink>
    </para>

    <para condition="html" role="usernotes">
      Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/Thunderbird"/>
    </para>
  </sect2>

  <sect2 role="installation">
    <title>Installation de Thunderbird</title>

    <note>
      <para>
        Le processus de construction pour Thunderbird peut utiliser plus de 8 Go de
RAM lors de l'édition des liens. Assurez-vous que vous avez assez de swap ou
de RAM avant de continuer.
      </para>
    </note>

    <para>
      La configuration de <application>Thunderbird</application> est réalisée en
créant un fichier <filename>mozconfig</filename> contenant les options de
configuration désirées. Un <filename>mozconfig</filename> par défaut est
créé plus bas. Pour voir la liste complète des options de configuration
disponibles (et une brève description de chacune), lancez
<command>mozilla/configure --help</command>. Créez le fichier avec la
commande suivante&nbsp;:
    </para>

<!-- no longer needed with 91.6
    <para>

      Apply a patch which allows compilation on systems with Wayland-1.20:
    </para>

<screen><userinput remap="pre">patch -p1 -i ../thunderbird-&thunderbird-version;-buildfix-1.patch</userinput></screen>
-->
<!-- applying this for 11.1: upstream haven't make their mind yet
     https://bugzilla.mozilla.org/show_bug.cgi?id=1729459 -->
<screen><!-- always built in versions 78+. The option is a noop
# If you want to compile the Mozilla Calendar, uncomment this line:
#ac_add_options - -enable-calendar
-->
<userinput>cat &gt; mozconfig &lt;&lt; "EOF"
<literal># If you have a multicore machine, all cores will be used.

# If you have installed wireless-tools comment out this line:
ac_add_options --disable-necko-wifi

# Uncomment the following option if you have not installed PulseAudio
#ac_add_options --disable-pulseaudio
# and uncomment this if you installed alsa-lib instead of PulseAudio
#ac_add_options --enable-alsa

# Comment out following options if you have not installed
# recommended dependencies:
ac_add_options --with-system-libevent
ac_add_options --with-system-nspr
ac_add_options --with-system-nss
ac_add_options --with-system-icu

# The elf-hack causes failed installs on some machines.
# It is supposed to improve startup time and it shrinks libxul.so
# by a few MB - comment this if you know your machine is not affected.
ac_add_options --disable-elf-hack

# The BLFS editors recommend not changing anything below this line:
ac_add_options --prefix=/usr
ac_add_options --enable-application=comm/mail

ac_add_options --disable-crashreporter
ac_add_options --disable-updater
ac_add_options --disable-debug
ac_add_options --disable-debug-symbols
ac_add_options --disable-tests

ac_add_options --enable-optimize=-O2
ac_add_options --enable-linker=gold
ac_add_options --enable-strip
ac_add_options --enable-install-strip

ac_add_options --enable-official-branding

ac_add_options --enable-system-ffi
ac_add_options --enable-system-pixman

ac_add_options --with-system-jpeg
ac_add_options --with-system-png
ac_add_options --with-system-zlib</literal>
EOF</userinput></screen>




    <para>
      Si vous construisez sur une machine 32&nbsp;bits, le sed suivant contourne
un problème avec un type <quote>double</quote> incompatible dans un fichier
d'en-tête&nbsp;:
    </para>

<screen><userinput>case "$(uname -m)" in
    i?86) sed -e '/typedef[ ]*double/s/double/long double/' \
              -i modules/fdlibm/src/math_private.h ;;
esac</userinput></screen>

    <para>
      Maintenant invoquez le script Python <command>mach</command> pour compiler
<application>Thunderbird</application>&nbsp;:
    </para>

    <note>
      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
       href="../../xincludes/mozshm.xml"/>

      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/mozmach.xml"/>

    </note>

<screen><userinput>export CC=gcc CXX=g++ &amp;&amp;
export MACH_USE_SYSTEM_PYTHON=1 &amp;&amp;
./mach create-mach-environment &amp;&amp;
./mach configure      &amp;&amp;
./mach build</userinput></screen>

    <para>
      Ce paquet n'a pas de suite de tests.
    </para>

    <para>
      Installez <application>Thunderbird</application> en exécutant les commandes
suivantes en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<!-- devs: For DESTDIR install, prepend DESTDIR=<dest>
 to the above -->
<screen role="root"><userinput>MACH_USE_SYSTEM_PYTHON=1 ./mach install</userinput></screen>

    <para>
      Videz les variables d'environnement qui ont été définies plus haut&nbsp;:
    </para>

<screen><userinput>unset CC CXX MACH_USE_SYSTEM_PYTHON</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>


    <!-- might be necessary, we need to verify this.
    <para>

      <command>test $(uname -m) = "i686" &amp;&amp; sed ...</command>: On this
      version of thunderbird, an old bug has reappeared in 32-bit builds.  With
      optimization, the install fails with a Python error.  This command will
      fix i686 builds and preserve the optimization on x86_64.
    </para>-->
<para>
      <!-- For more info, see Ticket #13969. ~12GB to ~5GB build size,
      significantly smaller build time.-->
<command>CC=gcc CXX=g++ ./mach configure</command>&nbsp;:
<application>Thunderbird</application> utilise maintenant ce script
<application>python3</application> pour lancer la construction et
l'installation. Forcer GCC fait que la construction est plus petite et fini
plus rapidement.
      
    </para>

    <para>
      <command>MACH_USE_SYSTEM_PYTHON=1</command>&nbsp;: utilise le python du
système pour créer un environnement virtuel pour <command>mach</command>
sans télécharger de wheel python.
    </para>

    <para>
      <option>./mach build --verbose</option>&nbsp;: utilisez cette alternative si
vous voulez des détails sur les fichiers compilés, avec les drapeaux C ou
C++ utilisés.
    </para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de Thunderbird</title>

    <sect3><title>Informations sur la configuration</title>

      <para>
        Si votre gestionnaire de bureau ou de fenêtre ne vous permet pas de
configurer un navigateur par défaut, vous pouvez ajouter un paramètre de
configuration à <application>Thunderbird</application> pour qu'un navigateur
démarre lorsque vous cliquez sur une URL Internet/intranet/locale. La
procédure pour vérifier ou modifier tout paramètre de configuration est
plutôt simple et les instructions présentées ici peuvent être utilisées pour
voir ou modifier n'importe quel paramètre.
      </para>

      <para>
        Commencez par ouvrir la fenêtre de configuration en ouvrant le menu
déroulant <quote>Edit</quote>. Choisissez <quote>Préferences</quote> puis
défilez vers le bas de la page. Ensuite, cliquez sur le bouton
<quote>Éditeur de configuration</quote>. Cliquez sur le bouton
<quote>J'accepte le risque !</quote>. Ceci affichera une liste des
préférences de configuration et des informations liées à chacune. Vous
pouvez utiliser la barre <quote>Filtrer :</quote> pour saisir des critères
de recherche et réduire le nombre d'entrées listées. Changer une préférence
se fait de deux manières. La première, si la préférence est une valeur
booléenne (Vrai/Faux), consiste à double-cliquer simplement sur la
préférence pour inverser la valeur et la deuxième, pour les autres
préférences consiste en un clic-droit sur la ligne voulue, à choisir
<quote>Modifier</quote> dans le menu et à changer la valeur. Créez une
nouvelle entrée de préférence de la même manière, sauf que vous choisirez
<quote>Nouveau</quote> dans le menu et que vous fournirez les données
désirées dans les champs quand demandé.
      </para>

      <para>
        L'entrée de préférence que vous devez vérifier pour que
<application>Thunderbird</application> utilise un navigateur spécifique est
<parameter>network.protocol-handler.app.http</parameter> qui devrait
contenir le chemin du navigateur désiré, par exemple
<option>/usr/bin/firefox</option>.
      </para>

      <tip>
        <para>
          Il y a une multitude de paramètres de configuration que vous pouvez affiner
pour personnaliser <application>Thunderbird</application>. Une vaste liste,
mais pas tout à fait à jour, de ces paramètres se trouve sur <ulink
url="http://preferential.mozdev.org/preferences.html"/>.
        </para>
      </tip>

    <para>

      <!--If you didn't enable
      <application>startup-notification</application> in your mozconfig, then
      change the StartupNotify line to false.-->
Si vous utilisez un environnement de bureau comme
<application>GNOME</application> ou <application>KDE</application>, un
fichier desktop <filename>thunderbird.desktop</filename> peut être créé pour
inclure une entrée <quote><application>Thunderbird</application></quote>
dans les menus. Lancez les commandes suivantes en tant qu'utilisateur
<systemitem class="username">root</systemitem>&nbsp;:

    </para>

<screen role="root"><userinput>mkdir -pv /usr/share/{applications,pixmaps} &amp;&amp;

cat &gt; /usr/share/applications/thunderbird.desktop &lt;&lt; "EOF" &amp;&amp;
<literal>[Desktop Entry]
Name=Thunderbird Mail
Comment=Send and receive mail with Thunderbird
GenericName=Mail Client
Exec=thunderbird %u
Terminal=false
Type=Application
Icon=thunderbird
Categories=Network;Email;
MimeType=text/html;text/xml;application/xhtml+xml;application/xml;application/rss+xml;x-scheme-handler/mailto;
StartupNotify=true</literal>
EOF

ln -sfv /usr/lib/thunderbird/chrome/icons/default/default256.png \
        /usr/share/pixmaps/thunderbird.png</userinput></screen>
    </sect3>
  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programme installé</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>
          thunderbird
        </seg>
        <seg>
          libldap60.so, libldif60.so, liblgpllibs.so, libmozgtk.so, libmozsandbox.so,
libmozsqlite3.so, libmozwayland.so, libprldap60.so, librnp.so et libxul.so,
tous dans le répertoire /usr/lib/thunderbird
        </seg>
        <seg>
          /usr/lib/thunderbird
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="thunderbird-prog">
        <term><command>thunderbird</command></term>
        <listitem>
          <para>
            est le client de courriel et de nouvelles de
<application>Mozilla</application>
          </para>
          <indexterm zone="thunderbird thunderbird-prog">
            <primary sortas="b-thunderbird">thunderbird</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
