<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY seamonkey-download-http "&mozilla-http;/seamonkey/releases/&seamonkey-version;/source/seamonkey-&seamonkey-version;.source.tar.xz">
  <!ENTITY seamonkey-download-ftp  "">
  <!ENTITY seamonkey-md5sum        "92ebcb6d9410442a9c1cf9c321f292f4">
  <!ENTITY seamonkey-size          "254&nbsp;Mo">
  <!ENTITY seamonkey-buildsize     "4,4&nbsp;Go (159&nbsp;Mo installés)">
  <!ENTITY seamonkey-time          "11&nbsp;SBU (avec parallélisme = 4)">
]>

<sect1 id="seamonkey" xreflabel="SeaMonkey-&seamonkey-version;">
  <?dbhtml filename="seamonkey.html" ?>


  <title>SeaMonkey-&seamonkey-version;</title>

  <indexterm zone="seamonkey">
    <primary sortas="a-SeaMonkey">SeaMonkey</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à SeaMonkey</title>

    <para>
      <application>SeaMonkey</application> est une suite internet, un successeur
de <application>Netscape</application>. Elle inclut le navigateur, le
compositeur, des clients de messagerie et de nouvelles et un client IRC.
    </para>

    <para>
      C'est le successeur communautaire de la suite d'application Mozilla, créée
après que Mozilla a décidé de se concentrer sur des applications séparées
pour la navigation et les courriels. Ces applications sont <xref
linkend="firefox"/> et <xref linkend="thunderbird"/>.
    </para>

    &lfs113_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&seamonkey-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&seamonkey-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5&nbsp;: &seamonkey-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &seamonkey-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &seamonkey-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &seamonkey-time;
        </para>
      </listitem>
    </itemizedlist>



    <!--
    <bridgehead renderas="sect3">
Additional Downloads</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Required patch:
          <ulink url="&patch-root;/seamonkey-&seamonkey-version;-upstream_fixes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
-->
<note>
      <para>
        L'archive <emphasis>seamonkey-&seamonkey-version;.source.tar.xz</emphasis>
se décompactera dans le répertoire
<emphasis>seamonkey-&seamonkey-version;</emphasis>.
      </para>
    </note>

    <bridgehead renderas="sect3">Dépendances de SeaMonkey</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="autoconf213"/>, <xref linkend="cbindgen"/>, <xref
linkend="gtk3"/>, <xref linkend="nodejs"/>, <xref linkend="python2"/>, <xref
linkend="unzip"/>, <xref linkend="yasm"/>, and <xref linkend="zip"/>
    </para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <!--<xref linkend="libvpx"/>
, Causes build failures similar to Firefox -->
<!-- <xref linkend="sqlite"/>
 system version no longer supported -->
<xref linkend="icu"/>, <xref linkend="libevent"/>, <xref
linkend="libwebp"/>, <xref linkend="llvm"/> (avec clang), <xref
linkend="nasm"/>, <xref linkend="nspr"/>, <xref linkend="nss"/> et <xref
linkend="pulseaudio"/>
      
    </para>

    <!--
    <bridgehead renderas="sect4">
Optional</bridgehead>
    <para role="optional">
      <xref linkend="sqlite"/> (not recommended due to potential
      security concerns)
    </para>
-->
<note>
      <para>
        Si vous n'installez pas les dépendances recommandées, alors des copies
internes de ses paquets seront utilisées. Elles sont testées pour
fonctionner, mais elles peuvent être dépassées ou contenir des trous de
sécurité.
      </para>
    </note>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <!--<xref linkend="curl"/>
,-->
<!--<xref linkend="doxygen"/>
,-->
<!--<xref linkend="gst10-plugins-base"/>
 (and other plugins, only for tests),-->
<!--<xref linkend="openjdk"/>
, Not seen in logs -->
<xref linkend="alsa-lib"/>, <xref linkend="dbus-glib"/>, <xref
linkend="GConf"/>, <xref linkend="startup-notification"/>, <xref
linkend="valgrind"/>, <xref linkend="wget"/>, <xref
linkend="wireless_tools"/>, <ulink
url="https://hunspell.sourceforge.net/">Hunspell</ulink> et <ulink
url="https://facebook.github.io/watchman/">Watchman</ulink>
    </para>

    <para condition="html" role="usernotes">
      Editor Notes: <ulink url="&blfs-wiki;/seamonkey"/>
    </para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de SeaMonkey</title>

    <para>
      La configuration de <application>SeaMonkey</application> se fait en créant
un fichier <filename>mozconfig</filename> contenant les options de
configuration désirées. Un fichier <filename>mozconfig</filename> par défaut
est créé ci-dessous. Pour voir toute la liste des options de configuration
disponibles (et une description abrégée de chacune), exécutez
<command>./configure --help</command>. Il se peut que vous vouliez aussi
relire tout le fichier et dé-commenter d'autres options souhaitées. Créez le
fichier en exécutant la commande suivante&nbsp;:
    </para>

<screen><!-- comments cause a blank line, following was for icu in the past
     seems OK with icu-60, seamonkey-2.49
     line below was with comment and explanation
# Use the internal version of icu due to execution problems-->
<?dbfo keep-together="auto"?><userinput>cat &gt; mozconfig &lt;&lt; "EOF"
<literal># If you have a multicore machine, all cores will be used

# If you have installed DBus-Glib comment out this line:
ac_add_options --disable-dbus

# If you have installed dbus-glib, and you have installed (or will install)
# wireless-tools, and you wish to use geolocation web services, comment out
# this line
ac_add_options --disable-necko-wifi

# Uncomment these lines if you have installed optional dependencies:
#ac_add_options --enable-system-hunspell
#ac_add_options --enable-startup-notification

# Uncomment the following option if you have not installed PulseAudio
#ac_add_options --disable-pulseaudio
# and uncomment this if you installed alsa-lib instead of PulseAudio
#ac_add_options --enable-alsa

# Comment out following option if you have gconf installed
ac_add_options --disable-gconf

# Comment out following options if you have not installed
# recommended dependencies:
ac_add_options --with-system-icu
ac_add_options --with-system-libevent
ac_add_options --with-system-nspr
ac_add_options --with-system-nss
ac_add_options --with-system-webp

# Disabling debug symbols makes the build much smaller and a little
# faster. Comment this if you need to run a debugger. Note: This is
# required for compilation on i686.
ac_add_options --disable-debug-symbols

# The elf-hack is reported to cause failed installs (after successful builds)
# on some machines. It is supposed to improve startup time and it shrinks
# libxul.so by a few MB - comment this if you know your machine is not affected.
ac_add_options --disable-elf-hack

# Seamonkey has some additional features that are not turned on by default,
# such as an IRC client, calendar, and DOM Inspector. The DOM Inspector
# aids with designing web pages. Comment these options if you do not
# desire these features.
ac_add_options --enable-calendar
ac_add_options --enable-dominspector
ac_add_options --enable-irc

# The BLFS editors recommend not changing anything below this line:
ac_add_options --prefix=/usr
ac_add_options --enable-application=comm/suite

ac_add_options --disable-crashreporter
ac_add_options --disable-updater
ac_add_options --disable-tests

# rust-simd does not compile with recent versions of rust.
# It is disabled in recent versions of firefox
ac_add_options --disable-rust-simd

ac_add_options --enable-optimize="-O2"
ac_add_options --enable-strip
ac_add_options --enable-install-strip
ac_add_options --enable-official-branding

# The option to use system cairo was removed in 2.53.9.
ac_add_options --enable-system-ffi
ac_add_options --enable-system-pixman

ac_add_options --with-system-bz2
ac_add_options --with-system-jpeg
ac_add_options --with-system-png
ac_add_options --with-system-zlib</literal>
EOF</userinput></screen>

    <note>
      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
       href="../../xincludes/mozshm.xml"/>
      <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
       href="../../xincludes/mozmach.xml"/>
    </note>


    <!-- Applied upstream
    <para>

      Apply a patch to fix a build failure with LLVM-16:
    </para>

<screen><userinput>patch -Np1 -i ../seamonkey-&seamonkey-version;-upstream_fixes-1.patch</userinput></screen>
-->
<para>
      Tout d'abord, supprimez un drapeau obsolète dans le code pyton, qui a été
supprimé de python-3.11&nbsp;:
    </para>

<!-- Causes issues since xpidl is python2 in Seamonkey
    <para>

      Then fix an issue with regular expressions in python-3.11:
    </para>

<screen><userinput>sed -e 's/?s)\./?s:.)/'               \
    -e '/?m)/{s/?m)/?m:/;s/\$"/$)"/}' \
    -e '/?s)%/{s/?s)/?s:/;s/?"/?)"/}' \
    -i xpcom/idl-parser/xpidl/xpidl.py</userinput></screen>
-->
<screen><userinput>grep -rl \'rU\' | xargs sed -i "s/'rU'/'r'/"</userinput></screen>



    <para>
      Ensuite, contournez un problème de l'environnement virtuel Python&nbsp;:
    </para>

<!-- Applied upstream
    <para>

      Next, work around a crash that occurs when playing audio when Seamonkey
      is compiled with rustc-1.67 or higher:
    </para>

<screen><userinput>sed -i '/USE_PULSE_RUST/d' media/libcubeb/src/moz.build</userinput></screen>
-->
<screen><userinput>sed -i "/if sys.executable !=/i\    open(join(bin_dir, 'pyvenv.cfg'), 'w').close()" \
    third_party/python/virtualenv/virtualenv.py</userinput></screen>



    <para>
      Compilez <application>seaMonkey</application> en exécutant les commandes
suivantes&nbsp;:
    </para>

<!-- comment this since llvm must have been installed for rust
    <note>

      <para>
        The CC and CXX variables above are only needed if
        <xref linkend="llvm"/> is installed and you do not want to use clang.
      </para>
    </note>-->
<screen><userinput>export CC=clang CXX=clang++          &amp;&amp;
./mach configure || ./mach configure &amp;&amp;
./mach build</userinput></screen>


    

    <para>
      Ce paquet n'a pas de suite de tests.
    </para>

    <para>
      Installez <application>SeaMonkey</application> en exécutant les commandes
suivantes en tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>


<screen role="root"><userinput>./mach install                  &amp;&amp;
chown -R 0:0 /usr/lib/seamonkey &amp;&amp;

cp -v $(find -name seamonkey.1 | head -n1) /usr/share/man/man1</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para>
      <command>export CC=clang CXX=clang++</command>&nbsp;: avec l'introduction de
<application>gcc-12</application>, bien plus d'avertissements sont générés
lors de la compilation des applications mozilla et cela rend la construction
plus lente et plus grosse. En plus, la construction avec GCC sur i?86 est
actuellement cassée. Bien que le code de mozilla en amont utilise
<application>llvm</application> par défaut à moins d'être modifié, l'ancien
code de configuration de <application>SeaMonkey</application> utilise gcc
par défaut.
    </para>

    <para>
      <command>./mach configure ||. /mach configure</command>&nbsp;: ceci valide
les dépendances fournies et le <filename>mozconfig</filename>. La commande
est exécutée deux fois car des problèmes avec mach le feront échouer la
première fois.
    </para>

    <para>
      <option>./mach build --verbose</option>&nbsp;: utilisez cette alternative si
vous avez besoin de détails sur les fichiers qui sont compilés, avec les
drapeaux C ou C++ utilisé. Mais n'ajoutez pas «&nbsp;--verbose&nbsp;» à la
commande d'installation, l'option n'y est pas acceptée.
    </para>

    <para>
      <option>./mach build -jN</option>&nbsp;: la construction devrait, par
défaut, utiliser tous les cœurs de CPU en ligne. Si utiliser tous les cœurs
fait swaper la construction à cause d'une mémoire insuffisante, utiliser
moins de cœurs peut être plus rapide.
    </para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de SeaMonkey</title>

    <para>
      Pour installer les différents plugins de
<application>SeaMonkey</application>, reportez-vous à <ulink
url="https://addons.thunderbird.net/en-US/seamonkey/">Greffons pour
Seamonkey</ulink>.
    </para>

    <para>
      Tout en utilisant le menu <quote>Préférences</quote> pour configurer les
options et les préférences de <application>SeaMonkey</application> pour les
adapter à vos propres goûts, un contrôle bien plus approfondi de nombreuses
options n'est disponible qu'en utilisant un outil non disponible depuis le
système de menu général. Pour accéder à cet outil, vous devrez ouvrir une
fenêtre du navigateur et saisir <systemitem
role="url">about:config</systemitem> dans la barre d'adresse. Cela affichera
une liste des préférences de configuration et des informations liées à
chacune. Vous pouvez utiliser la barre de <quote>Filtre:</quote> pour saisir
des critères de recherche et réduire les éléments listés. La modification
d'une préférence se fait en utilisant deux méthodes. L'une, si la préférence
a une valeur booléenne (True/False, Vrai/Faux), double-cliquez simplement
sur la préférence pour basculer la valeur, et l'autre, pour les préférences,
faites simplement un clic droit sur la ligne désirée, choisissez
<quote>Modifier</quote> dans le menu et modifiez la valeur. La création de
nouveaux éléments de préférence se fait de la même façon, sauf qu'il faut
choisir <quote>Nouveau</quote> depuis le menu et fournir les données
désirées dans les champs quand on vous le demande.
    </para>


    <!-- The URL no longer exists.
    <tip>

      <para>
        There is a multitude of configuration parameters you can tweak to
        customize <application>SeaMonkey</application>. A very extensive list of
        these parameters can be found at
        <ulink url="http://preferential.mozdev.org/preferences.html"/>.
      </para>
    </tip>
-->
<para>
      Si vous utilisez un environnement de bureau comme
<application>Gnome</application> ou <application>KDE</application> vous
pourriez souhaiter créer un fichier <filename>seamonkey.desktop</filename>
pour que <application>Seamonkey</application> apparaisse dans les menus du
bureau. Si vous n'avez pas activé
<application>Startup-Notification</application> dans votre mozconfig,
modifiez la ligne StartupNotify en false. En tant qu'utilisateur <systemitem
class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>mkdir -pv /usr/share/{applications,pixmaps}              &amp;&amp;

cat &gt; /usr/share/applications/seamonkey.desktop &lt;&lt; "EOF"
<literal>[Desktop Entry]
Encoding=UTF-8
Type=Application
Name=SeaMonkey
Comment=The Mozilla Suite
Icon=seamonkey
Exec=seamonkey
Categories=Network;GTK;Application;Email;Browser;WebBrowser;News;
StartupNotify=true
Terminal=false</literal>
EOF

ln -sfv /usr/lib/seamonkey/chrome/icons/default/default128.png \
        /usr/share/pixmaps/seamonkey.png</userinput></screen>
  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>seamonkey</seg>
        <seg>
          De nombreuses bibliothèques, le navigateur et les composants de
messagerie/nouvelles, les greffons, les extensions, et les modules
auxiliaires installés dans <filename
class="directory">/usr/lib/seamonkey</filename>
        </seg>
        <seg>
          /usr/lib/seamonkey
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?> <?dbhtml list-presentation="table"?>

      <varlistentry id="seamonkey-prog">
        <term><command>seamonkey</command></term>
        <listitem>
          <para>
            est une suite client de navigateur/messagerie/nouvelles/groupe/chat
          </para>
          <indexterm zone="seamonkey seamonkey-prog">
            <primary sortas="b-seamonkey">seamonkey</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>

</sect1>
