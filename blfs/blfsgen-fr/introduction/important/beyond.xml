<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="beyond" xreflabel="Aller au-delà de BLFS">
  <?dbhtml filename="beyond.html"?>


  <title>Aller au-delà de BLFS</title>

  <para>Les paquets installés dans ce livre ne sont que la partie visible de
l'iceberg. Nous espérons que l'expérience acquise avec les livres LFS et
BLFS vous donnera les bases nécessaires pour compiler, installer et
configurer des paquets non inclus dans ce livre.</para>

  <para>Quand vous installez un paquet à un emplacement différent de <filename
class='directory'>/</filename>, ou <filename
class='directory'>/usr</filename>, vous l'installez hors des paramètres
d'environnement par défaut de la plupart des machines. Les exemples suivants
devraient vous aider à trouver la solution à ce problème. Les exemples
couvrent tout l'éventail des paramètres qui peuvent nécessiter une mise à
jour, mais ils ne sont pas tous nécessaires dans toutes les situations.</para>

  <itemizedlist>
    <listitem>
      <para>Étendez la variable <envar>PATH</envar> pour inclure <filename
class='directory'>$PREFIX/bin</filename>.</para>
    </listitem>
    <listitem>
      <para>Étendez la variable <envar>PATH</envar> de <systemitem
class="username">root</systemitem> pour inclure <filename
class='directory'>$PREFIX/sbin</filename>.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/lib</filename> à
<filename>/etc/ld.so.conf</filename> ou étendez la variable
<envar>LD_LIBRARY_PATH</envar> pour l'inclure. Avant de recourir à cette
dernière option, consultez la page <ulink
url="http://xahlee.info/UnixResource_dir/_/ldpath.html"/>.  Si vous modifiez
<filename>/etc/ld.so.conf</filename>, rappelez-vous de mettre à jour
<filename>/etc/ld.so.cache</filename> en exécutant la commande
<command>ldconfig</command> en tant qu'utilisateur <systemitem
class="username">root</systemitem>.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/man</filename> à
<filename>/etc/man_db.conf</filename> ou étendez la variable
<envar>MANPATH</envar>.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/info</filename> à la variable
<envar>INFOPATH</envar>.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/lib/pkgconfig</filename> à la
variable <envar>PKG_CONFIG_PATH</envar>. Comme certains paquets installent
maintenant des fichiers <filename class='extension'>.pc</filename> dans
<filename class='directory'>$PREFIX/share/pkgconfig</filename>, il est
possible que vous ayez également à inclure ce répertoire.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/include</filename> à la variable
<envar>CPPFLAGS</envar> lors de la compilation de paquets qui dépendent du
paquet que vous avez installé.</para>
    </listitem>
    <listitem>
      <para>Ajoutez <filename class='directory'>$PREFIX/lib</filename> à la variable
<envar>LDFLAGS</envar> lors de la compilation de paquets qui dépendent d'une
bibliothèque installée par le paquet.</para>
    </listitem>
  </itemizedlist>

  <para>Si vous cherchez un paquet qui n'est pas dans le livre, voici différentes
manières de le trouver.</para>

  <itemizedlist>
    <listitem>
      <para>Si vous connaissez le nom du paquet, cherchez-le sur SourceCode sur <ulink
url="https://sourceforge.net/directory/"/> et cherchez-le sur GitHub sur
<ulink url="https://github.com/"/>. Cherchez aussi sur Google sur <ulink
url="https://google.com/"/>. Une recherche de <filename
class='extension'>rpm</filename> sur <ulink url="https://rpmfind.net/"/> ou
de <filename class='extension'>deb</filename> sur <ulink
url="https://www.debian.org/distrib/packages#search_packages"/> peut parfois
mener à un lien vers le paquet.</para>
    </listitem>
    <listitem>
      <para>Si vous connaissez le nom de l'exécutable mais pas le paquet auquel il
appartient, essayez d'abord de le chercher sur Google avec le nom de
l'exécutable. S'il y a trop de résultats, cherchez cet exécutable dans le
dépôt Debian sur <ulink
url="https://www.debian.org/distrib/packages#search_contents"/>.</para>
    </listitem>
  </itemizedlist>

  <para>Quelques astuces générales sur la gestion des nouveaux paquets&nbsp;:</para>

  <itemizedlist>
    <listitem>
      <para>De nombreux paquets récents suivent le processus <command>./configure
&amp;&amp; make &amp;&amp; make install</command>. Vous pouvez obtenir de
l'aide sur les options acceptées par configure via la commande
<command>./configure --help</command>.</para>
    </listitem>
    <listitem>
      <para>La plupart des paquets contiennent de la documentation sur la compilation et
l'installation du paquet. Certaines documentations sont excellentes, mais ce
n'est pas toujours le cas. Consultez la page d'accueil du paquet pour
obtenir des indications supplémentaires à jour sur la compilation et la
configuration du paquet.</para>
    </listitem>
    <listitem>
      <para>Si vous rencontrez un problème lors de la compilation du paquet, cherchez
l'erreur dans les archives LFS sur <ulink
url="https://www.&lfs-domainname;/search.html"/>. Si cela ne fonctionne pas,
cherchez sur Google. En général une distribution aura déjà corrigé le
problème (nombre d'entre elles utilisent les versions de développement des
paquets, elles voient donc les changements plus tôt que nous qui utilisons
généralement les versions stables publiées). Cependant, faites attention —
les outils de construction ont tendance à appliquer des correctifs qui ne
sont plus nécessaires et à faire des modifications qui ne sont liées qu'à
leur manière de construire un paquet. Vous devrez peut-être faire des
recherches approfondies pour trouver un correctif à la version du paquet que
vous essayez d'utiliser, voire pour trouver le paquet (les noms sont parfois
différents de ceux auxquels on s'attend, comme
<application>ghostscript</application> qui a souvent un préfixe ou un
suffixe dans son nom), mais les remarques suivantes peuvent vous aider,
particulièrement pour ceux qui, comme les éditeurs, souhaitent construire
les dernières versions et rencontrent des problèmes&nbsp;:</para>
      <itemizedlist>
        <listitem>
          <para>Arch <ulink url="https://www.archlinux.org/packages/"/>&nbsp;: saisissez le
nom du paquet dans le champ «&nbsp;Keywords&nbsp;» (mots-clés), sélectionnez
le nom du paquet, puis le champ «&nbsp;Source Files&nbsp;» (Fichiers
sources), et enfin l'entrée <filename>PKGBUILD</filename> pour voir comment
le paquet est construit.</para>
        </listitem>
        <listitem>
          <para>Debian <ulink url="https://ftp.debian.org/debian/pool"/> (utilisez la
version de votre pays s'il y en a une)&nbsp;: les sources se trouvent dans
des archives .tar.gz (soit les sources originales <filename
class='extension'>.orig</filename>, soit les fichiers
<filename>dfsg</filename> qui contiennent les parties conformes aux
principes du logiciel libre de Debian), accompagnées d'ajouts versionnés
.diff.gz ou .tar.gz. Ces ajouts montrent souvent la manière dont le paquet
est construit et peuvent contenir des correctifs. Dans les versions
.diff.gz, tous les correctifs créent des fichiers dans le répertoire
<filename class="directory">debian/patches</filename>.</para>
        </listitem>
        <listitem>
          <para>La source des paquets de Fedora est réorganisée de temps en temps. Pour
l'instant la source des paquets rpm se trouve sur <ulink
url="https://src.fedoraproject.org/projects/rpms/%2A"/> et à partir de là,
vous pouvez saisir le nom d'un paquet dans le champ de recherche. Si le
paquet est trouvé, vous pouvez consulter ses fichiers (specfile pour
contrôler la construction, et divers correctifs) ou les commits. Si c'est
impossible, vous pouvez télécharger un srpm (un rpm source) et en utilisant
<application>rpm2cpio</application> (voir les astuces au bas de cette
page). Rendez-vous sur <ulink
url="https://dl.fedoraproject.org/pub/fedora/linux/"/> pour les rpm, puis
choisissez le dépôt que vous souhaitez consulter&nbsp;: development/rawhide
correspond à la dernière version de développement. Choisissez releases pour
voir ce qui se trouvait dans une version publiée, updates pour les mises à
jour, ou updates/testing pour les dernières mises à jour qui peuvent
fonctionner ou avoir des problèmes.
          </para>
        </listitem>
        <listitem>
          <para>Gentoo - First use a search engine to find an ebuild which looks as if it
will fix the problem, or search at <ulink
url="https://packages.gentoo.org/"/> - use the search field. Note where the
package lives in the portage hierarchy, e.g.
<filename>app-something/</filename>. In general you can treat the ebuild as
a sort of pseudo-code / shell combination with some functions you can hazard
a guess at, such as <command>dodoc</command>. If the fix is just a
<command>sed</command>, try it. However, in most cases the fix will use a
patch. To find the patch, use a gentoo-portage mirror: Two links to mirrors
in the U.S.A. which seem to usually be up to date are <ulink
url="https://mirror.rackspace.com/gentoo-portage/"/> and <ulink
url="https://mirror.steadfast.net/gentoo-portage/"/>. Navigate down the tree
to the package, then to the <filename>files/</filename> directory to look
for the patch. Sometimes a portage mirror has not yet been updated,
particularly for a recent new patch. In a few cases, gentoo batch the
patches into a tarball and the ebuild will have a link in the form
https://dev.gentoo.org/~${PATCH_DEV}/distfiles/${P}-patches-${PATCH_VER}.tar.xz
: here, look for PATCH_DEV and PATCH_VER in the build and format the full
URL in your browser or for wget : remember the '~' before the developer's ID
and note that trying to search the earlier levels of the URL in a browser
may drop you at www.gentoo.org or return 403 (forbidden).
          </para>
        </listitem>
        <listitem>
          <para>openSUSE est une distribution à publication continue. Certaines versions des
paquets sont disponibles sur <ulink
url="https://download.opensuse.org/source/tumbleweed/repo/oss/src/"/> mais
d'autres se trouvent dans ../update/openSUSE-current/src&nbsp;: les sources
ne semblent disponibles que dans des rpm sources.</para>
        </listitem>
        <listitem>
          <para>Slackware&nbsp;: actuellement le navigateur de paquets officiel ne
fonctionne pas. Le site <ulink url="https://slackbuilds.org/"/> regroupe les
versions précédentes et actuelles dans leur dépôt non officiel, avec des
liens vers les pages d'accueil, les téléchargements et des fichiers
individuels, en particulier les fichiers <filename>.SlackBuild</filename>.</para>
        </listitem>
        <listitem>
          <para>Ubuntu <ulink url="ftp://ftp.ubuntu.com/ubuntu/pool/"/>&nbsp;: voir les
notes Debian ci-dessus.</para>
        </listitem>
      </itemizedlist>
      <para>Si vous n'y parvenez pas, essayez la liste de diffusion blfs-support.</para>
    </listitem>
  </itemizedlist>

  <tip>
    <para>Si vous avez trouvé un paquet qui n'est disponible qu'au format <filename
class='extension'>.deb</filename> ou <filename
class='extension'>.rpm</filename>, deux petits scripts
<command>rpm2targz</command> et <command>deb2targz</command> sont
disponibles sur <ulink
url="&sources-anduin-http;/extras/deb2targz.tar.bz2"/> et <ulink
url="&sources-anduin-http;/extras/rpm2targz.tar.bz2"/> pour convertir les
archives dans un simple format <filename>tar.gz</filename>.</para>
    <para>Le script rpm2cpio peut s'avérer utile.  La version Perl qui se trouve dans
les archives du noyau linux, sur <ulink
url="https://lore.kernel.org/all/20021016121842.GA2292@ncsu.edu/2-rpm2cpio"/>,
fonctionne pour la plupart des sources rpm.  Le script rpm2targz utilise un
script ou un binaire rpm2cpio s'il y en a un dans votre PATH. Remarquez que
rpm2cpio extrait un rpm source dans le répertoire actuel, et donne une
archive tar, un fichier spec, et peut-être des correctifs ou d'autres
fichiers.</para>
  </tip>

</sect1>
