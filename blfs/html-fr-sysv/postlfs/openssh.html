<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      OpenSSH-8.7p1
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-914+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-914+
      </h4>
      <h3>
        Chapitre&nbsp;4.&nbsp;Sécurité
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="nss.html" title="NSS-3.69">Précédent</a>
          <p>
            NSS-3.69
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="p11-kit.html" title=
          "p11-kit-0.24.0">Suivant</a>
          <p>
            p11-kit-0.24.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title=
          "Chapitre&nbsp;4.&nbsp;Sécurité">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="openssh" name="openssh"></a>OpenSSH-8.7p1
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à OpenSSH
        </h2>
        <p>
          Le paquet <span class="application">OpenSSH</span> contient des
          clients <span class="command"><strong>ssh</strong></span> et le
          démon <span class="command"><strong>sshd</strong></span>. Il sert à
          chiffrer l'authentification et le trafic consécutif sur un réseau.
          Les commandes <span class="command"><strong>ssh</strong></span> et
          <span class="command"><strong>scp</strong></span> sont des
          implémentions sécurisées, respectivement de <span class=
          "command"><strong>telnet</strong></span> et de <span class=
          "command"><strong>rcp</strong></span>.
        </p>
        <p>
          This package still needs to be checked.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.7p1.tar.gz">
                https://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-8.7p1.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                f545230799f131aecca04da56e61990a
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 1.7&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 48&nbsp;Mo (plus
                18&nbsp;Mo pour les tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0.3 SBU (Using
                parallelism=4; running the tests takes 20+ minutes,
                irrespective of processor speed)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de OpenSSH
        </h3>
        <h4>
          Facultatives
        </h4>
        <p class="optional">
          <a class="xref" href="../general/gdb.html" title=
          "GDB-10.2">GDB-10.2</a> (pour les tests), <a class="xref" href=
          "linux-pam.html" title="Linux-PAM-1.5.1">Linux-PAM-1.5.1</a>,
          <a class="xref" href="../x/installing.html" title=
          "Chapitre&nbsp;24.&nbsp;Environnement X Window System">Système X
          Window</a>, <a class="xref" href="mitkrb.html" title=
          "MIT Kerberos V5-1.19.2">MIT Kerberos V5-1.19.2</a>, <a class=
          "ulink" href="http://www.thrysoee.dk/editline/">libedit</a>,
          <a class="ulink" href="http://www.libressl.org/">LibreSSL
          Portable</a>, <a class="ulink" href=
          "https://github.com/OpenSC/OpenSC/wiki">OpenSC</a> et <a class=
          "ulink" href=
          "http://www.citi.umich.edu/projects/smartcard/sectok.html">libsectok</a>
        </p>
        <h4>
          Facultatives pour l'exécution (Utilisé seulement pour modifier
          l'entropie)
        </h4>
        <p class="optional">
          <a class="xref" href="../general/openjdk.html" title=
          "OpenJDK-16.0.2">OpenJDK-16.0.2</a>, <a class="xref" href=
          "../basicnet/net-tools.html" title=
          "Net-tools-2.10">Net-tools-2.10</a> et <a class="xref" href=
          "../general/sysstat.html" title="Sysstat-12.5.4">Sysstat-12.5.4</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/OpenSSH">https://wiki.linuxfromscratch.org/blfs/wiki/OpenSSH</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de OpenSSH
        </h2>
        <p>
          <span class="application">OpenSSH</span> lance pas moins de deux
          processus en se connectant à d'autres ordinateurs. Le premier
          processus est un processus privilégié et il contrôle comme il faut
          l'émission de privilèges. Le deuxième processus communique avec le
          réseau. Des étapes d'installation supplémentaires sont nécessaires
          pour paramétrer le bon environnement, effectuées en lançant les
          commandes suivantes en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">install  -v -m700 -d /var/lib/sshd &amp;&amp;
chown    -v root:sys /var/lib/sshd &amp;&amp;

groupadd -g 50 sshd        &amp;&amp;
useradd  -c 'sshd PrivSep' \
         -d /var/lib/sshd  \
         -g sshd           \
         -s /bin/false     \
         -u 50 sshd</kbd></pre>
        <p>
          Installez <span class="application">OpenSSH</span> en lançant les
          commandes suivantes&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr                            \
            --sysconfdir=/etc/ssh                    \
            --with-md5-passwords                     \
            --with-privsep-path=/var/lib/sshd        \
            --with-default-path=/usr/bin             \
            --with-superuser-path=/usr/sbin:/usr/bin \
            --with-pid-dir=/run
make</kbd></pre>
        <p>
          La suite de tests demande l'installation d'une copie de
          <span class="command"><strong>scp</strong></span> pour finir les
          tests de multiplexage. Pour lancer la suite de tests, commencez par
          copier le programme <span class=
          "command"><strong>scp</strong></span> dans <code class=
          "filename">/usr/bin</code>, en faisant attention à sauvegarder
          toute copie déjà existante.
        </p>
        <p>
          Pour tester les résultats lancez&nbsp;: <span class=
          "command"><strong>make -j1 tests</strong></span>.
        </p>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
install -v -m755    contrib/ssh-copy-id /usr/bin     &amp;&amp;

install -v -m644    contrib/ssh-copy-id.1 \
                    /usr/share/man/man1              &amp;&amp;
install -v -m755 -d /usr/share/doc/openssh-8.7p1     &amp;&amp;
install -v -m644    INSTALL LICENCE OVERVIEW README* \
                    /usr/share/doc/openssh-8.7p1</kbd></pre>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <em class=
          "parameter"><code>--sysconfdir=/etc/ssh</code></em>&nbsp;: Ceci
          empêche les fichiers de configuration de s'installer dans
          <code class="filename">/usr/etc</code>.
        </p>
        <p>
          <em class="parameter"><code>--with-md5-passwords</code></em>&nbsp;:
          Cela autorise l'utilisation de mots de passe MD5.
        </p>
        <p>
          <em class=
          "parameter"><code>--with-default-path=/usr/bin</code></em> et
          <em class=
          "parameter"><code>--with-superuser-path=/usr/sbin:/usr/bin</code></em>&nbsp;:
          ces paramètres initialisent <code class="envar">PATH</code> en
          accord avec le paquet <span class="application">Shadow</span> de
          LFS et BLFS
        </p>
        <p>
          <em class="parameter"><code>--with-pid-dir=/run</code></em>&nbsp;:
          ceci empêche <span class="application">OpenSSH</span> d'utiliser
          <code class="filename">/var/run</code> qui est obsolète.
        </p>
        <p>
          <code class="option">--with-pam</code>&nbsp;: Ce paramètre active
          le support de <span class="application">Linux-PAM</span> dans la
          construction.
        </p>
        <p>
          <code class="option">--with-xauth=/usr/bin/xauth</code>&nbsp;:
          Règle l'emplacement par défaut du binaire <span class=
          "command"><strong>xauth</strong></span> pour l'authentification X.
          Modifiez l'emplacement si <span class=
          "command"><strong>xauth</strong></span> sera installé à un autre
          endroit. Vous pouvez aussi contrôler cela depuis <code class=
          "filename">sshd_config</code> avec le mot-clé XAuthLocation. Vous
          pouvez vous passer de cette option si <span class=
          "application">Xorg</span> est déjà installé.
        </p>
        <p>
          <code class="option">--with-kerberos5=/usr</code>&nbsp;: Cette
          option est utilisée pour inclure le support Kerberos 5 dans la
          construction.
        </p>
        <p>
          <code class="option">--with-libedit</code>&nbsp;: Cette option
          active les possibilités d'édition de lignes et d'historique pour
          <span class="command"><strong>sftp</strong></span>.
        </p>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration d'OpenSSH
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="openssh-config" name="openssh-config"></a>Fichiers de
            configuration
          </h3>
          <p>
            <code class="filename">~/.ssh/*</code>, <code class=
            "filename">/etc/ssh/ssh_config</code> et <code class=
            "filename">/etc/ssh/sshd_config</code>
          </p>
          <p>
            Aucune modification n'est nécessaire dans aucun de ces fichiers.
            Cependant, vous pourriez souhaiter relire les fichiers
            <code class="filename">/etc/ssh/</code> et effectuer les
            modifications adéquates pour la sécurité de votre système. Une
            des modifications recommandées est de désactiver la connexion en
            <code class="systemitem">root</code> via <span class=
            "command"><strong>ssh</strong></span>. Exécutez la commande
            suivante en tant qu'utilisateur <code class=
            "systemitem">root</code> pour désactiver la connexion
            <code class="systemitem">root</code> via <span class=
            "command"><strong>ssh</strong></span>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">echo "PermitRootLogin no" &gt;&gt; /etc/ssh/sshd_config</kbd></pre>
          <p>
            Si vous voulez vous loguer sans taper votre mot de passe,
            commencez par créer ~/.ssh/id_rsa et ~/.ssh/id_rsa.pub avec
            <span class="command"><strong>ssh-keygen</strong></span> et
            ensuite copiez ~/.ssh/id_rsa.pub dans ~/.ssh/authorized_keys sur
            l'ordinateur distant où vous voulez vous loguer. Vous devrez
            changer REMOTE_USERNAME et REMOTE_HOSTNAME par le nom d'hôte de
            l'ordinateur distant et vous devrez entrer votre mot de passe
            pour que la commande ssh réussisse&nbsp;:
          </p>
          <pre class="userinput"><kbd class="command">ssh-keygen &amp;&amp;
ssh-copy-id -i ~/.ssh/id_rsa.pub <em class=
"replaceable"><code>REMOTE_USERNAME</code></em>@<em class=
"replaceable"><code>REMOTE_HOSTNAME</code></em></kbd></pre>
          <p>
            Une fois que vous avez configuré un accès sans mot de passe,
            c'est en fait plus sécurisant que de vous connecter avec un mot
            de passe (puisque la clé privée est plus longue que la plupart
            des mots de passes). Si vous voulez maintenant désactiver la
            connexion avec mot de passe, en tant qu'utilisateur <code class=
            "systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">echo "PasswordAuthentication no" &gt;&gt; /etc/ssh/sshd_config &amp;&amp;
echo "ChallengeResponseAuthentication no" &gt;&gt; /etc/ssh/sshd_config</kbd></pre>
          <p>
            Si vous avez ajouté le support de <span class=
            "application">LinuxPAM</span> et que vous voulez que ssh
            l'utilise, vous devrez ajouter un fichier de configuration pour
            <span class="application">sshd</span> et permettre l'utilisation
            de <span class="application">LinuxPAM</span>. Remarquez que ssh
            n'utilise PAM que pour vérifier les mots de passe. Si vous avez
            désactivé le login par mot de passe, ces commandes sont inutiles.
            Lancez les commandes suivantes en tant qu'utilisateur
            <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">sed 's@d/login@d/sshd@g' /etc/pam.d/login &gt; /etc/pam.d/sshd &amp;&amp;
chmod 644 /etc/pam.d/sshd &amp;&amp;
echo "UsePAM yes" &gt;&gt; /etc/ssh/sshd_config</kbd></pre>
          <p>
            Vous pouvez trouver des informations de configuration
            supplémentaires dans les pages de man de <span class=
            "command"><strong>sshd</strong></span>, <span class=
            "command"><strong>ssh</strong></span> et de <span class=
            "command"><strong>ssh-agent</strong></span>.
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="openssh-init" name="openssh-init"></a>Script de démarrage
          </h3>
          <p>
            Pour lancer le serveur SSH au démarrage du système, installez le
            script de démarrage <code class=
            "filename">/etc/rc.d/init.d/sshd</code> fourni dans le paquet
            <a class="xref" href="../introduction/bootscripts.html" title=
            "Scripts de démarrage BLFS">blfs-bootscripts-20210810</a>.
          </p>
          <pre class="root"><kbd class=
          "command">make install-sshd</kbd></pre>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">scp, sftp, ssh, ssh-add, ssh-agent,
              ssh-copy-id, ssh-keygen, ssh-keyscan et sshd</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">Aucune</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/etc/ssh, /usr/share/doc/openssh-8.7p1 et
              /var/lib/sshd</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="scp" name="scp"></a><span class=
                    "term"><span class="command"><strong>scp</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un programme de copie de fichier agissant comme
                    <span class="command"><strong>rcp</strong></span> sauf
                    qu'il utilise un protocole chiffré
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="sftp" name="sftp"></a><span class=
                    "term"><span class=
                    "command"><strong>sftp</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un programme de genre FTP fonctionnant sur les
                    protocoles SSH1 et SSH2
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh" name="ssh"></a><span class=
                    "term"><span class="command"><strong>ssh</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un client du type <span class=
                    "command"><strong>rlogin</strong></span>/<span class=
                    "command"><strong>rsh</strong></span> sauf qu'il utilise
                    un protocole chiffré
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="sshd" name="sshd"></a><span class=
                    "term"><span class=
                    "command"><strong>sshd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un démon qui écoute les requêtes de connexion
                    <span class="command"><strong>ssh</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh-add" name="ssh-add"></a><span class=
                    "term"><span class=
                    "command"><strong>ssh-add</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un outil qui ajoute des clés à <span class=
                    "command"><strong>ssh-agent</strong></span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh-agent" name="ssh-agent"></a><span class=
                    "term"><span class=
                    "command"><strong>ssh-agent</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un agent d'authentification qui peut stocker des clés
                    privées
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh-copy-id" name="ssh-copy-id"></a><span class=
                    "term"><span class=
                    "command"><strong>ssh-copy-id</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un script qui permet de se connecter sur des machines
                    distantes en utilisant des clés locales
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh-keygen" name="ssh-keygen"></a><span class=
                    "term"><span class=
                    "command"><strong>ssh-keygen</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un outil de génération de clés
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="ssh-keyscan" name="ssh-keyscan"></a><span class=
                    "term"><span class=
                    "command"><strong>ssh-keyscan</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un outil pour réunir des clés d'hôte publiques à
                    partir d'un certain nombre d'hôtes
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="nss.html" title="NSS-3.69">Précédent</a>
          <p>
            NSS-3.69
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="p11-kit.html" title=
          "p11-kit-0.24.0">Suivant</a>
          <p>
            p11-kit-0.24.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title=
          "Chapitre&nbsp;4.&nbsp;Sécurité">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
