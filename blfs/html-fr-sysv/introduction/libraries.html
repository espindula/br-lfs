<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      Bibliothèques&nbsp;: statiques ou partagées&nbsp;?
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-914+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-914+
      </h4>
      <h3>
        Chapitre&nbsp;2.&nbsp;Informations importantes
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="la-files.html" title=
          "À propos des fichiers d'archive libtool (.la)">Précédent</a>
          <p>
            À propos des fichiers d'archive libtool (.la)
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="locale-issues.html" title=
          "Problèmes liés aux locales">Suivant</a>
          <p>
            Problèmes liés aux locales
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="important.html" title=
          "Chapitre&nbsp;2.&nbsp;Informations importantes">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="libraries" name="libraries"></a>Bibliothèques&nbsp;: statiques
        ou partagées&nbsp;?
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Bibliothèques&nbsp;: statiques ou partagées&nbsp;?
        </h2>
        <p>
          À l'origine les bibliothèques étaient simplement une archive de
          routines, à partir de laquelle on extrayait ou on liait les
          routines nécessaires dans l'exécutable. On appelle cela des
          bibliothèques statiques (libfoo.a). Sur certains systèmes
          d'exploitation anciens, ce sont les seules qui sont disponibles.
        </p>
        <p>
          Sur la plupart des plate-formes Linux, il y a aussi des
          bibliothèques partagées (libfoo.so) - une copie de la bibliothèque
          est chargée dans la mémoire virtuelle et partagée par tous les
          programmes qui appellent une de ses fonctions. C'est plus efficace
          en terme d'espace.
        </p>
        <p>
          Autrefois, des programmes essentiels tels que le shell étaient
          souvent liés de manière statique pour qu'il existe certaines formes
          de systèmes de secours minimaux, même en cas de bibliothèques
          partagées endommagées telles que libc.so (par exemple, déplacées
          dans <code class="filename">lost+found</code> après un fsck
          consécutif à une extinction brutale). Aujourd'hui, la plupart des
          gens utilisent une installation système alternative ou un Live CD
          s'ils ont besoin d'un sauvetage. Les systèmes de fichiers
          journalisés réduisent également la probabilité de ce genre de
          problème.
        </p>
        <p>
          Les développeurs, au moins pendant qu'ils développent, préfèrent
          souvent utiliser les versions statiques des bibliothèques
          auxquelles ils lient leur code.
        </p>
        <p>
          À plusieurs endroits du livre, des paramètres de configuration tels
          que <span class="command"><strong>--disable-static</strong></span>
          sont utilisés, et à d'autres endroits, vous avez la possibilité
          d'utiliser les versions du système des bibliothèques plutôt que les
          versions fournies par un autre paquet. Nous traitons cela pour
          simplifier les mises à jour des bibliothèques.
        </p>
        <p>
          Si un paquet est lié à une bibliothèque dynamique, la mise à jour
          de la bibliothèque se fait automatiquement une fois que la nouvelle
          bibliothèque est installée et le programme est (re)démarré (à
          condition que la version majeure de la bibliothèque reste
          inchangée, passant par exemple de libfoo.so.2.0 à
          libfoo.so.2.1&nbsp;: le passage à libfoo.so.3 exigera une
          recompilation - utilisez <span class=
          "command"><strong>ldd</strong></span> pour connaître les outils qui
          utilisent l'ancienne version). Si un programme est lié à une
          bibliothèque statique, il faut toujours recompiler le programme. Si
          vous connaissez les programmes liés à une bibliothèque statique en
          particulier, pas de problème. Mais en général, vous ne connaîtrez
          <span class="emphasis"><em>pas</em></span> les programmes qu'il
          faut recompiler.
        </p>
        <p>
          La plupart des bibliothèques sont partagées, mais si vous faites
          quelque chose de peu commun, par exemple si vous déplacez une
          bibliothèque partagée dans <code class="filename">/lib</code> et
          que vous cassez le lien symbolique <code class="literal">.so</code>
          dans <code class="filename">/usr/lib</code>, mais si vous laissez
          la bibliothèque statique dans <code class="filename">/lib</code>,
          la bibliothèque statique sera liée, de façon silencieuse, aux
          programmes qui en ont besoin.
        </p>
        <p>
          Une manière d'identifier si une bibliothèque statique est utilisée
          est de s'en préoccuper à la fin de l'installation de chaque paquet.
          Écrivez un script pour trouver toutes les bibliothèques statiques
          dans <code class="filename">/usr/lib</code> ou bien partout où vous
          installez, puis soit déplacez-les dans un autre répertoire de sorte
          que l'éditeur de liens ne les trouve plus, soit renommez-les pour
          que libfoo.a devienne par exemple libfoo.a.hidden. Vous pouvez
          alors restaurer temporairement une bibliothèque statique si
          nécessaire, et noter les paquets qui en ont besoin. Vous pouvez
          choisir d'exclure de glibc certaines bibliothèques statiques si
          vous faites cela (<code class="filename">libc_nonshared.a, libg.a,
          libieee.a, libm.a, libpthread_nonshared.a, librpcsvc.a,
          libsupc++.a</code>) pour simplifier la compilation.
        </p>
        <p>
          Si vous faites cela, il se peut que vous trouviez que plus de
          paquets que vous ne le pensiez utilisent une bibliothèque statique.
          C'était le cas avec <span class="application">nettle-2.4</span>
          dans sa configuration par défaut en statique seulement&nbsp;: il
          était exigé par <span class="application">GnuTLS-3.0.19</span>,
          mais aussi lié à des paquets qui utilisaient <span class=
          "application">GnuTLS-3.0.19</span>, tels que <span class=
          "application">glib-networking-2.32.3</span>.
        </p>
        <p>
          De nombreux paquets mettent certaines de leurs fonctions courantes
          dans une bibliothèque qui n'est utilisée que par les programmes du
          paquet et qui, surtout, <span class="emphasis"><em>n'est
          pas</em></span> installée en tant que bibliothèque autonome. Ces
          bibliothèques internes ne posent pas problème - si le paquet doit
          être reconstruit pour corriger un bogue ou une faille de sécurité,
          rien de plus ne s'y liera.
        </p>
        <p>
          Quand BLFS indique des bibliothèques Système, cela signifie les
          versions partagées. Certains paquets tels que <a class="xref" href=
          "../xsoft/firefox.html" title="Firefox-91.0.1">Firefox-91.0.1</a>
          et <a class="xref" href="../pst/gs.html" title=
          "ghostscript-9.54.0">ghostscript-9.54.0</a> incluent beaucoup
          d'autres bibliothèques. Quand elles s'y lient, elles le font de
          manière statique, donc cela également grossit les programmes. La
          version incluse est souvent plus ancienne que la version utilisée
          dans le système, donc il se peut qu'elle comporte des bogues -
          parfois les développeurs prennent la peine de corriger les bogues
          dans les bibliothèques qu'ils incluent, mais pas toujours.
        </p>
        <p>
          Parfois, décider d'utiliser les bibliothèques du système est
          facile. D'autres fois il se peut que vous deviez modifier la
          version du système (c'est le cas pour <a class="xref" href=
          "../general/libpng.html" title="libpng-1.6.37">libpng-1.6.37</a> si
          on l'utilise pour <a class="xref" href="../xsoft/firefox.html"
          title="Firefox-91.0.1">Firefox-91.0.1</a>). En outre, un paquet qui
          contient une ancienne bibliothèque ne peut plus se lier à la
          version actuelle, mais il peut se lier à une version moins
          ancienne&nbsp;: en général, le livre n'utilisera que la version
          incluse. Parfois, la bibliothèque incluse n'est plus développée de
          son côté, ou ses responsables en amont sont les mêmes que ceux du
          paquet et vous n'avez aucun autre paquet qui l'utilisera. Dans ces
          cas, vous pourriez décider d'utiliser la bibliothèque statique
          incluse même si vous préférez généralement utiliser les
          bibliothèques du système.
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/libraries">https://wiki.linuxfromscratch.org/blfs/wiki/libraries</a>
        </p>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="la-files.html" title=
          "À propos des fichiers d'archive libtool (.la)">Précédent</a>
          <p>
            À propos des fichiers d'archive libtool (.la)
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="locale-issues.html" title=
          "Problèmes liés aux locales">Suivant</a>
          <p>
            Problèmes liés aux locales
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="important.html" title=
          "Chapitre&nbsp;2.&nbsp;Informations importantes">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
