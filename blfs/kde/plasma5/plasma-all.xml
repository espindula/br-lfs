<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
 <!ENTITY % general-entities SYSTEM "../../general.ent">
 %general-entities;
  <!ENTITY plasma5-download-http "http://download.kde.org/stable/plasma/&plasma5-version;">
  <!ENTITY plasma5-download-ftp  " ">
  <!ENTITY plasma5-md5sum        "See Below">
  <!ENTITY plasma5-size          "129 Mo">
  <!ENTITY plasma5-buildsize     "933 Go">
  <!ENTITY plasma5-time          "15 SBU (using parallelism=6)">
]>
<sect1 id="plasma5-build" xreflabel="Plasma-&plasma5-version;">
  <?dbhtml filename="plasma-all.html"?>
  <sect1info>
     <othername>$LastChangedBy: bdubbs $</othername>
     <date>$Date: 2015-09-24 16:44:04 -0500 (Thu, 24 Sep 2015) $</date>
  </sect1info>
  <title>Construction de Plasma 5</title>
  <indexterm zone="plasma5-build">
     <primary sortas="a-kf5">KDE Plasma 5</primary>
  </indexterm>
  <para>KDE Plasma 5 est une collection de paquets basés sur KDE Frameworks
  5 et QML dérivé du bureau monolithique KDE 4. Ils implémentent l'environnement d'affichage KDE
  (Plasma 5).</para>

  <para>Les instructions suivantes construisent tous les paquets Plasma 5 en une étape en utilisant un script
  bash.  </para>
  <bridgehead renderas="sect3">Information sur le paquet </bridgehead>
  <itemizedlist spacing="compact">
    <listitem>
      <para>Téléchargement (HTTP) : <ulink url="&plasma5-download-http;"/></para>
    </listitem>
    <listitem>
      <para>Téléchargement (FTP) : <ulink url="&plasma5-download-ftp;"/></para>
    </listitem>
    <listitem>
      <para>Somme de contrôle MD5 du téléchargement : &plasma5-md5sum;</para>
    </listitem>
    <listitem>
      <para>Taille du téléchargement : &plasma5-size;</para>
    </listitem>
    <listitem>
      <para>Estimation de l'espace disque requis : &plasma5-buildsize;</para>
    </listitem>
    <listitem>
      <para>Estimation du temps de construction : &plasma5-time;</para>
    </listitem>
  </itemizedlist>
  <bridgehead renderas="sect3">Dépendances de Plasma 5</bridgehead>
  <bridgehead renderas="sect4">Requises</bridgehead>
  <para role="required">
    <xref linkend="kf5-frameworks"/>
  </para>
  
  <para condition="html" role="usernotes">Notes utilisateur :
  <ulink url="&blfs-wiki;/kf5"/></para>
  <sect2>
    <title>Téléchargement de KDE Frameworks</title>
    <para>
      La meilleure façon d'avoir les paquets de KDE Plasma5 est d'utiliser un seul
      <command>wget</command> pour les avoir tous en meme temps :
    </para>
 
<screen>
<userinput>url=http://download.kde.org/stable/plasma/&plasma5-version;/
wget -r -nH --cut-dirs=3 -A '*.xz' -np $url
<literal>
The options used here are: 
  -r            recurse through child directories
  -nH           disable generation of host-prefixed directories
  --cut-dirs=3  remove three levels of directories when saving
  -A '*.xz'     just get the *.xz files
  -np           don't get parent directories</literal></userinput>
</screen>
   </sect2>
  <sect2>
    <title>Initialisation de l'ordre des paquets</title>
    <para>
      L'ordre de construction des fichiers est important à cause des dépendances internes.
      Créez la liste des fichiers dans le bon ordre comme suivant:
    </para>
<screen>
<userinput>cat &gt; plasma-&kf5-version;.md5 &lt;&lt; "EOF"
<literal>cfff87d002b42b2487b522f94f157cb7  kwayland-5.4.1.tar.xz  
bc8fd24c6ecd0948fc5adb3bda096f88  libkscreen-5.4.1.tar.xz
c48b9030d7f5e86dc1f07091c3695758  libksysguard-5.4.1.tar.xz
bd5a8def665759beab8170acd80ca53f  breeze-5.4.1.tar.xz
91e85616bd899d2a610311b2ca1de622  kwin-5.4.1.tar.xz
a56031b9600712eabcc0f6baeb8a2947  oxygen-5.4.1.tar.xz
88522f2478fdff511e02102861dab620  oxygen-fonts-5.4.1.tar.xz
99df60a8b2cc2b5c0f924a7c36cd9ad3  khelpcenter-5.4.1.tar.xz
2aab5a329f2b4b196cd3e130bdf00bc6  kinfocenter-5.4.1.tar.xz
68a6ffc478a63002cb183e64d1630d80  ksysguard-5.4.1.tar.xz
2701f56228b6b45155b35a98a4a25df7  systemsettings-5.4.1.tar.xz
0675ac84f739218cd1a17cfdc3d91e22  plasma-workspace-5.4.1.tar.xz
33eb66bcec1c7f27b1a6a7629042de8e  bluedevil-5.4.1.tar.xz
56a3a65f21fe1b78c409129dfdc48d9e  khotkeys-5.4.1.tar.xz
5533875aea1883ce0d59cd72f1b05c24  kmenuedit-5.4.1.tar.xz
2d656cd96b0910129890973c4ee01d01  kscreen-5.4.1.tar.xz
6064bd41f2a7cdbe97a5be84e1a87fe3  kwrited-5.4.1.tar.xz
030248d066c81093a954de64e51d31bf  milou-5.4.1.tar.xz
528b5d70f64450a7d6e31f55dde2b155  plasma-nm-5.4.1.tar.xz
ff82dd9fdbaaf96a25f6a23f96bce5f7  plasma-workspace-wallpapers-5.4.1.tar.xz
0e27d8c01b108aa709a130466bc56a9a  polkit-kde-agent-1-5.4.1.tar.xz
cb6b2663a3fdac63561b87a340aa91df  powerdevil-5.4.1.tar.xz
823180ad53fafca7a6be56ab3f9ec2df  plasma-desktop-5.4.1.tar.xz
d91c7633eca6bad228003a168d6789b1  kdeplasma-addons-5.4.1.tar.xz
161710cb26d5fb123be4062656124934  kwayland-integration-5.4.1.tar.xz</literal>
EOF</userinput>
</screen>
  <para>Dans cette liste, notez que trois fichiers sont commentés avec #. L'entrée
  extra-cmake-modules est commentée car elle est construite précédement dans 
  <xref linkend="kde-prereq"/>. Les autres peuvent être construit si les dépendances facultatives
  sont installées.</para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de Plasma5</title>
    &as_root;
    <caution>
      <para>Pour une installation dans /opt et qu'il y a un /opt/kf5 existant, soit comme répertoire ou lien
      symbolique, il peut être supprimé (en tant que root):</para>
      
<screen>
<userinput>bash -e</userinput>
</screen>
    </caution>
    <para>
      Commencez par démarrer un sosu-shell qui sortira s'il y a une erreur:
    </para>
<screen>
<userinput>while read -r line; do
    # Get the file name, ignoring comments and blank lines
    if $(echo $line | grep -E -q '^ *$|^#' ); then continue; fi
    file=$(echo $line | cut -d" " -f2)
    
    pkg=$(echo $file|sed 's|^.*/||')          # Remove directory
    packagedir=$(echo $pkg|sed 's|.tar.*||') # Package directory
    tar -xf $file
    pushd $packagedir
       mkdir build
       cd    build
       cmake -DCMAKE_INSTALL_PREFIX=$KF5_PREFIX                   -DCMAKE_BUILD_TYPE=Debug                             -DLIB_INSTALL_DIR=lib                                -DBUILD_TESTING=OFF                                  -DQML_INSTALL_DIR=lib/qt5/qml                        -DQT_PLUGIN_INSTALL_DIR=lib/qt5/plugins              -DECM_MKSPECS_INSTALL_DIR=$KF5_PREFIX/share/qt5/mkspecs/modules              -DOXYGEN_FONT_INSTALL_DIR=/usr/share/fonts/truetype/oxygen                   -Wno-dev ..  &amp;&amp;
        make
        as_root make install
    popd
    rm -rf $packagedir
    as_root /sbin/ldconfig
done &lt; plasma-&kf5-version;.md5
exit</userinput>
</screen>
    <para>
      Installez tous les paquets en lançant la suite
       
    </para>
    <note><para>Tous les modules qui ont été oubliés peuvent être installés plus tard en utilisant la même
    procédure mkdir build; cd build; cmake; make; make install que précédement.</para></note>
    <para>Parfois les chemins d'installation sont codés en dure dans les fichiers installés.
    Si le répertoire installé n'est pas /usr, renomez le répertoire ou créez un lien symbolique:</para>
    
    
  </sect2>
    <sect2 role="commands">
    <title>Explications des commandes</title>
    <para>
      <parameter>-DCMAKE_PREFIX_PATH=$QT5DIR</parameter> : Ce paramètre est utilisé pour permettre
      à cmake de trouver les bonnes bibliothèques Qt.
    </para>
    <para>
      <parameter>-DCMAKE_BUILD_TYPE=Release</parameter> : Ce paramètre est utilisé pour appliquer le plus
      haut niveau d'optimisations du compilateur.
    </para>
    <para>
      <parameter>-DLIB_INSTALL_DIR=lib</parameter> : Ce paramètre est utilisé pour avoir les bibliothèques
      installés dans <filename
      class="directory">$KF5_PREFIX/lib</filename> au lieu de <filename
      class="directory">$KF5_PREFIX/lib64</filename> sur un système 64 bits.
    </para>
    <para>
      <parameter>-DBUILD_TESTING=OFF</parameter> : Ce paramètre est utilisé pour empêcher
      la construction des programmes et bibliothèques de test qui ne sont pas utilisés par un utilisateur.
    </para>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>
          checkXML5, depdiagram-generate, depdiagram-generate-all, depdiagram-prepare,
          desktoptojson, kactivitymanagerd, kbuildsycoca5, kconfig_compiler_kf5,
          kcookiejar5, kdebugdialog5, kded5, kdeinit5, kdeinit5_shutdown, kdeinit5_wrapper,
          kf5-config, kf5kross, kgenapidox, kgendesignerplugin, genframeworksapidox,
          kglobalaccel5, kiconfinder5, kjs5, kjscmd5, kjsconsole, kmailservice5,
          kpackagelauncherqml, kpackagetool5, kquitapp5, kreadconfig5, kshell5,
          ktelnetservice5, ktrash5, kwalletd5, kwrapper5, kwriteconfig5, meinproc5,
          plasmapkg2, preparetips5, et solid-hardware5
        </seg>
        <seg>
          libkdeinit5_kded5.so, libkdeinit5_klauncher.so, libKF5Activities.so,
          libKF5Archive.so, libKF5Attica.so, libKF5Auth.so, libKF5BluezQt.so,
          libKF5Bookmarks.so, libKF5Codecs.so, libKF5Completion.so,
          libKF5ConfigCore.so, libKF5ConfigGui.so, libKF5ConfigWidgets.so,
          libKF5CoreAddons.so, libKF5Crash.so, libKF5DBusAddons.so,
          libKF5Declarative.so, libKF5DNSSD.so, libKF5Emoticons.so,
          libKF5GlobalAccelPrivate.so, libKF5GlobalAccel.so, libKF5GuiAddons.so,
          libKF5I18n.so, libKF5IconThemes.so, libKF5IdleTime.so,
          libKF5ItemModels.so, libKF5ItemViews.so, libKF5JobWidgets.so, libKF5JSApi.so,
          libKF5JsEmbed.so, libKF5JS.so, libKF5KCMUtils.so, libKF5KDELibs4Support.so,
          libKF5KHtml.so, libKF5KIOCore.so, libKF5KIOFileWidgets.so, libKF5KIONTLM.so,
          libKF5KIOWidgets.so, libKF5KrossCore.so, libKF5KrossUi.so, libKF5MediaPlayer.so,
          libKF5ModemManagerQt.so, libKF5NetworkManagerQt.so, libKF5NewStuff.so,
          libKF5Notifications.so, libKF5NotifyConfig.so, libKF5Package.so,
          libKF5Parts.so, libKF5PeopleBackend.so, libKF5People.so,
          libKF5PeopleWidgets.so, libKF5PlasmaQuick.so, libKF5Plasma.so,
          libKF5Plotting.so, libKF5Pty.so, libKF5QuickAddons.so, libKF5Runner.so,
          libKF5Service.so, libKF5Solid.so, libKF5SonnetCore.so, libKF5SonnetUi.so,
          libKF5Style.so, libKF5Su.so, libKF5TextEditor.so, libKF5TextWidgets.so,
          libKF5ThreadWeaver.so, libKF5UnitConversion.so, libKF5Wallet.so,
          libKF5WebKit.so, libKF5WidgetsAddons.so, libKF5WindowSystem.so,
          libKF5XmlGui.so, libKF5XmlRpcClient.so, libKF5XsltKde.a, et
          libkwalletbackend5.so
        </seg>
        <seg>
          $KF5_PREFIX/include/KF5/{Attica,BluezQt,KActivities,KArchive,KAuth},
          $KF5_PREFIX/include/KF5/{KBookmarks,KCMUtils,KCodecs,KCompletion},
          $KF5_PREFIX/include/KF5/{KConfigCore,KConfigGui,KConfigWidgets,KCoreAddons},
          $KF5_PREFIX/include/KF5/{KCrash,KDBusAddons,KDeclarative,KDELibs4Support},
          $KF5_PREFIX/include/KF5/{KDESu,KDEWebKit,KDNSSD,KEmoticons,KGlobalAccel},
          $KF5_PREFIX/include/KF5/{KGuiAddons,KHtml,KI18n,KIconThemes,KIdleTime},
          $KF5_PREFIX/include/KF5/{kio,KIOCore,KIOFileWidgets,KIOWidgets},
          $KF5_PREFIX/include/KF5/{KItemModels,KItemViews,KJobWidgets,kjs,KJsEmbed},
          $KF5_PREFIX/include/KF5/{KMediaPlayer,KNewStuff3,KNotifications},
          $KF5_PREFIX/include/KF5/{KNotifyConfig,KPackage,KParts,KPeople,KPlotting},
          $KF5_PREFIX/include/KF5/{KPty,KrossCore,KrossUi,KRunner,KService,KStyle},
          $KF5_PREFIX/include/KF5/{KTextEditor,KTextWidgets,KUnitConversion,KWallet},
          $KF5_PREFIX/include/KF5/{KWidgetsAddons,KWindowSystem,KXmlGui},
          $KF5_PREFIX/include/KF5/{KXmlRpcClient,ModemManagerQt,NetworkManagerQt},
          $KF5_PREFIX/include/KF5/{plasma,Plasma,Solid,SonnetCore},
          $KF5_PREFIX/include/KF5/{SonnetUi,ThreadWeaver,wtf,XsltKde},
          $KF5_PREFIX/lib/cmake/{KDED,KDELibs4,KF5Activities,KF5Archive,KF5Attica},
          $KF5_PREFIX/lib/cmake/{KF5Auth,KF5BluezQt,KF5Bookmarks,KF5Codec},
          $KF5_PREFIX/lib/cmake/{KF5Completion,KF5Config,KF5ConfigWidgets},
          $KF5_PREFIX/lib/cmake/{KF5CoreAddons,KF5Crash,KF5DBusAddons},
          $KF5_PREFIX/lib/cmake/{KF5Declarative,KF5DesignerPlugin,KF5DNSSD},
          $KF5_PREFIX/lib/cmake/{KF5DocTools,KF5Emoticons,F5FrameworkIntegration},
          $KF5_PREFIX/lib/cmake/{KF5GlobalAccel,KF5GuiAddons,KF5I18n},
          $KF5_PREFIX/lib/cmake/{KF5IconThemes,KF5IdleTime,KF5Init},
          $KF5_PREFIX/lib/cmake/{KF5ItemModels,KF5ItemViews,KF5JobWidgets},
          $KF5_PREFIX/lib/cmake/{KF5JS,KF5JsEmbed,KF5KCMUtils},
          $KF5_PREFIX/lib/cmake/{KF5KDE4Support,KF5KDELibs4Support},
          $KF5_PREFIX/lib/cmake/{KF5KHtml,KF5KIO,KF5Kross,KF5MediaPlayer},
          $KF5_PREFIX/lib/cmake/{KF5ModemManagerQt,KF5NetworkManagerQt,KF5NewStuff},
          $KF5_PREFIX/lib/cmake/{KF5Notifications,KF5NotifyConfig,KF5Package},
          $KF5_PREFIX/lib/cmake/{KF5Parts,KF5People,KF5Plasma,KF5PlasmaQuick},
          $KF5_PREFIX/lib/cmake/{KF5Plotting,KF5Pty,KF5Runner,KF5Service},
          $KF5_PREFIX/lib/cmake/{KF5Solid,KF5Sonnet,KF5Su,KF5TextEditor},
          $KF5_PREFIX/lib/cmake/{KF5TextWidgets,KF5ThreadWeaver},
          $KF5_PREFIX/lib/cmake/{KF5UnitConversion,KF5Wallet,KF5WebKit},
          $KF5_PREFIX/lib/cmake/{KF5WidgetsAddons,KF5WindowSystem,KF5XmlGui},
          $KF5_PREFIX/lib/cmake/KF5XmlRpcClient,
          $KF5_PREFIX/lib/libexec/{kauth,kf5},
          $KF5_PREFIX/lib/python&python2-majorver;/site-packages/kapidox,
          $KF5_PREFIX/lib/qt5/{designer,imageformats,kactivitymanagerd},
          $KF5_PREFIX/lib/qt5/{kauth,kf5,org.kde.kglobalaccel5.platforms},
          $KF5_PREFIX/lib/qt5/{plasma,platformthemes,script},
          $KF5_PREFIX/lib/qml/org/kde/{activities,bluezqt,draganddrop},
          $KF5_PREFIX/lib/qml/org/kde/{kcoreaddons,kio,kquickcontrols},
          $KF5_PREFIX/lib/qml/org/kde/{kquickcontrolsaddons,kwindowsystem},
          $KF5_PREFIX/lib/qml/org/kde/{people,plasma,private,runnermodel},
          $KF5_PREFIX/lib/qml/org/kde/solid,
          $KF5_PREFIX/lib/qml/QtQuick/Controls/Styles/Plasma,
          $KF5_PREFIX/share/doc/HTML/*/{kdebugdialog5,kdoctools5-common,kioslave5},
          $KF5_PREFIX/share/emoticons/Glass,
          $KF5_PREFIX/share/{katepart5,knotifications5,kservices5,kservicetypes5},
          $KF5_PREFIX/share/kf5/{infopage,kactivitymanagerd,kauth,kcharselect},
          $KF5_PREFIX/share/kf5/{kconfigwidgets,kcookiejar,kdoctools,khtml,kjava},
          $KF5_PREFIX/share/kf5/{kjs,kmoretools,knewstuff,kpeople,kssl,kxmlgui},
          $KF5_PREFIX/share/kf5/{locale,sonnet,widgets},
          $KF5_PREFIX/share/kxmlgui5/{katepart,khtml}i, et
          $KF5_PREFIX/share/plasma/{desktoptheme,services}
        </seg>
      </seglistitem>
    </segmentedlist>
  </sect2>
</sect1>
