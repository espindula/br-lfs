<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
 <!ENTITY % general-entities SYSTEM "../../general.ent">
 %general-entities;
  <!ENTITY kf5-download-http "&kf5-download-http;">
  <!ENTITY kf5-download-ftp  "&kf5e-download-ftp;">
  <!ENTITY kf5-md5sum        "See Below">
  <!ENTITY kf5-size          "30 MB">
  <!ENTITY kf5-buildsize     "11.7 MB">
  <!ENTITY kf5-time          "0.4 SBU">
]>
<sect1 id="kf5-intro" xreflabel="Introduction to KF5">
  <?dbhtml filename="kf5-intro.html"?>
  <sect1info>
     <othername>$LastChangedBy: bdubbs $</othername>
     <date>$Date: 2015-06-26 14:39:08 -0500 (Fri, 26 Jun 2015) $</date>
  </sect1info>
  <title>Configuration de préinstallation de KDE Frameworks 5</title>
  <indexterm zone="kf5">
     <primary sortas="a-kf5">KDE Frameworks</primary>
  </indexterm>
  <para>KF5 peut être installé dans /usr ou /opt/kf5. Les éditeurs de BLFS
  recommandent la dernière dans un environement BLFS.
  </para>
  <sect2>
    <title>Installation dans /usr</title>
    <para>
      Une option est d'installer <application>KDE Frameworks 5</application>
      dans la hiérarchie <filename class="directory">/usr</filename>.
      Cela crée un simple setup mais rend plus difficile d'essayer des versions différentes de 
      <application>KDE Frameworks</application>.
    </para>
<screen>
<userinput>export KF5_PREFIX=/usr</userinput>
</screen>
    <para>
      C'est une bonne idée d'ajouter les variables suivantes à votre système ou à votre profile personnel:
    </para>
<screen role="root">
<userinput>cat &gt; /etc/profile.d/kf5.sh &lt;&lt; "EOF"
<literal># Begin /etc/profile.d/kf5.sh
export KF5_PREFIX=/usr
pathappend /usr/lib/qt5/plugins    QT_PLUGIN_PATH
pathappend $QT5DIR/lib/qt5/plugins QT_PLUGIN_PATH
pathappend /usr/lib/qt5/qml        QML_IMPORT_PATH
pathappend $QT5DIR/lib/qt5/qml     QML_IMPORT_PATH
pathappend /usr/lib/qt5/qml        QML2_IMPORT_PATH
pathappend $QT5DIR/lib/qt5/qml     QML2_IMPORT_PATH
# End /etc/profile.d/kf5.sh</literal>
EOF
cat &gt; /etc/profile.d/qt5.sh &lt;&lt; "EOF"
<literal># Begin Qt5 changes for KF5
pathappend $QT5DIR/lib/qt5/plugins  QT_PLUGIN_PATH
pathappend $QT5DIR/lib/qt5/qml      QML_IMPORT_PATH
pathappend $QT5DIR/lib/qt5/qml      QML2_IMPORT_PATH
# End Qt5 changes for KF5</literal>
EOF</userinput>
</screen>
    <note><para>Si <application>qt5</application> est installé dans /usr, la partie
    $QT5DIR/lib/ des chemins précédents doit être changée en 
    $QT5DIR/lib/qt5/.</para></note>

    <warning>
      <para>
        Si <application>KDE4</application> est installé dans 
        <filename class="directory">/usr</filename>, certains paquets de ce chapitre peuvent
        écraser certains programmes installés par les paquets
        <application>KDE4</application>.
      </para>
    </warning>
  </sect2>
  <sect2>
    <title>Installation dans /opt</title>
    <para>
      Une méthode d'installer plusieurs versions de 
      <application>KDE Frameworks 5</application> est de construire dans la hiérarchie
      <filename class="directory">/opt</filename> :
    </para>
<screen>
<userinput>export KF5_PREFIX=/opt/kf5</userinput>
</screen>
    <para>
      Si vous n'avez pas installé <application>KDE Frameworks 5</application>
      dans <filename class="directory">/usr</filename>, vous devrez faire des modifications de configurations
      supplémentaires. La meilleure pratique est d'ajouter cela à votre système ou profile personnel:
    </para>
<screen role="root">
<userinput>cat &gt; /etc/profile.d/kf5.sh &lt;&lt; "EOF"
<literal># Begin /etc/profile.d/kf5.sh
export KF5_PREFIX=/opt/kf5
pathappend $KF5_PREFIX/bin             PATH
pathappend $KF5_PREFIX/lib/pkgconfig   PKG_CONFIG_PATH
pathappend /etc/xdg                    XDG_CONFIG_DIRS
pathappend $KF5_PREFIX/etc/xdg         XDG_CONFIG_DIRS
pathappend /usr/share                  XDG_DATA_DIRS
pathappend $KF5_PREFIX/share           XDG_DATA_DIRS
pathappend /usr/lib/qt5/plugins        QT_PLUGIN_PATH
pathappend $KF5_PREFIX/lib/plugins     QT_PLUGIN_PATH
pathappend /usr/lib/qt5/qml            QML_IMPORT_PATH
pathappend $KF5_PREFIX/lib/qml         QML_IMPORT_PATH
pathappend /usr/lib/qt5/qml            QML2_IMPORT_PATH
pathappend $KF5_PREFIX/lib/qml         QML2_IMPORT_PATH
pathappend $KF5_PREFIX/lib/python&python2-majorver;/site-packages PYTHONPATH
# End /etc/profile.d/kf5.sh</literal>
EOF
cat &gt; /etc/profile.d/qt5.sh &lt;&lt; "EOF"
<literal># Begin /etc/profile.d/kf5.sh
# Begin Qt5 changes for KF5
pathappend $QT5DIR/plugins             QT_PLUGIN_PATH
pathappend $QT5DIR/qml                 QML_IMPORT_PATH
pathappend $QT5DIR/qml                 QML2_IMPORT_PATH
# End Qt5 changes for KF5</literal>
EOF</userinput>
</screen>
    <para>
      Complêtez votre fichier <filename>/etc/ld.so.conf</filename>:
    </para>
<screen role="root">
<userinput>cat &gt;&gt; /etc/ld.so.conf &lt;&lt; "EOF"
<literal># Begin KF5 addition
/opt/kf5/lib
# End KF5 addition</literal>
EOF</userinput>
</screen>
    <indexterm zone="kf5-intro">
      <primary sortas="e-etc-ld.so.conf">/etc/ld.so.conf</primary>
    </indexterm>
    <para>
      Plusieurs paquets de <application>KDE Frameworks 5</application> installent des fichiers
      dans les répertoires <application>D-Bus</application>. Quand on installe
      <application>KDE Frameworks 5</application> dans un endroit autre que 
      <filename class="directory">/usr</filename>,
      <application>D-Bus</application> doit pouvoir trouver ces fichiers.
      La façon la plus simple de faire cela est de créer le lien symbolique suivant (en tant
      qu'utilisateur <systemitem class="username">root</systemitem>):
    </para>
<screen role="root">
<userinput>install -v -dm755           $KF5_PREFIX/{etc,share} &amp;&amp;
ln -sfv /etc/dbus-1         $KF5_PREFIX/etc         &amp;&amp;
ln -sfv /usr/share/dbus-1   $KF5_PREFIX/share</userinput>
</screen>
    <para>
      Certains paquets peuvent aussi installer des icônes dans l'ensemble "hicolor". Depuis que cet ensemble
      d'icônes est utilisé par plusieurs paquets, c'est une bonne idée de créer un lien symbolique à celui dans
      <filename class="directory">/usr/share</filename>
      pour permetrre d'avoir des installations multiples de <xref linkend="hicolor-icon-theme"/>.
      Lancez les commandes suivantes en tant qu'utilisateur <systemitem class="username">root</systemitem>
      :
    </para>
<screen role="root">
<userinput>install -v -dm755                $KF5_PREFIX/share/icons &amp;&amp;
ln -sfv /usr/share/icons/hicolor $KF5_PREFIX/share/icons</userinput>
</screen>
    <tip>
      <para>
        Parfois, les chemins d'installation sont codés en durs dans les fichiers installés.
        C'est la raison pourquoi <filename class="directory">/opt/kf5</filename>
        est utilisé comme préfixe d'installation à la place de <filename
        class="directory">/opt/kf5-&kf5-version;</filename>. Après l'installation de 
        <application>KDE Frameworks</application>, vous pouvez renommer le répertoire et créer un lien symbolique:
      </para>
<screen role="root">
<userinput>mv /opt/kf5{,-&kf5-version;}
ln -sfv kf5-&kf5-version; /opt/kf5</userinput>
</screen>
      <para>
        Plus tard, vous pouvez vouloir installer d'autres version de
        <application>KDE Frameworks 5</application>. Pour faire cela, supprimez juste le lien symbolique et
        utilisez <filename class="directory">/opt/kf5</filename>
        de nouveau comme préfixe. La version de 
        <application>KDE Frameworks 5</application> que vous utilisez dépend seulement d'ou le lien
        symbolique pointe. Pas d'autres reconfigurations sera nécessaire.
      </para>
    </tip>
  </sect2>
</sect1>
