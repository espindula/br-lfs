Révision 16195

fichiers modifiés :
   packages.ent
   pst/typesetting/biber.xml
   introduction/welcome/changelog.xml

Log :
Use the released tarball for biblatex-biber-2.1.

Le robot a traité 22 % du commit anglais
Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 16194)
+++ introduction/welcome/changelog.xml	(révision 16195)
@@ -48,6 +48,10 @@
       <para>June 30th, 2015</para>
       <itemizedlist>
         <listitem>
+          <para>[ken] - Update to released version of blblatex-biber-2.1. Fixes
+          <ulink url="&blfs-ticket-root;6610">#6610</ulink>.</para>
+        </listitem>
+        <listitem>
           <para>[bdubbs] - Add opencv (Open Computer Vision).</para>
         </listitem>
         <listitem>

Index: pst/typesetting/biber.xml
===================================================================
--- pst/typesetting/biber.xml	(révision 16194)
+++ pst/typesetting/biber.xml	(révision 16195)
@@ -41,12 +37,9 @@
     <title>Introduction to biber</title>
 
     <para>Biber is a BibTeX replacement for users of biblatex, written in
-<application>Perl</application>. Upstream prefers to provide binaries
-and no longer offers a source tarball, so that has been taken from the
-git tree : see the file <filename>Fixes-from-git</filename> to see
-which changes (since 2.1 was tagged) have been included.</para>
+    <application>Perl</application>, with full Unicode support.</para>
 
-&gcc5_checked;
+    &lfs77_checked; &gcc5_checked;
 
     <bridgehead renderas="sect3">Package Information</bridgehead>
     <itemizedlist spacing="compact">
@@ -70,17 +63,22 @@
       </listitem>
     </itemizedlist>
 
-<bridgehead renderas="sect3">Required Additional Download</bridgehead>
+    <bridgehead renderas="sect3">Required Additional Downloads</bridgehead>
 
-<para>The corresponding version of <application>biblatex</application> is
-a separate project - the tds version is pre-packaged for untarring into
-the <filename class="directory">texmf-dist</filename> directory.</para>
     <itemizedlist spacing="compact">
       <listitem>
-<para>Download (HTTP): <ulink url="&biblatex-download-http;"/></para>
+        <para>
+          Required patch:
+          <ulink url="&patch-root;/biblatex-biber-&biber-version;-upstream_fixes-1.patch"/>
+        </para>
       </listitem>
       <listitem>
+      <para>The corresponding version of <application>biblatex</application> is
+      a separate project - the tds tarball is pre-packaged for untarring into
+      the <filename class="directory">texmf-dist</filename> directory.
+      Download (HTTP): <ulink url="&biblatex-download-http;"/></para>
+      </listitem>
+      <listitem>
         <para>Download MD5 sum: &biblatex-md5sum;</para>
       </listitem>
       <listitem>
@@ -107,7 +105,10 @@
       <xref linkend="perl-log-log4perl"/>
       <xref linkend="perl-lwp"/>
       <xref linkend="perl-list-allutils"/>
+      <!-- this is pulled in by perl-text-bibtex, but mention it explicitly
+      so that the note on automatically installing missing dependencies makes
+      more sense -->
+      <xref linkend="perl-module-build"/>
       <xref linkend="perl-regexp-common"/>
       <xref linkend="perl-text-bibtex"/>
       <xref linkend="perl-text-roman"/>
@@ -134,11 +135,32 @@
 
     <note>
       <para>
+        Although the tarball name is unversioned, it will untar to a
+        correctly-versioned biblatex-biber-&biber-version; directory.
+      </para>
+      <para>
         It is possible to install (all) missing dependencies automatically.
-Begin by running <command>perl ./Build.PL</command> and then when it
+        From <application>perl-5.22.0</application> onwards,
+        <xref linkend="perl-module-build"/> is no longer part of
+        the core distribution.  To automatically install the remaining perl
+        dependencies you will need to install that first.
+        You can then run <command>perl ./Build.PL</command> and when it
         prompts you, become the root user and run
         <command>./Build installdeps</command>
       </para>
+      <para>
+        If you run <command>./Build.PL</command> under versions of
+        <application>perl</application> after 5.20.2 it will tell you that the
+        version of <application>Unicode::Normalize</application> is too
+        <emphasis>new</emphasis>. In fact, the new version works, but is now
+        pure perl and takes longer to run : <emphasis>much</emphasis> longer
+        if you have a large bibliography.  You can find the old version at <ulink
+        url="http://backpan.perl.org/authors/id/S/SA/SADAHIRO/Unicode-Normalize-1.17.tar.gz"/>
+        and use the standard <xref linkend="perl-standard-install"/>
+        to install it if you wish. Further details are in the User Notes.
+      </para>
     </note>
 
     <para condition="html" role="usernotes">User Notes:
@@ -150,12 +172,19 @@
     <title>Installation of Biber</title>
 
     <para>Install <application>Biber</application> by running the following
-commands:</para>
+    commands (patching the read-only files will produce warnings):</para>
 
-<screen><userinput>perl ./Build.PL &amp;&amp;
+<screen><userinput>patch -Np1 -i ../biblate-biber-&biber-version;-upstream_fixes-1.patch &amp;&amp;
+sed -i 's/ 44/ 43/' t/bcfvalidation.t &amp;&amp;
+perl ./Build.PL &amp;&amp;
 ./Build</userinput></screen>
 
-<para>To test the results, enter: <command>./Build test</command></para>
+    <para>To test the results, enter: <command>./Build test</command> - you will
+    require the en_GB.UTF-8 and sv_SE.UTF-8 locales. Two tests (and two subtests)
+    will fail : for speed the tests use system locales instead of the default
+    Unicode::Collation algorithm, and some minor details of the locales in OSX
+    (where development takes place) differ from those in
+    <application>glibc</application></para>
 
     <para>Now, as the <systemitem class="username">root</systemitem> user:</para>
 
@@ -169,6 +198,19 @@
     <title>Command Explanations</title>
 
     <para>
+      <parameter>patch -Np1 -i
+      ../biblate-biber-&biber-version;-upstream_fixes-1.patch</parameter>:
+      <application>perl-5.22</application> has become more strict about
+      what needs to be escaped.
+    </para>
+    <para>
+      <parameter>sed -i 's/ 44/ 43/' t/bcfvalidation.t</parameter>: Although
+      the git master branch has 44 pairs of files for this test, the shipped
+      tarball only contains 43. The sed prevents it failing.
+    </para>
+    <para>
       <parameter>tar -xf biblatex-&biblatex-version;a.tds.tar.gz -C
       /opt/texlive/&texlive-year;/texmf-dist</parameter>:
       this installs the new <application>biblatex</application> files over those

