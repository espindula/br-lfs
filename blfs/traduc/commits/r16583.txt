Révision 16583

fichiers modifiés :
M       scripts/blfs-chapter36.php
M       scripts/blfs-chapter39.php
M       scripts/summ-blfs.php
M       scripts/blfs-include.php
M       scripts/blfs-chapter40.php
M       scripts/blfs-chapter43.php
M       scripts/blfs-chapter25.php
M       scripts/blfs-chapter26.php
M       scripts/blfs-chapter09.php
M       scripts/blfs-chapter27.php
M       scripts/blfs-chapter29.php
M       scripts/blfs-chapter12.php
M       scripts/blfs-chapter13.php
M       scripts/blfs-chapter14.php
M       scripts/blfs-chapter32.php
M       scripts/blfs-chapter17.php

Log :
General update for book and upstream changes

Le robot a traité 31 % du commit anglais
Index: scripts/blfs-chapter12.php
===================================================================
--- scripts/blfs-chapter12.php	(révision 16582)
+++ scripts/blfs-chapter12.php	(révision 16583)
@@ -9,15 +9,15 @@
 $STOP_PACKAGE  = 'zip';
 
 $renames = array();
-$renames[ 'at_'      ] = 'at';
+//$renames[ 'at_'      ] = 'at';
 $renames[ 'udisks1'  ] = 'udisks2';
 $renames[ 'sg'       ] = 'sg3_utils';
 $renames[ 'unrarsrc' ] = 'unrar';
-$renames[ 'p7zip_'   ] = 'p7zip';
+//$renames[ 'p7zip_'   ] = 'p7zip';
 
 $ignores = array();
 
-//$current="obex-data-server";
+//$current="at";
 
 $regex = array();
 $regex[ 'acpid'   ] = "/^.*Download acpid-(\d[\d\.]+\d).tar.*$/";
@@ -162,8 +162,8 @@
   if ( $book_index == "apache-ant" )
     return find_max( $lines, '/apache-ant/', '/^.*apache-ant-([\d\.]+)-src.tar.*$/' );
 
-if ( $book_index == "at_" )
-return find_max( $lines, '/at_/', '/^.*at_([\d\.]+).orig.tar.*$/' );
+  if ( $book_index == "at" )
+    return find_max( $lines, '/orig/', '/^.*at_([\d\.]+).orig.tar.*$/' );
 
   if ( $book_index == "dbus" )
     return find_even_max( $lines, '/dbus/', '/^.*dbus-(\d[\d\.]*\d).tar.*$/' );

Index: scripts/blfs-chapter13.php
===================================================================
--- scripts/blfs-chapter13.php	(révision 16582)
+++ scripts/blfs-chapter13.php	(révision 16583)
@@ -9,7 +9,7 @@
 $STOP_PACKAGE  = 'junit';
 
 $renames = array();
-$renames[ 'librep_'    ] = 'librep';
+//$renames[ 'librep_'    ] = 'librep';
 $renames[ 'py'         ] = 'pycairo';
 $renames[ 'Python'     ] = 'python2';
 #$renames[ 'python'     ] = 'python2 docs';
@@ -17,7 +17,7 @@
 #$renames[ 'python1'    ] = 'python3 docs';
 $renames[ 'pygobject'  ] = 'pygobject2';
 $renames[ 'pygobject1' ] = 'pygobject3';
-$renames[ 'junit4_'    ] = 'junit';
+//$renames[ 'junit4_'    ] = 'junit';
 
 $ignores = array();
 $ignores[ 'cfe'          ] = '';
@@ -36,12 +36,12 @@
 $ignores[ 'python'       ] = '';
 $ignores[ 'python1'      ] = '';
 
-//$current="jtreg";
+//$current="php";  // For debugging
 
 $regex = array();
 $regex[ 'check'   ] = "/^.*Download check-(\d[\d\.]+\d).tar.*$/";
@@ -476,9 +476,16 @@
        $position = strrpos( $dirpath, "/" );
        $dirpath  = substr ( $dirpath, 0, $position ) . "/$prev";
     }
+    
+    if ( $package == "npapi-sdk" )
+    {
+      # We have to process the stupid javascript to get this to work
+      exec( "lynx -dump  $dirpath", $output );
+      $max = find_max( $output, "/npapi-sdk/", "/^.*npapi-sdk-([\d\.]*\d)\.tar.*$/" );
+      return $max;
+    }
     $strip = "yes";
-if ( $package == "npapi-sdk" ) $strip = "no";
     $lines = http_get_file( $dirpath, $strip );
     if ( ! is_array( $lines ) ) return $lines;
   } // End fetch

Index: scripts/blfs-chapter14.php
===================================================================
--- scripts/blfs-chapter14.php	(révision 16582)
+++ scripts/blfs-chapter14.php	(révision 16583)
@@ -9,14 +9,14 @@
 $STOP_PACKAGE  = 'wireshark';
 
 $renames = array();
-$renames[ 'net-tools-CVS_'  ] = 'net-tools';
+//$renames[ 'net-tools-CVS_'  ] = 'net-tools';
 $renames[ 'wireless_tools.' ] = 'wireless_tools';
 $renames[ 'whois_'          ] = 'whois';
 $renames[ 'bind'            ] = 'bind9';
 
 $ignores = array();
 
-//$current="bind";
+//$current="samba";
 
 $regex[ 'bridge-utils'    ] = "/^.*Download bridge-utils-(\d[\d\.]+\d).tar.*$/";
 $regex[ 'nfs-utils'       ] = "/^.*Download nfs-utils-(\d[\d\.]+\d).tar.*$/";

Index: scripts/blfs-chapter25.php
===================================================================
--- scripts/blfs-chapter25.php	(révision 16582)
+++ scripts/blfs-chapter25.php	(révision 16583)
@@ -16,15 +16,17 @@
 $renames[ 'qt-everywhere-opensource-src'   ] = 'qt4';
 $renames[ 'qt-everywhere-opensource-src1'  ] = 'qt5';
 $renames[ 'webkitgtk'                      ] = 'webkitgtk+-2.4';
-$renames[ 'webkitgtk1'                     ] = 'webkitgtk+-2.8';
+$renames[ 'webkitgtk1'                     ] = 'webkitgtk+-2.10';
 
 $ignores = array();
 
-//$current="libxklavier"; // For debugging
+#$current="sddm"; // For debugging
 
 $regex = array();
 $regex[ 'freeglut' ] = "/^.*Download freeglut-(\d[\d\.]+\d).tar.*$/";
 $regex[ 'libepoxy' ] = "/^.*v(\d[\d\.]+\d).*$/";
+$regex[ 'lxdm'     ] = "/^.*Download lxdm-(\d[\d\.]+\d).tar.*$/";
+$regex[ 'sddm'     ] = "/^.*Version (\d[\d\.]+\d).*$/";
 
 $url_fix = array (
 
@@ -43,6 +45,14 @@
    array( 'pkg'     => 'libepoxy',
           'match'   => '^.*$', 
           'replace' => "https://github.com/anholt/libepoxy/releases" ),
+   
+   array( 'pkg'     => 'lxdm',
+          'match'   => '^.*$', 
+          'replace' => "http://sourceforge.net/projects/lxdm/files" ),
+   array( 'pkg'     => 'sddm',
+          'match'   => '^.*$', 
+          'replace' => "https://github.com/sddm/sddm/releases" ),
 );
 
 function get_packages( $package, $dirpath )

Index: scripts/blfs-chapter26.php
===================================================================
--- scripts/blfs-chapter26.php	(révision 16582)
+++ scripts/blfs-chapter26.php	(révision 16583)
@@ -9,7 +9,7 @@
 $STOP_PACKAGE  = 'sawfish';
 
 $renames = array();
-$renames[ 'sawfish_' ] = 'sawfish';
+//$renames[ 'sawfish_' ] = 'sawfish';
 
 $ignores = array();
 
@@ -94,6 +94,9 @@
      return 0;  // This is an error
   }
 
+  if ( $package == 'sawfish' )
+    return find_max( $lines, "/sawfish/", "/^.*sawfish_([\d\.]*\d)\.tar.*$/" );
   // Most packages are in the form $package-n.n.n
   // Occasionally there are dashes (e.g. 201-1)
 

Index: scripts/blfs-chapter27.php
===================================================================
--- scripts/blfs-chapter27.php	(révision 16582)
+++ scripts/blfs-chapter27.php	(révision 16583)
@@ -94,6 +94,8 @@
   }
   else // http
   {
+     if ( $book_index == "kdepimlibs"         ) return "check manually";
+     if ( $book_index == "oxygen-icons"       ) return "check manually";
      if ( $book_index == "kfilemetadata"      ) return "check manually";
      if ( $book_index == "kde-workspace"      ) return "check manually";
      if ( preg_match( '/baloo/', $book_index) ) return "check manually";

Index: scripts/blfs-chapter29.php
===================================================================
--- scripts/blfs-chapter29.php	(révision 16582)
+++ scripts/blfs-chapter29.php	(révision 16583)
@@ -17,7 +17,7 @@
 $regex = array();
 //$regex[ 'agg'      ] = "/^.*agg-(\d[\d\.]+\d).tar.*$/";
 
-//$current="polkit-qt-1";
+//$current="libkcddb";
 
 $url_fix = array (
 
@@ -73,13 +73,17 @@
      if ( $package == "konsole"          ||
           $package == "kdeplasma-addons" ||
           $package == "kate"             ||
+          $package == "ark"              ||
+          $package == "kmix"             ||
+          $package == "kdepim"           ||
+          $package == "kdepim-runtime"   ||
           $package == "gwenview" ) return "check manually";
 
      if ( ! is_array($kde_lines) )
      {
        $dirpath   = "http://download.kde.org/stable/applications/";
        $lines     = http_get_file( $dirpath );
-$kde_ver   = find_max( $lines, "/4\./", "/^.*;(1[\d\.]+\d)\/.*$/" );
+       $kde_ver   = find_max( $lines, "/1\d/", "/^.*;(1[\d\.]+\d)\/.*$/" );
        $kde_lines = http_get_file( "$dirpath/$kde_ver/src" );
      }
 
@@ -95,7 +99,7 @@
 
 function get_pattern( $line )
 {
-// Set up specific patter matches for extracting book versions
+   // Set up specific pattern matches for extracting book versions
 
    $match = array(
      array( 'pkg'   => 'libkexiv', 

Index: scripts/blfs-chapter32.php
===================================================================
--- scripts/blfs-chapter32.php	(révision 16582)
+++ scripts/blfs-chapter32.php	(révision 16583)
@@ -9,18 +9,18 @@
 $STOP_PACKAGE  = 'xfce4-notifyd';
 
 $renames = array();
-$renames[ 'midori_' ] = 'midori_';
+//$renames[ 'midori_' ] = 'midori_';
 
 $ignores = array();
 

Index: scripts/blfs-chapter36.php
===================================================================
--- scripts/blfs-chapter36.php	(révision 16582)
+++ scripts/blfs-chapter36.php	(révision 16583)
@@ -14,7 +14,7 @@
 
 $libreoffice = array();
 
-//$current="thunderbird";
+//$current="firefox";
 
 $regex = array();
 $regex[ 'inkscape'     ] = "/^.*Latest.*(\d[\d\.]+\d).*$/";
@@ -162,9 +162,9 @@
          $dirs = http_get_file( $dirpath );
 
          if ( $package == "seamonkey" )
-return find_max( $dirs, "/^\d\./", "/^(\d\.[\.\d]+)\/.*$/" );
+            return find_max( $dirs, "/\d\./", "/^(\d\.[\.\d]+)\/.*$/" );
          else 
-return find_max( $dirs, "/^\d/", "/^(\d{2}[\.\d]+)\/.*/" );
+            return find_max( $dirs, "/\d/", "/^.*(\d{2}[\.\d]+)\/.*/" );
      }
 
      if ( preg_match( "/abiword/", $dirpath ) )

Index: scripts/blfs-chapter39.php
===================================================================
--- scripts/blfs-chapter39.php	(révision 16582)
+++ scripts/blfs-chapter39.php	(révision 16583)
@@ -14,10 +14,11 @@
 $renames[ 'libvpx-v'        ] = 'libvpx';
 $renames[ 'v'               ] = 'fdk-aac';
 $renames[ 'x'               ] = 'x264';
+$renames[ 'x1'              ] = 'x265';
 
 $ignores = array();
 
-//$current="frei0r-snapshot";
+//$current="x265";
 
 $regex = array();
 $regex[ 'faac'             ] = "/^.*Download faac-(\d[\d\.]+\d).tar.*$/";
@@ -207,6 +208,14 @@
         return find_max( $lines, "/libmpeg3/", "/^.*libmpeg3-(\d[\d\.]+)-src.*$/" );
      }
 
+     if ( $package == "x265" )
+     {
+        # We have to process the stupid javascript to get this to work
+        exec( "lynx -dump  $dirpath", $output );
+        $max = find_max( $output, "/x265_/", "/^.*x265_([\d\.]*\d)\.tar.*$/" );
+        return $max;
+     }
      $lines = http_get_file( $dirpath );
 
      if ( ! is_array( $lines ) ) return $lines;
@@ -310,6 +319,9 @@
 
      array( 'pkg'   => 'v4l-utils', 
             'regex' => "/^.*v4l-utils-(\d[\d\.]+\d).*$/" ),
+     array( 'pkg'   => 'x265', 
+            'regex' => "/^.*x265_(\d[\d\.]+\d).*$/" ),
    );
 
    foreach( $match as $m )

Index: scripts/blfs-chapter40.php
===================================================================
--- scripts/blfs-chapter40.php	(révision 16582)
+++ scripts/blfs-chapter40.php	(révision 16583)
@@ -8,6 +8,8 @@
 $START_PACKAGE = 'mpg123';
 $STOP_PACKAGE  = 'libisofs';
 
+//$current="transcode";  // For debugging
 $renames = array();
 
 $ignores = array();
@@ -113,6 +115,14 @@
   }
   else // http
   {
+     if ( $package == "transcode" )
+     {
+       # We have to process the stupid javascript to get this to work
+       exec( "lynx -dump  $dirpath", $output );
+       $max = find_max( $output, "/transcode/", "/^.*transcode-([\d\.]*\d)\.tar.*$/" );
+       return $max;
+     }
      $lines = http_get_file( $dirpath );
      if ( ! is_array( $lines ) ) return $lines;
   } // End fetch

Index: scripts/blfs-chapter43.php
===================================================================
--- scripts/blfs-chapter43.php	(révision 16582)
+++ scripts/blfs-chapter43.php	(révision 16583)
@@ -13,12 +13,12 @@
 $ignores[ 'install-tl-unx' ] = '';
 $ignores[ 'texlive1'       ] = '';
 
-//$current="texlive";  // For debugging
+//$current="docbook-xsl-doc";  // For debugging
 
 $regex = array();
 $regex[ 'gutenprint'      ] = "/^.*Download gutenprint-(\d[\d\.]+\d).*$/";
 $regex[ 'OpenSP'          ] = "/^.*Download OpenSP-(\d[\d\.]+\d).*$/";
-$regex[ 'docbook-xsl-doc' ] = "/^.*Download docbook-xsl-(\d[\d\.]+\d).*$/";
+$regex[ 'docbook-xsl-doc' ] = "/^.*Download docbook-xsl-doc-(\d[\d\.]+\d).*$/";
 $regex[ 'paps'            ] = "/^.*Download paps-(\d[\d\.]+\d).tar.*$/";
 $regex[ 'asymptote'       ] = "/^.*Download asymptote-(\d[\d\.]+\d).*$/";
 $regex[ 'biblatex'        ] = "/^.*Download biblatex-(\d[\d\.]+\d).*$/";

Index: scripts/blfs-include.php
===================================================================
--- scripts/blfs-include.php	(révision 16582)
+++ scripts/blfs-include.php	(révision 16583)
@@ -151,6 +151,7 @@
 
       $basename = strstr( $file, $version, true );
       $basename = rtrim( $basename, "-" );
+      $basename = rtrim( $basename, "_" );
 
       if ( $basename == $START_PACKAGE ) $start = true;
       if ( ! $start ) continue;

Index: scripts/summ-blfs.php
===================================================================
--- scripts/summ-blfs.php	(révision 16582)
+++ scripts/summ-blfs.php	(révision 16583)
@@ -89,7 +89,7 @@
   if ( $c[3] == "0" ) $c[3] .= " ";
   $x    = substr("chapter $c[0]: $c[1]                         ", 0, 32);
   $x   .= substr("$c[2]                          ",  0, 25);
-$x   .= substr("$c[3]          ", 0, 12);
+  $x   .= substr("$c[3]           ", 0, 13);
 
   $tick = "";
 

