Révision 12157

fichiers modifiés :
   x/lib/qt4.xml
   x/lib/qt5.xml

Log :
change qt instructions to not modify file timestamp from other packages but still prevent breakage if deviating from book instructions

Le robot a traité 14 % du commit anglais
Index: x/lib/qt4.xml
===================================================================
--- x/lib/qt4.xml	(révision 12156)
+++ x/lib/qt4.xml	(révision 12157)
@@ -249,6 +249,14 @@
     </para>
 
     <para>
+      Remove references to the build directory from the
+      <filename class="extension">.pc</filename> files by running
+      the following command:
+    </para>
+<screen><userinput>find . -name "*.pc" -exec perl -pi -e "s, -L$PWD/?\S+,,g" {} \;</userinput></screen>
+    <para>
       Now, as the <systemitem class="username">root</systemitem> user:
     </para>
 
@@ -271,11 +279,12 @@
       <systemitem class="username">root</systemitem> user:
     </para>
 
-<screen role="root"><userinput>for file in `basename -a -s .prl /usr/lib/lib*.prl`; do
+<screen role="root"><userinput>for file in 3Support CLucene Core DBus Declarative DesignerComponents \
+            Designer Gui Help Multimedia Network OpenGL Script \
+            ScriptTools Sql Svg Test UiTools WebKit XmlPatterns Xml phonon
 do
-sed -i -e '/^QMAKE_PRL_BUILD_DIR/d;s/\(QMAKE_PRL_LIBS =\).*/\1/' \
-/usr/lib/${file}.prl
-perl -pi -e "s, -L$PWD/?\S+,,g" /usr/lib/pkgconfig/${file##lib}.pc
+  [ -e /usr/lib/libQt${file}.prl ] &amp;&amp; sed -i -e '/^QMAKE_PRL_BUILD_DIR/d;s/\(QMAKE_PRL_LIBS =\).*/\1/' \
+                                              /usr/lib/libQt${file}.prl
 done
 unset file</userinput></screen>
 
@@ -336,6 +345,14 @@
 make</userinput></screen>
 
     <para>
+      Remove references to the build directory from the
+      <filename class="extension">.pc</filename> files by running
+      the following command:
+    </para>
+<screen><userinput>find . -name "*.pc" -exec perl -pi -e "s, -L$PWD/?\S+,,g" {} \;</userinput></screen>
+    <para>
       Now, as the <systemitem class="username">root</systemitem> user:
     </para>
 
@@ -359,10 +376,12 @@
       <systemitem class="username">root</systemitem> user:
     </para>
 
-<screen role="root"><userinput>for file in `basename -a -s .prl $QTDIR/lib/lib*.prl`; do
-sed -i -e '/^QMAKE_PRL_BUILD_DIR/d;s/\(QMAKE_PRL_LIBS =\).*/\1/' \
-$QTDIR/lib/${file}.prl
-perl -pi -e "s, -L$PWD/?\S+,,g" $QTDIR/lib/pkgconfig/${file##lib}.pc
+<screen role="root"><userinput>for file in 3Support CLucene Core DBus Declarative DesignerComponents \
+            Designer Gui Help Multimedia Network OpenGL Script \
+            ScriptTools Sql Svg Test UiTools WebKit XmlPatterns Xml phonon;
+do
+  [ -e $QTDIR/lib/libQt${file}.prl ] &amp;&amp; sed -i -e '/^QMAKE_PRL_BUILD_DIR/d;s/\(QMAKE_PRL_LIBS =\).*/\1/' \
+                                                $QTDIR/lib/libQt${file}.prl
 done
 
 unset file</userinput></screen>

Index: x/lib/qt5.xml
===================================================================
--- x/lib/qt5.xml	(révision 12156)
+++ x/lib/qt5.xml	(révision 12157)
@@ -270,7 +270,7 @@
 
 <screen role="root"><userinput>sed -i -e "s:$PWD/qtbase:/usr/lib/qt5:g" \
     /usr/lib/qt5/mkspecs/modules/qt_lib_bootstrap.pri &amp;&amp;
-find /usr/lib/*.prl -exec sed -i -e \
+find /usr/lib/lib{qgsttools_p,Qt5*}.prl -exec sed -i -e \
      '/^QMAKE_PRL_BUILD_DIR/d;s/\(QMAKE_PRL_LIBS =\).*/\1/' {} \;</userinput></screen>
 
     <para>

