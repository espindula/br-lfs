Révision 12870

fichiers modifiés :
   general.ent
   general/prog/ruby.xml
   general/genlib/libatomic_ops.xml
   introduction/welcome/changelog.xml
   postlfs/security/ssh-askpass.xml
   postlfs/security/sudo.xml
   postlfs/security/openssh.xml

Log :
Updates to sudo-1.8.10p1, openssh-6.6p1, ssh-askpass-6.6p1 and libatomic_ops-7.4.0. Fix Ruby-2.1.1 to build with Readline-6.3. Thanks Armin K.

Le robot a traité 10 % du commit anglais
Index: general/genlib/libatomic_ops.xml
===================================================================
--- general/genlib/libatomic_ops.xml	(révision 12869)
+++ general/genlib/libatomic_ops.xml	(révision 12870)
@@ -7,11 +7,10 @@
   <!ENTITY libatomic_ops-download-http
            "http://www.hpl.hp.com/research/linux/atomic_ops/download/libatomic_ops-&libatomic_ops-version;.tar.gz">
   <!ENTITY libatomic_ops-download-ftp  " ">
-<!ENTITY libatomic_ops-md5sum        "7035692fec4db2659b06485040829e43">
-<!ENTITY libatomic_ops-size          "244 KB">
-<!ENTITY libatomic_ops-buildsize     "4.5 MB (additional 0.6 MB for tests)">
-<!ENTITY libatomic_ops-time          "Less than 0.1 SBU (additional less than
-0.1 SBU for tests)">
+  <!ENTITY libatomic_ops-md5sum        "59f9a7cc845dcc775e7b7901eb582766">
+  <!ENTITY libatomic_ops-size          "448 KB">
+  <!ENTITY libatomic_ops-buildsize     "5.3 MB (additional 0.9 MB for tests)">
+  <!ENTITY libatomic_ops-time          "less than 0.1 SBU (additional less than 0.1 SBU for tests)">
 ]>
 
 <sect1 id="libatomic_ops" xreflabel="libatomic_ops-&libatomic_ops-version;">
@@ -89,15 +88,12 @@
       commands:
     </para>
 
-<screen><userinput>sed -i 's#AM_CONFIG_HEADER#AC_CONFIG_HEADERS#' configure.ac &amp;&amp;
-sed -i 's#AC_PROG_RANLIB#AC_LIBTOOL_DLOPEN\nAC_PROG_LIBTOOL#' configure.ac &amp;&amp;
-sed -i 's#b_L#b_LTL#;s#\.a#.la#g;s#_a_#_la_#' src/Makefile.am &amp;&amp;
-sed -i 's#\.a#.so#g;s#\.\./src/#../src/.libs/#g' tests/Makefile.am &amp;&amp;
-sed -i 's#pkgdata#doc#' doc/Makefile.am &amp;&amp;
+<screen><userinput>sed -i 's#pkgdata#doc#' doc/Makefile.am &amp;&amp;
 autoreconf -fi &amp;&amp;
-./configure --prefix=/usr \
---docdir=/usr/share/doc/libatomic_ops-&libatomic_ops-version; \
---disable-static &amp;&amp;
+./configure --prefix=/usr    \
+            --enable-shared  \
+            --disable-static \
+            --docdir=/usr/share/doc/libatomic_ops-&libatomic_ops-version; &amp;&amp;
 make</userinput></screen>
 
     <para>
@@ -109,7 +105,10 @@
       Now, as the <systemitem class="username">root</systemitem> user:
     </para>
 
-<screen role="root"><userinput>make install</userinput></screen>
+<screen role="root"><userinput>make install &amp;&amp;
+mv -v   /usr/share/libatomic_ops/* \
+        /usr/share/doc/libatomic_ops-&libatomic_ops-version; &amp;&amp;
+rm -vrf /usr/share/libatomic_ops</userinput></screen>
 
   </sect2>
 
@@ -117,22 +116,19 @@
     <title>Command Explanations</title>
 
     <para>
-<command>sed -i 's#AM_CONFIG_HEADER ...</command>: This
-<command>sed</command> fixes building with
-<application>Automake</application> 1.13.
+      <command>sed -i ...</command>: This <command>sed</command> makes the docs
+      to be installed in an appropriate directory.
     </para>
 
     <para>
-<command>sed -i 's#AC_PROG_RANLIB ...</command>: These
-<command>sed</command>s massage the autotool files so that a shared
-library is built, the tests pass, and the docs are installed in an
-appropriate directory.
+      <command>autoreconf -fi</command>: This regenerates the
+      <command>configure</command> script and the
+      <filename>Makefile.in</filename>.
     </para>
 
     <para>
-<command>autoreconf -fi</command>: This regenerates the
-<command>configure</command> script and the <filename>Makefile.in</filename>
-files and installs a missing file.
+      <parameter>--enable-shared</parameter>: This switch enables building of the
+      <filename class="libraryfile">libatomic_ops</filename> shared libraries.
     </para>
 
     <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"

Index: general/prog/ruby.xml
===================================================================
--- general/prog/ruby.xml	(révision 12869)
+++ general/prog/ruby.xml	(révision 12870)
@@ -99,7 +99,11 @@
       commands:
     </para>
 
-<screen><userinput>./configure --prefix=/usr --docdir=/usr/share/doc/ruby-&ruby-version; --enable-shared &amp;&amp;
+<screen><userinput>sed -i ext/readline/readline.c \
+    -e "s:(Function \*)readline:(rl_hook_func_t \*)readline:" &amp;&amp;
+./configure --prefix=/usr   \
+            --enable-shared \
+            --docdir=/usr/share/doc/ruby-&ruby-version; &amp;&amp; 
 make</userinput></screen>
 
     <para>
@@ -118,7 +122,13 @@
     <title>Command Explanations</title>
 
     <para>
-<option>--enable-shared</option>: This switch enables building of
+      <command>sed -i  ext/readline/readline.c ...</command>: This
+      <command>sed</command> fixes building with
+      <application>Readline</application> 6.x (x>2).
+    </para>
+    <para>
+      <parameter>--enable-shared</parameter>: This switch enables building of
       the <filename class="libraryfile">libruby</filename> shared library.
     </para>
 

Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 12869)
+++ introduction/welcome/changelog.xml	(révision 12870)
@@ -48,6 +48,27 @@
       <para>March 16th, 2014</para>
       <itemizedlist>
         <listitem>
+          <para>[fernando] - Update to libatomic_ops-7.4.0. Fixes
+          <ulink url="&blfs-ticket-root;4812">#4812</ulink>.</para>
+        </listitem>
+        <listitem>
+          <para>[fernando] - Ruby-2.1.1 fails to build with Readline-6.3. 
+          Thanks Armin K. Fixes
+          <ulink url="&blfs-ticket-root;4810">#4810</ulink>.</para>
+        </listitem>
+        <listitem>
+          <para>[fernando] - Update to ssh-askpass-6.6p1. Fixes
+          <ulink url="&blfs-ticket-root;4809">#4809</ulink>.</para>
+        </listitem>
+        <listitem>
+          <para>[fernando] - Update to openssh-6.6p1. Fixes
+          <ulink url="&blfs-ticket-root;4807">#4807</ulink>.</para>
+        </listitem>
+        <listitem>
+          <para>[fernando] - Update to sudo-1.8.10p1. Fixes
+          <ulink url="&blfs-ticket-root;4806">#4806</ulink>.</para>
+        </listitem>
+        <listitem>
           <para>[pierre] - Add haveged. Fixes
           <ulink url="&blfs-ticket-root;4682">#4682</ulink>.</para>
         </listitem>
@@ -61,7 +82,7 @@
         </listitem>
         <listitem>
           <para>[fernando] - PCRE-8.34: build and security fixes for
-MariaDB-10.0.9.</para>
+          MariaDB-10.0.9. Thanks Bruce Dubbs.</para>
         </listitem>
       </itemizedlist>
     </listitem>

Index: postlfs/security/openssh.xml
===================================================================
--- postlfs/security/openssh.xml	(révision 12869)
+++ postlfs/security/openssh.xml	(révision 12870)
@@ -8,7 +8,7 @@
            "http://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-&openssh-version;.tar.gz">
   <!ENTITY openssh-download-ftp
            "ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-&openssh-version;.tar.gz">
-<!ENTITY openssh-md5sum        "a084e7272b8cbd25afe0f5dce4802fef">
+  <!ENTITY openssh-md5sum        "3e9800e6bca1fbac0eea4d41baa7f239">
   <!ENTITY openssh-size          "1.3 MB">
   <!ENTITY openssh-buildsize     "32 MB (additional 2 MB if running the tests)">
   <!ENTITY openssh-time          "0.5 SBU (running the tests takes at least 10
@@ -336,7 +336,7 @@
         </seg>
         <seg>
           /etc/ssh,
-/usr/lib/openssh,
+          /usr/libexec/openssh,
           /usr/share/doc/openssh-&openssh-version;, and
           /var/lib/sshd
         </seg>

Index: postlfs/security/ssh-askpass.xml
===================================================================
--- postlfs/security/ssh-askpass.xml	(révision 12869)
+++ postlfs/security/ssh-askpass.xml	(révision 12870)
@@ -8,7 +8,7 @@
     "http://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-&ssh-askpass-version;.tar.gz">
   <!ENTITY ssh-askpass-download-ftp
     "ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-&ssh-askpass-version;.tar.gz">
-<!ENTITY ssh-askpass-md5sum        "a084e7272b8cbd25afe0f5dce4802fef">
+  <!ENTITY ssh-askpass-md5sum        "3e9800e6bca1fbac0eea4d41baa7f239">
   <!ENTITY ssh-askpass-size          "1.3 MB">
   <!ENTITY ssh-askpass-buildsize     "6.4 MB">
   <!ENTITY ssh-askpass-time          "Less than 0.1 SBU">
@@ -104,12 +104,12 @@
       Now, as the <systemitem class="username">root</systemitem> user:
     </para>
 
-<screen role="root"><userinput>install -v -d -m755                  /usr/lib/openssh/contrib     &amp;&amp;
-install -v -m755  gnome-ssh-askpass2 /usr/lib/openssh/contrib     &amp;&amp;
-ln -sv -f contrib/gnome-ssh-askpass2 /usr/lib/openssh/ssh-askpass</userinput></screen>
+<screen role="root"><userinput>install -v -d -m755                  /usr/libexec/openssh/contrib     &amp;&amp;
+install -v -m755  gnome-ssh-askpass2 /usr/libexec/openssh/contrib     &amp;&amp;
+ln -sv -f contrib/gnome-ssh-askpass2 /usr/libexec/openssh/ssh-askpass</userinput></screen>
 
     <para>
-The use of /usr/lib/openssh/contrib and a symlink is justified by the
+     The use of /usr/libexec/openssh/contrib and a symlink is justified by the
      eventual necessity of a different program for that service.
     </para>
 
@@ -128,7 +128,7 @@
 
 <screen role="root"><userinput>cat &gt;&gt; /etc/sudo.conf &lt;&lt; "EOF" &amp;&amp;
 <literal># Path to askpass helper program
-Path askpass /usr/lib/openssh/ssh-askpass</literal>
+Path askpass /usr/libexec/openssh/ssh-askpass</literal>
 EOF
 chmod -v 0644 /etc/sudo.conf</userinput></screen>
 
@@ -160,7 +160,7 @@
           None
         </seg>
         <seg>
-/usr/lib/openssh/contrib
+          /usr/libexec/openssh/contrib
         </seg>
       </seglistitem>
     </segmentedlist>

Index: postlfs/security/sudo.xml
===================================================================
--- postlfs/security/sudo.xml	(révision 12869)
+++ postlfs/security/sudo.xml	(révision 12870)
@@ -6,10 +6,10 @@
 
   <!ENTITY sudo-download-http "http://www.sudo.ws/sudo/dist/sudo-&sudo-version;.tar.gz">
   <!ENTITY sudo-download-ftp  "ftp://ftp.sudo.ws/pub/sudo/sudo-&sudo-version;.tar.gz">
-<!ENTITY sudo-md5sum        "954d64906c3f6e2436f33445a049c58b">
+  <!ENTITY sudo-md5sum        "1d9c2bc5aaf02608343d17b9a666e8e1">
   <!ENTITY sudo-size          "2.2 MB">
   <!ENTITY sudo-buildsize     "25 MB (additional 1 MB for tests)">
-<!ENTITY sudo-time          "0.4 SBU">
+  <!ENTITY sudo-time          "0.5 SBU">
 ]>
 
 <sect1 id="sudo" xreflabel="Sudo-&sudo-version;">
@@ -100,11 +100,12 @@
       Install <application>Sudo</application> by running the following commands:
     </para>
 
-<screen><userinput>./configure --prefix=/usr                        \
---docdir=/usr/share/doc/sudo-&sudo-version;  \
---libexecdir=/usr/lib/sudo           \
---with-all-insults                   \
---with-env-editor                    \
+<screen><userinput>./configure --prefix=/usr              \
+            --libexecdir=/usr/lib/sudo \
+            --with-all-insults         \
+            --with-env-editor          \
+            --disable-static           \
+            --docdir=/usr/share/doc/sudo-&sudo-version; \
             --with-passprompt="[sudo] password for %p" &amp;&amp;
 make</userinput></screen>
 
@@ -144,6 +145,9 @@
       <parameter>--with-passprompt</parameter>: This switch sets the prompt.
     </para>
 
+    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
+      href="../../xincludes/static-libraries.xml"/>
     <note>
       <para>
         There are many options to <application>sudo</application>'s

