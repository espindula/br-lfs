Révision 15913

fichiers modifiés :
   general.ent
   packages.ent
   general/prog/java.xml
   general/prog/openjdk.xml
   introduction/welcome/changelog.xml

Log :
Update to OpenJDK-1.8.0.45

Le robot a traité 50 % du commit anglais
Index: general/prog/openjdk.xml
===================================================================
--- general/prog/openjdk.xml	(révision 15912)
+++ general/prog/openjdk.xml	(révision 15913)
@@ -279,7 +276,7 @@
     <bridgehead renderas="sect4">Optional</bridgehead>
     <para role="optional">
       <xref linkend="mercurial"/> and
-<xref linkend="twm"/> (for the tests)
+      an X Window manager such as <xref linkend="twm"/> (for the tests)
     </para>
 
     <para condition="html" role="usernotes">User Notes:
@@ -310,7 +307,7 @@
       If you have downloaded the test harness, unpack it too:
     </para>
 
-<screen><userinput>tar -xf ../jtreg&jtreg-version;.tar.gz</userinput></screen>
+<screen><userinput>tar -xf ../jtreg&jtreg-version;.tar.xz</userinput></screen>
 
 <!--TODO: it might be better to add instructions for the cacerts file at
 this place and to use the switch "with-cacerts-file" -->
@@ -322,7 +319,7 @@
 <screen><userinput>sed -e 's/DGifCloseFile(gif/&amp;, NULL/' \
     -e '/DGifOpen/s/c)/c, NULL)/'     \
     -i jdk/src/share/native/sun/awt/splashscreen/splashscreen_gif.c</userinput></screen>
+<!-- Seems to be corrected
     <para>
       Fix a bug in a shell script used to set the flags for
       <command>make</command>:
@@ -330,7 +327,7 @@
 
 <screen><userinput>sed 's/\([ \t]\)\]\([^\]\)/\1I]\2/g' \
     -i hotspot/make/linux/makefiles/adjust-mflags.sh</userinput></screen>
+-->
     <note>
       <para>
         Before proceeding, you should ensure that your environment
@@ -359,7 +356,9 @@
    --enable-unlimited-crypto  \
    --with-zlib=system         \
    --with-giflib=system       &amp;&amp;
-make DEBUG_BINARIES=true all</userinput></screen>
+make DEBUG_BINARIES=true all  &amp;&amp;
+find build/*/images/j2sdk-image -iname \*.diz -delete
+</userinput></screen>
 
     <para>
       It seems that the test infrastructure of OpenJDK is a work in
@@ -388,8 +387,8 @@
 xhost +</userinput></screen>
 
     <para>
-Then, it is necessary to modify some files (replace &lt;N&gt; with the
-number of JAVA VM allowed to run concurrently):
+      Then, it is necessary to modify some files<!-- (replace &lt;N&gt; with the
+      number of JAVA VM allowed to run concurrently)-->:
     </para>
 
 <screen role='nodump'><userinput>echo -e "
@@ -405,11 +404,12 @@
           sun/pisces          \\
           com/sun/java/swing" >> jdk/test/TEST.groups &amp;&amp;
 sed -e 's/all:.*jck.*/all: jtreg/'      \
--i langtools/test/Makefile          &amp;&amp;
+    -e '/^JTREG /s@\$(JT_PLATFORM)/@@'  \
+    -i langtools/test/Makefile<!--          &amp;&amp;
 sed -i 's@/win32@@' jdk/test/Makefile   &amp;&amp;
 sed -e 's@JTREG_HOME@JT_PLATFORM="" &amp;@' \
     -e 's@TEST="@CONCURRENCY=&lt;N&gt; &amp;@'    \
--i test/Makefile</userinput></screen>
+    -i test/Makefile--></userinput></screen>
 
     <para>
       Some variables have to be set:
@@ -432,16 +432,24 @@
                 -dir:$(pwd)/hotspot/test     \
                 -k:\!ignore                  \
                 -jdk:${PRODUCT_HOME}         \
--agentvm -conc:&lt;N&gt;           \
-:jdk</userinput></screen>
+<!--                -agentvm -conc:&lt;N&gt;           \
+-->                :jdk</userinput></screen>
 
     <para>
       The test results can be compared to
       <ulink url="http://download.java.net/openjdk/testresults/8/">these
-results</ulink>.
-Finally, stop the virtual frame buffer and clean up:
+      results</ulink>, although they usually are run on a newer version.
+      There are a few failures, the number of which depends on various
+      conditions, like whether the computer is connected to network. Also, some
+      test may timeout if the machine is under load.
     </para>
 
+    <para>
+      Next some cleanup has to be done. The instructions below only stop the
+      frame buffer, but it has been reported that some java VM may be left running
+      after the tests, so it is necessary to check orphaned processes:
+    </para>
 <screen role='nodump'><userinput>kill -9 `cat twm.pid`  &amp;&amp;
 kill -9 `cat Xvfb.pid` &amp;&amp;
 rm -f Xvfb.out twm.out &amp;&amp;
@@ -453,11 +461,7 @@
     <para>Install the package with the following commands as the
     <systemitem class="username">root</systemitem> user:</para>
 
-<screen role="root"><userinput>find build/*/images/j2sdk-image -iname \*.jar -exec chmod a+r {} \; &amp;&amp;
-chmod a+r build/*/images/j2sdk-image/lib/ct.sym &amp;&amp;
-find build/*/images/j2sdk-image -iname \*.diz -delete &amp;&amp;
-find build/*/images/j2sdk-image -iname \*.debuginfo -delete &amp;&amp;
-cp -R build/*/images/j2sdk-image /opt/OpenJDK-&openjdk-version; &amp;&amp;
+<screen role="root"><userinput>cp -R build/*/images/j2sdk-image /opt/OpenJDK-&openjdk-version; &amp;&amp;
 chown -R root:root /opt/OpenJDK-&openjdk-version;</userinput></screen>
 
     <para>

Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 15912)
+++ introduction/welcome/changelog.xml	(révision 15913)
@@ -45,6 +45,16 @@
 -->
 
     <listitem>
+      <para>May 2nd, 2015</para>
+      <itemizedlist>
+        <listitem>
+          <para>[pierre] - Update to Openjdk-1.8.0.45. Fixes
+          <ulink url="&blfs-ticket-root;6431">#6431</ulink>.</para>
+        </listitem>
+      </itemizedlist>
+    </listitem>
+    <listitem>
       <para>May 1st, 2015</para>
       <itemizedlist>
         <listitem>

