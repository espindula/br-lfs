Révision 14700

fichiers ajoutés :
   pst/typesetting/tex-path.xml
   pst/typesetting/texlive-pass1.xml

fichiers modifiés :
   introduction/welcome/changelog.xml
   pst/typesetting/tl-installer.xml
   pst/typesetting/typesetting.xml
   pst/typesetting/texlive.xml

Log :
Correct the date in the changelog, add texmf to allow texlive to be installed without the binary installer.

Le robot a traité 66 % du commit anglais

ATTENTION : il faut relire les fichiers suivants qui sont ajoutés
Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 14699)
+++ introduction/welcome/changelog.xml	(révision 14700)
@@ -45,9 +45,15 @@
 -->
 
     <listitem>
-<para>October 20th, 2014</para>
+      <para>October 21st, 2014</para>
       <itemizedlist>
         <listitem>
+          <para>[ken] - Add alternative texlive build method using texmf
+          without the binary installer, details in the Typesetting page for
+          chapter 48. Fixes <ulink url="&blfs-ticket-root;5443">#5443</ulink>.
+          </para>
+        </listitem>
+        <listitem>
           <para>[fernando] - Update to emacs-24.4.  Fixes 
           <ulink url="&blfs-ticket-root;5712">#5712</ulink>.</para>
         </listitem>

Index: pst/typesetting/texlive.xml
===================================================================
--- pst/typesetting/texlive.xml	(révision 14699)
+++ pst/typesetting/texlive.xml	(révision 14700)
@@ -23,7 +21,7 @@
     <date>$Date$</date>
   </sect1info>
 
-<title>texlive-&texlive-version;</title>
+  <title>texlive-&texlive-version;-source</title>
 
   <indexterm zone="texlive">
     <primary sortas="a-texlive">texlive</primary>
@@ -32,9 +30,10 @@
   <sect2 role="package">
     <title>Introduction to TeX Live from source</title>
 
-<para>A binary version of the <application>TeX Live</application> package
-is installed at <xref linkend="tl-installer"/>. Here, we use that to rebuild
-the compiled programs from source.</para>
+    <para>After installing a partial TeX build (or alternatively installing the
+    binary version), here we will build all of TeX Live from source (except
+    <application>biber</application> which is not supplied in the source tarball
+    and will be dealt with separately).</para>
 
     &lfs76_checked;
 
@@ -64,10 +63,8 @@
 
     <bridgehead renderas="sect4">Required</bridgehead>
     <para role="required">
-<xref linkend="tl-installer"/> or a previous version of TeX Live
-(untested, you would need to alter the configure switches which refer
-to &texlive-year; so that it overwrites your existing installation, or
-else copy everything to the location for the current year), and
+      Either <xref linkend="texpass1"/> or <xref linkend="tl-installer"/>
+      , and
       <xref linkend="clisp"/> (to build <command>xindy</command> which is an
       index processor for multi-lingual index creation)
     </para>
@@ -108,7 +105,7 @@
 
     <bridgehead renderas="sect4">Runtime dependencies</bridgehead>
     <para role="recommended">
-Some (re-installed) scripts will use
+      Some scripts will use
       <xref linkend="python2"/> or <xref linkend="ruby"/>.
     </para>
 
@@ -120,35 +117,16 @@
   <sect2 role="installation">
     <title>Installation of TeX Live</title>
 
-<para>These instructions will overwrite the corresponding files from the
-binary installer.  As with the installer, change x86_64-linux to whatever
-matches your architecture.</para>
+    <para>If you started with the binary installer, these instructions will
+    overwrite the programs it installed.</para>
 
-<para>Please note that installing from source will recompile the binary
-programs and recreate the <literal>man</literal> and <literal>info</literal>
-files.  It will also overwrite the scripts - some of these may be older
-versions than those from the newer installer.  It will <emphasis>not</emphasis>
-recreate any of the following: the more than 200 symlinks in the
-x86_64-linux directory (some are alternate names, many are pointers to
-the scripts), html files, PDF files, licenses, README files, two config
-files (<filename>texmf.cnf</filename> and <filename>texmfcnf.lua</filename>),
-nor the many package and font files in
-<filename class="directory">texmf-dist</filename> and
-<filename class="directory">texmf-var</filename>, nor the files recording
-the actions of the installer, and the <filename>ls-R</filename> files listing
-what was originally installed.</para>
-<para>Asy and the rest of asymptote is by default not rebuilt, so we have to
-separately run <command>configure</command> and <command>make</command> in its
-directory.
-</para>
-<screen><userinput>mkdir texlive-build &amp;&amp;
+<screen role="root"><userinput>export TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/') &amp;&amp;
+mkdir texlive-build &amp;&amp;
 cd texlive-build    &amp;&amp;
 
 ../configure                                        \
     --prefix=/opt/texlive/&texlive-year;                      \
---bindir=/opt/texlive/&texlive-year;/bin/x86_64-linux     \
+    --bindir=/opt/texlive/&texlive-year;/bin/$TEXARCH         \
     --datarootdir=/opt/texlive/&texlive-year;                 \
     --includedir=/usr/include                       \
     --infodir=/opt/texlive/&texlive-year;/texmf-dist/doc/info \
@@ -187,13 +165,14 @@
 
 ./configure LIBS="-ltirpc "                         \
     --prefix=/opt/texlive/&texlive-year;/                     \
---bindir=/opt/texlive/&texlive-year;/bin/x86_64-linux     \
+    --bindir=/opt/texlive/&texlive-year;/bin/$TEXARCH     \
     --enable-texlive-build                          \
     --datarootdir=/opt/texlive/&texlive-year;/texmf-dist      \
     --infodir=/opt/texlive/&texlive-year;/texmf-dist/doc/info \
     --mandir=/opt/texlive/&texlive-year;/texmf-dist/doc/man   \
    --cache-file=config.cache &amp;&amp; &amp;&amp;
 popd &amp;&amp;
+unset TEXARCH &amp;&amp;
 
 make &amp;&amp;
 make -C ../utils/asymptote</userinput></screen>
@@ -201,12 +180,21 @@
     <para>To test the results, issue: <command>make -k check &amp;&amp;
     make -C utils/asymptote check</command>.</para>
 
-<para>Now, as the <systemitem class="username">root</systemitem>
+    <para>If you have used the binary installer, you will want to
+    do a full install. As the <systemitem class="username">root</systemitem>
     user:</para>
 
-<screen><userinput role="root">make install &amp;&amp;
+<screen><userinput role="nodump">make install &amp;&amp;
 make -C ../utils/asymptote install</userinput></screen>
 
+    <para>For people who have followed the LFS way and built from source,
+    it is only necessary to install <application>xindy</application> and
+    <application>asy</application>, so, as the
+    <systemitem class="username">root</systemitem> user:</para>
+<screen><userinput role="root">make -C utils/xindy install &amp;&amp;
+make -C ../utils/asymptote install</userinput></screen>
     <para>One part of the package remains to be rebuilt:
     <xref linkend="biber"/>.</para>
 

Index: pst/typesetting/tl-installer.xml
===================================================================
--- pst/typesetting/tl-installer.xml	(révision 14699)
+++ pst/typesetting/tl-installer.xml	(révision 14700)
@@ -164,36 +164,8 @@
     the download will depend on your internet connection speed and the
     number of packages selected.</para>
 
-<para>After the package download is complete, the next step is to make sure
-that the system can properly find the files.  If you set up your login
-scripts as recommended in <xref linkend='postlfs-config-profile'/>, update
-the needed paths by appending to the
-<filename>extrapaths.sh</filename> script. The programs are always
-installed in an &lt;ARCH&gt;-linux subdirectory and on 32-bit x86 this is
-always i386-linux. For x86_64 and i?86 we can generate this as $TEXARCH:
-</para>
+    <para>Now proceed to <xref linkend="tex-path"/>.</para>
 
-<!-- EOF should NOT be in double quotes, we want it to evaluate $TEXARCH -->
-<screen role="root"><userinput>export TEXARCH=$(uname -m | sed -e 's/i.86/i386/' -e 's/$/-linux/') &amp;&amp;
-cat &gt;&gt; /etc/profile.d/extrapaths.sh &lt;&lt; EOF
-pathappend /usr/share/man                        MANPATH
-pathappend /opt/texlive/&texlive-year;/texmf-dist/doc/man  MANPATH
-pathappend /usr/share/info                       INFOPATH
-pathappend /opt/texlive/&texlive-year;/texmf-dist/doc/info INFOPATH
-pathappend /opt/texlive/&texlive-year;/bin/$TEXARCH
-EOF
-unset TEXARCH</userinput></screen>
-<note><para>The standard MANPATH and INFOPATH path are specified above to
-ensure they are included.  If they are already set in the boot script
-procedure, the pathappend function will ensure duplicates are
-removed, so including them here will do no harm.</para></note>
-<para>The new paths can be immediately activated by running <command>source
-/etc/profile</command>.</para>
-<para>At this point the binary installation is complete.</para>
   </sect2>
 
   <sect2 role="commands">

Index: pst/typesetting/typesetting.xml
===================================================================
--- pst/typesetting/typesetting.xml	(révision 14699)
+++ pst/typesetting/typesetting.xml	(révision 14700)
@@ -15,10 +15,40 @@
 
   <title>Typesetting</title>
 
-<para>This chapter includes applications that create output equivalent to
-typesetting.</para>
+  <para>This chapter includes <application>texlive</application> applications that
+  create output equivalent to typesetting.</para>
 
+  <para>There are two alternative routes through this chapter:</para>
+  <para>Some people may wish to use the binary installer, either because of the
+  complexity of installing all of <application>texlive</application> from
+  source, or because they only want a part of the package, or perhaps because
+  they wish to get updates as soon as those are available (the source is only
+  updated annually). These people should follow the <xref
+  linkend="tl-installer"/> instructions,. After installing, they can run
+  <command>tlmgr</command> to update their system.</para>
+  <para>Most people reading BLFS will wish to build from source. You can either
+  do as BLFS used to do, by starting with <application>install-tl-unx</application>,
+  or you can avoid the binary files completely and begin at
+  <xref linkend="texpass1"/> which will install most of
+  <application>texlive</application>, together with <emphasis>all</emphasis> of the
+  supporting files. This almost-complete install is then used to build two
+  remaining parts of <application>texlive</application>, xindy and asy (that
+  involves recompiling all of the package, but not reinstalling all of it).</para>
+  <para>Because the texmf files (including documentation, fonts, scripts and
+  supporting files) are all in one tarball, it is not practical to limit what
+  gets extracted in a sensible way (e.g. to exclude one or other of the typesetting
+  engines).</para>
+  <para>After that, people building from source will wish to install <xref
+  linkend="biber"/>, which is supplied separately, to complete the full
+  installation.</para>
   <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="tl-installer.xml"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="texlive-pass1.xml"/>
  <xi:include xmlns:xi="http://www.w3.org/2001/XInclude" href="tex-path.xml"/>

