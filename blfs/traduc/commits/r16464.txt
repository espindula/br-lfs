Révision 16464

fichiers modifiés :
   general.ent
   kde/core/config.xml
   x/dm/sddm.xml
   x/installing/xinit.xml
   introduction/welcome/changelog.xml
   xfce/core/xfce4-session.xml
   lxqt/desktop/post-install.xml
   postlfs/security/consolekit.xml
   lxde/desktop/lxde-common.xml

Log :
• Fix starting X with startx or sddm ... Part 2. ▪ sddm-0.12.0 ▪ xinit-1.3.4 ▪ ConsoleKit2-1.0.0 ▪ lxde-common-0.99.0 ▪ LXQt Desktop Final Instructions ▪ xfce4-session-4.12.1 ▪ Starting KDE4

Le robot a traité 6 % du commit anglais
Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 16463)
+++ introduction/welcome/changelog.xml	(révision 16464)
@@ -43,7 +43,19 @@
 
 -->
     <listitem>
+      <para>September 25th, 2015</para>
+      <itemizedlist>
+        <listitem>
+          <para>[fernando] - Fix starting X with startx ... Part 2.
+          Partially fixes
+          <ulink url="&blfs-ticket-root;6972">#6972</ulink>.</para>
+        </listitem>
+      </itemizedlist>
+    </listitem>
+    <listitem>
       <para>September 24th, 2015</para>
       <itemizedlist>
         <listitem>

Index: kde/core/config.xml
===================================================================
--- kde/core/config.xml	(révision 16463)
+++ kde/core/config.xml	(révision 16464)
@@ -17,9 +17,10 @@
 
   <bridgehead renderas="sect3">KDE4 Startup Dependencies</bridgehead>
 
-<bridgehead renderas="sect4">Optional</bridgehead>
-<para role="optional">
-<xref linkend="dbus"/> (runtime)
+  <bridgehead renderas="sect4">Recommended Runtime Dependencies</bridgehead>
+  <para role="recommended">
+    <xref linkend="consolekit"/> and
+    <xref linkend="dbus"/>
   </para>
 
   <para>After <application>Kde-workspace</application> has been installed, the
@@ -48,33 +49,36 @@
 
     <para>
       The X session starts on the first unused virtual terminal, normally vt7.
-You can switch to a vtn (n=1, 2, ...) simultaneously pressing the keys
-Ctrl-Alt-Fn. To switch back to the X session, normally started at vt7,
-use Ctrl-Alt-F7. If started from vt1 (the usual case), you will see many
-messages there, including X starting messages, applications automatically
-started with the session, and eventually, some warning and error
-messages. You may prefer to redirect those messages to a log file, which
-not only will keep vt1 uncluttered, but also can be used for debug
-purposes. This can be done starting X with:
+      You can switch to another vt<emphasis>n</emphasis> simultaneously
+      pressing the keys Ctrl-Alt-F<emphasis>n</emphasis>
+      (<emphasis>n</emphasis>=1, 2, ...).  To switch back to the X session,
+      normally started at vt7, use Ctrl-Alt-F7. The vt where the command
+      <command>startx</command> was executed will display many messages,
+      including X starting messages, applications automatically started with
+      the session, and eventually, some warning and error messages. You may
+      prefer to redirect those messages to a log file, which not only will keep
+      the initial vt uncluttered, but can also be used for debug purposes. This
+      can be done starting X with:
     </para>
 
     <screen><userinput>startx &amp;&gt; ~/.x-session-errors</userinput></screen>
 
-<para>
-You may wish to drop consolekit and/or dbus-launch, e.g., just using
-startlxde in .~/.xinitrc, but some functionalities such as mount/umount
-file systems from a file manager will not be possible, or the reboot
-option will be absent or not functioning, between other problems.
-</para>
+    <note>
+      <para>
+        You may wish to drop consolekit and/or dbus-launch, e.g., just using
+        startkde in .~/.xinitrc, but some functionalities such as mount/umount
+        file systems from a file manager will not be possible, or the reboot
+        option will be absent or not functioning, between other problems.
+      </para>
+    </note>
 
     <para>
-Because X is (normally) on vt7, when you shutdown the vt is switched back
-to that one where the command starting it was executed. In this case, if
-you wish to see the shutdown messages, simultaneously press keys Alt-F7,
-because normally those messages appear on the vt where X was running.
+      When shutting down or rebooting, the stopping messages appear on the vt
+      where X was running. If you wish to see those messages, simultaneously
+      press keys Alt-F7 (assuming that X was running on vt7).
     </para>
 
  </sect2>

Index: lxde/desktop/lxde-common.xml
===================================================================
--- lxde/desktop/lxde-common.xml	(révision 16463)
+++ lxde/desktop/lxde-common.xml	(révision 16464)
@@ -89,10 +89,15 @@
       <xref linkend="shared-mime-info"/>
     </para>
 
+    <bridgehead renderas="sect4">Recommended Runtime Dependencies</bridgehead>
+    <para role="recommended">
+      <xref linkend="consolekit"/> and
+      <xref linkend="dbus"/>
+    </para>
     <bridgehead renderas="sect4">Optional Runtime Dependencies</bridgehead>
     <para role="optional">
-<xref linkend="dbus"/>, and
-a notification daemon such as
+      A notification daemon such as
       <xref linkend="notification-daemon"/> or
       <xref linkend="xfce4-notifyd"/>
     </para>
@@ -156,30 +161,33 @@
 
     <para>
       The X session starts on the first unused virtual terminal, normally vt7.
-You can switch to a vtn (n=1, 2, ...) simultaneously pressing the keys
-Ctrl-Alt-Fn. To switch back to the X session, normally started at vt7,
-use Ctrl-Alt-F7. If started from vt1 (the usual case), you will see many
-messages there, including X starting messages, applications automatically
-started with the session, and eventually, some warning and error
-messages. You may prefer to redirect those messages to a log file, which
-not only will keep vt1 uncluttered, but also can be used for debug
-purposes. This can be done starting X with:
+      You can switch to another vt<emphasis>n</emphasis> simultaneously
+      pressing the keys Ctrl-Alt-F<emphasis>n</emphasis>
+      (<emphasis>n</emphasis>=1, 2, ...).  To switch back to the X session,
+      normally started at vt7, use Ctrl-Alt-F7. The vt where the command
+      <command>startx</command> was executed will display many messages,
+      including X starting messages, applications automatically started with
+      the session, and eventually, some warning and error messages. You may
+      prefer to redirect those messages to a log file, which not only will keep
+      the initial vt uncluttered, but can also be used for debug purposes. This
+      can be done starting X with:
     </para>
 
     <screen><userinput>startx &amp;&gt; ~/.x-session-errors</userinput></screen>
 
-<para>
-You may wish to drop consolekit and/or dbus-launch, e.g., just using
-startlxde in .~/.xinitrc, but some functionalities such as mount/umount
-file systems from a file manager will not be possible, or the reboot
-option will be absent or not functioning, between other problems.
-</para>
+    <note>
+      <para>
+        You may wish to drop consolekit and/or dbus-launch, e.g., just using
+        startlxde in .~/.xinitrc, but some functionalities such as mount/umount
+        file systems from a file manager will not be possible, or the reboot
+        option will be absent or not functioning, between other problems.
+      </para>
+    </note>
 
     <para>
-Because X is (normally) on vt7, when you shutdown the vt is switched back
-to that one where the command starting it was executed. In this case, if
-you wish to see the shutdown messages, simultaneously press keys Alt-F7,
-because normally those messages appear on the vt where X was running.
+      When shutting down or rebooting, the stopping messages appear on the vt
+      where X was running. If you wish to see those messages, simultaneously
+      press keys Alt-F7 (assuming that X was running on vt7).
     </para>
 
   </sect2>

Index: lxqt/desktop/post-install.xml
===================================================================
--- lxqt/desktop/post-install.xml	(révision 16463)
+++ lxqt/desktop/post-install.xml	(révision 16464)
@@ -41,7 +41,8 @@
       <xref linkend="sddm"/> (this has been
       reported as the <quote>recommended <application>LXQt</application>
       display manager</quote>) or another Display Manager, e.g.
-<xref linkend="lxdm"/>.
+      <xref linkend="lxdm"/>, and
+      <xref linkend="dbus"/>
     </para>
 
     <para condition="html" role="usernotes">
@@ -102,30 +103,33 @@
 
     <para>
       The X session starts on the first unused virtual terminal, normally vt7.
-You can switch to a vtn (n=1, 2, ...) simultaneously pressing the keys
-Ctrl-Alt-Fn. To switch back to the X session, normally started at vt7,
-use Ctrl-Alt-F7. If started from vt1 (the usual case), you will see many
-messages there, including X starting messages, applications automatically
-started with the session, and eventually, some warning and error
-messages. You may prefer to redirect those messages to a log file, which
-not only will keep vt1 uncluttered, but also can be used for debug
-purposes. This can be done starting X with:
+      You can switch to another vt<emphasis>n</emphasis> simultaneously
+      pressing the keys Ctrl-Alt-F<emphasis>n</emphasis>
+      (<emphasis>n</emphasis>=1, 2, ...).  To switch back to the X session,
+      normally started at vt7, use Ctrl-Alt-F7. The vt where the command
+      <command>startx</command> was executed will display many messages,
+      including X starting messages, applications automatically started with
+      the session, and eventually, some warning and error messages. You may
+      prefer to redirect those messages to a log file, which not only will keep
+      the initial vt uncluttered, but can also be used for debug purposes. This
+      can be done starting X with:
     </para>
 
     <screen><userinput>startx &amp;&gt; ~/.x-session-errors</userinput></screen>
 
-<para>
-You may wish to drop consolekit and/or dbus-launch, e.g., just using
-startlxde in .~/.xinitrc, but some functionalities such as mount/umount
-file systems from a file manager will not be possible, or the reboot
-option will be absent or not functioning, between other problems.
-</para>
+    <note>
+      <para>
+        You may wish to drop consolekit and/or dbus-launch, e.g., just using
+        startlxqt in .~/.xinitrc, but some functionalities such as mount/umount
+        file systems from a file manager will not be possible, or the reboot
+        option will be absent or not functioning, between other problems.
+      </para>
+    </note>
 
     <para>
-Because X is (normally) on vt7, when you shutdown the vt is switched back
-to that one where the command starting it was executed. In this case, if
-you wish to see the shutdown messages, simultaneously press keys Alt-F7,
-because normally those messages appear on the vt where X was running.
+      When shutting down or rebooting, the stopping messages appear on the vt
+      where X was running. If you wish to see those messages, simultaneously
+      press keys Alt-F7 (assuming that X was running on vt7).
     </para>
 
   </sect2>

Index: postlfs/security/consolekit.xml
===================================================================
--- postlfs/security/consolekit.xml	(révision 16463)
+++ postlfs/security/consolekit.xml	(révision 16464)
@@ -164,9 +164,9 @@
 
     <para>
       <parameter>--with-xinitrc-dir=/etc/X11/app-defaults/xinitrc.d</parameter>:
-Fix the localization of the 90-consolekit.sh script. Notice that the
-script was renamed, after installation, because xinitrc expects script
-names to have extension <emphasis>.sh</emphasis>.
+      Fix the location of the 90-consolekit.sh script. Notice that the script
+      has been renamed after installation, because xinitrc only sources script
+      names ending with extension <emphasis>.sh</emphasis>.
     </para>
 
     <para>

Index: x/dm/sddm.xml
===================================================================
--- x/dm/sddm.xml	(révision 16463)
+++ x/dm/sddm.xml	(révision 16464)
@@ -211,11 +211,22 @@
 
 <screen><userinput>sddm --example-config > sddm.example.conf</userinput></screen>
 
+      <note>
+        <para>
+          This command generates an <emphasis>example</emphasis> config file,
+          which depends on several conditions of the system where it is
+          generated. A few options are <emphasis>defaults</emphasis> from
+          upstream.  If there is a previously installed
+          <filename>/etc/sddm.conf</filename>, it will generate a replica. When
+          it is generated during an X session, some session configurations are
+          replicated, e.g. if the cursor from the Adwaita theme is already
+          configured, you will obtain <emphasis>CursorTheme=Adwaita</emphasis>
+          in the example file generated.
+        </para>
+      </note>
       <para>
-We repeat, this command generates an example config file.  If there is
-an already previously installed <filename>/etc/sddm.conf</filename>, it
-will generate a replica. If there is no yet the
-<filename>/etc/sddm.conf</filename> file, as the
+        If there is no <filename>/etc/sddm.conf</filename> file yet, as the
         <systemitem class="username">root</systemitem> user, copy the example
         file to <filename>/etc/sddm.conf</filename>:
       </para>
@@ -227,7 +238,7 @@
         in /opt, use your preferred editor as the
         <systemitem class="username">root</systemitem>
         user to replace the <emphasis>XauthPath</emphasis> default path by
-<emphasis>/usr/bin/xauth</emphasis>. Or, as the <systemitem
+        <emphasis>/opt/xorg/bin/xauth</emphasis>. Or, as the <systemitem
         class="username">root</systemitem> user, issue
       </para>
 
@@ -240,13 +251,12 @@
       </para>
 
       <para>
-From now on, we will describe how to modify configurations using sed,
-but of course you may rather use your preferred editor as the
-<systemitem class="username">root</systemitem>, instead. You generally
-want the server option that comes in sddm.example.conf, for security
-reasons.  Unless you want a remote machine to use the local X server,
-in which case, as the <systemitem class="username">root</systemitem>
-user, issue:
+        From now on, we will describe how to modify configurations using sed.
+        Of course, you may instead use your preferred editor as the <systemitem
+        class="username">root</systemitem> user. For security reasons, you
+        normally want the default server option in sddm.example.conf, unless a
+        remote machine needs access to the local X server. In that case, as the
+        <systemitem class="username">root</systemitem> user, issue:
       </para>
 
 <screen role="root"><userinput>sed -e 's/-nolisten tcp//'\
@@ -262,8 +272,8 @@
     -i /etc/sddm.conf</userinput></screen>
 
       <para>
-That was for Desktop users. For Notebook users,
-replace \"on\" by \"off\", in the command above.
+        for Desktop users. For Notebook users, replace \"on\" by \"off\",
+        in the command above.
       </para>
 
    </sect3>
@@ -352,7 +362,7 @@
       <title>Starting sddm</title>
 
       <para>
-If the sddm bootscript has been installed, start it by running, as
+        If the sddm bootscript has been installed, start sddm by running, as the
         <systemitem class="username">root</systemitem> user:
       </para>
 
@@ -456,10 +466,10 @@
 
       <para>
         E.g. <command>echo 'setxkbmap "fr,gb,br,us"' &gt;&gt;
-/usr/share/sddm/scripts/Xsetup</command>. You can be accurate defining
-the keyboard(s), for example: <command>echo 'setxkbmap -model pc105
--layout br,us -variant abnt2,dvorak -keycodes evdev' &gt;&gt;
-/usr/share/sddm/scripts/Xsetup</command>. See man setxkbmap.
+        /usr/share/sddm/scripts/Xsetup</command>. A very accurate definition
+        of the keyboard(s) is possible, for example: <command>echo 'setxkbmap
+        -model pc105 -layout br,us -variant abnt2,dvorak -keycodes evdev'
+        &gt;&gt; /usr/share/sddm/scripts/Xsetup</command>. See man setxkbmap.
       </para>
 
       <para>
@@ -472,8 +482,10 @@
 <screen role="root"><userinput>echo "source /etc/profile.d/dircolors.sh" &gt;&gt; /etc/bashrc</userinput></screen>
 
       <para>
-It has been reported that this package does not work with Xorg installed
-with a prefix other than <filename class="directory">/usr</filename>.
+        It has been reported that problems may happen with this package, if
+        Xorg is installed with a prefix other than <filename
+        class="directory">/usr</filename>. So far, BLFS development team has
+        not hit any problem, in this case.
       </para>
 
     </sect3>

Index: xfce/core/xfce4-session.xml
===================================================================
--- xfce/core/xfce4-session.xml	(révision 16463)
+++ xfce/core/xfce4-session.xml	(révision 16464)
@@ -197,30 +197,33 @@
 
     <para>
       The X session starts on the first unused virtual terminal, normally vt7.
-You can switch to a vtn (n=1, 2, ...) simultaneously pressing the keys
-Ctrl-Alt-Fn. To switch back to the X session, normally started at vt7,
-use Ctrl-Alt-F7. If started from vt1 (the usual case), you will see many
-messages there, including X starting messages, applications automatically
-started with the session, and eventually, some warning and error
-messages. You may prefer to redirect those messages to a log file, which
-not only will keep vt1 uncluttered, but also can be used for debug
-purposes. This can be done starting X with:
+      You can switch to another vt<emphasis>n</emphasis> simultaneously
+      pressing the keys Ctrl-Alt-F<emphasis>n</emphasis>
+      (<emphasis>n</emphasis>=1, 2, ...).  To switch back to the X session,
+      normally started at vt7, use Ctrl-Alt-F7. The vt where the command
+      <command>startx</command> was executed will display many messages,
+      including X starting messages, applications automatically started with
+      the session, and eventually, some warning and error messages. You may
+      prefer to redirect those messages to a log file, which not only will keep
+      the initial vt uncluttered, but can also be used for debug purposes. This
+      can be done starting X with:
     </para>
 
     <screen><userinput>startx &amp;&gt; ~/.x-session-errors</userinput></screen>
 
-<para>
-You may wish to drop consolekit and/or dbus-launch, e.g., just using
-startlxde in .~/.xinitrc, but some functionalities such as mount/umount
-file systems from a file manager will not be possible, or the reboot
-option will be absent or not functioning, between other problems.
-</para>
+    <note>
+      <para>
+        You may wish to drop consolekit and/or dbus-launch, e.g., just using
+        startxfce4 in .~/.xinitrc, but some functionalities such as mount/umount
+        file systems from a file manager will not be possible, or the reboot
+        option will be absent or not functioning, between other problems.
+      </para>
+    </note>
 
     <para>
-Because X is (normally) on vt7, when you shutdown the vt is switched back
-to that one where the command starting it was executed. In this case, if
-you wish to see the shutdown messages, simultaneously press keys Alt-F7,
-because normally those messages appear on the vt where X was running.
+      When shutting down or rebooting, the stopping messages appear on the vt
+      where X was running. If you wish to see those messages, simultaneously
+      press keys Alt-F7 (assuming that X was running on vt7).
     </para>
 
   </sect2>

Index: x/installing/xinit.xml
===================================================================
--- x/installing/xinit.xml	(révision 16463)
+++ x/installing/xinit.xml	(révision 16464)
@@ -79,6 +79,18 @@
 <screen><userinput>sed -e '/$serverargs $vtarg/ s/serverargs/: #&amp;/' \
     -i startx.cpp</userinput></screen>
 
+    <note>
+      <para>
+        If you have already installed this package without the sed above, there
+        is no need to reinstall. Just modify the installed
+        <command>startx</command>, issuing, as the <systemitem
+        class="username">root</systemitem> user:
+<screen role="root"><userinput>sed -e '/$serverargs $vtarg/ s/serverargs/: #&amp;/' \
+    -i.orig /usr/bin/startx</userinput></screen>
+      </para>
+    </note>
     <para>Install <application>xinit</application> by running the
     following commands:</para>
 

