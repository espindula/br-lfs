Révision 15947

fichiers modifiés :
   general/prog/openjdk.xml
   introduction/welcome/changelog.xml

Log :
Improve wording and explanations for OpenJDK tests and cacerts generation. Adapted from an HTML patch by Paul Rogers.

Le robot a traité 3 % du commit anglais
Index: general/prog/openjdk.xml
===================================================================
--- general/prog/openjdk.xml	(révision 15946)
+++ general/prog/openjdk.xml	(révision 15947)
@@ -247,7 +247,7 @@
       </listitem>
       <listitem>
         <para>
-Optional test harness: <ulink url="&jtreg-download;"/>
+          Recommended test harness: <ulink url="&jtreg-download;"/>
         </para>
       </listitem>
     </itemizedlist>
@@ -304,7 +304,7 @@
 tar -xf ../nashorn.tar.xz</userinput></screen>
 
     <para>
-If you have downloaded the test harness, unpack it too:
+      If you have downloaded the recommended test harness, unpack it too:
     </para>
 
 <screen><userinput>tar -xf ../jtreg&jtreg-version;.tar.xz</userinput></screen>
@@ -360,9 +360,26 @@
 find build/*/images/j2sdk-image -iname \*.diz -delete
 </userinput></screen>
 
+    <warning>
+      <para>
+        Although the test infrastructure of <application>OpenJDK</application>
+        is not easy to use, it is recommended to run the tests in order to
+        make sure that the JVM runs fine. A malfunctionning JVM may have
+        catastrophic consequences in term of security.
+      </para>
+    </warning>
+    <note>
+      <para>
+        Testing will involve the interplay of pairs of JVMs using the
+        networking interface, so networking must be started.  If it
+        isn't, not only will these tests fail, but the test cleanup
+        will leave orphaned JVMs running.  There will be many of
+        them.  Rebooting may be the easiest recovery.
+      </para>
+    </note>
     <para>
-It seems that the test infrastructure of OpenJDK is a work in
-progress, so that testing the newly built JVM involves several steps.
+      Testing the newly built JVM involves several steps.
       First, it is better to run the test suite in a frame buffer on a
       different display, using Xvfb:
     </para>
@@ -439,7 +456,7 @@
       The test results can be compared to
       <ulink url="http://download.java.net/openjdk/testresults/8/">these
       results</ulink>, although they usually are run on a newer version.
-There are a few failures, the number of which depends on various
+      Some failures can be expected, the number of which depends on various
       conditions, like whether the computer is connected to network. Also, some
       tests may timeout if the machine is under load.
     </para>
@@ -556,7 +573,7 @@
     </para>
 
     <para>
-<option>--with-jobs=N</option>: Allows to set the number
+      <option>--with-jobs=N</option>: Allows setting the number
       of jobs for <command>make</command> equal to N. The default is the
       result of a calculation involving the available memory and the number
       of processors. Note that even if you specify N=1, some parallelization
@@ -566,26 +583,22 @@
 
     <para>
       <option>--with-cacerts-file=...</option>: Specifies where to find a
-<filename>cacerts</filename> file. Otherwise, an empty one is created.
+      <filename>cacerts</filename> file, typically <filename>
+      /opt/jdk/jre/lib/security</filename>. Otherwise, an empty one is created.
       You can get it from an earlier version of the package, or use the
       script below to generate one.
     </para>
@@     @@
     </para>
 
     <para>
-<command>find ... -iname '*.jar' -exec chmod a+r {} \;</command>
-and following line: Fix permission in some library files, in order to
-allow all users to access them.
+      <command>find ... -iname '*.diz' -delete</command>: This command
+      removes redundant files.
     </para>
 
-<para>
-<command>find ... -iname '*.diz' -delete</command>: This command and the
-the next one remove redundant files.
-</para>
   </sect2>
 
   <sect2 role="configuration"
@@ -612,10 +625,12 @@
       (cacerts) file</title>
 
       <para>
-Use the following procedure to install the
-<filename>cacerts</filename> or to generate a new one if
-<xref linkend="cacerts"/> have been updated. First, if it is not
-already present, generate the <command>mkcacerts</command> script
+        <application>OpenJDK</application> uses its own format for the
+        CA certificates. Those certificates are located in a file named <filename>
+        /opt/jdk/jre/lib/security/cacerts</filename>. That file may be generated
+        from the one installed using the instructions on the <xref
+        linkend="cacerts"/> page, using the following procedure.
+        First, generate the <command>mkcacerts</command> script
         as the <systemitem class="username">root</systemitem> user:
       </para>
 
@@ -845,16 +860,19 @@
     </para>
   </note>
 
-<para>If you need to generate a <filename>cacerts</filename> file,
-and there is already one in
-<filename class="directory">/opt/jdk/jre/lib/security</filename>, it
-is better to make a backup. Then, you can create a new one, as the
-<systemitem class="username">root</systemitem> user:</para>
+    <para>
+      Generate the <application>OpenJDK</application> <filename>cacerts</filename>
+      file as the <systemitem class="username">root</systemitem> user:
+    </para>
 
-<screen role="root"><userinput>/opt/jdk/bin/mkcacerts            \
--d "/etc/ssl/certs/"      \
--k "/opt/jdk/bin/keytool" \
--s "/usr/bin/openssl"     \
+<screen role="root"><userinput>if [ -f /opt/jdk/jre/lib/security/cacerts ]; then
+  mv /opt/jdk/jre/lib/security/cacerts \
+     /opt/jdk/jre/lib/security/cacerts.bak
+fi &amp;&amp;
+/opt/jdk/bin/mkcacerts                 \
+        -d "/etc/ssl/certs/"           \
+        -k "/opt/jdk/bin/keytool"      \
+        -s "/usr/bin/openssl"          \
         -o "/opt/jdk/jre/lib/security/cacerts"</userinput></screen>
 
     <para>Use the following commands to check if the

Index: introduction/welcome/changelog.xml
===================================================================
--- introduction/welcome/changelog.xml	(révision 15946)
+++ introduction/welcome/changelog.xml	(révision 15947)
@@ -48,6 +48,10 @@
       <para>May 9th, 2015</para>
       <itemizedlist>
         <listitem>
+          <para>[pierre] - Improve wording an explanations for OpenJDK tests
+          and cacerts generation. Adapted from a patch by Paul Rogers.</para>
+        </listitem>
+        <listitem>
           <para>[fernando] - Update to libreoffice-4.4.3. Fixes
           <ulink url="&blfs-ticket-root;6475">#6475</ulink>.</para>
         </listitem>

