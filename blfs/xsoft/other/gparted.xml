<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY gparted-download-http
           "&sourceforge-repo;/gparted/gparted-&gparted-version;.tar.bz2">
  <!ENTITY gparted-download-ftp  " ">
  <!ENTITY gparted-md5sum        "ecd66491bb2061c6aa6077cc24823b9e">
  <!ENTITY gparted-size          "2.0 Mo">
  <!ENTITY gparted-buildsize     "77 Mo (ajouter 4 Mo pour construire la documentation facultative)">
  <!ENTITY gparted-time          "0.9 SBU">
]>
<sect1 id="gparted" xreflabel="gparted-&gparted-version;">
  <?dbhtml filename="gparted.html"?>
  <sect1info>
    <othername>$LastChangedBy&nbsp;: krejzi $</othername>
    <date>$Date&nbsp;: 2013-04-27 20:04:22 +0200 (sam. 27 avril 2013) $</date>
  </sect1info>
  <title>gparted-&gparted-version;</title>
  <indexterm zone="gparted">
    <primary sortas="a-gparted">gparted</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à Gparted</title>
    <para>
      Gparted est l'éditeur de partitions de Gnome, un GUI Gtk 2 pour d'autres outils en
      ligne de commande qui peut créer, réorganiser ou effacer des partitions de disques.
    </para>
   &lfs74_checked;
    <bridgehead renderas="sect3">Information sur le paquet </bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Téléchargement (HTTP)&nbsp;: <ulink url="&gparted-download-http;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&gparted-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
        <para>
          Somme de contrôle MD5 du téléchargement&nbsp;: &gparted-md5sum;
        </para>
      </listitem>
      <listitem>
        <para>
          Taille du téléchargement&nbsp;: &gparted-size;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation de l'espace disque requis&nbsp;: &gparted-buildsize;
        </para>
      </listitem>
      <listitem>
        <para>
          Estimation du temps de construction&nbsp;: &gparted-time;
        </para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de Gparted</bridgehead>
    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="gtkmm2"/>,
      <xref linkend="intltool"/> et
      <xref linkend="parted"/>.
    </para>
    <bridgehead renderas="sect4">Facultative</bridgehead>
    <para role="optional">
      <ulink url="&gnome-download-http;/gnome-doc-utils/">
      GNOME Doc Utils</ulink> et
      <xref linkend="rarian"/>.
    </para>
    <para condition="html" role="usernotes">
      Notes utilisateur&nbsp;: <ulink url="&blfs-wiki;/gparted"/>
    </para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de Gparted</title>
    <para>
      Installez <application>Gparted</application> en lançant les commandes suivantes&nbsp;:
      commands:
    </para>
<screen>
<userinput>./configure --prefix=/usr    \
            --disable-doc    \
            --disable-static &amp;&amp;
make</userinput>
</screen>
    <para>
      Ce paquet n'a pas de suite de tests.
    </para>
    <para>
      Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:
    </para>
<screen role="root">
<userinput>make install</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explications des commandes</title>
 
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/static-libraries.xml"/>
      <para><option>--disable-doc</option>&nbsp;: Cette option désactive la construction 
      optionnelle de la documentation. Enlevez la si vous avez installé 
       <application>GNOME Doc Utils</application>.
    </para>
  </sect2>
  <sect2 role="using">
    <title>utilisation de gparted</title>
    <para>
      Pour manipuler les systèmes de fichiers, Gparted a des dépendances d'exécutions à différents
      outils de systèmes de fichiers ( vous devez installer seulement les outils pour les systèmes
      que vous utilisez):
      e2fsprogs (installé comme un composant de LFS),
      <xref linkend="jfsutils"/>,
     <xref linkend="ntfs-3g"/>,
      <xref linkend="reiserfs"/>,
      <xref linkend="xfsprogs"/>,
      <ulink url="https://btrfs.wiki.kernel.org/index.php/Btrfs_source_repositories">
        btrfs-progs</ulink>,
      <ulink url="http://www.daniel-baumann.ch/software/dosfstools/">dosfstools</ulink>,
      <ulink url="http://ftp.gnu.org/pub/gnu/mtools/">mtools</ulink> (requis pour lire et
      écrire les labels et UUID des volumes FAT16/32),
      <ulink url="ftp://ftp.mars.org/pub/hfs/">hfsutils</ulink>,
      hfsprogs,
      <ulink url="http://www.nilfs.org/download/">nilfs-utils</ulink> et
      reiser4progs.
    </para>
    <para>
      Les privilèges Root sont requis pour lancer Gparted. Si vous souhaitez lancer l'application depuis le menu, des applications et des configurations
      supplémentaire sont nécessaires. Exemples d'applications qui peuvent être utilisées :
      <ulink url="http://people.debian.org/~kov/gksu">gksu</ulink>,
      <ulink url="https://launchpad.net/kdesudo">kdesudo</ulink>, ou
      <ulink url="https://github.com/tarakbumba/xdg-su">xdg-su</ulink>.
     Une autre solution est d'utiliser <application>pkexec</application>, de
      <xref linkend="polkit"/>, mais un peu de configuration est nécessaire.
      Une autre solution simple est 
     <application>gnome-ssh-askpass2</application> (qui ne nécessite pas
      <application>GNOME</application>). A la suite, nous décrivons ces deux alternatives: "ssh-askpass" et "pkexec".
   </para>
    <sect3 role="ssh-askpass">
      <title>ssh-askpass</title>
        <para>
          Pour utiliser facultativement <application>ssh-askpass</application>, vous devez avoir installé
	  <xref linkend="sudo"/> et <xref linkend="openssh"/>.
          Décompressez l'archive <xref linkend="openssh"/> et, dans le répertoire des sources
          , installez <application>ssh-askpass</application> avec les commandes suivantes:
        </para>
<screen>
<userinput>cd contrib &amp;&amp;
make gnome-ssh-askpass2</userinput>
</screen>
        <para>
          Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>:
        </para>
<screen role="root">
<userinput>install -v -d -m755                  /usr/lib/openssh/contrib     &amp;&amp;
install -v -m755  gnome-ssh-askpass2 /usr/lib/openssh/contrib     &amp;&amp;
ln -sv -f contrib/gnome-ssh-askpass2 /usr/lib/openssh/ssh-askpass</userinput>
</screen>
        <para>
          Restez en tant qu'utilisateur <systemitem class="username">root</systemitem>,
          configurez <xref linkend="gparted"/> et <xref linkend="sudo"/> pour utiliser
          <application>ssh-askpass</application>:
        </para>
<screen role="root">
<userinput>cp -v /usr/share/applications/gparted.desktop /usr/share/applications/gparted.desktop.back &amp;&amp;
sed -i 's/Exec=/Exec=sudo -A /'               /usr/share/applications/gparted.desktop      &amp;&amp;
cat &gt;&gt; /etc/sudo.conf &lt;&lt; "EOF" &amp;&amp;
# Path to askpass helper program
Path askpass /usr/lib/openssh/ssh-askpass
EOF
chmod -v 0644 /etc/sudo.conf</userinput>
</screen>
        <para>
         Maintenant, cliquez dans le menu de Gparted, une boite de dialogue apparaît à l'écran,
	 demandant le mot de passe de l'administrateur. Tous les programmes graphiques demandant les droits root peuvent être lancé en utilisant
	 "sudo -A &lt;program&gt;",
         par exemple, depuis un terminal, depuis un lanceur de bureau, ou pour l'inclure dans un fichier du bureau.
        </para>
    </sect3>
    <sect3 role="pkexec">
      <title>pkexec</title>
        <para>
          Pour utiliser facultativement <application>pkexec</application>, vous devez installer
          <xref linkend="which"/> (pour le script)
	  <xref linkend="polkit-gnome"/> ou <xref linkend="lxpolkit"/>, et
          <xref linkend="consolekit"/> avec le support
          <xref linkend="linux-pam"/> et <xref linkend="polkit"/>.
          En tant qu'utilisateur <systemitem class="username">root</systemitem> ,
          configurez <xref linkend="gparted"/> et <xref linkend="polkit"/> avec les commandes suivantes:
        </para>
<screen role="root">
<userinput>cp -v /usr/share/applications/gparted.desktop \
                                     /usr/share/applications/gparted.desktop.back &amp;&amp;
sed -i 's:/usr/sbin/gparted:/usr/sbin/gparted_polkit:' \
                                     /usr/share/applications/gparted.desktop      &amp;&amp;
cat &gt; /usr/sbin/gparted_polkit &lt;&lt; "EOF" &amp;&amp;
#!/bin/bash
if [ $(which pkexec) ]; then
    pkexec --disable-internal-agent "/usr/sbin/gparted" "$@"
else
    /usr/sbin/gparted "$@"
fi
EOF
chmod -v 0755 /usr/sbin/gparted_polkit</userinput>
</screen>
        <para>
          Restez en tant qu'utilisateur <systemitem class="username">root</systemitem>,
          configurez <xref linkend="polkit"/> et <xref linkend="gparted"/> pour utiliser <application>pkexec</application>:
        </para>
<screen role="root">
<userinput>cat &gt; /usr/share/polkit-1/actions/org.freedesktop.policykit.pkexec.policy &lt;&lt; "EOF"
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE policyconfig PUBLIC
 "-//freedesktop//DTD PolicyKit Policy Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/PolicyKit/1/policyconfig.dtd"&gt;
&lt;policyconfig&gt;
  &lt;action id="org.freedesktop.policykit.pkexec.run-gparted"&gt;
    &lt;description&gt;Run GParted&lt;/description&gt;
    &lt;message&gt;Authentication is required to run GParted&lt;/message&gt;
    &lt;defaults&gt;
      &lt;allow_any&gt;no&lt;/allow_any&gt;
      &lt;allow_inactive&gt;no&lt;/allow_inactive&gt;
      &lt;allow_active&gt;auth_admin_keep&lt;/allow_active&gt;
    &lt;/defaults&gt;
    &lt;annotate key="org.freedesktop.policykit.exec.path"&gt;/usr/sbin/gparted&lt;/annotate&gt;
    &lt;annotate key="org.freedesktop.policykit.exec.allow_gui"&gt;true&lt;/annotate&gt;
  &lt;/action&gt;
&lt;/policyconfig&gt;
EOF
chmod -v 0644 /usr/share/polkit-1/actions/org.freedesktop.policykit.pkexec.policy</userinput>
</screen>
        <para>
        Maintenant, cliquez dans le menu de Gparted, une boite de dialogue apparaît à l'écran,
	 demandant le mot de passe de l'administrateur. Tous les programmes graphiques demandant les droits root peuvent être lancé en utilisant
	 "pkexec &lt;program&gt;",
         par exemple, depuis un terminal, depuis un lanceur de bureau, ou pour l'inclure dans un fichier du bureau.
        </para>
    </sect3> 
</sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>bibliothèque installée</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>
          gparted et
          gpartedbin.
        </seg>
	<seg>Aucune</seg>
        <seg>
          /usr/share/gnome/help/gparted et
          /usr/share/omf/gparted.
        </seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Description courte</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="gparted-prog">
        <term><command>gparted</command></term>
        <listitem>
          <para>
            est un script shell qui initialise l'environnement avant d'appeler
            <command>gpartedbin</command>.
          </para>
          <indexterm zone="gparted gparted-prog">
            <primary sortas="b-gparted">gparted</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="gpartedbin">
        <term><command>gpartedbin</command></term>
        <listitem>
          <para>
            est le binaire de Gparted.
          </para>
          <indexterm zone="gparted gpartedbin">
            <primary sortas="b-gpartedbin">gpartedbin</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
  </sect1>
