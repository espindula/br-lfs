<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY gdm-download-http "&gnome-download-http;/gdm/&gnome-version;/gdm-&gdm-version;.tar.xz">
  <!ENTITY gdm-download-ftp  "&gnome-download-ftp;/gdm/&gnome-version;/gdm-&gdm-version;.tar.xz">
  <!ENTITY gdm-md5sum        "df3f38061066f5e0816676b4eef7854a">
  <!ENTITY gdm-size          "1.6 Mio">
  <!ENTITY gdm-buildsize     "59 Mio">
  <!ENTITY gdm-time          "0.7 SBU">
]>

<sect1 id="gdm" xreflabel="GDM-&gdm-version;">
  <?dbhtml filename="gdm.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: ken $</othername>
    <date>$Date&nbsp;: 2012-04-02 00:10:48 +0200 (Mon, 02 Apr 2012) $</date>
  </sect1info>

  <title>GDM-&gdm-version;</title>

  <indexterm zone="gdm">
    <primary sortas="a-GDM">GDM</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à GDM</title>

    <para>Le paquet <application>GDM</application> contient le démon du
    gestionnaire d'affichage de <application>GNOME</application>. C'est
    utile pour permettre des connexions graphiques configurables.</para>

    &lfs70_built;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&gdm-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&gdm-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &gdm-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &gdm-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &gdm-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &gdm-time;</para>
      </listitem>
    </itemizedlist>

    <!-- <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/gdm-&gdm-version;-fixes-1.patch"/></para>
      </listitem>
    </itemizedlist>-->

    <bridgehead renderas="sect3">Dépendances de GDM</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><xref linkend="accountsservice"/>,
    <xref linkend="gnome-panel"/>,
    <xref linkend="linux-pam"/> et
    <xref linkend="xorg7-lib"/></para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended"><xref linkend="consolekit"/>
    (Requis pour la fonitionnalité Shutdown/Restart) et
    <xref linkend="polkit-gnome"/></para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
    <xref linkend='check'/> (requis pour lancer la suite de tests),
    <xref linkend="upower"/>,
    <xref linkend="libxklavier"/>, et
    <xref linkend="tcpwrappers"/></para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/gdm"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de GDM</title>

    <para>Il est recommandé d'avoir un groupe et un utilisateur dédiés pour
    prendre le contrôle du démon <command>gdm-binary</command> après qu'il
    a été démarré. Lancez les commandes suivantes en tant qu'utilisateur
    <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role='root'><userinput>groupadd -fg 21 gdm &amp;&amp;
useradd -c "GDM Daemon Owner" -d /var/lib/gdm -u 21 \
    -g gdm -s /bin/false gdm  || [ $? == 9 ]</userinput></screen>

    <para>Installez <application>GDM</application> en lançant les commandes
    suivantes en tant qu'utilisateur non privilégié&nbsp;:</para>

<screen><userinput><!--patch -Np1 -i ../gdm-&gdm-version;-fixes-1.patch &amp;&amp;-->
./configure --prefix=$GNOME_PREFIX \
            --sysconfdir=$GNOME_SYSCONFDIR \
            --libexecdir=$GNOME_PREFIX/lib/gdm \
             --localstatedir=/var \
             --libexecdir=$(pkg-config \
             --variable=prefix ORBit-2.0)/lib/gdm \
             --with-pam-prefix=/etc \
             --enable-static=no &amp;&amp;
make</userinput></screen>

    <para>Si vous avez installé <xref linkend="check"/> et si vous souhaitez
    lancer la suite de tests, lancez&nbsp;: <command>make check</command>.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role='root'><userinput>make install &amp;&amp;
ln -fsv $GNOME_PREFIX/lib/gnome-settings-daemon-2.0/gnome-settings-daemon \
        $GNOME_PREFIX/lib/gdm &amp;&amp;-->
ln -fsv $GNOME_PREFIX/lib/gnome-settings-daemon/gnome-settings-daemon \
        $GNOME_PREFIX/lib/gdm &amp;&amp;
ln -fsv /usr/lib/ConsoleKit/ck-get-x11-display-device \
        $GNOME_PREFIX/lib/gdm &amp;&amp;
ln -fsv /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 \
        $GNOME_PREFIX/lib/gdm
</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
    href="../../xincludes/gnome-prefix.xml"/>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
    href="../../xincludes/gnome-sysconfdir.xml"/>

    <para><parameter>--libexecdir=$GNOME_PREFIX/lib/gdm</parameter>&nbsp;: Ce
    paramètre est utilisé pour que les programmes de support internes de
    <application>GDM</application> s'installent à l'endroit préféré <filename
    class='directory'>$GNOME_PREFIX/lib/gdm</filename> et non <filename
    class='directory'>$GNOME_PREFIX/libexec</filename>.</para>

    <para><parameter>--localstatedir=/var</parameter>&nbsp;: Cette commande
    met les fichiers dans <filename class="directory">/var</filename> et non
    dans <filename class="directory">$GNOME_PREFIX/var</filename>.</para>

    <para><parameter>--with-pam-prefix=/etc</parameter>&nbsp;: Cette commande
    met les fichiers de configuration de <application>PAM</application> dans
    <filename class="directory">/etc/pam.d</filename> au lieu de
    <filename class="directory">$GNOME_SYSCONFDIR</filename>.</para>

    <para><parameter>--enable-static=no</parameter>&nbsp;: Ce paramèqee empêche
    les bibliothèques statiques de s'installer.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de GDM</title>

    <sect3 id="gdm-config">
      <title>Fichiers de configuration</title>

      <para><filename>$GNOME_SYSCONFDIR/gdm/custom.conf</filename></para>

      <indexterm zone="gdm gdm-config">
        <primary sortas="e-etc-gnome-&gnome-version;&gnome-minor-version;gdm-custom.conf">
        $GNOME_SYSCONFDIR/gdm/custom.conf</primary>
      </indexterm>
      
    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Le démon GDM est configuré en utilisant le fichier
      <filename>$GNOME_SYSCONFDIR/gdm/custom.conf</filename>.
      Les valeurs par défaut sont stockées dans GConf dans le fichier
      <filename>gdm.schemas</filename>. Il est recommandé que les utilisateurs finaux
      modifient le fichier <filename>$GNOME_SYSCONFDIR/gdm/custom.conf</filename>
      car le fichier schemas peut être écrasé par les utilisateurs mettent à jour leur 
	  système pour avoir une nouvelle version de GDM.</para>

      <para>Les fichiers de configuration <application>PAM</application> de
      <application>GDM</application> contiennent des modules non présents dans
      installation de BLFS. Si vous avez installé
      <application>PAM</application>, lancez les commandes suivantes
      en tant qu'utilisateur <systemitem class="username">root</systemitem> 
      pour remplacer ces fichiers par des fichiers contenant les modules
      correctement spécifiés&nbsp;:</para>

<screen role="root"><userinput>cat &gt; /etc/pam.d/gdm &lt;&lt; "EOF"
<literal>auth        required    pam_env.so
auth        required    pam_unix.so
account     required    pam_nologin.so
account     required    pam_unix.so
password    required    pam_unix.so
session     optional    pam_keyinit.so force revoke
session     required    pam_unix.so
session     required    pam_loginuid.so
session     optional    pam_console.so</literal>

EOF
cat &gt; /etc/pam.d/gdm-autologin &lt;&lt; "EOF"
<literal>auth        required    pam_env.so
account     required    pam_nologin.so
account     required    pam_unix.so
password    required    pam_unix.so
session     optional    pam_keyinit.so force revoke
session     required    pam_unix.so
session     required    pam_loginuid.so
session     optional    pam_console.so</literal>

EOF
cat &gt; /etc/pam.d/gdm-welcome &lt;&lt; "EOF"
<literal>auth        required    pam_env.so
auth        required    pam_permit.so
account     required    pam_nologin.so
account     required    pam_unix.so
password    required    pam_unix.so
session     required    pam_loginuid.so
session     optional    pam_keyinit.so force revoke
session     required    pam_unix.so</literal>

EOF</userinput></screen>

      <indexterm zone="gdm gdm-config">
        <primary sortas="e-etc-pam.d-gdm">/etc/pam.d/gdm</primary>
      </indexterm>
      <indexterm zone="gdm gdm-config">
        <primary
        sortas="e-etc-pam.d-gdm-autologin">/etc/pam.d/gdm-autologin</primary>
      </indexterm>

      <para id="gdm-config-dbus">Si vous avez installé <application>D-BUS</application>
      et si vous voulez démarrer le démon de la session
      <application>D-BUS</application> quand vous démarrez un environnement de
      bureau GNOME en utilisant <command>gdm</command>, vous devrez créer 
      un nouveau fichier Xsession. Créez le fichier en utilisant la commande
      suivante en tant qu'utilisateur root.</para>

<screen role="root"><userinput>cat &gt; $GNOME_PREFIX/share/xsessions/gnome-dbus.desktop &lt;&lt; "EOF"
<literal>[Desktop Entry]
Encoding=UTF-8
Name=GNOME with D-BUS
Comment=GNOME Desktop with D-BUS support
Exec=dbus-launch --exit-with-session gnome-session
TryExec=/usr/bin/dbus-launch
Icon=
Type=Application</literal>

EOF
chmod -v 644 $GNOME_PREFIX/share/xsessions/gnome-dbus.desktop</userinput></screen>

      <para>Choisissez cette session en utilisant la boîte de dialogue de sélection de
      session sur l'écran de connexion du gestionnaire d'affichage. Vous avez
      aussi la possibilité d'en faire votre session par défaut.</para>

      <note>
        <para>Il se peut que vous utilisiez le fichier 
        <filename class='extension'>.desktop</filename> créé ci-dessus comme
        exemple pour créer des fichiers 
        <filename class='extension'>.desktop</filename> supplémentaires et 
        ajouter d'autres éléments désirés au menu de sélection des sessions
        du gestionnaire d'affichage <application>GDM</application>.</para>
      </note>

      <important>
        <para>Si le démon système <application>D-BUS</application> est exécuté pendant
        l'installation de <application>gdm</application>,
        assurez vous de stopper et de redémarrer le demon <application>D-BUS</application>
        avant de tenter de démarrer <command>gdm</command>.</para>
      </important>

      <para>On peut tester <command>gdm</command> en l'exécutant en tant 
      qu'utilisateur
      <systemitem class="username">root</systemitem>. Utilisez la commande
      <command>gdm-stop</command> si vous souhaitez arrêter le gestionnaire 
      d'affichage.</para>

    </sect3>

    <sect3 id="gdm-init">
      <title>Script de démarrage</title>

      <para>Pour démarrer une connexion graphique au démarrage du système,
      installez le script de démarrage
      <filename>/etc/rc.d/init.d/gdm</filename> fourni dans le paquet
      <xref linkend="bootscripts"/>. Si votre variable d'environnement
      <envar>GNOME_PREFIX</envar> est autre chose que
      <filename class='directory'>/usr</filename> ou <filename
      class='directory'>/opt/gnome-&gnome-version;&gnome-minor-version;</filename>,
      vous devrez modifier la déclaration de <envar>PATH</envar> du script pour
      inclure le chemin où vous avez installé <application>GNOME</application>.</para>

      <indexterm zone="gdm gdm-init">
        <primary sortas="f-gdm">gdm</primary>
      </indexterm>

<screen role="root"><userinput>make install-gdm</userinput></screen>

      <para>Maintenant éditez <filename>/etc/inittab</filename> avec les
      commandes suivantes.</para>

<screen role="root"><userinput>sed -i 's/id:3:initdefault:/id:5:initdefault:/' \
    /etc/inittab</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>Default, Default.sample, Default, Default, Xsession, gdm,
        gdm-screenshot, gdmflexiserver, gdm-crash-logger, gdm-factory-slave,
        gdm-host-chooser, gdm-product-slave, gdm-session-worker,
        gdm-simple-chooser, gdm-simple-greeter, gdm-simple-slave,
        gdm-user-switch-applet, gdm-xdmcp-chooser-slave, gdm et gdm-binary</seg>
        <seg>libfingerprint.so, libpassword.so, libsmartcard.so</seg>
        <seg>$GNOME_SYSCONFDIR/{dbus-1/system.d.gdm/{Init,PostLogin,PostSession,PreSession}},
        <envar>$GNOME_PREFIX</envar>/{lib/gdm,share/{gnome/help/gdm/*,omf/gdm,
        pixmaps/faces}},
        /var/{cache/gdm,gdm,lib/gdm/.gconf.mandatory,log/gdm,
        run/gdm/greeter}</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="gdmflexiserver">
        <term><command>gdmflexiserver</command></term>
        <listitem>
          <para>est le mécanisme de serveur flexi qui permet de lancer des sessions
          GDM à la demande, dans une nouvelle console virtuelle.</para>
          <indexterm zone="gdm gdmflexiserver">
            <primary sortas="b-gdmflexiserver">gdmflexiserver</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gdm-screenshot">
        <term><command>gdm-screenshot</command></term>
        <listitem>
          <para>est un outil d'impression écran.</para>
          <indexterm zone="gdm gdm-screenshot">
            <primary sortas="b-gdm-screenshot">gdm-screenshot</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gdm-prog">
        <term><command>gdm</command></term>
        <listitem>
          <para>est un script enveloppe pour exécute le binaire
          <application>GDM</application>, l'invite de connexion configurable
          basé sur <application>GNOME</application>.</para>
          <indexterm zone="gdm gdm-prog">
            <primary sortas="b-gdm">gdm</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gdm-binary">
        <term><command>gdm-binary</command></term>
        <listitem>
          <para>est l'invite de connexion basé sur <application>GNOME</application>.</para>
          <indexterm zone="gdm gdm-binary">
            <primary sortas="b-gdm-binary">gdm-binary</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <!-- <varlistentry id="gdm-restart">
        <term><command>gdm-restart</command></term>
        <listitem>
          <para>envoie le signal HUP au démon <application>GDM</application>
          pour qu'il redémarre. Il est utilisé après que le fichier de 
          configuration a été édité</para>
          <indexterm zone="gdm gdm-restart">
            <primary sortas="b-gdm-restart">gdm-restart</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gdm-safe-restart">
        <term><command>gdm-safe-restart</command></term>
        <listitem>
          <para>envoie le signal USR1 au démon <application>GDM</application>
          pour qu'il redémarre. Il est utilisé après que le fichier de
          configuration a été édité.</para>
          <indexterm zone="gdm gdm-safe-restart">
            <primary sortas="b-gdm-safe-restart">gdm-safe-restart</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="gdm-stop">
        <term><command>gdm-stop</command></term>
        <listitem>
          <para>envoie le signal TERM au démon <application>GDM</application>
          pour qu'il s'arrête. Il est utilisé après que le fichier de 
          configuration a été édité.</para>
          <indexterm zone="gdm gdm-stop">
            <primary sortas="b-gdm-stop">gdm-stop</primary>
          </indexterm>
        </listitem>
      </varlistentry>-->

    </variablelist>

  </sect2>

</sect1>
