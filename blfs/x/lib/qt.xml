<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY qt-download-http "&trinity-repo-http;/qt3-3.3.8.d.tar.gz">
  <!ENTITY qt-download-ftp  "&trinity-repo-ftp;/qt3-3.3.8.d.tar.gz ">
  <!ENTITY qt-md5sum        "78dc675e84aed595375449818cbb589a">
  <!ENTITY qt-size          "16.8 MB">
  <!ENTITY qt-buildsize     "801 MB">
  <!ENTITY qt-time          "8.6 SBU">
]>

<sect1 id="qt" xreflabel="Qt-&qt-version;">
  <?dbhtml filename="qt.html" ?>

  <sect1info>
    <othername>$LastChangedBy: bdubbs $</othername>
    <date>$Date: 2011-12-21 10:58:00 +0100 (mer. 21 déc. 2011) $</date>
  </sect1info>

  <title>Qt-&qt-version;</title>

  <indexterm zone="qt">
    <primary sortas="a-qt">Qt</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Qt</title>

    <para>Le paquet <application>Qt</application> contient une bibliothèque GUI
    <application>C++</application>. Elle est utile pour créer des applications
    graphiques ou exécuter des applications graphiques liées dynamiquement à
    la bibliothèque <application>Qt</application>. Deux des utilisations
    majeurs de <application>Qt</application> sont
    <application>KDE</application> et <application>Trinity</application>.</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&qt-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&qt-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &qt-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &qt-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &qt-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &qt-time;</para>
      </listitem>
    </itemizedlist>
    
    <bridgehead renderas="sect3">Téléchargement supplémentaire</bridgehead>
    <itemizedlist spacing='compact'>
      <listitem>
        <para>Correctif requis : <ulink
          url="&patch-root;/qt-3.3.8.d-libpng15-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
    
    <bridgehead renderas="sect3">Dépendances de Qt</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><xref linkend="x-window-system"/></para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="libjpeg"/> et
      <xref linkend="libmng"/>
    </para>

    <para>Remarque&nbsp;: si pour une raison quelconque, vous n'avez pas installé
    les bibliothèques recommandées sur votre système, vous devez supprimer les
    paramètres 
    <parameter>-system-<replaceable>&lt;bibliothèque&gt;</replaceable></parameter> et
    <parameter>-plugin-imgfmt-<replaceable>&lt;bibliothèque&gt;</replaceable></parameter>
    recommandés des commandes <command>configure</command> décrites 
    dans les instructions ci-dessous.</para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
<!--    <xref linkend="nas"/>, -->
      <xref linkend="cups"/>,
      <xref linkend="mysql"/>,
      <xref linkend="postgresql"/>,
      <xref linkend="unixodbc"/>,
      <xref linkend="sqlite"/>, et
      <ulink url="http://firebird.sourceforge.net/">Firebird</ulink>
    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/qt"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Qt</title>

    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
    href="../../xincludes/X11R6_symlink.xml"/>

    <para>Il y a plusieurs manières d'installer un paquet aussi compliqué que
    <application>Qt</application>. Les fichiers ne sont pas complètement 
    indifférents à la position. Les procédures d'installation exécutent le 
    programme <command>pkg-config</command> pour déterminer l'emplacement des
    exécutables du paquet, les bibliothèques, les en-têtes et d'autres fichiers.
    Pour <application>Qt4</application>, <command>pkg-config</command> 
    cherchera les fichiers <filename>lib/pkgconfig/qt-mt.pc</filename> adéquats
    qui doivent être modifiés en cas de relocalisation du paquet. Ces fichiers
    sont correctement paramétrés par le processus de construction.</para>

    <para>L'installation par défaut met les fichiers dans
    <filename class='directory'>/usr/local/qt/</filename>. Beaucoup de
    distributions mettent les fichiers dans la hiérarchie 
        <filename class='directory'>/usr</filename> du système. Le paquet peut
    être aussi installé dans un répertoire de votre choix.</para>

    <para>Cette section vous montrera deux méthodes différentes.</para>

    <warning>
      <para>La construction de <application>Qt</application> dans un environnement
      <command>chroot</command> peut échouer.</para>
    </warning>

    <note>
      <para>Le temps de construction de <application>Qt</application> est
      très long. Si vous voulez gagner du temps et si vous ne voulez pas les
      tutoriels et les exemples, modifiez la première commande
      <command>make</command> en&nbsp;:</para>

<screen><userinput>make sub-tools</userinput></screen>

    </note>

    <sect3>
      <title>Méthode 1 - Installation dans la hiérarchie '/usr'</title>

      <para>L'avantage de cette méthode est qu'aucune mise à jour de
      <filename>/etc/ld.so.conf</filename> ou de
      <filename>/etc/man_db.conf</filename> n'est nécessaire. Les fichiers
      du paquet sont répartis dans plusieurs sous-répertoires de la hiérarchie
      <filename class='directory'>/usr</filename>. C'est une méthode utilisée
      par la plupart des distributions du marché.</para>

      <note>
        <para>Si vous allez réinstaller <application>Qt</application>, lancez
        les commandes suivantes depuis une console ou un gestionnaire de fenêtres
        non basé sur Qt. Elle écrase les bibliothèques de
        <application>Qt</application> qui ne devraient pas être utilisés pendant
        le processus d'installation.</para>
      </note>

<screen><userinput>sed -i '/QMAKE_RPATH/d' mkspecs/linux*/qmake.conf &amp;&amp;

bash
export PATH=$PWD/bin:$PATH 			 &amp;&amp;
export LD_LIBRARY_PATH=$PWD/lib:$LD_LIBRARY_PATH &amp;&amp;

patch -Np1 -i ../qt-3.3.8.d-libpng15-1.patch    &amp;&amp;

./configure -prefix     /usr                \
            -docdir     /usr/share/doc/qt   \
            -headerdir  /usr/include/qt     \
            -plugindir  /usr/lib/qt/plugins \
            -datadir    /usr/share/qt       \
            -sysconfdir /etc/qt             \
            -translationdir /usr/share/qt/translations \
            -qt-gif                         \
            -system-zlib                    \
            -system-libpng                  \
            -system-libjpeg                 \
            -system-libmng                  \
            -plugin-imgfmt-png              \
            -plugin-imgfmt-jpeg             \
            -plugin-imgfmt-mng              \
            -no-exceptions                  \
            -thread                         \
            -tablet &amp;&amp;

make &amp;&amp;
exit</userinput></screen>

      <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

      <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
ln -v -sf libqt-mt.so /usr/lib/libqt.so &amp;&amp;
ln -v -snf ../../bin /usr/share/qt/bin &amp;&amp;
ln -v -snf ../../include/qt /usr/share/qt/include &amp;&amp;
ln -v -snf ../../lib /usr/share/qt/lib &amp;&amp;
cp -v -r doc/man /usr/share &amp;&amp;
cp -v -r examples /usr/share/doc/qt</userinput></screen>

    </sect3>

    <sect3>
      <title>Méthode 2 - Installation dans '/opt'</title>

      <para>C'est la méthode recommandée par les développeurs de
      <application>Qt</application>. Elle présente l'avantage de
      garder tous les fichiers du paquet rassemblés dans une hiérarchie de
      répertoires dédiée. En utilisant cette méthode, on peut faire une mise à 
      jour sans écraser l'installation précédente et les utilisateurs peuvent
      facilement revenir en arrière vers une version précédente en modifiant un
      lien symbolique.</para>

      <para>Les développeurs de <application>Qt</application> utilisent un
      emplacement par défaut de <filename class='directory'>/usr/local/qt/</filename>, 
      mais la procédure ci-dessous met les fichiers dans <filename
      class='directory'>/opt/qt-&qt-version;/</filename> puis crée un lien
      symbolique vers <filename>/opt/qt/</filename>.</para>

<screen><userinput>bash
export QTDIR=$PWD 				 &amp;&amp;
export LD_LIBRARY_PATH=$PWD/lib:$LD_LIBRARY_PATH &amp;&amp;
export PATH=$PWD/bin:$PATH 			 &amp;&amp;

patch -Np1 -i ../qt-3.3.8.d-libpng15-1.patch    &amp;&amp;

./configure -prefix /opt/qt-&qt-version; \
            -sysconfdir /etc/qt \
            -qt-gif \
            -system-zlib \
            -system-libpng \
            -system-libjpeg \
            -system-libmng \
            -plugin-imgfmt-png \
            -plugin-imgfmt-jpeg \
            -plugin-imgfmt-mng \
            -no-exceptions \
            -thread \
            -tablet &amp;&amp;

make &amp;&amp;
exit</userinput></screen>

      <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

      <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
ln -v -sfn qt-&qt-version; /opt/qt &amp;&amp;
ln -v -s libqt-mt.so /opt/qt/lib/libqt.so &amp;&amp;
cp -v -r doc/man examples /opt/qt/doc</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><command>sed -i '/QMAKE_RPATH/d' mkspecs/linux*/qmake.conf</command>&nbsp;:
    Dans la méthode 1, <application>Qt</application> sera installé dans les
    répertoires du système standard. Le chemin de recherche de la bibliothèque 
    d'exécution n'a pas besoin d'être réglé dans ce cas.</para>

    <para><command>bash</command>&nbsp;: Cette commande entre dans un sous-shell
    pour isoler les modifications de l'environnement.</para>

    <para><command>export QTDIR=$PWD</command>&nbsp;: Cette commande définit
    la racine du répertoire <application>Qt</application>.</para>

    <para><command>export LD_LIBRARY_PATH=$PWD/lib:$LD_LIBRARY_PATH</command>&nbsp;:
    Cette commande permet aux bibliothèques <application>Qt</application> pas
    encore installées d'être utilisées par des programmes <application>Qt</application>
    non encore installés..</para>

    <para><command>export PATH=$PWD/bin:$PATH</command>&nbsp;: Cette commande
    permet au processus de construction de trouver les exécutables de
    support.</para>

    <para><parameter>-qt-gif</parameter>&nbsp;: Ce paramètre ajoute le support des
    fichiers <filename>gif</filename> aux bibliothèques.</para>

    <para><parameter>-system-zlib -system-libpng -system-libjpeg
    -system-mng</parameter>&nbsp;: Ces paramètres obligent les instructions de
    construction à utiliser les bibliothèques partagées sur votre système au 
    lieu de créer un réglage personnalisé des bibliothèques de support de ces 
    fonctions.</para>

    <para><parameter>-plugin-imgfmt-png -plugin-imgfmt-jpeg
    -plugin-imgfmt-mng</parameter>&nbsp;: Ces paramètres activent védition de
    liens des bibliothèques référencées lors de l'exécution.</para>

    <para>Si vous passez le paramètre
    <option>-plugin-sql-<replaceable>&lt;pilote&gt;</replaceable></option> ou
    <option>-qt-sql-<replaceable>&lt;pilote&gt;</replaceable></option> à la
    commande <command>configure</command>, vous devez également passer
    <option>-I<replaceable>&lt;/chemin/vers/entêtes/sql/&gt;</replaceable></option>
    pour que <command>make</command> puisse trouver les fichiers d'en-tête 
    adéquats. Par exemple, la construction en dur du support
    <application>MySQL</application> (à l'inverse de la construction du
    plugin) devra utiliser <option>-I/usr/include/mysql
    -qt-sql-mysql</option>.</para>

    <note>
      <para>Pour vérifier que <application>mysql</application> est détecté 
      automatiquement correctement, regardez la sortie de <command>./configure -qt-sql-mysql
      -help</command>. D'autres support de base de données exigeront des paramètres
      <command>configure</command> identiques.</para>
    </note>

    <para><parameter>-no-exceptions</parameter>&nbsp;: Ce paramètre désactive
    le codage d'exception générées par le compilateur <application>C++</application>.</para>

    <para><parameter>-thread</parameter>&nbsp;: Ce paramètre ajoute le
    support du multi-threading.</para>

    <para><command>ln -v -sf libqt-mt.so /usr/lib/libqt.so</command>&nbsp;: Cette
    commande permet aux scripts <command>configure</command> de trouver une
    installation <application>Qt</application> qui fonctionne.</para>

    <para><command>ln -v -snf ../../bin /usr/share/qt/bin</command>&nbsp;: Cette
    commande et les deux suivantes permettent à l'installation du style
    <filename class="directory">/usr</filename> de mimer l'installation de style
    <filename class="directory">/opt</filename> en rendant tous les binaires,
    les en-têtes, et les fichiers disponibles depuis un seul répertoire,
    <filename class="directory">/usr/share/qt</filename>.</para>

    <para><command>cp -v -r doc/man examples /usr/share (or
    /opt/qt/doc)</command>&nbsp;: Cette commande installe les pages de man et 
    les exaemples oubliés par <command>make install</command>.</para>

    <para><command>exit</command>&nbsp;: Cette commande retourne au shell
    parent et élimine les variables d'environnement réglées tout à l'heure.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de Qt</title>

    <sect3 id='qt-config'>
      <title>Informations de configuration</title>

      <para>La variable d'environnement <envar>QTDIR</envar> doit être réglée
      lors de la construction des paquets qui dépendent de <application>Qt</application>. 
      Ajoutez ce qui suit au script d'initialisation 
      <filename>.bash_profile</filename> pour chaque utilisateur qui construit
      des paquets en utilisant les bibliothèques <application>Qt</application>.
      Vous pouvez sinon régler la variable dans le fichier
      <filename>/etc/profile</filename> global.</para>

      <para>Pour la méthode 1 (c'est facultatif, ne paramétrez ceci que si une
      application ne peut pas trouver les bibliothèques ou les en-têtes 
      installées)&nbsp;:</para>

<screen><literal>export QTDIR=/usr/share/qt</literal></screen>

      <para>ou pour la méthode 2&nbsp;:</para>

<screen><literal>export QTDIR=/opt/qt</literal></screen>

      <para>Si vous avez installé <application>Qt</application> en utilisant la
      méthode 2, vous devez aussi mettre à jour les fichiers de configuration 
      suivants pour que <application>Qt</application> soient trouvé correctement
      par les autres paquets et les processus système.</para>

      <para>Mettez à jour les fichiers <filename>/etc/ld.so.conf</filename> et
      <filename>/etc/man_db.conf</filename>&nbsp;:</para>

<screen role="root"><userinput>cat &gt;&gt; /etc/ld.so.conf &lt;&lt; "EOF" &amp;&amp;
<literal># Début du supplément qt de /etc/ld.so.conf

/opt/qt/lib

# Fin du supplément qt</literal>
EOF
ldconfig &amp;&amp;
cat &gt;&gt; /etc/man_db.conf &lt;&lt; "EOF"
<literal># Début du supplément qt de man_db.conf

MANDATORY_MANPATH /opt/qt/doc/man
MANPATH_MAP       /opt/qt/bin         /opt/qt/doc/man
MANDB_MAP         /opt/qt/doc/man     /var/cache/man/qt

# Fin du supplément qt de man_db.conf</literal>
EOF</userinput></screen>

      <indexterm zone="qt qt-config">
        <primary sortas="e-etc-ld.so.conf">/etc/ld.so.conf</primary>
      </indexterm>

      <indexterm zone="qt qt-config">
        <primary sortas="e-etc-man_db.conf">/etc/man_db.conf</primary>
      </indexterm>

      <indexterm zone="qt qt-config">
        <primary sortas="e-etc-profile">/etc/profile</primary>
      </indexterm>

      <indexterm zone="qt qt-config">
        <primary sortas="e-AA.bash_profile">~/.bash_profile</primary>
      </indexterm>

      <para>Mettez à jour la variable d'environnement <envar>PKG_CONFIG_PATH</envar> 
      dans votre <filename>~/.bash_profile</filename> ou
      <filename>/etc/profile</filename> avec ce qui suit&nbsp;:</para>

<screen><literal>PKG_CONFIG_PATH=$PKG_CONFIG_PATH:/opt/qt/lib/pkgconfig</literal></screen>

      <para>Si vous voulez les exécutables <application>Qt</application> dans
      le chemin de recherche de votre ,shell, mettez à jour la variable d'environnement
      <envar>PATH</envar> dans votre <filename>~/.bash_profile</filename> ou
      <filename>/etc/profile</filename> pour inclure
      <filename class='directory'>/opt/qt/bin</filename>.</para>

      <tip><para>The PATH, MANPATH, et PKG_CONFIG_PATH peuvent être mis à jour dans
      extrapaths.sh (ou un autre scripte) dans le répertoire /etc/profile.d 
      si vous avez configuré les fichiers de démarrage tel que recommandé dans 
      <xref linkend='postlfs-config-profile'/>.</para></tip>

      <para>Comme avec la plupart des bibliothèques, il n'y a pas de configuration 
      explicite à faire. Après la mise à jour de <filename>/etc/ld.so.conf</filename>
      comme expliquée ci-dessus, lancez <command>/sbin/ldconfig</command> pour
      que <command>ldd</command> puisse trouver les bibliothèques partagées.</para>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>assistant, designer, linguist, lrelease, lupdate, moc,
        qm2ts, qmake, qtconfig, et uic</seg>
        <seg>libqt-mt.so, libqt.so libqui.so, libdesignercore.a,
        libeditor.a, et libqassistantclient.a</seg>
        <seg>/opt/qt-&qt-version; or /usr/lib/qt, /usr/share/qt,
        /usr/share/doc/qt, /usr/include/qt, et /etc/qt</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="assistant">
        <term><command>assistant</command></term>
        <listitem>
          <para>est un outil pour présenter de la documentation en ligne.</para>
          <indexterm zone="qt assistant">
            <primary sortas="b-assistant">assistant</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="designer">
        <term><command>designer</command></term>
        <listitem>
          <para>est un constructeur GUI complètement mûr. Il inclut des
          fonctionnalités puissantes telles qu'un mode de prévisualisation, 
          l'aménagement automatique des widgets, le support des widgets
          personnalisés et aun éditeur avancé de propriétés.</para>
          <indexterm zone="qt designer">
            <primary sortas="b-designer">designer</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="linguist">
        <term><command>linguist</command></term>
        <listitem>
          <para>fournit un support de traduction d'applications en langues
          locales.</para>
          <indexterm zone="qt linguist">
            <primary sortas="b-linguist">linguist</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lrelease">
        <term><command>lrelease</command></term>
        <listitem>
          <para>est un outil simple en ligne de commande. Il lit un fichier
          de projet Qt et produit des fichiers de message utilisés par
          l'application.</para>
          <indexterm zone="qt lrelease">
            <primary sortas="b-lrelease">lrelease</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="lupdate">
        <term><command>lupdate</command></term>
        <listitem>
          <para>lit un fichier de projet Qt, cherche les chaînes traduisibles
          dans les sources spécifiées, l'en-tête et les fichiers du designer 
          Qt, et produit ou met à jour les fichiers de traduction listés dans
          le fichier du projet.</para>
          <indexterm zone="qt lupdate">
            <primary sortas="b-lupdate">lupdate</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="moc">
        <term><command>moc</command></term>
        <listitem>
          <para>génère le support du code des méta-objets Qt.</para>
          <indexterm zone="qt moc">
            <primary sortas="b-moc">moc</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="qm2ts">
        <term><command>qm2ts</command></term>
        <listitem>
          <para>est un outil pour convertir des formats de fichiers de messages
          Qt.</para>
          <indexterm zone="qt qm2ts">
            <primary sortas="b-qm2ts">qm2ts</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="qmake">
        <term><command>qmake</command></term>
        <listitem>
          <para>qutilise des informations stockées dans des fichiers de projet
          pour déterminer ce qui devrait aller dans les makefiles qu'il génère.</para>
          <indexterm zone="qt qmake">
            <primary sortas="b-qmake">qmake</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="qtconfig">
        <term><command>qtconfig</command></term>
        <listitem>
          <para>est utilisé pour personnaliser l'apparance des
          applications Qt.</para>
          <indexterm zone="qt qtconfig">
            <primary sortas="b-qtconfig">qtconfig</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="uic">
        <term><command>uic</command></term>
        <listitem>
          <para>est un compilateur d'interface utilisateur Qt.</para>
          <indexterm zone="qt uic">
            <primary sortas="b-uic">uic</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
