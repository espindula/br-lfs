<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY xulrunner-download-http
  "http://releases.mozilla.org/pub/mozilla.org/firefox/releases/&firefox-version;/source/firefox-&firefox-version;.source.tar.bz2">
  <!ENTITY xulrunner-download-ftp
  "ftp://ftp.mozilla.org/pub/mozilla.org/firefox/releases/&firefox-version;/source/firefox-&firefox-version;.source.tar.bz2">
  <!-- md5sum et size should match firefox, but the buildsize and time will differ -->
  <!ENTITY xulrunner-md5sum        "5ce038d591964f72c534fa33b75a62f5">
  <!ENTITY xulrunner-size          "72 Mio">
  <!ENTITY xulrunner-buildsize     "2.6 Gio (440 Mio installé)">
  <!ENTITY xulrunner-time          "22 SBU">
]>

<sect1 id="xulrunner" xreflabel="Xulrunner-&xulrunner-version;">
  <?dbhtml filename="xulrunner.html" ?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: andy $</othername>
    <date>$Date&nbsp;: 2012-02-19 15:16:15 +0100 (dim. 19 févr. 2012) $</date>
  </sect1info>

  <title>Xulrunner-&xulrunner-version;</title>

  <indexterm zone="xulrunner">
    <primary sortas="a-Xulrunner">Xulrunner</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Xulrunner</title>

    <para><application>Xulrunner</application> est un environnement d'exécution
    pour les applications XUL, et il constitue la majeure partie de la base de
    code de <application>Mozilla</application>. En particulier, il offre 
    le moteur gecko et les fichiers pkgconfig pour que des applications telles que
    <application>Yelp</application> puissent l'utiliser. Toutefois, sachez que les 
    applications Gnome sont en transition vers <application> Webkit </application>,
    au lieu de gecko</para>

    &lfs70_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&xulrunner-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&xulrunner-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &xulrunner-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &xulrunner-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &xulrunner-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &xulrunner-time;</para>
      </listitem>
    </itemizedlist>
    
    <bridgehead renderas="sect3">Dépendances de Xulrunner</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><xref linkend="alsa-lib"/>, <xref linkend="gtk2"/>,
    <xref linkend="zip"/> and <xref linkend="unzip"/>.</para>

    <para>Remarque&nbsp;: Vous devriez avoir installé <application>libjpeg</application> 
    et <application>libpng</application> (corrigé pour le support apng)
    avant <application>gdk-pixbuf</application> et elle devrait exister sur votre 
    système. Si pour une raison quelconque, vous ne les avez pas installées, 
    vous devriez supprimer les options
    <option>--with-system-jpeg</option> et <option>--with-system-png</option> du 
    fichier
    <filename>mozconfig</filename> créé ci-dessous.</para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended"><xref linkend="yasm"/> ou
    <xref linkend="libvpx"/>.</para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="dbus-glib"/>,
    <xref linkend="startup-notification"/>, <xref linkend="sqlite"/>,
    <ulink url="http://www.webmproject.org/code/">libvpx</ulink>,
    <ulink url="http://sourceforge.net/projects/hunspell/">Hunspell</ulink>,
    <ulink url="http://libevent.org/">Libevent</ulink>,
    <xref linkend="doxygen"/>,
    <xref linkend="gnome-vfs"/> and <xref linkend="libgnomeui"/> (pour
    l'intégration gnome), <xref linkend="libnotify"/>, <xref linkend="nspr"/>,
    <xref linkend="nss"/>, <xref linkend="unzip"/>,
    <xref linkend="wireless_tools"/>,
    <ulink url="http://www.valgrind.org/">Valgrind</ulink> (seulement pour
    tester le code jemalloc) et <xref linkend="wget"/></para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/xulrunner"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Xulrunner</title>

    <para>La configuration de <application>Xulrunner</application> se fait en
    créant un fichier <filename>mozconfig</filename> contenant les options de
    configuration désirées. Un <filename>mozconfig</filename> par défaut est
    créé ci-dessous. Pour voir toute la liste des options de configuration 
    disponibles (et une description abrégée de chacune), exécutez
    <command>./configure --help</command>. Vosu devez éditer entièrement le fichier
    et commenter ou décommenter les options il faut.</para>

<screen><userinput>cat &gt; mozconfig &lt;&lt; "EOF"
# Si vous avez une machine multicoeurs, vous pouvez accélérer la
# construction en lançant plusieurs tâches en même temps, mais vous n'avez qu'un
# coeur, effacez cette ligne&nbsp;:
mk_add_options MOZ_MAKE_FLAGS="-j4"

# Si vous avez installé Yasm effacez cette option&nbsp;:
ac_add_options --disable-webm

# Si vous avez installé DBus-Glib effacez cette option&nbsp;:
ac_add_options --disable-dbus

# Si vous avez installé wireless-tools effacez cette option&nbsp;:
ac_add_options --disable-necko-wifi

# Si vous avez installé libnotify effacez cette option&nbsp;:
ac_add_options --disable-libnotify

# Si vous n'avez pas installé nss effacez ces deux lignes&nbsp;:
#ac_add_options --with-system-nspr
#ac_add_options --with-system-nss

# Décommentez ceci si vous les avez installés&nbsp;:
# ac_add_options --enable-system-sqlite
# ac_add_options --with-system-libvpx
# ac_add_options --enable-startup-notification
# ac_add_options --enable-system-hunspell
# ac_add_options --with-system-libevent

mk_add_options MOZ_OBJDIR=@TOPSRCDIR@/xulrunner-build-dir
ac_add_options --prefix=/usr
ac_add_options --enable-application=xulrunner
ac_add_options --with-pthreads
ac_add_options --enable-system-ffi
ac_add_options --with-system-jpeg
ac_add_options --with-system-png
ac_add_options --enable-system-cairo
ac_add_options --with-system-zlib
ac_add_options --enable-shared
ac_add_options --disable-static
ac_add_options --disable-debug
ac_add_options --disable-crashreporter
ac_add_options --disable-installer
ac_add_options --disable-updater
ac_add_options --disable-tests
EOF</userinput></screen>

    <para>Installez <application>Xulrunner</application> en tapant les
    commandes suivantes&nbsp;:</para>

<screen><userinput>sed -i 's#VPX_CODEC_USE_INPUT_PARTITION#VPX_CODEC_USE_INPUT_FRAGMENTS#' configure &amp;&amp;
sed -i '/Version/aRequires: nspr &gt;= &nspr-version;' xulrunner/installer/libxul-embedding.pc.in &amp;&amp;
make -f client.mk build</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>>&nbsp;:nbsp;:</para>

<screen role="root"><userinput>make -C xulrunner-build-dir install &amp;&amp;
mkdir -p /usr/lib/mozilla &amp;&amp;
ln -sv ../mozilla/plugins /usr/lib/xulrunner-&xulrunner-version; &amp;&amp;
chown -Rv root:root /usr/{include,lib,share/idl}/xulrunner-*</userinput></screen>

    <para>Si vous avez choisi d'utiliser les NSPR et NSS inclus (par exemple,
    si vous <emphasis>n'avez pas</emphasis> installé <xref linkend="nspr"/> et
    <xref linkend="nss"/>), en tant qu'utilisateur
    <systemitem class="username">root</systemitem>, terminez l'instalaltion avec
    les commandes suivantes&nbsp;:</para>

<screen role="root"><userinput>for DL in libnss3.so libnssutil3.so libsmime3.so \
  libssl3.so libsoftokn3.so  libplds4.so libplc4.so libnspr4.so
do ln -sv xulrunner-&xulrunner-version;/${DL} /usr/lib
done &amp;&amp;
unset DL</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>
 
    <para><command>sed -i 's#VPX_CODEC_USE ...</command>&nbsp;: Ceci corrige le
    script <command>configure</command> de <application>Xulrunner&apos;s</application> 
    pour détecter correctement libvpx-v1.0.0. Ce n'est pas utile si vous avez
    installé libvpx-v0.9.7 ou supérieur ou si vous n'avez pas installé
    <xref linkend="libvpx"/>.</para>

    <para><command>sed ... Requires: nspr</command>&nbsp;: Si vous essayez de
    construire <application>Yelp</application> sans
    cela, l'en-tête prtypes de nspr ne sera pas installée. On peut discuter
    pour savoir si c'est un problème (le code fonctionne en principe sur les
    geckos récents), mais cette correction est peu vraisemblablement à l'origine
    de problèmes dans d'autres paquets.</para>

    <para><command>make -f client.mk ...</command>&nbsp;: Les produits Mozilla
    sont empaquetées pour permettre l'utilisation d'un fichier de configuration
    qu'on peut utiliser pour passer les paramètres de configuration à la
    commande <command>configure</command>. <command>make</command> utilise
    le fichier <filename>client.mk</filename> pour obtenir la configuration de
    départ et paramétrer les réglages.</para>

    <para><command>ln -sv ../mozilla/plugins ...</command>&nbsp;: Certains
    paquets installeront des greffons de navigateur dans
    <filename class="directory">/usr/lib/mozilla/plugins</filename>. La création
    du lien symbolique <application>Xulrunner</application> conserve les greffons
    supplémentaires gans le répertoire habituel.</para>

    <para><command>for DL in ...</command>&nbsp;: Les bibliothèques NSPR et NSS
      inclus avec ce paquet sont installés dans <filename>/usr/lib/xulrunner-&xulrunner-version;</filename>,
    ce qui signifie qu'elles ne seront pas trouvées au moment de l'exécution. En
    utilisant des liens symboliques issus de
    <filename class="directory">/usr/lib</filename> les bibliothèques seront trouvées
    et les liens pourront être modifiés facilement pour pointer vers une version plus
    récente quand nous mettrons à jour.</para>

   <note>
     <para>Quand vous mettez à jour Xulrunner, rappelez vous de mettre à jour les liens symboliques.</para>
   </note>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>xulrunner, et optionally nspr-config</seg>
        <seg>Numerous libraries, browser components, plugins, extensions, et
        helper modules installed in <filename
       class='directory'>/usr/lib/xulrunner-&xulrunner-version;</filename></seg>
        <seg>/etc/gre.d, /usr/include/xulrunner-&xulrunner-version;,
        /usr/lib/xulrunner-&xulrunner-version;,
        /usr/lib/xulrunner-devel-&xulrunner-version;, et
        /usr/share/idl/xulrunner-&xulrunner-version;</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="xulrunner-prog">
        <term><command>xulrunner</command></term>
        <listitem>
          <para>est un script shell, utile pour identifier la version
          installée.</para>
          <indexterm zone="xulrunner xulrunner-prog">
            <primary sortas="b-xulrunner">xulrunner</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
