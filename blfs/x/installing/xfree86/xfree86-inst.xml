<sect2>
<title>Installation de XFree86</title>

<sect3>
<title>Paramétrages de compilation du noyau</title>
<para>Si vous avez un Intel P6 (Pentium Pro, Pentium II et suivants), il est
recommandé de compiler le support de MTRR (Memory Type Range Registers) dans le
noyau. Le noyau peut interfacer les CPUs Cyrix et AMD avec l'interface MTRR,
donc la sélection de cette option est aussi utile pour ces processeurs. Cette
option se trouve dans le menu "Processor type and features". Il peut améliorer
la performance des opérations d'écriture d'images, de la 2,5 fois à plus sur les
cartes vidéo PCI et AGP.</para>

<para>Dans la section "Character Devices", activez le support de l'AGP et
sélectionnez le support du chipset de votre carte mère. Si vous ne connaissez
pas le chipset, vous pouvez sélectionner tous les types de composants, ce qui
va agrandir la taille de votre noyau. Vous pouve déterminer habituellement le
chipset de votre carte mère en lançant:and select the chipset
<screen><userinput>cat /proc/pci</userinput></screen></para>

<para>Dans le section "Character Devices", <emphasis>désactivez</emphasis> le
'Direct Rendering Manager' sauf si vous avez une carte vidéo disposant de
l'infrastructure 'Direct Rendering Infrastructure' (DRI). Voir la section DRI
plus bas pour une liste. Si vous activez le DRI ici, assurez-vous de
sélectionner la carte vidéo, en tant que module, carte vidéo pour laquelle vous
souhaitez disposer du support.</para>

<para>Si vous faites tout changement dans la configuration du noyau,
recompilez-le avec
<screen><userinput>make dep &amp;&amp;
make bzImage &amp;&amp;
make modules &amp;&amp;
make modules_install</userinput></screen>
</para>

<para>Copiez <filename>/usr/src/linux/arch/i386/boot/bzImage</filename> et
<filename>/usr/src/linux/System.map</filename> dans
<filename>/boot</filename>, éditez <filename>/etc/lilo.conf</filename>
de manière appropriée et lancez <userinput>lilo</userinput>.</para>

<note><para>Si vous construisez XFree86 dans un environnement chroot,
assurez-vous que la version du noyau du système de base et du système cible sont
les mêmes. Ceci est tout spécialement important si vous avec activé le support
de DRI en tant que module en suivant les instructions ci-dessus.</para></note>

</sect3>

<sect3><title>Créer <filename>host.def</filename></title>

<para>Bien que XFree86 compilera sans fichier host.def, le fichier suivant est
recommendé pour personnalisation de l'installation. Commencez à partir du
répertoire <filename>xc</filename>.</para>

<para><screen><userinput>cat &gt; config/cf/host.def &lt;&lt; "EOF"
/* Begin XFree86 hosts.def file */

/* System Related Information.  If you read and configure only one
 * section then it should be this one.  The Intel architecture defaults are 
 * set for a i686 and higher.  Axp is for the Alpha architecture and Ppc is  
 * for the Power PC.  Note that there have been reports that the Ppc 
 * optimization line causes segmentation faults during build.  If that 
 * happens, try building without the DefaultGcc2PpcOpt line.  **************/

#define DefaultGcc2i386Opt  -O2 -fomit-frame-pointer -march=i686  
#define DefaultGcc2AxpOpt   -O2 -mcpu=ev6
#define DefaultGcc2PpcOpt   -O2 -mcpu=750

/* The following definitions are normally set properly by XFree86's scripts.
 * You can uncomment them if you want to make sure. ************************/
 
/* #define HasMTRRSupport      YES  */ /* Enabled in kernel see kernel docs */
/* #define HasMMXSupport        NO  */ /* Any i586 or above */
/* #define HasKatmaiSupport     NO  */ /* PIII SSE instuctions */
/* #define Has3DNowSupport      NO  */ /* AMD instructions */


/* This setting reduces compile time a little by omitting rarely used input 
 * devices.  You can find the complete list in config/cf/xfree86.cf ********/
 
#define XInputDrivers                 mouse void

/* VIDEO DRIVERS ***********************************************************/

/* If you are sure you only want the drivers for one or a few video cards,
 * you can delete the drivers you do not want. *****************************/ 

#define XF86CardDrivers mga glint nv tga s3virge rendition \
                        cirrus vmware tseng chips apm \
                        fbdev i128 \
                        ati AgpGartDrivers DevelDrivers ark cyrix \
                        vesa vga XF86OSCardDrivers

/* FONT SERVER AND LIBRARY SETTINGS ****************************************/

/* These setting should be set by default, but we are making sure. *********/

#define BuildFontServer          YES  /* Need for GhostScript Print Server */
#define SharedLibFont            YES  
#define CompressAllFonts         YES
#define GzipFontCompression      YES

/* These setting ensure we use the proper version of freetype **************/
#define HasFreetype2             YES
#define BuildFreetype2Library     NO
#define Freetype2Dir            /usr

/* The font path can be redefined in the XF86Config file *******************/

#define DefaultFontPath                $(FONTDIR)/misc/,$(FONTDIR)/75dpi/,\
$(FONTDIR)/100dpi/,$(FONTDIR)/Type1,$(FONTDIR)/local,\
$(FONTDIR)/TrueType,$(FONTDIR)/CID,$(FONTDIR)/Speedo

/* INTERNATIONAL FONTS.  Change to YES if you need any of them.  These  are
 * the defaults. ***********************************************************/

#define BuildCyrillicFonts            NO
#define BuildArabicFonts              NO
#define BuildISO8859_6Fonts           NO
#define BuildGreekFonts               NO
#define BuildISO8859_7Fonts           NO
#define BuildHebrewFonts              NO
#define BuildISO8859_8Fonts           NO
#define BuildKOI8_RFonts              NO
#define BuildJapaneseFonts            NO
#define BuildJISX0201Fonts            NO
#define BuildKoreanFonts              NO
#define BuildChineseFonts             NO

/* DOCUMENTATION SETTINGS **************************************************/

/* These setting are the defaults. *****************************************/

#define BuildLinuxDocHtml             NO    /* X Docs in Html format */
#define BuildLinuxDocPS               NO    /* X Docs in PostScript format */
#define BuildAllSpecsDocs             NO    /* Various docs */
#define BuildHtmlManPages             NO

/* Linux Distribution Information - Not essential that it is totally right.*/

#define LinuxDistribution         LFS 

/* GENERAL SETTINGS: You generally want to leave these alone when
 * building X on an LFS system *********************************************/

#define GccWarningOptions         -pipe
#define TermcapLibrary            -lncurses
#define XprtServer                YES /* Needed by realplayer */
#define XnestServer               YES
#define XAppLoadDir               EtcX11Directory/app-defaults
#define VarLibDir                 /var/lib
#define XFree86Devel               NO
#define FSUseSyslog               YES
#define ThreadedX                 YES
#define HasZlib                   YES
#define HasNCurses                YES
#define HasPam                     NO        
#define SystemManDirectory        /usr/share/man
#define HasLibCrypt               YES
#define InstallXinitConfig        YES
#define InstallXdmConfig          YES
#define ForceNormalLib            YES
#define BuildSpecsDocs             NO

/* End XFree86 host.def file */
EOF</userinput></screen></para>

<para>Editiez le fichier suivant votre matériel et vos désirs.</para>

</sect3>

<sect3>
<title>Commandes de construction</title>
<para>Installez XFree86 en lançant les commandes suivantes:</para>


<para><screen><userinput>patch -Np1 -i ../4.2.0-4.2.1.diff &amp;&amp;
make World 2&gt;&amp;1 | tee xfree-compile.log &amp;&amp;
make install &amp;&amp;
make install.man &amp;&amp;
ln -sf /usr/X11R6/bin /usr/bin/X11 &amp;&amp;
ln -sf /usr/X11R6/lib/X11 /usr/lib/X11 &amp;&amp;
ln -sf /usr/X11R6/include/X11 /usr/include/X11</userinput></screen></para>

</sect3>
</sect2>

