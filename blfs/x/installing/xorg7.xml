<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="xorg7" xreflabel="Xorg-&xorg-version;">
  <?dbhtml filename="xorg7.html"?>

  <sect1info>
    <othername>$LastChangedBy: bdubbs $</othername>
    <date>$Date: 2011-12-14 00:47:14 +0100 (mer. 14 déc. 2011) $</date>
  </sect1info>

  <title>Introduction à Xorg-&xorg-release;</title>

  <indexterm zone="xorg7">
    <primary sortas="a-xorg7">Xorg</primary>
  </indexterm>

  <para><application>Xorg</application> est une implémentation très distribuable
  et libre du système de fenêtres <application>X</application>. Ce système offre
  une interface client/serveur entre le matériel d'affichage (la souris, le 
  clavier et les afficheurs graphiques) et l'environnement de bureau, tout en
  fournissant aussi à la fois l'infrastructure de fenêtres et une interface
  d'applications standardisée (API).</para>

  <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
  <ulink url='&blfs-wiki;/Xorg7'/></para>

  <bridgehead renderas="sect3">Instructions de téléchargement et installation de
  Xorg</bridgehead>

  <para>Xorg-7.0 a introduit un système de construction complètement auto-tooled
  et modulaire. Avec le nouveau système de construction modulaire, il n'est plus
  possible de télécharger tout le paquet dans un seul fichier. En fait, il peut
  y avoir plus de 1000 paquets à récupérer sur le lieu du téléchargement. 
  Pour vous aider pour une tâche si importante, l'installation de
  <xref linkend="wget"/> est fortement recommandée pour télécharger les fichiers
  nécessaires. On fournit une liste complète des fichiers 
  <application>wget</application> pour chaque page incluant plusieurs paquets.</para>

  <para>Étant donné le nombre de paquets disponibles, la décision des paquets à
  installer selon votre configuration particulière peut paraître de prime abord
  écrasante. Jetez un &oelig;il sur
  <ulink url="http://wiki.x.org/wiki/ModuleDescriptions">cette page</ulink>
  et
  <ulink url="http://lists.x.org/archives/xorg-modular/2005-November/000801.html">ce
  fil</ulink> pour vous faire une idée de ce dont vous aurez besoin. Si vous 
  n'êtes pas sûr, vous devriez installer tous les paquets, au prix d'un espace 
  disque supplémentaire.</para>

  <note>
    <para>Même si vous ne voulez télécharger que les paquets nécessaires, vous
    devriez télécharger les listes de fichiers wget. La liste des fichiers est
    rangée par dépendances et les versions des paquets listés dans les fichiers
    sont connues pour bien fonctionner ensembles. En outre, les listes de 
    fichiers wget contiennent des commentaires pour des paquets spécifiques 
    obsolètes ou dont on ne recommande pas l'installation. Les paquets plus 
    récents sont probablement prévus pour la prochaine version de
    <application>Xorg</application> et ils ont déjà prouvé leur incompatibilité
    avec les versions actuelles des logiciels installés dans BLFS. La taille du
    <application>Xorg</application> installé peut être réduite considérablement
    en n'installant que les paquets dont vous avez besoin et que vous utiliserez,
    mais le livre BLFS ne peut pas tenir compte de toutes les dépendances et de
    toutes les options de construction des paquets <application>Xorg</application>
    individuels. Les instructions supposent que tous les paquets ont été 
    construits. Une page 
    <ulink url="&blfs-wiki;/Xorg7">wiki</ulink> contenant des informations de
    dépendances est en développement. On vous encourage à compléter ces pages si
    vous trouvez des informations supplémentaires qui peuvent aider les autres
    utilisateurs qui installent de manière sélective les paquets individuels.</para>
  </note>

  <para>De plus, du fait du grand nombre de commandes répétitives, on vous
  invite à automatiser partiellement la construction. On vous donne ici des
  instructions qui utilisent le paquet <xref linkend="sudo"/>. Il est recommandé
  à l'utilisateur qui va construire les paquets de xorg
  d'utiliser l'option de configuration <parameter>:NOPASSWD</parameter>.
  <!-- peut entrer les commandes
  ci-dessous (ou d'autres identiques) sur la ligne de commande pour compiler
  chaque section (proto, utils (outils), libs (biblio), apps, drivers
  (pilotes)). Les liens wiki sur chaque page de section contiennent des commandes
  spécifiques pour compiler tout le groupe de paquets, basées sur le contenu des
  fichiers wget.</para>

<screen>bash -e #exit on all errors
section=<replaceable>&lt;proto&gt;</replaceable>
version=&xorg7-release;
mkdir $section
cd $section

# téléchargement et vérification des paquets
grep -v '^#' ../${section}-${version}.wget | wget -i- -c \
    -B http://xorg.freedesktop.org/releases/individual/${section}/
md5sum -c ../${section}-${version}.md5

# construction des paquets
for package in $(grep -v '^#' ../${section}-${version}.wget)
do
  packagedir=$(echo $package | sed 's/.tar.bz2//')
  tar -xf $package
  cd $packagedir
  ./configure $XORG_CONFIG
  make
  make install
  cd ..
  rm -rf $packagedir
done 2&gt;&amp;1 | tee -a ../xorg-${section}-compile.log #log the entire loop</screen>

  <para>Le shell ci-dessus quittera immédiatement à la moindre erreur. S'il ne
  va pas au bout, vous devriez quitter à la main le shell avant d'aller
  au jeu d'instructions suivant.</para>
-->

  <sect2>
    <title>Paramétrer l'environnement de construction de Xorg</title>

    <para>Tout d'abord, vous devrez créer un répertoire de travail&nbsp;:</para>

<screen><userinput>mkdir xc &amp;&amp;
cd xc</userinput></screen>

    <para>Comme avec les versions précédentes du système X Window, il peut être
    souhaitable d'installer <application>Xorg</application> dans un préfixe
    alternatif. Ce n'est plus une pratique courante dans les distributions Linux.
    Le préfixe d'installation habituelle de <application>Xorg</application> sur
    Linux est <filename class="directory">/usr</filename>.  Il n'y a pas de
    préfixe alternatif standard, ni d'exception dans la révision actuelle du 
    standard de hiérarchie des systèmes de fichiers (FHS) pour la version 7 du 
    système X Window. Alan Coopersmith de Sun Microsystems, a déclaré récemment
    « Chez Sun, nous utilisions 
    <filename class="directory">/usr/X11</filename> et nous envisageons de continuer 
    comme ça. » Seul le préfixe <filename class="directory">/opt/*</filename> ou
    le préfixe <filename class="directory">/usr</filename> correspondent aux lignes
    directrices actuelles du FHS actuel.</para>

    <para>Choisissez votre préfixe d'installation et réglez la variable
    <envar>XORG_PREFIX</envar> avec la commande suivante&nbsp;:</para>

<screen><userinput>export XORG_PREFIX="<replaceable>&lt;PREFIX&gt;</replaceable>"</userinput></screen>

    <para>Tout au long de ces instructions, vous utiliserez les paramètres
    <command>configure</command> suivants pour tous les paquets. Créez la variable
    <envar>XORG_CONFIG</envar> à utiliser en remplacement de ce paramètre&nbsp;:</para>

<screen><userinput>export XORG_CONFIG="--prefix=$XORG_PREFIX --sysconfdir=/etc \
    --mandir=$XORG_PREFIX/share/man --localstatedir=/var"</userinput></screen>

    <para>Creer un fichier de configuration <filename>/etc/profile.d/xorg.sh</filename>
    ces variables pour <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen><userinput role="root">cat &gt; /etc/profile.d/xorg.sh &lt;&lt; "EOF" &amp;&amp;
XORG_PREFIX="<replaceable>&lt;PREFIX&gt;</replaceable>"
XORG_CONFIG="--prefix=$XORG_PREFIX \
             --sysconfdir=/etc \
             --mandir=$XORG_PREFIX/share/man \
             --localstatedir=/var"
export XORG_PREFIX XORG_CONFIG
EOF
chmod 644 /etc/profile.d/xorg.sh</userinput></screen>

    <para>Si vous décidez d'utiliser le prefixe standard
    <filename class="directory">/usr</filename>, vous pouvez omettre le rappel
    de cette page. Cependant, soyez certain d'ajouter
    <filename class="directory">$XORG_PREFIX/bin</filename> à votre variable d'environnement
    <envar>PATH</envar>, et <filename class="directory">$XORG_PREFIX/lib/pkgconfig</filename>
    et <filename class="directory">$XORG_PREFIX/share/pkgconfig</filename>
    à votre variable <envar>PKG_CONFIG_PATH</envar>. Taper les commandes suivantes
    en tant que <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen><userinput role="root">cat &gt;&gt; /etc/profile.d/xorg.sh &lt;&lt; "EOF"

pathappend $XORG_PREFIX/bin PATH
pathappend $XORG_PREFIX/lib/pkgconfig PKG_CONFIG_PATH
pathappend $XORG_PREFIX/share/pkgconfig PKG_CONFIG_PATH
export PATH PKG_CONFIG_PATH
EOF</userinput></screen>

    <para>Vous pouvez aussi ajouter
    <filename class="directory">$XORG_PREFIX/lib</filename> dans le fichier
    <filename>/etc/ld.so.conf</filename>. De nouveau, en tant que 
    <systemitem class="username">root</systemitem>&nbsp;, taper la commande suivante:</para>

<screen><userinput role="root">echo "${XORG_PREFIX}/lib" >> /etc/ld.so.conf</userinput></screen>

    <para>Vous pouvez aussi modifier
    <filename>/etc/man_db.conf</filename>, en ajoutant les entrées appropriées
    MANDATORY_MANPATH, MANPATH_MAP, et MANDB_MAP comme le montre les exemples
    examples de <filename class="directory">/usr/X11R6</filename>. Taper la commande
    suivante en tant qu'utilisateur <systemitem class="username">root</systemitem>:</para>

<screen><userinput role="root">sed 's@/usr/X11R6@<replaceable>&lt;PREFIX&gt;</replaceable>@g' -i /etc/man_db.conf</userinput></screen>

    <para>Enfin, si vous construisez en x86_64, vous devrez créer le répertoire
    <filename class="directory">$XORG_PREFIX/lib</filename> et le lien symbolique
    <filename>$XORG_PREFIX/lib64</filename>. De nouveau en tant que 
    <systemitem class="username">root</systemitem>&nbsp;, taper les commandes suivantes
    &nbsp;:</para>

<screen><userinput role="root">install -v -m755 -d $XORG_PREFIX &amp;&amp;
install -v -m755 -d $XORG_PREFIX/lib &amp;&amp;
ln -s lib $XORG_PREFIX/lib64</userinput></screen>

   </sect2>

</sect1>
