<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="xorg-config">
  <?dbhtml filename="xorg-config.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: krejzi $</othername>
    <date>$Date&nbsp;: 2012-04-14 04:06:03 +0200 (Sat, 14 Apr 2012) $</date>
  </sect1info>
  
  <title>Xorg-&xorg7-release; Test et configuration</title>

  <indexterm zone="xorg-config">
    <primary sortas="g-configuring-xorg">Configuring Xorg</primary>
  </indexterm>

    <sect2 id='X11-testing' xreflabel="Testing Xorg">
    <title>Test de Xorg</title>
     
    <para>Pour tester l'installation de <application>Xorg</application>, tapez
    <userinput>startx</userinput>.  Cette commande lance un gestionnaire de fenêtres
    très rudimentaire appelé <emphasis>twm</emphasis> avec trois terminaux X (xterm)
    et une fenêtre d'horloge (xclock). Le terminal X dans le coin supérieur gauche
    est un terminal de login et lance <emphasis>exit</emphasis> dans le terminal 
    quand l'on quittera la session <application>X Window</application>. 
    Le troisième terminal X peut être recouvert sur votre système par les deux 
    autres terminaux X.</para>
    
    <para>Généralement, il n'y a pas de configuration spécifique requise pour
    <application>Xorg</application>, mais une personnalisation est possible.  Pour plus de détails
    voir <xref linkend='xconfig'/> en dessous.</para>

    </sect2>

    <sect2 role="configuration" id='checking-dri' xreflabel="Checking the DRI installation">
    <title>Vérifier l'installation de la Direct Rendering Infrastructure (DRI)</title>

    <para>DRI est un environnement permettant aux logiciels d'accéder au matériel
    graphique d'une manière sûre et efficace. Elle est installée par défaut dans
    <application>X</application> (en utilisant <application>MesaLib</application>) 
    si vous avez une carte graphique supportée.</para>

    <para>Pour vérifier que la DRI est installée correctement, vérifiez que le
    fichier journal <filename>/var/log/Xorg.0.log</filename> contient des messages
    comme&nbsp;:</para>

<screen><literal>(II) R128(0): Direct rendering enabled</literal></screen>

    <note><para>Il se peut que la configuration DRI diffère si vous utilisez
    d'autres pilotes tels que ceux de 
    <ulink url="http://www.nvidia.com/page/home.html">NVIDIA</ulink> ou de
    <ulink url="http://www.ati.com/">ATI</ulink>.</para>
    </note>

    <para>Alors que tous les utilisateurs peuvent utiliser l'accélération logicielle,
    l'accélération matérielle (DRI2), n'est disponible que pour
    <systemitem class="username">root</systemitem> et les membres du groupe
    <systemitem class="groupname">video</systemitem>.</para>

    <para>Pour voir si l'accélération matérielle est disponible pour votre pilote,
    cherchez dans <filename>/var/log/Xorg.0.log</filename> des messages
    comme&nbsp;:</para>

<screen><literal> (II) intel(0): direct rendering: DRI2 Enabled</literal></screen>

    <para>Si votre pilote est supporté, ajoutez les utilisateurs qui pourraient
    utiliser X à ce groupe&nbsp;:</para>

<screen role="root"><userinput>usermod -a -G video <replaceable>&lt;username&gt;</replaceable></userinput></screen>

    <para>Si vous optez pour l'installation du paquet Mesa-Demos lors de
    l'installation de
    <xref linkend="mesalib"/>, depuis un <command>xterm</command>, lancez
    <command>glxinfo</command> et cherchez d'emblée le passage&nbsp;:</para>

<screen><computeroutput>direct rendering: Yes</computeroutput></screen>

    <para>Si direct rendering est activé, vous pouvez ajouter de la verbosité en
    lançant <command>LIBGL_DEBUG=verbose glxinfo</command>.  Ceci affichera
    les pilotes, les n&oelig;uds de périphériques et les fichiers utilisés par 
    le système DRI.</para>

    <para>Si la DRI est activée, pour confirmer que l'accélération matérielle 
    DRI2 fonctionne, vous pouvez (toujours dans un <command>xterm</command>) 
    lancer la commande 
    <command>glxinfo | grep "OpenGL renderer string"</command> - si cela
    renvoie quelque chose <emphasis>d'autre que</emphasis>
    <literal>Software Rasterizer</literal> c'est que l'accélération fonctionne
    pour l'utilisateur qui a lancç la commande.</para>

    <para>De nouveau, si vous avez ajouté le paquet Mesa-Demos, vous pouvez
    aussi lancer le programme de test <command>glxgears</command>.
    Ce programme affiche une fenêtre de trois boutons à bascule. Le
    <command>xterm</command> affichera le nombre de cadres dessinés toutes les
    cinq secondes, donc c'est un test fiable. La fenêtre est échelonable et les
    cadres dessinés par secondes dépendent beaucoup de la taille de la fenêtre.</para>

    </sect2>

    <sect2 role="configuration" id='X11R6-compat-symlink'
         xreflabel="Creating an X11R6 Compatibility Symlink">

    <title>Création d'un lien symbolique de compatibilité X11R6</title>

    <para>Jusqu'à récemment (relativement parlant) presque toutes les
    installations <application>X Window</application> que vous avez effectuées
	ou rencontrées étaient installées dans le répertoire
    <filename class='directory'>/usr/X11R6</filename>. Cela a été la norme
	pendant des années. Les développeurs restant sur cela ont écrit leurs scripts
	d'installation des paquets à la recherche de <application>X</application> dans 
	l'emplacement standard. Les choses ont changées et la tendance est d'installer
	maintenant <application>X</application> dans <filename class='directory'>/usr</filename>.
	Certaines personnes veulent installer dans un emplacement personnalisé.</para>

    <para>Beaucoup de développeurs de paquets n'ont pas rattrapé le changement
	et leurs paquets sont encore à essayer de trouver <application>X</application> dans
    <filename class='directory'>/usr/X11R6</filename> et donc échouent quand
    vous essayez de construire le paquet. Si pour la plupart des  paquets, il n'est
	pas difficile de «hacker» le script d'installation pour résoudre le problème,
	ce n'est pas la solution à long terme au problème. Les développeurs amont ont
	besoin de moderniser leurs scripts d'installation et d'éliminer complètement le problème.</para>

    <para>Jusque-là, vous pouvez créer un lien symbolique pour satisfaire 
	la nécessité de <filename class='directory'>/usr/X11R6</filename> de sorte que vous ne
	serez pas gêné avec un échec de construction de paquet en raison de ce problème connu.
	Si vous souhaitez créer le lien symbolique, taper la commande suivante en tant que
    <systemitem class="username">root</systemitem>&nbsp;</para>

<screen role="root"><userinput>ln -vsf $XORG_PREFIX /usr/X11R6</userinput></screen>

    </sect2>

    <sect2 role="configuration" id="xft-font-protocol"  xreflabel="Xft Font Protocol">
      <title>Protocole Xft Font</title>

      <indexterm zone="xft-font-protocol" id="fonts">
        <primary sortas="g-truetype">TrueType Fonts</primary>
      </indexterm>

      <para>Xft fournit le rendu des polices anti-crénelage à travers
      <application>Freetype</application>, et les polices sont contrôlés par 
	  le côté client à l'aide de <application>Fontconfig</application>. Le chemin
	  de recherche par défaut est <filename class="directory">/usr/share/fonts</filename>
      et <filename class="directory">~/.fonts</filename>.
      <application>Fontconfig</application> recherche des répertoires dans son chemin
	  de façon récursive et  maintient un cache des caractéristiques de la police dans
      les fichiers <filename>fonts.cache-1</filename> dans chaque répertoire.  Si le
	  cache semble  pas être à jour, il est ignorée, et l'information est (lentement)
	  extraites de la polices elles-mêmes. Ce cache peut être régénéré en utilisant 
	  <command> fc-cache  </command> à tout moment. Vous pouvez voir la liste des polices
	  connues par <application>Fontconfig</application> en exécutant la commande
      <command>fc-list</command>.</para>

      <para>si vous avez installé <application>Xorg</application> dans n'importe quel
	  préfixe autre que <filename class="directory">/usr</filename>, Les polices
      <application>X</application> ne seront pas installées dans un emplacement connu
	  par <application>Fontconfig</application>. Cela empêche
      <application>Fontconfig</application> d'utiliser le faible rendu des polices
	  Type 1 ou les polices non-évolutive  bitmap. Les liens symboliques sont créés
      depuis <filename class="directory">OTF</filename> et <filename
      class="directory">TTF</filename> les répertoires de polices <application>X</application>
	  vers <filename class="directory">/usr/share/fonts/X11-{OTF,TTF}</filename>.
	  Cela autorise <application>Fontconfig</application> à utiliser les polices
	  OpenType et TrueType fournies par <application>X</application> (qui sont évolutives
	  et de qualité supérieure).</para>

      <para><application>Fontconfig</application> utilise des noms comme
      "Monospace 12" pour définir les polices.  Les applications utilisent généralement
	  les noms de polices génériques telles que  "Monospace", "Sans" et "Serif".
      <application>Fontconfig</application> résout ces noms par une police qui a tous
	  les caractères  qui couvrent l'orthographe de la langue indiquée par
	  les paramètres régionaux.  La connaissance de ces noms de polices est inclus dans
      <filename>/etc/fonts/fonts.conf</filename>. Les polices qui ne sont pas répertoriés
	  dans ce fichier restent utilisables par <application>Fontconfig</application>,
      mais elles ne seront pas  accessibles  par les noms de familles génériques.</para>

      <para>Les polices standards évolutives qui accompagnent <application>X</application>
      fournissent une très mauvaise couverture d'Unicode.  Vous remarquerez peut-être
	  dans les applications qui utilisent <application> Xft </application> que certains
	  caractères apparaissent comme une boîte avec quatre chiffres binaires à l'intérieur.
	  Dans ce cas, un jeu de polices avec les  glyphes  disponibles  n'a pas été trouvé. 
	  D'autres fois, les applications qui n'utilisent pas d'autres familles de polices
	  par défaut et n'ont pas accepté les substitutions de l'<application> Fontconfig </application>
	  affichent des lignes vides lorsque la police par défaut ne couvre pas l'orthographe 
	  de la langue de l'utilisateur. Cela arrive, par exemple avec <application> Fluxbox </application>
	  dans la localisation ru_RU.KOI8-R.</para>

      <para>Afin d'offrir une plus grande couverture d'Unicode, il est recommandé
       que vous installiez ces polices:</para>

      <itemizedlist>
        <listitem>
          <para><ulink url="http://dejavu.sourceforge.net/">DejaVu fonts</ulink>
          - Ces polices sont des remplacements  pour les polices Bitstream Vera et
         fournissent des scripts basés sur le latin avec des accents et des glyphes
		 cyrilliques.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://download.savannah.nongnu.org/releases/freefont/">FreeFont</ulink>
          - Cet ensemble de polices couvre presque tous les caractères non-CJC, mais
		  n'est pas agréable visuellement. <application>Fontconfig</application> va 
		  l'utiliser comme un dernier recours pour remplacer les noms génériques 
		  de la famille de polices.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://corefonts.sourceforge.net/">Microsoft Core fonts</ulink>
          - Ces polices offrent une couverture légèrement moins bonne que freefont d'Unicode,
		  mais font plus illusion. Soyez sûr de lire la licence avant de les utiliser.
		  Ces polices sont énumérés dans les alias du répertoire 
          <filename class="directory">/etc/fonts/fonts.d</filename> par défaut.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://cle.linux.org.tw/fonts/FireFly">Firefly New Sung font</ulink>
          - Cette police fourni la couverture chinoise. Ces polices sont énumérés 
		  dans les alias du répertoire <filename class="directory">/etc/fonts/fonts.d</filename>
		  par défaut.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://cle.linux.org.tw/fonts/Arphic">Arphic fonts</ulink> -
          un ensemble similaire à la police Firefly New Sung de polices chinoises.
          Ces polices sont énumérés dans les alias du répertoire 
          <filename class="directory">/etc/fonts/fonts.d</filename> par défaut.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://sourceforge.jp/projects/efont/">Kochi fonts</ulink> -
          Elles fournissent les caractères japonnais, et sont listées dans les alias
          du répertoire <filename class="directory">/etc/fonts/fonts.d</filename>
          par défaut.</para>
        </listitem>
        <listitem>
          <para><ulink
          url="http://kldp.net/projects/baekmuk/">Baekmuk fonts</ulink>
          - Ces polices fournissent la couverture Coréenne, et sont listées dans les alias
          du répertoire <filename class="directory">/etc/fonts/fonts.d</filename>
          par défaut.</para>
        </listitem>
        <listitem>
          <para><ulink url="&gnome-download-http;/cantarell-fonts/0.0/">Polices Cantarell</ulink>
          - La famille des polices Cantarell fournit une contemporaine Humaniste sans
          serif. Elle est particulièrement optimisée pour être lisible dans les petites tailles
	  et est la famille de polices préférée pour l'interface utilisateur de 
	  <application>GNOME-3</application>.</para>
        </listitem>
      </itemizedlist>

      <para>La liste ci-dessus ne donnera pas une couverture complète d'Unicode.
	  Pour plus d'informations, vous pouvez consulter le <ulink
      url="http://unifont.org/fontguide/">Unicode Font Guide</ulink>.</para>

      <para>Par exemple, considérons l'installation des polices DejaVu. A partir
      du répertoire source décompressé, exécuter les commandes suivantes en tant que
      <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -d -m755 /usr/share/fonts/dejavu &amp;&amp;
install -v -m644 *.ttf /usr/share/fonts/dejavu &amp;&amp;
fc-cache -v /usr/share/fonts/dejavu</userinput></screen>

    </sect2>

  <sect2 role="configuration" id='xconfig'>
    <title>Configuration des périphériques Xorg</title>
    <para>Pour la plupart des configurations matérielles, Xorg va automatiquement
	obtenir la configuration correcte du serveur sans aucune intervention de l'utilisateur.
	Il existe, cependant, certains cas où l'auto-configuration sera incorrecte. Voici quelques
	exemples de la configuration manuelle qui peuvent être utile dans ces cas la.</para>

    <sect3 id="xinput">
    <title>Configuration des périphériques X d'entrée</title>
    <para>Pour la plupart des appareils d'entrée, aucune configuration supplémentaire sera
     nécessaires. Cette section est fourni à titre informatif seulement.</para>
    
    <para>Un exemple de configuration XKB par défaut peut être comme le suivant (executé en tant que
    <systemitem class="username">root</systemitem>&nbsp;):</para>
<screen><userinput role="username">cat &gt; /etc/X11/xorg.conf.d/xkb-defaults.conf &lt;&lt; "EOF"
Section "InputClass"
    Identifier "XKB Defaults"
    MatchIsKeyboard "yes"
    Option "XkbOptions" "terminate:ctrl_alt_bksp"
EOF</userinput></screen>

  </sect3>

  <sect3 id="xdisplay">
  <title>Réglage fin des paramètres d'affichage</title>
  <para>Encore une fois, avec Xorg, peu ou aucune configuration supplémentaire n'est
   nécessaires. Si vous avez besoin d'options supplémentaires à passer à votre pilote vidéo,
   par exemple, vous pouvez utiliser ce qui suit (de nouveau, executé en tant que 
  <systemitem class="username">root</systemitem>&nbsp;):</para>

<screen><userinput role="root">cat &gt; /etc/X11/xorg.conf.d/videocard-0.conf &lt;&lt; "EOF"
Section "Device"
    Identifier  "Videocard0"
    Driver      "radeon"
    VendorName  "Videocard vendor"
    BoardName   "ATI Radeon 7500"
    Option      "NoAccel" "true"
EndSection
EOF</userinput></screen>

  <para>Une autre configuration courante est d'avoir des configurations multi-serveurs pour
  une utilisation dans des environnements différents. Bien que le serveur détecte automatiquement
  la présence d'un autre moniteur, il peut obtenir un ordre incorrect:</para>

<screen><userinput role="root">cat &gt; /etc/X11/xorg.conf.d/server-layout.conf &lt;&lt; "EOF"
Section "ServerLayout"
    Identifier     "DefaultLayout"
    Screen      0  "Screen0" 0 0
    Screen      1  "Screen1" LeftOf "Screen0"
    Option         "Xinerama"
EndSection
EOF</userinput></screen>

  </sect3>
  </sect2>
</sect1>
