<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      À propos des périphériques
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">systemd)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;3.&nbsp;Questions de configuration après LFS
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="firmware.html" title=
          "À propos des Firmwares">Précédent</a>
          <p>
            À propos des Firmwares
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="skel.html" title=
          "Configuration de l'ajout d'utilisateurs">Suivant</a>
          <p>
            Configuration de l'ajout d'utilisateurs
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="config.html" title=
          "Chapitre&nbsp;3.&nbsp;Questions de configuration après LFS">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="postlfs-devices" name="postlfs-devices"></a>À propos des
        périphériques
      </h1>
      <p>
        Bien que la plupart des périphériques dont ont besoin les paquets de
        BLFS ont été correctement paramétrés par <span class=
        "application">udev</span> en utilisant les règles par défaut
        installées par LFS dans <code class=
        "filename">/etc/udev/rules.d</code>, il y a des cas où il faut
        modifier ou ajouter des règles.
      </p>
      <p class="usernotes">
        Notes utilisateur&nbsp;: <a class="ulink" href=
        "https://wiki.linuxfromscratch.org/blfs/wiki/aboutdevices">https://wiki.linuxfromscratch.org/blfs/wiki/aboutdevices</a>
      </p>
      <div class="sect2" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Cartes sons multiples
        </h2>
        <p>
          S'il y a plusieurs cartes sons sur un système, la carte son
          «&nbsp;default&nbsp;» (par défaut) devient aléatoire. La méthode
          pour établir un ordre dans les cartes sons dépend du fait que les
          pilotes soient en modules ou pas. Si les pilotes de la carte son
          sont compilés dans le noyau, leur contrôle s'effectue via des
          paramètres de la ligne de commande du noyau dans <code class=
          "filename">/boot/grub/grub.cfg</code>. Par exemple, si un système
          contient une carte FM801 et une carte PCI SoundBlaster, ce qui suit
          peut être ajouté à la ligne de commande&nbsp;:
        </p>
        <pre class="screen"><code class=
        "literal">snd-fm801.index=0 snd-ens1371.index=1</code></pre>
        <p>
          Si les pilotes de la carte son sont construits en modules, on peut
          établir l'ordre dans le fichier <code class=
          "filename">/etc/modprobe.conf</code> avec&nbsp;:
        </p>
        <pre class="screen"><code class="literal">options snd-fm801 index=0
options snd-ens1371 index=1</code></pre>
      </div>
      <div class="sect2" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="usb-device-issues" name="usb-device-issues"></a>Problèmes
          sur les périphériques USB
        </h2>
        <p>
          Les périphériques USB ont habituellement deux types de nœuds de
          périphériques associés avec eux.
        </p>
        <p>
          Le premier type est créé par le pilote du périphérique spécifique
          (usb_storage/sd_mod ou usblp) dans le noyau. Par exemple, un
          périphérique de stockage USB peut être /dev/sdb, et une imprimante
          USB peut être /dev/usb/lp0. Ces nœuds de périphériques existent
          seulement quand le pilote du périphérique spécifique est chargé.
        </p>
        <p>
          Le second type de nœud de périphériques (/dev/bus/usb/BBB/DDD, ou
          BBB est le numéro du bus et DDD est le numéro du périphérique) est
          créé chaque fois que le périphérique n'a pas de driver dans le
          noyau. En utilisant ces nœuds de périphérique USB "directs", une
          application peut échanger arbitrairement des paquets USB avec le
          périphérique, c'est-à-dire, court-circuiter le possible pilote
          existant du noyau.
        </p>
        <p>
          Accéder aux nœuds périphériques USB directement est nécessaire
          quand un programme de l'espace utilisateur est considéré comme un
          pilote de périphérique. Cependant, pour que le programme ouvre avec
          succès le périphérique, les permissions doivent être initialisées
          correctement. Par défaut, pour des considérations de sécurité, tous
          les périphériques USB directs appartiennent à l'utilisateur root et
          au groupe usb, et ont la permission 0664 (l'accès en lecture est
          nécessaire, par exemple pour que lsusb puisse travailler et pour
          les programmes d'accès aux concentrateurs USB). Des paquets (comme
          SANE et libgphoto2) contenant un pilote de périphérique USB dans
          l'espace utilisateur utilisent aussi les règles udev pour changer
          les permissions des périphériques USB contrôlés. Ce qui fait que
          les règles installées par SANE changent les permissions pour les
          scanners reconnus, mais pas pour les imprimantes. Si le mainteneur
          du paquet oublie d'écrire une règle pour votre périphérique,
          signalez le bogue à BLFS (si le paquet est ici) et en amont, et
          vous aurez besoin d'écrire votre propre règle.
        </p>
        <p>
          Il y a une situation ou un contrôle d'accès fin avec des règles
          udev pré-générées ne marche pas. Nommément, les émulateurs de PC
          comme KVM, QEMU et VirtualBox utilisent des nœuds de périphérique
          USB direct pour les périphériques USB arbitrairement présents dans
          le système d'exploitation invité (note&nbsp;: des correctifs sont
          nécessaires pour que cela fonctionne dans les points de montage
          obsolètes /proc/bus/usb décris précédemment). Naturellement, les
          mainteneurs de ces paquets ne peuvent pas connaître quels
          périphériques USB seront connectés sur le système d'exploitation
          invité. Vous pouvez soit écrire des règles udev séparées pour tous
          les périphériques USB nécessaires vous même, soit utiliser les
          règles par défaut du groupe "usb", les membres de celui-ci pouvant
          envoyer des commandes arbitraires pour tous périphériques USB.
        </p>
        <p>
          Avant Linux-2.6.15, l'accès direct aux périphériques USB n'était
          pas géré avec les nœuds de périphériques /dev/bus/usb/BBB/DDD, mais
          avec des pseudo-fichiers /proc/bus/usb/BBB/DDD. Quelques
          applications (par exemple., VMware Workstation) semblent utiliser
          seulement cette technique obsolète et ne peuvent pas utiliser les
          nouveaux nœuds de périphériques. Pour qu'elles puissent
          fonctionner, utiliser le groupe "usb", mais rappelez-vous que les
          membres ont un accès complet à tous les périphériques USB. Pour
          créer l'entrée fstab pour le fichier système obsolète usbfs:
        </p>
        <pre class="screen"><code class=
        "literal">usbfs  /proc/bus/usb  usbfs  devgid=14,devmode=0660  0  0</code></pre>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Ajouter les utilisateurs dans le groupe "usb" est par nature pas
            sécurisé, car cela court-circuite les restrictions d'accès
            imposées par les pilotes spécifiques des nœuds de périphériques
            USB. Par nature, ils peuvent lire des données sensibles des
            disques USB sans être dans le groupe "disque". Évitez d'ajouter
            des utilisateurs dans ce groupe si vous le pouvez.
          </p>
        </div>
      </div>
      <div class="sect2" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Attributs de périphériques d'Udev
        </h2>
        <p>
          Le peaufinage des attributs de périphériques tels que le nom du
          groupe et les droits est possible en créant des règles <span class=
          "application">udev</span> supplémentaires, correspondant à quelque
          chose de ce genre. On peut trouver le fabricant et le produit en
          cherchant les entrées du répertoire <code class=
          "filename">/sys/devices</code> ou en utilisant <span class=
          "command"><strong>udevinfo</strong></span> après avoir attaché le
          périphérique. Voir la documentation dans le répertoire
          d'<span class="application">udev</span> actuel <code class=
          "filename">/usr/share/doc</code> pour des détails.
        </p>
        <pre class="screen"><code class=
        "literal">SUBSYSTEM=="usb_device", SYSFS{idVendor}=="05d8", SYSFS{idProduct}=="4002", \
  GROUP:="scanner", MODE:="0660"</code></pre>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            On n'utilise la ligne ci-dessus qu'à des fins descriptives. Les
            règles d'analyse d'<span class="application">udev</span> sont
            mises en place lors de l'installation de <a class="xref" href=
            "../pst/sane.html" title="SANE-1.0.29">SANE-1.0.29</a>.
          </p>
        </div>
      </div>
      <div class="sect2" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="dev-dvd" name="dev-dvd"></a>Périphériques pour les lecteurs
          DVD
        </h2>
        <p>
          Si le processus de démarrage initial ne met pas en place le
          périphérique <code class="systemitem">/dev/dvd</code> correctement,
          cela peut être fait avec les modifications suivantes des règles
          udev par défaut. En tant qu'utilisateur <code class=
          "systemitem">root</code>, lancez&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed '1d;/SYMLINK.*cdrom/ a\
KERNEL=="sr0", ENV{ID_CDROM_DVD}=="1", SYMLINK+="dvd", OPTIONS+="link_priority=-100"' \
/lib/udev/rules.d/60-cdrom_id.rules &gt; /etc/udev/rules.d/60-cdrom_id.rules</kbd></pre>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="firmware.html" title=
          "À propos des Firmwares">Précédent</a>
          <p>
            À propos des Firmwares
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="skel.html" title=
          "Configuration de l'ajout d'utilisateurs">Suivant</a>
          <p>
            Configuration de l'ajout d'utilisateurs
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="config.html" title=
          "Chapitre&nbsp;3.&nbsp;Questions de configuration après LFS">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
