<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      autofs-5.1.7
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">systemd)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;12.&nbsp;Outils systèmes
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="at.html" title="at-3.2.2">Précédent</a>
          <p>
            at-3.2.2
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="bluez.html" title="BlueZ-5.61">Suivant</a>
          <p>
            BlueZ-5.61
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="autofs" name="autofs"></a>autofs-5.1.7
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à Autofs
        </h2>
        <p>
          <span class="application">Autofs</span> contrôle les opérations du
          démon d'automontage. Le démon d'automontage monte automatiquement
          les systèmes de fichier quand ils sont accessibles et les démonte
          après une période d'inactivité. C'est fait sur la base d'un
          ensemble de règles pré-configurées.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.0
          platform.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://www.kernel.org/pub/linux/daemons/autofs/v5/autofs-5.1.7.tar.xz">
                https://www.kernel.org/pub/linux/daemons/autofs/v5/autofs-5.1.7.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=""></a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                6bd1ea8a9e5dc3a7dc95119e3bbaf52c
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 324&nbsp;Ko
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 6.7&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0.1 SBU
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de Autofs
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="../basicnet/libtirpc.html" title=
          "libtirpc-1.3.2">libtirpc-1.3.2</a> et <a class="xref" href=
          "../basicnet/rpcsvc-proto.html" title=
          "rpcsvc-proto-1.4.2">rpcsvc-proto-1.4.2</a>
        </p>
        <h4>
          Facultatives
        </h4>
        <p class="optional">
          <a class="xref" href="../basicnet/nfs-utils.html" title=
          "NFS-Utils-2.5.4">nfs-utils-2.5.4</a>, <a class="xref" href=
          "../basicnet/libnsl.html" title="libnsl-1.3.0">libnsl-1.3.0</a>,
          <a class="xref" href="libxml2.html" title=
          "libxml2-2.9.12">libxml2-2.9.12</a>, <a class="xref" href=
          "../postlfs/mitkrb.html" title="MIT Kerberos V5-1.19.2">MIT
          Kerberos V5-1.19.2</a>, <a class="xref" href=
          "../server/openldap.html" title="OpenLDAP-2.5.7">OpenLDAP-2.5.7</a>
          (client uniquement) et <a class="xref" href=
          "../postlfs/cyrus-sasl.html" title="Cyrus SASL-2.1.27">Cyrus
          SASL-2.1.27</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/autofs">https://wiki.linuxfromscratch.org/blfs/wiki/autofs</a>
        </p>
      </div>
      <div class="kernel" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="autofs-kernel" name="autofs-kernel"></a>Configuration du
          noyau
        </h2>
        <p>
          Vérifiez que le support d'auto-montage du noyau a été activé&nbsp;:
        </p>
        <pre class="screen"><code class="literal">File systems ---&gt;
  &lt;*/M&gt; Kernel automounter support (supports v3, v4, and v5) [CONFIG_AUTOFS_FS]</code></pre>
        <p>
          Éventuellement, activez les options suivantes dans la configuration
          du noyau&nbsp;:
        </p>
        <pre class="screen"><code class="literal">File systems  ---&gt;
  [*] Network File Systems  ---&gt;                                      [CONFIG_NETWORK_FILESYSTEMS]
    &lt;*/M&gt; NFS client support                                          [CONFIG_NFS_FS]
    &lt;*/M&gt; SMB3 and CIFS support (advanced network filesystem)         [CONFIG_CIFS]</code></pre>
        <p>
          Recompilez et installez le nouveau noyau si nécessaire.
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de Autofs
        </h2>
        <p>
          Certaines lignes de code doivent être supprimées pour que ce paquet
          reste cohérent avec glibc-2.34. Nous supprimerons ces lignes avec
          des commandes sed par numéro de ligne avec des méthodes légèrement
          différentes.
        </p>
        <pre class="userinput"><kbd class="command">sed -e '87d'        \
    -e '2618,2644d' \
    -i daemon/automount.c &amp;&amp;

sed -i '1178,1180d' daemon/state.c &amp;&amp;
sed -i '275,+2 d'   lib/alarm.c</kbd></pre>
        <p>
          Installez <span class="application">Autofs</span> en lançant les
          commandes suivantes&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr             \
            --with-mapdir=/etc/autofs \
            --with-libtirpc           \
            --with-systemd            \
            --without-openldap        \
            --mandir=/usr/share/man &amp;&amp;
make</kbd></pre>
        <p>
          Ce paquet n'est pas fourni avec une suite de tests.
        </p>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install</kbd></pre>
        <div class="admon caution">
          <img alt="[Attention]" src="../images/caution.png" />
          <h3>
            Attention
          </h3>
          <p>
            Si <span class="application">autofs</span> est déjà installé sur
            votre système, assurez-vous de sauvegarder vos fichiers de
            configuration. Ils seront écrasés par la commande suivante.
          </p>
        </div>
        <p>
          Installez les fichiers de configuration par défaut, toujours en
          tant qu'utilisateur <code class="systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">make install_samples</kbd></pre>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <em class="parameter"><code>--with-libtirpc</code></em>&nbsp;: Ce
          paramètre force le paquet à utiliser libtirpc pour la
          fonctionnalité RPC plutôt que d'utiliser l'implémentation de Glibc
          qui a été supprimée dans LFS 8.1.
        </p>
        <p>
          <em class="parameter"><code>--with-systemd</code></em>&nbsp;: Ce
          paramètre active l'installation des unités systemd incluses.
        </p>
        <p>
          <em class="parameter"><code>--without-openldap</code></em>&nbsp;:
          Ce paramètre désactive openldap s'il est trouvé. Si openldap est
          souhaité, supprimez ce paramètre. Notez que le support de openldap
          dans autofs nécéssite <a class="xref" href="../postlfs/mitkrb.html"
          title="MIT Kerberos V5-1.19.2">MIT Kerberos V5-1.19.2</a>.
        </p>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration d'Autofs
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="autofs-config" name="autofs-config"></a>Fichiers de
            configuration
          </h3>
          <p>
            <code class="filename">/etc/sysconfig/autofs.conf</code>,
            <code class="filename">/etc/autofs/auto.master</code>,
            <code class="filename">/etc/autofs/auto.misc</code> et
            <code class="filename">/etc/autofs/auto.net</code>
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            Informations de configuration
          </h3>
          <p>
            Le processus d'installation crée <code class=
            "filename">auto.master</code>, <code class=
            "filename">auto.misc</code>, <code class=
            "filename">auto.smb</code> et <code class=
            "filename">auto.net</code>. Remplacez le fichier <code class=
            "filename">auto.master</code> avec les commandes suivantes en
            tant qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">mv /etc/autofs/auto.master /etc/autofs/auto.master.bak &amp;&amp;
cat &gt; /etc/autofs/auto.master &lt;&lt; "EOF"
<code class="literal"># Begin /etc/autofs/auto.master

/media/auto  /etc/autofs/auto.misc  --ghost
#/home        /etc/autofs/auto.home

# End /etc/autofs/auto.master</code>
EOF</kbd></pre>
          <p>
            Ce fichier crée un nouveau répertoire de médias, <code class=
            "filename">/media/auto</code> qui englobera tous les répertoires
            existants du même nom. Dans l'exemple, le fichier <code class=
            "filename">/etc/autofs/auto.misc</code>, contient une
            ligne&nbsp;:
          </p>
          <pre class=
          "screen">cd   -fstype=iso9660,ro,nosuid,nodev :/dev/cdrom</pre>
          <p>
            ce qui montera un cdrom en tant que <code class=
            "filename">/media/auto/cd</code> si ce répertoire est accessible.
            L'option <code class="option">--ghost</code> dit à l'automounteur
            de créer des versions <span class="quote">«&nbsp;<span class=
            "quote">fantômes</span>&nbsp;»</span> (c'est-à-dire des
            répertoires vides) de tous les points de montage listés dans le
            fichier de configuration, que les systèmes de fichiers soient
            effectivement montés ou pas. C'est très pratique et fortement
            recommandé car cela vous affichera les systèmes de fichiers qu'on
            peut monter automatiquement comme des répertoires existants, même
            quand leur système de fichiers n'est pas actuellement monté. Sans
            l'option <code class="option">--ghost</code>, vous devrez vous
            souvenir des noms des répertoires. Dès que vous essaierez
            d'accéder à l'un d'entre eux, le répertoire sera créé et le
            système de fichiers sera monté. Quand le système de fichiers est
            de nouveau démonté, le répertoire est lui aussi détruit, sauf si
            on a donné l'option <code class="option">--ghost</code>.
          </p>
          <div class="admon note">
            <img alt="[Note]" src="../images/note.png" />
            <h3>
              Note
            </h3>
            <p>
              Une méthode alternative serait de spécifier un autre
              emplacement d'automontage tel que <code class=
              "filename">/var/lib/auto/cdrom</code> et de créer un lien
              symbolique de <code class="filename">/media/cdrom</code> vers
              l'emplacement de l'automontage.
            </p>
          </div>
          <p>
            Le fichier <code class="filename">auto.misc</code> doit être
            configuré pour votre matériel. Le fichier de configuration chargé
            chargerait votre cdrom si <code class=
            "filename">/dev/cdrom</code> est actif ou s'il peut être édité
            pour s'adapter à votre configuration de périphériques. Des
            exemples pour les disquettes sont disponibles dans le fichier et
            facilement activables. La documentation de ce fichier est
            disponible en utilisant la commande <span class=
            "command"><strong>man 5 autofs</strong></span>.
          </p>
          <p>
            Sur la deuxième ligne, s'il est activé, un répertoire home pour
            l'utilisateur serait monté via NFS lors de la connexion. Le
            <code class="filename">/etc/home.auto</code> devrait exister et
            contenir une entrée du genre&nbsp;:
          </p>
          <pre class="screen">joe  example.org:/export/home/joe</pre>
          <p>
            où le répertoire <code class="filename">/export/home/joe</code>
            est exporté via NFS à partir du système example.org. Les partages
            NFS sont traités à la page suivante.
          </p>
          <p>
            On pourrait aussi utiliser ce paquet pour monter des partages SMB
            mais cette fonctionnalité n'est pas configurée dans ces
            instructions. Pour des informations de configuration
            supplémentaires, voir les pages de man d'auto.master(5). Il y a
            aussi des ressources Internet telles que celle disponible sur
            <a class="ulink" href="http://wiki.gentoo.org/wiki/AutoFS">AUTOFS
            HOWTO</a>.
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="autofs-init" name="autofs-init"></a> Unité Systemd
          </h3>
          <p>
            Pour démarrer <span class="application">Autofs</span> au
            démarrage, activez l'unité systemd précédemment installée en
            lançant la commande suivante en tant qu'utilisateur <code class=
            "systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">systemctl enable autofs</kbd></pre>
          <div class="admon note">
            <img alt="[Note]" src="../images/note.png" />
            <h3>
              Note
            </h3>
            <p>
              Vous pouvez aussi spécifier la variable <code class=
              "envar">OPTIONS</code> dans le fichier <code class=
              "filename">/etc/sysconfig/autofs</code> avec tout paramètre
              supplémentaire que vous voudriez donner au démon automount.
            </p>
          </div>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programme installé:</strong>
              <span class="segbody">automount</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">lookup_dir.so, lookup_file.so,
              lookup_files.so, lookup_hosts.so, lookup_ldap.so,
              lookup_multi.so, lookup_nis.so, lookup_nisplus.so,
              lookup_program.so, lookup_userhome.so, lookup_yp.so,
              mount_afs.so, mount_autofs.so, mount_bind.so, mount_changer.so,
              mount_ext2.so, mount_ext3.so, mount_ext4.so, mount_generic.so,
              mount_nfs.so, mount_nfs4.so, parse_amd.so et
              parse_sun.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/usr/lib/autofs, /etc/autofs</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="automount" name="automount"></a><span class=
                    "term"><span class=
                    "command"><strong>automount</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est le démon qui effectue un montage quand on sollicite
                    un périphérique
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="at.html" title="at-3.2.2">Précédent</a>
          <p>
            at-3.2.2
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="bluez.html" title="BlueZ-5.61">Suivant</a>
          <p>
            BlueZ-5.61
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
