<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      JS-78.13.0
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-914+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">systemd)</span> - Version r10.1-914+
      </h4>
      <h3>
        Chapitre&nbsp;9.&nbsp;Bibliothèques générales
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="jansson.html" title=
          "Jansson-2.13.1">Précédent</a>
          <p>
            Jansson-2.13.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="json-c.html" title="JSON-C-0.15">Suivant</a>
          <p>
            JSON-C-0.15
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="genlib.html" title=
          "Chapitre&nbsp;9.&nbsp;Bibliothèques générales">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="js78" name="js78"></a>JS-78.13.0
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à JS
        </h2>
        <p>
          <span class="application">JS</span> est le moteur JavaScript de
          Mozilla écrit en C. JS78 provient de Firefox.
        </p>
        <p>
          This package still needs to be checked.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://archive.mozilla.org/pub/firefox/releases/78.13.0esr/source/firefox-78.13.0esr.source.tar.xz">
                https://archive.mozilla.org/pub/firefox/releases/78.13.0esr/source/firefox-78.13.0esr.source.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=""></a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                872623fc9f93ea8d3f3290024f0c0925
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 319&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 3,0 Go (36 Mo
                installés après avoir supprimé la bibliothèque statique de 34
                Mo)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 2,4 SBU (sur une
                machine à 4 cœurs avec parallélisme à 4)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de JS78
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="autoconf213.html" title=
          "Autoconf2.13">Autoconf-2.13</a>, <a class="xref" href="icu.html"
          title="ICU-69.1">ICU-69.1</a>, <a class="xref" href="rust.html"
          title="Rustc-1.52.0">rustc-1.52.0</a> et <a class="xref" href=
          "which.html" title="Which-2.21 et Alternatives">Which-2.21</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/js78">https://wiki.linuxfromscratch.org/blfs/wiki/js78</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de JS
        </h2>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Contrairement à la plupart des autres paquets dans BLFS, les
            instructions ci-dessous requièrent que vous décompressiez
            <code class="filename">firefox-78.13.0esr.tar.xz</code> et
            entriez dans le répertoire <code class=
            "filename">firefox-78.13.0</code>.
          </p>
          <p>
            L'extraction de l'archive remettra les permissions du répertoire
            actuel à 0755 si vous avez les permissions nécessaires pour cela.
            Si vous faites cela dans un répertoire avec le bit sticky, comme
            <code class="filename">/tmp</code>, le processus terminera avec
            des messages d'erreur&nbsp;:
          </p>
          <div class="literallayout">
            <p>
              tar:&nbsp;.:&nbsp;Cannot&nbsp;utime:&nbsp;Operation&nbsp;not&nbsp;permitted<br />

              tar:&nbsp;.:&nbsp;Cannot&nbsp;change&nbsp;mode&nbsp;to&nbsp;rwxr-xr-t:&nbsp;Operation&nbsp;not&nbsp;permitted<br />

              tar:&nbsp;Exiting&nbsp;with&nbsp;failure&nbsp;status&nbsp;due&nbsp;to&nbsp;previous&nbsp;errors<br />
            </p>
          </div>
          <p>
            Cela termine avec un statut différent de zéro, mais ne signifie
            <span class="emphasis"><em>PAS</em></span> qu'il y a un vrai
            problème. Ne désarchivez pas en tant qu'utilisateur <code class=
            "systemitem">root</code> das un répertoire où le bit sticky est
            présent, cela le désactiverait.
          </p>
        </div>
        <p>
          Installez <span class="application">JS</span> en lançant les
          commandes suivantes&nbsp;:
        </p>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Si vous compilez ce paquet dans un chroot vous devez faire deux
            choses. Tout d'abord, en tant qu'utilisateur <code class=
            "systemitem">root</code>, assurez-vous que <code class=
            "filename">/dev/shm</code> est monté. Si vous ne le faites pas,
            le configury en <span class="application">Python</span> échouera
            avec un trace évocant <code class=
            "filename">/usr/lib/pythonN.N/multiprocessing/synchronize.py</code>.
            Lancez&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">mountpoint -q /dev/shm || mount -t tmpfs devshm /dev/shm</kbd></pre>
          <p>
            Deuxièmement, vous devez soit exporter en tant qu'utilisateur
            <code class="systemitem">root</code> la variable d'environnement
            <code class="envar">$SHELL</code> avec <span class=
            "command"><strong>export SHELL=/bin/sh</strong></span>, soit
            rajouter <code class="envar">SHELL=/bin/sh</code> devant
            l'invocation de la commande <span class=
            "command"><strong>configure</strong></span>.
          </p>
          <p>
            La compilation du code C++ respecte $MAKEFLAGS et utilise « j1 »
            par défaut, le code rust utilisera tous les processeurs.
          </p>
        </div>
        <pre class="userinput"><kbd class="command">mkdir obj &amp;&amp;
cd    obj &amp;&amp;

CC=gcc CXX=g++ \
../js/src/configure --prefix=/usr            \
                    --with-intl-api          \
                    --with-system-zlib       \
                    --with-system-icu        \
                    --disable-jemalloc       \
                    --disable-debug-symbols  \
                    --enable-readline        &amp;&amp;
make</kbd></pre>
        <p>
          Pour lancer la suite de tests de JS, lancez&nbsp;: <span class=
          "command"><strong>make -C js/src check-jstests
          JSTESTS_EXTRA_ARGS="--timeout 300 --wpt=disabled"</strong></span>.
          Il est recommandé de rediriger la sortie vers un fichier journal.
          En fonction de la machine, entre dix et quatorze tests de JS liés
          aux paramètres régionaux et aux fuseaux horaires échouent à cause
          d'un problème dans les versions récentes de <a class="xref" href=
          "icu.html" title="ICU-69.1">ICU-69.1</a>.
        </p>
        <p>
          Pour lancer la suite de tests du JIT, lancez&nbsp;: <span class=
          "command"><strong>make -C js/src check-jit-test
          JITTEST_EXTRA_ARGS="--timeout 300"</strong></span>. Un test peut
          échouer.
        </p>
        <div class="admon caution">
          <img alt="[Attention]" src="../images/caution.png" />
          <h3>
            Attention
          </h3>
          <p>
            Un problème avec le processus d'installation fait que les
            programmes qui se lient à la bibliothèque partagée JS78 (par
            exemple, GNOME Shell) crashent si JS78 est mis à jour ou
            réinstallé. Pour contourner le problème, supprimez l'ancienne
            version de la bibliothèque partagée JS78 avant
            l'installation&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">rm -fv /usr/lib/libmozjs-78.so</kbd></pre>
        </div>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
rm -v /usr/lib/libjs_static.ajs &amp;&amp;
sed -i '/@NSPR_CFLAGS@/d' /usr/bin/js78-config</kbd></pre>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <code class="envar">CC=gcc CXX=g++</code>&nbsp;: les développeurs
          en amont préfèrent maintenant <span class=
          "application">clang</span>, corrigez cela comme avec les autres
          paquets de Mozilla dans le livre BLFS.
        </p>
        <p>
          <em class="parameter"><code>--with-*</code></em>&nbsp;: ces
          paramètres permettent au système de construction d'utiliser les
          versions du système des bibliothèques ci-dessus. Ils sont requis
          pour la stabilité.
        </p>
        <p>
          <em class="parameter"><code>--enable-readline</code></em>&nbsp;: ce
          paramètre active la prise en charge de Readline dans le shell JS.
        </p>
        <p>
          <em class="parameter"><code>--disable-jemalloc</code></em>&nbsp;:
          ce paramètre désactive l'allocateur de mémoire interne utilisé dans
          JS78. jemalloc est conçu uniquement pour l'environnement du
          navigateur Firefox. Si JS78 utilise jemalloc, les autres
          applications qui l'utilisent peuvent crasher quand des éléments
          alloués par jemalloc sont libérés avec l'allocateur du système
          (glibc).
        </p>
        <p>
          <em class=
          "parameter"><code>--disable-debug-symbols</code></em>&nbsp;: ne
          génère pas les symboles de débogage parce qu'ils sont très gros et
          que la plupart des utilisateurs n'en ont pas besoin. Supprimez-le
          si vous voulez déboguer JS78.
        </p>
        <p>
          <span class="command"><strong>rm -v
          /usr/lib/libjs_static.ajs</strong></span>&nbsp;: supprimez une
          grosse bibliothèque statique qui n'est utilisée par aucun paquet de
          BLFS.
        </p>
        <p>
          <span class="command"><strong>sed -i '/@NSPR_CFLAGS@/d'
          /usr/bin/js78-config</strong></span>&nbsp;: évite que <span class=
          "command"><strong>js78-config</strong></span> n'utilise des CFLAGS
          bogués.
        </p>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">js78 et js78-config</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">libmozjs-78.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/usr/include/mozjs-78</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="js6-js78" name="js6-js78"></a><span class=
                    "term"><span class=
                    "command"><strong>js78</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    fournit une interface en ligne de commande au moteur
                    <span class="application">JavaScript</span>
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="js78-config" name="js78-config"></a><span class=
                    "term"><span class=
                    "command"><strong>js78-config</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est utilisé pour trouver le compilateur JS et les
                    drapeaux de l'éditeur de liens
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libmozjs-78" name="libmozjs-78"></a><span class=
                    "term"><code class=
                    "filename">libmozjs-78.so</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    contient les fonction de l'API de Mozilla JavaScript
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="jansson.html" title=
          "Jansson-2.13.1">Précédent</a>
          <p>
            Jansson-2.13.1
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="json-c.html" title="JSON-C-0.15">Suivant</a>
          <p>
            JSON-C-0.15
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="genlib.html" title=
          "Chapitre&nbsp;9.&nbsp;Bibliothèques générales">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
