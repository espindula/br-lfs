<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      dbus-1.12.20
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-914+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">systemd)</span> - Version r10.1-914+
      </h4>
      <h3>
        Chapitre&nbsp;12.&nbsp;Outils systèmes
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="cups-pk-helper.html" title=
          "cups-pk-helper-0.2.6">Précédent</a>
          <p>
            cups-pk-helper-0.2.6
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="fcron.html" title="Fcron-3.2.1">Suivant</a>
          <p>
            Fcron-3.2.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="dbus" name="dbus"></a>dbus-1.12.20
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à D-Bus
        </h2>
        <p>
          Bien que <span class="application">D-Bus</span> a été construit
          dans LFS, il y a des fonctionnalités offertes par le paquet dont
          d'autres paquets de BLFS ont besoin, mais leur dépendances ne
          tiennent pas dans LFS.
        </p>
        <p>
          This package still needs to be checked.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://dbus.freedesktop.org/releases/dbus/dbus-1.12.20.tar.gz">
                https://dbus.freedesktop.org/releases/dbus/dbus-1.12.20.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=""></a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                dfe8a71f412e0b53be26ed4fbfdc91c4
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 2.0 Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 21 Mo (plus 18 Mo
                pour les tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0,3 SBU (plus 8,0
                SBU pour les tests)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de D-Bus
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="systemd.html" title=
          "Systemd-249">Systemd-249</a>
        </p>
        <h4>
          Recommandées
        </h4>
        <p class="recommended">
          <a class="xref" href="../x/x7lib.html" title=
          "Bibliothèques Xorg">Bibliothèques Xorg</a> (pour le programme
          <span class="command"><strong>dubs-launch</strong></span>)
        </p>
        <h4>
          Facultatives
        </h4>
        <p class="optional">
          Pour les tests&nbsp;: <a class="xref" href="dbus-glib.html" title=
          "dbus-glib-0.112">dbus-glib-0.112</a>, <a class="xref" href=
          "python-modules.html#dbus-python" title="D-Bus Python-1.2.18">D-Bus
          Python-1.2.18</a>, <a class="xref" href=
          "python-modules.html#pygobject3" title=
          "PyGObject-3.40.1">PyGObject-3.40.1</a> et <a class="xref" href=
          "valgrind.html" title="Valgrind-3.17.0">Valgrind-3.17.0</a>&nbsp;;
          pour la documentation&nbsp;: <a class="xref" href="doxygen.html"
          title="Doxygen-1.9.1">Doxygen-1.9.1</a>, <a class="xref" href=
          "../pst/xmlto.html" title="xmlto-0.0.28">xmlto-0.0.28</a>,
          <a class="ulink" href=
          "https://pypi.python.org/pypi/mallard-ducktype">Ducktype</a> et
          <a class="ulink" href=
          "https://download.gnome.org/sources/yelp-tools/">Yelp Tools</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/dbus">https://wiki.linuxfromscratch.org/blfs/wiki/dbus</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de D-Bus
        </h2>
        <p>
          Installez <span class="application">D-Bus</span> en lançant les
          commandes suivantes (vous pouvez d'abord souhaiter observer la
          sortie de <span class="command"><strong>./configure
          --help</strong></span> et ajouter des paramètres désirés à la
          commande <span class="command"><strong>configure</strong></span>
          affichée ci-dessous)&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">./configure --prefix=/usr                        \
            --sysconfdir=/etc                    \
            --localstatedir=/var                 \
            --enable-user-session                \
            --disable-doxygen-docs               \
            --disable-xml-docs                   \
            --disable-static                     \
            --docdir=/usr/share/doc/dbus-1.12.20 \
            --with-console-auth-dir=/run/console \
            --with-system-pid-file=/run/dbus/pid \
            --with-system-socket=/run/dbus/system_bus_socket &amp;&amp;
make</kbd></pre>
        <p>
          Voir ci-dessous pour les instructions de test.
        </p>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install</kbd></pre>
        <p>
          Si vous utilisez une installation DESTDIR, <span class=
          "command"><strong>dbus-daemon-launch-helper</strong></span> doit
          être corrigé. Tapez en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">chown -v root:messagebus /usr/libexec/dbus-daemon-launch-helper &amp;&amp;
chmod -v      4750       /usr/libexec/dbus-daemon-launch-helper</kbd></pre>
        <p>
          Les tests de dbus ne peuvent pas être lancés avant l'installation
          de <a class="xref" href="dbus-glib.html" title=
          "dbus-glib-0.112">dbus-glib-0.112</a>. Ils doivent être lancés en
          tant qu'utilisateur non privilégié depuis une session locale avec
          une adresse de bus. Pour lancer la suite de tests standard, lancez
          <span class="command"><strong>make check</strong></span>.
        </p>
        <p>
          Si vous voulez lancer les tests unitaires, des paramètres
          supplémentaires doivent être passés à configure qui exposent des
          fonctionnalités supplémentaires dans les fichiers binaires mais ne
          sont pas destinées à être utilisées dans une construction de
          production de <span class="application">D-Bus</span>. Si vous
          souhaitez lancer les tests, tapez les commandes suivantes (pour les
          tests, vous n'avez pas besoin de construire la doc)&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">make distclean                                    &amp;&amp;
PYTHON=python3 ./configure --enable-tests         \
                           --enable-asserts       \
                           --disable-doxygen-docs \
                           --disable-xml-docs     &amp;&amp;
make                                              &amp;&amp;
make check</kbd></pre>
        <p>
          Il y a un signalement indiquant que les tests peuvent échouer s'ils
          sont lancés depuis un shell Midnight Commander. Il se peut vous
          ayez des messages d'erreur de dépassement de mémoire lors des
          tests. Ils sont normaux et vous pouvez sans problème les ignorer.
        </p>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <em class=
          "parameter"><code>--disable-doxygen-docs</code></em>&nbsp;: Ce
          paramètre désactive la construction de la documentation doxygen et
          son installation, si vous avez installé <span class=
          "application">doxygen</span>. Si <span class=
          "application">doxygen</span> est installé et que vous souhaitez
          construire et l'installer, effacez ce paramètre.
        </p>
        <p>
          <em class="parameter"><code>--disable-xml-docs</code></em>&nbsp;:
          Ce paramètre désactive la construction et l'installation de la
          documentation html si vous avez installé <span class=
          "application">xmlto</span>. Supprimez-le, si <span class=
          "application">xmlto</span> est installé et que vous souhaitiez la
          construire et l'installer.
        </p>
        <p>
          <em class="parameter"><code>--disable-static</code></em>&nbsp;: Ce
          paramètre empêche l'installation des versions statiques des
          bibliothèques.
        </p>
        <p>
          <em class=
          "parameter"><code>--enable-user-session</code></em>&nbsp;: Ce
          paramètre active les sessions utilisateurs DBus avec <span class=
          "phrase"><span class="application">systemd</span>.</span>
        </p>
        <p>
          <em class=
          "parameter"><code>--with-console-auth-dir=/run/console</code></em>&nbsp;:
          ce paramètre spécifie le répertoire dont il faut vérifier
          l'appartenance à la console.
        </p>
        <p>
          <em class=
          "parameter"><code>--with-system-pid-file=/run/dbus/pid</code></em>&nbsp;:
          Ce paramètre spécifie l'endroit pour le fichier PID.
        </p>
        <p>
          <em class=
          "parameter"><code>--with-system-socket=/run/dbus/system_bus_socket</code></em>&nbsp;:
          Ce paramètre spécifie l'emplacement du socket du bus système.
        </p>
        <p>
          <em class="parameter"><code>--enable-tests</code></em>&nbsp;:
          Construit des parties supplémentaires du code pour tous les tests.
          N'utilisez pas ce paramètre pour une construction de production.
        </p>
        <p>
          <code class="option">--enable-embedded-tests</code>&nbsp;:
          Construit des parties supplémentaires du code pour prendre en
          charge seulement les tests unitaires. N'utilisez pas ce paramètres
          pour une construction de production.
        </p>
        <p>
          <em class="parameter"><code>--enable-asserts</code></em>&nbsp;:
          Active le code de débogage pour exécuter des déclarations
          d'éléments supposées normalement vrais. Cela empêche un
          avertissement selon lequel '<em class=
          "parameter"><code>--enable-tests</code></em>' n'est utile en
          lui-même que pour le profilage et il pourrait ne pas donner de bons
          résultats pour tous les tests, mais il ajoute sa propre remarque
          selon laquelle cela ne devrait pas être utilisé dans une
          construction de production.
        </p>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration de D-Bus
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dbus-config" name="dbus-config"></a>Fichiers de
            configuration
          </h3>
          <p>
            <code class="filename">/etc/dbus-1/session.conf</code>,
            <code class="filename">/etc/dbus-1/system.conf</code> et
            <code class="filename">/etc/dbus-1/system.d/*</code>
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dbus-session-config" name=
            "dbus-session-config"></a>Informations sur la configuration
          </h3>
          <p>
            On ne devrait probablement pas modifier les fichiers de
            configuration listés ci-dessus. Si des modifications sont
            requises, vous devriez créer <code class=
            "filename">/etc/dbus-1/session-local.conf</code> ou <code class=
            "filename">/etc/dbus-1/system-local.conf</code> et effectuer les
            changements désirés dans ces fichiers.
          </p>
          <p>
            Si un paquet installe un fichier <code class=
            "filename">.service</code> de <span class=
            "application">D-Bus</span> hors du répertoire <code class=
            "filename">/usr/share/dbus-1/services</code> standard, vous
            devriez ajouter ce répertoire à la configuration de la session
            locale. Par exemple, <code class=
            "filename">/usr/local/share/dbus-1/services</code> peut être
            ajouté en effectuant les commandes suivantes en tant
            qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/dbus-1/session-local.conf &lt;&lt; "EOF"
<code class="literal">&lt;!DOCTYPE busconfig PUBLIC
 "-//freedesktop//DTD D-BUS Bus Configuration 1.0//EN"
 "http://www.freedesktop.org/standards/dbus/1.0/busconfig.dtd"&gt;
&lt;busconfig&gt;

  &lt;!-- Search for .service files in /usr/local --&gt;
  &lt;servicedir&gt;/usr/local/share/dbus-1/services&lt;/servicedir&gt;

&lt;/busconfig&gt;</code>
EOF</kbd></pre>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dbus-session" name="dbus-session"></a>Démon de Session
            D-Bus
          </h3>
          <p>
            Il y a plusieurs méthodes que vous pouvez utiliser pour démarrer
            un démon de session avec la commande <span class=
            "command"><strong>dbus-launch</strong></span>. Regardez la page
            de manuel de <span class=
            "command"><strong>dbus-launch</strong></span> pour les détails à
            propos des paramètres disponibles et des options. Voici quelques
            suggestions et exemples&nbsp;:
          </p>
          <div class="itemizedlist">
            <ul class="compact">
              <li class="listitem">
                <p>
                  Ajouter <span class=
                  "command"><strong>dbus-launch</strong></span> à la ligne
                  dans le fichier <code class="filename">~/.xinitrc</code>
                  qui démarre votre environnement graphique.
                </p>
              </li>
              <li class="listitem">
                <p>
                  Si vous utilisez <span class=
                  "command"><strong>gdm</strong></span> ou un autre
                  gestionnaire d'affichage qui appelle le fichier
                  <code class="filename">~/.xsession</code>, vous pouvez
                  ajouter <span class=
                  "command"><strong>dbus-launch</strong></span> à la ligne
                  dans votre fichier <code class=
                  "filename">~/.xsession</code> qui démarre votre
                  environnement graphique. La syntaxe ressemblerait à celle
                  de l'exemple dans le fichier <code class=
                  "filename">~/.xinitrc</code>.
                </p>
              </li>
              <li class="listitem">
                <p>
                  L'exemple montré précédemment utilise <span class=
                  "command"><strong>dbus-launch</strong></span> pour
                  spécifier un programme à exécuter. Ceci a le bénéfice
                  (quand on utilise également le paramètre <em class=
                  "parameter"><code>--exit-with-session</code></em>) de
                  stopper le démon de la session quand le programme spécifié
                  est stoppé. Vous pouvez également démarrer le démon de la
                  session dans vos scripts de démarrage du système ou
                  personnels en ajoutant les lignes suivantes&nbsp;:
                </p>
                <pre class="userinput"><kbd class="command"><code class=
                "literal"># Start the D-Bus session daemon
eval `dbus-launch`
export DBUS_SESSION_BUS_ADDRESS</code></kbd></pre>
                <p>
                  Cette méthode n'arrêtera pas le démon de session quand vous
                  quittez votre shell, donc vous devriez ajouter la ligne
                  suivante à votre fichier <code class=
                  "filename">~/.bash_logout</code>&nbsp;:
                </p>
                <pre class="userinput"><kbd class="command"><code class=
                "literal"># Kill the D-Bus session daemon
kill $DBUS_SESSION_BUS_PID</code></kbd></pre>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <p>
          Une liste des fichiers installés, avec leur description courte se
          trouve sur <a class="ulink" href=
          "../../../../lfs/view/systemd/chapter08/dbus.html#contents-dbus">../../../../lfs/view/systemd/chapter08/dbus.html#contents-dbus</a>.
        </p>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="cups-pk-helper.html" title=
          "cups-pk-helper-0.2.6">Précédent</a>
          <p>
            cups-pk-helper-0.2.6
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="fcron.html" title="Fcron-3.2.1">Suivant</a>
          <p>
            Fcron-3.2.1
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition systemd) - Version r10.1-914+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
