<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY bridge-download-http "&sourceforge-repo2;/projects/bridge/files/bridge/bridge-utils-&bridgeutils-version;.tar.gz">
  <!ENTITY bridge-download-ftp  " ">
  <!ENTITY bridge-md5sum        "ec7b381160b340648dede58c31bb2238">
  <!ENTITY bridge-size          "36 Ko">
  <!ENTITY bridge-buildsize     "1 Mo">
  <!ENTITY bridge-time          "moins de 0.1 SBU">
]>
<sect1 id="bridgeutils" xreflabel="bridge-utils-&bridgeutils-version;">
  <?dbhtml filename="bridge-utils.html"?>
  <sect1info>
    <othername>$LastChangedBy : bdubbs $</othername>
    <date>$Date : 2013-03-10 20:13:21 +0100 (Sun, 10 Mar 2013) $</date>
  </sect1info>
  <title>bridge-utils-&bridgeutils-version;</title>
  <indexterm zone="bridgeutils">
    <primary sortas="a-bridgeutils">bridge-utils</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à bridge-utils</title>
    <para>Le paquet <application>bridge-utils</application> contient un utilitaire necessaire
    pour créer et gérer un périphérique de pont. Il est pratique dans l'initialisation d'un réseau
    pour une machine virtuelle (VM).</para>
    &lfs77_checked;
    <bridgehead renderas="sect3">Information sur le paquet </bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&bridge-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&bridge-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &bridge-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &bridge-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &bridge-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &bridge-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Correctif requis:
         <ulink url="&patch-root;/bridge-utils-&bridgeutils-version;-linux_3.8_fix-1.patch"/>
        </para>
     </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de bridge-utils</bridgehead>
    <bridgehead renderas="sect4">Facultative (pour lancer les tests)</bridgehead>
    <para role="optional">
      <xref linkend="net-tools"/> 
    </para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/bridge"/></para>
  </sect2>
  <sect2 role="kernel" id='bridgeutils-kernel'>
    <title>Configuration du noyau</title>
    <para>Activez les options suivantes dans la configuration du noyau et
    recompilez le noyau si nécessaire&nbsp;:</para>
<screen>
<literal>[*] Networking support ---&gt;            [CONFIG_NET]
      Networking options ---&gt;
        &lt;*/M&gt; 802.1d Ethernet Bridging [CONFIG_BRIDGE]</literal>
</screen>
    <indexterm zone="bridgeutils bridgeutils-kernel">
      <primary sortas="d-bridgeutils">Bridge Utilities</primary>
    </indexterm>
  </sect2>
  <sect2 role="installation">
    <title>Installation de bridge-utils</title>
    <para>Installez <application>bridge-utils</application> en lançant les commandes suivantes&nbsp;:
    </para>
<screen>
<userinput>patch -Np1 -i ../bridge-utils-&bridgeutils-version;-linux_3.8_fix-1.patch &amp;&amp;
autoconf -o configure configure.in                      &amp;&amp;
./configure --prefix=/usr                               &amp;&amp;
make</userinput>
</screen>
    <para>Le test des résultats demande de lancer les six scripts dans le répertoire
    <filename class='directory'>tools/</filename>.  
    Deux des tests demandent d'avoir 2 ports ethernet. Quelques tests ne garderont pas la configuration
    actuelle du réseau. Voir pour les détails <filename>tests/README</filename>.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install</userinput>
</screen>
  </sect2>
 
  <sect2 role="configuration">
    <title>Configurer bridge-utils</title>
    <sect3 id='bridgeutils-init'>
      <title>Informations de configuration</title>
      <para>Pour automatiser la création et la configuration d'un pont, 
      installez script de service <filename>/lib/services/etc/bridge</filename>
      inclu dans le paquet <xref linkend="bootscripts"/>.</para>
      <indexterm zone="bridgeutils bridgeutils-init">
        <primary sortas="f-bridgeutils">bridge-utils</primary>
      </indexterm>
<screen role="root">
<userinput>make install-service-bridge</userinput>
</screen>
      <note><para>Le script <filename>bridge</filename> dépend des
      comamndes <command>/sbin/ifup</command> et
      <command>/sbin/ifdown</command> et le script de service
      <emphasis>ipv4-static</emphasis> des scripts de démarrage <emphasis>LFS</emphasis>
      en date du 27 janvier 2012 ou plus tard.</para></note>
      <para>Le fichier de configuration suivant va créer un périphérique de bridge
      au moment du démarrage et y rattacher l'eth0. Si vous désirez plus d'un
      périphérique, utilisez une liste d'INTERFACE_COMPONENTS séparés chacun par un espace .  Cette
      configuration est utile lorsqu'on envisage de faire fonctionner une machine virtuelle 
      telle que kvm/qemu.</para>
      <para>D'autres combinaisons de SERVICE sont possibles, par exemple, 
      SERVICES="bridge dhcp".  Dans ce cas, les paramètres d'adresse ne sont
      pas nécessaires mais ils n'interfèrent pas s'ils sont présents. Vous
      pouvez utiliser le service bridge seul, mais vous aurez besoin  d'une
      configuration consécutive supplémentaire.</para>
      <caution><para>Ne lancez pas de configuration parallèle pour un périphérique
      dans la liste INTERFACE_COMPONENTS. Par exemple, dans l'exemple ci-dessous, 
      ne configurez pas <filename>/etc/sysconfig/ifconfig.eth0</filename>
      pour se lancer au moment du démarrage. La commande <command>ifdown br0</command>
      suivie de la commande <command>ifup eth0</command> fonctionnera, mais
      n'essayez pas de faire marcher les deux en même temp.</para></caution>
      
<screen role="root">
<userinput>cat &gt; /etc/sysconfig/ifconfig.br0 &lt;&lt; "EOF"
<literal>ONBOOT=yes
IFACE=br0
SERVICE="bridge ipv4-static"  # Space separated
IP=192.168.1.32
GATEWAY=192.168.1.1
PREFIX=24
BROADCAST=192.168.1.255
CHECK_LINK=no                 # Don't check before bridge is created
STP=no                        # Spanning tree protocol, default no
INTERFACE_COMPONENTS="eth0"   # Add to IFACE, space separated devices
IP_FORWARD=true</literal>
EOF</userinput>
</screen>
      <para>Vous devriez changer toutes les adresses pour correspondre à votre
      contexte.</para>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programme installé </segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>brctl</seg>
        <seg>Aucun</seg>
        <seg>Aucun</seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Description courte</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="brctl">
        <term><command>brctl</command></term>
        <listitem>
          <para>est un programme utilisé pour initialiser, maintenir, et analyser la configuration
          ethernet en mode pont dans le noyau linux.  </para>
          <indexterm zone="bridgeutils brctl">
            <primary sortas="b-brctl">brctl</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
