<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY wpa_supplicant-download-http
           "http://hostap.epitest.fi/releases/wpa_supplicant-&wpa_supplicant-version;.tar.gz">
  <!ENTITY wpa_supplicant-download-ftp  " ">
  <!ENTITY wpa_supplicant-md5sum        "3be2ebfdcced52e00eda0afe2889839d">
  <!ENTITY wpa_supplicant-size          "2.0 Mo">
  <!ENTITY wpa_supplicant-buildsize     "32 Mo">
  <!ENTITY wpa_supplicant-time          "0.2 SBU">
]>

<sect1 id="wpa_supplicant" xreflabel="wpa_supplicant-&wpa_supplicant-version;">
  <?dbhtml filename="wpa_supplicant.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: randy $</othername>
    <date>$Date&nbsp;: 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>

  <title>wpa_supplicant-&wpa_supplicant-version;</title>

  <indexterm zone="wpa_supplicant">
    <primary sortas="a-wpa_supplicant">wpa_supplicant</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à wpa_supplicant</title>

    <para><application>wpa_supplicant</application> est un client d'accès au Wi-Fi protégé
    (WPA) et compatible IEEE 802.1X. Il implémente la négociation de clé WPA avec une authentification WPA
    et le protocole d'authentification étendue (EAP) avec un serveur d'authentification.
    De plus, il contrôle l'itinérance et l'authentification/association IEEE 802.11 des pilotes.
    Il est pratique pour se connecter à un point d'accès protégé par mot de passe.</para>

   &lfs73_checked;

    <bridgehead renderas="sect3">Information sur le paquet </bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;:
        <ulink url="&wpa_supplicant-download-http;"/></para>
      </listitem>
      <listitem>
        <para>
          Téléchargement (FTP)&nbsp;: <ulink url="&wpa_supplicant-download-ftp;"/>
        </para>
      </listitem>
      <listitem>
         <para>Somme de contrôle MD5 du téléchargement&nbsp;: &wpa_supplicant-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &wpa_supplicant-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &wpa_supplicant-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &wpa_supplicant-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de wpa_supplicant</bridgehead>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
       <xref linkend="libnl"/> et
      <!-- From defconfig: WEXT is deprecated in the current Linux kernel
      version and no new functionality is added to it. nl80211-based
      interface is the new replacement for WEXT -->
      <xref linkend="openssl"/>.
      <!-- For EAP-* Methods -->
      </para>

    <bridgehead renderas="sect4">Facultative</bridgehead>
    <para role="optional">
      <xref linkend="dbus"/>,
      <xref linkend="libxml2"/> et
      <xref linkend="qt"/>
    </para>

    <!-- TODO: Write instructions for building wpa_gui -->
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/wpa_supplicant"/></para>
  </sect2>

  <sect2 role="kernel" id="wpa_supplicant-kernel">
    <title>Configuration du noyau</title>

    <para>Activez les options suivantes dans la configuration du noyau et recompilez si nécessaire&nbsp;:</para>

<screen><literal>[*] Networking support  --->
  [*]   Wireless  --->
    [*]   cfg80211 - wireless configuration API
    [*]     cfg80211 wireless extensions compatibility
    [*]   Generic IEEE 802.11 Networking Stack (mac80211)

Device Drivers  --->
  [*] Network device support  --->
    [*]   Wireless LAN  --->
</literal></screen>

    <para>Selectionnez les options que supportent votre matériel&nbsp;:
    <command>lspci</command> de <xref linkend="pciutils"/> peut être utilisé
    pour voir votre configuration matérielle.</para>

    <indexterm zone="wpa_supplicant wpa_supplicant-kernel">
      <primary sortas="d-wpa_supplicant">wpa_supplicant</primary>
    </indexterm>
  </sect2>

  <sect2 role="installation">
    <title>Installation de wpa_supplicant</title>

    <para>
      En premier vous devez créer un fichier de configuration initial pour la construction.
      Vous pouvez lire <filename>wpa_supplicant/README</filename>
      et <filename>wpa_supplicant/defconfig</filename> pour les explications des options
      suivantes aussi bien que pour les autres options qui peuvent être utilisées.
      Créer un fichier de configuration qui peut fonctionner avec les initialisations
      standards pour le WiFi en lançant les commandes suivantes:
    </para>

<screen><userinput>cat &gt; wpa_supplicant/.config &lt;&lt; "EOF"
CONFIG_BACKEND=file
CONFIG_CTRL_IFACE=y
CONFIG_DEBUG_FILE=y
CONFIG_DEBUG_SYSLOG=y
CONFIG_DEBUG_SYSLOG_FACILITY=LOG_DAEMON
CONFIG_DRIVER_NL80211=y
CONFIG_DRIVER_WEXT=y
CONFIG_DRIVER_WIRED=y
CONFIG_EAP_GTC=y
CONFIG_EAP_LEAP=y
CONFIG_EAP_MD5=y
CONFIG_EAP_MSCHAPV2=y
CONFIG_EAP_OTP=y
CONFIG_EAP_PEAP=y
CONFIG_EAP_TLS=y
CONFIG_EAP_TTLS=y
CONFIG_IEEE8021X_EAPOL=y
CONFIG_IPV6=y
CONFIG_LIBNL32=y
CONFIG_PEERKEY=y
CONFIG_PKCS12=y
CONFIG_READLINE=y
CONFIG_SMARTCARD=y
CONFIG_WPS=y
CFLAGS += -I/usr/include/libnl3
EOF</userinput></screen>

    <para>
      Si vous souhaitez utiliser <application>WPA Supplicant</application> avec
      <xref linkend="NetworkManager"/>, soyez certain d'avoir installé
      <xref linkend="dbus"/> et <xref linkend="libxml2"/>, ensuite ajoutez
      les options suivantes dans le fichier de configuration de <application>WPA Supplicant</application>
      en lançant les commandes suivantes&nbsp;:
    </para>

<screen><userinput>cat &gt;&gt; wpa_supplicant/.config &lt;&lt; "EOF"
CONFIG_CTRL_IFACE_DBUS=y
CONFIG_CTRL_IFACE_DBUS_NEW=y
CONFIG_CTRL_IFACE_DBUS_INTRO=y
EOF</userinput></screen>


    <para>
      Installez <application>WPA Supplicant</application> en lançant les commandes suivantes:
    </para>

<screen><userinput>cd wpa_supplicant &amp;&amp;
make BINDIR=/sbin LIBDIR=/lib</userinput></screen>

    <para>
      Si vous avez installé <xref linkend="qt"/> et souhaitez construire l'interface graphique
      de <application>WPA Supplicant</application>, lancez les commandes suivantes:
    </para>
<screen><userinput>pushd wpa_gui-qt4 &amp;&amp;
make wpa_gui.pro &amp;&amp;
make &amp;&amp;
popd</userinput></screen>
    <para>
       Ce paquet n'est pas livré avec une suite de tests.</para>

    <para>Maintenant en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m755 wpa_{cli,passphrase,supplicant} /sbin/ &amp;&amp;
install -v -m644 doc/docbook/wpa_supplicant.conf.5 /usr/share/man/man5/ &amp;&amp;
install -v -m644 doc/docbook/wpa_{cli,passphrase,supplicant}.8 /usr/share/man/man8/</userinput></screen>

    <para>
      Si vous avez construit <application>WPA Supplicant</application> avec le support
      <application>D-Bus</application>, vous devez installez les fichiers de configuration de
      <application>D-Bus</application>. Installez les en lançant les commandes suivantes en tant
      qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:
    </para>

<screen role="root"><userinput>install -v -m644 dbus/fi.{epitest.hostap.WPASupplicant,w1.wpa_supplicant1}.service \
   /usr/share/dbus-1/system-services \ &amp;&amp;
install -v -m644 dbus/dbus-wpa_supplicant.conf \
       /etc/dbus-1/system.d/wpa_supplicant.conf
</userinput></screen>

    <para>
      Si vous avez construit l'interface graphique de <application>WPA Supplicant</application>,
      installez le en lançant les commandes suivantes en tant qu'utilisateur
     <systemitem class="username">root</systemitem>&nbsp;:
    </para>
<screen role="root"><userinput>
install -v -m755 wpa_gui-qt4/wpa_gui           /usr/bin/ &amp;&amp;
install -v -m644 doc/docbook/wpa_gui.8         /usr/share/man/man8/ &amp;&amp;
install -v -m644 wpa_gui-qt4/wpa_gui.desktop   /usr/share/applications/ &amp;&amp;
install -v -m644 wpa_gui-qt4/icons/wpa_gui.svg /usr/share/pixmaps/</userinput></screen>

   <note>
      <para>
        Vous devrez redémarrer le démon du système <application>D-Bus</application> avant que vous puissiez
        utiliser l'interface <application>D-Bus</application> de <application>WPA Supplicant</application>.
     </para>
    </note>
    <xi:include xmlns:xi="http://www.w3.org/2001/XInclude"
      href="../../xincludes/update-desktop-database.xml"/>
  </sect2>  
  <sect2 role="configuration">
    <title>Configuration de wpa_supplicant</title>

    <sect3 id="wpa_supplicant-config">
      <title>Fichier de Configuration</title>
      <para>
        <filename>/etc/sysconfig/wpa_supplicant-*.conf</filename>
      </para>

      <indexterm zone="wpa_supplicant wpa_supplicant-config">
        <primary
        sortas="e-etc-sysconfig-wpa_supplicant-star.conf">/etc/sysconfig/wpa_supplicant-*.conf</primary>
      </indexterm>
    </sect3>

    <sect3>
      <title>Information de Configuration</title>

      <para>Pour se connecter à un point d'acces qui utilise un mot de passe vous devez mettre
      la clé public dans <filename>/etc/sysconfig/wpa_supplicant-<replaceable>wifi0</replaceable>.conf</filename>.
      SSID est la chaîne que le point d'accès ou le routeur
      transmet pour s'identifier. En tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>wpa_passphrase <replaceable>SSID</replaceable> <replaceable>SECRET_PASSWORD</replaceable> &gt; /etc/sysconfig/wpa_supplicant-<replaceable>wifi0</replaceable>.conf</userinput></screen>

      <para><filename>/etc/sysconfig/wpa_supplicant-<replaceable>wifi0</replaceable>.conf</filename> peut retenir les détails de plusieurs points d'accès.
      Quand vous lancez <command>wpa_supplicant</command> il scannera les SSIDs qu'il peut voir
      et choisira le mot de passe approprié pour se connecter.</para>

      <para>Si vous souhaitez vous connecter à un point d'accès qui n'est pas protégé par un mot de passe,
	indiquez une entrée comme cela dans in
      <filename>etc/sysconfig/wpa_supplicant-<replaceable>wifi0</replaceable>.conf</filename>. Remplacez
      "Some-SSID" avec le SSID du point d'accès/routeur.</para>

<screen>network={
  ssid="<replaceable>Some-SSID</replaceable>"
  key_mgmt=NONE
}</screen>

      <para>Il y a beaucoup d'options que vous pouvez utiliser pour personnaliser la façon de se connecter
      à chaque point d'accès. Elles sont décrites en détails dans le fichier
      <filename>wpa_supplicant/wpa_supplicant.conf</filename> dans les sources.</para>

    </sect3>
    <sect3>
      <title>Connexion à un point d'accès</title>
      <para id="wpa-service">
        Si vous voulez configurer une interface réseau au démarrage en utilisant
        <command>wpa_supplicant</command>, vous devez installer le script
        <filename>/lib/services/wpa</filename> 
        fourni dans le paquet <xref linkend="bootscripts"/>&nbsp;:
      </para>
<screen role="root"><userinput>make install-service-wpa</userinput></screen>
      <indexterm zone="wpa_supplicant wpa-service">
        <primary sortas="f-wpa">wpa</primary>
      </indexterm>

     <para>
        Si votre routeur/point d'accès utilise DHCP pour allouer les adresses IP, vous pouvez installer un client
        <xref linkend="dhcp"/> et l'utiliser pour obtenir automatiquement une adresse réseau.
        Créez 
        <filename>/etc/sysconfig/ifconfig-<replaceable>wifi0</replaceable>
        </filename> en lançant la commande suivante en tant qu'utilisateur
        <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>cat &gt; /etc/sysconfig/ifconfig.<replaceable>wifi0</replaceable> &lt;&lt; "EOF"
<literal>ONBOOT="yes"
IFACE="<replaceable>wifi0</replaceable>"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""
WPA_SERVICE="dhclient"
DHCP_START=""
DHCP_STOP=""

# Set PRINTIP="yes" to have the script print
# the DHCP assigned IP address
PRINTIP="no"

# Set PRINTALL="yes" to print the DHCP assigned values for
# IP, SM, DG, and 1st NS. This requires PRINTIP="yes".
PRINTALL="no"</literal>
EOF</userinput></screen>

      <para>
        Si vous préférez <xref linkend="dhcpcd"/> au lieu du client 
        <xref linkend="dhcp"/>, alors créez 
        <filename>/etc/sysconfig/ifconfig-<replaceable>wifi0</replaceable>
        </filename> en lançant la commande suivante en tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>cat &gt; /etc/sysconfig/ifconfig.<replaceable>wifi0</replaceable> &lt;&lt; "EOF"
<literal>ONBOOT="yes"
IFACE="<replaceable>wifi0</replaceable>"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""
WPA_SERVICE="dhcpcd"
DHCP_START="-b -q <replaceable>&lt;insert appropriate start options here&gt;</replaceable>"
DHCP_STOP="-k <replaceable>&lt;insert additional stop options here&gt;</replaceable>"</literal>
EOF</userinput></screen>

      <para>
         Sinon, si vous utilisez une adresse statique de votre réseau local.
      alors créez
        <filename>/etc/sysconfig/ifconfig-<replaceable>wifi0</replaceable>
        </filename> en lançant la commande suivante en tant qu'utilisateur 
         <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root"><userinput>cat &gt; /etc/sysconfig/ifconfig.<replaceable>wifi0</replaceable> &lt;&lt; "EOF"
<literal>ONBOOT="yes"
IFACE="<replaceable>wifi0</replaceable>"
SERVICE="wpa"

# Additional arguments to wpa_supplicant
WPA_ARGS=""
WPA_SERVICE="ipv4-static"
IP="192.168.1.1"
GATEWAY="192.168.1.2"
PREFIX="24"
BROADCAST="192.168.1.255"</literal>
EOF</userinput></screen>
      <para>
        Vous pouvez vous connecter au point d'accès sans fil en lançant la commande suivante en tant qu'utilisateur
        <systemitem class="username">root</systemitem>&nbsp;:
      </para>
<screen role="root"><userinput>ifup <replaceable>wifi0</replaceable></userinput></screen>
      <para>
        Remplacez <replaceable>wifi0</replaceable> par l'interface sans fil correspondante et <replaceable>wifi0</replaceable>
        par le nom du fichier de configuration souhaité. Merci de noter que
        les fichiers de configuration <filename>wpa_supplicant-*.conf</filename> et
        <filename>ifconfig.*</filename> doivent avoir des noms identiques, c'est à dire les deux 
        contiennent <replaceable>wifi0</replaceable> dans leur nom.
      </para>
    </sect3>
  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>

      <seglistitem>
        <seg>
          wpa_gui, wpa_supplicant, wpa_passphrase et wpa_cli
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Description courte</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="wpa_gui">
        <term><command>wpa_gui</command></term>
       <listitem>
          <para>
            est une interface graphique pour interagir avec
            <application>wpa_supplicant</application>.
          </para>
          <indexterm zone="wpa_supplicant wpa_gui">
            <primary sortas="b-wpa_gui">wpa_gui</primary>
          </indexterm>
        </listitem>
      </varlistentry>

       <varlistentry id="wpa_supplicant-prog">
        <term><command>wpa_supplicant</command></term>
        <listitem>
          <para>est un démon qui peut se connecter à un point d'accès protégé par un mot de passe.</para>
          <indexterm zone="wpa_supplicant wpa_supplicant-prog">
            <primary sortas="b-wpa_supplicant">wpa_supplicant</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="wpa_passphrase">
        <term><command>wpa_passphrase</command></term>
        <listitem>
          <para>prend un SSID et un mot de passe et génère une configuration simple
          que <command>wpa_supplicant</command> peut comprendre.</para>
          <indexterm zone="wpa_supplicant wpa_passphrase">
            <primary sortas="b-wpa_passphrase">wpa_passphrase</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="wpa_cli">
        <term><command>wpa_cli</command></term>
        <listitem>
          <para>est une interface en ligen de commandes pour contrôler le lancement du démon
	  <command>wpa_supplicant</command>.
          </para>
          <indexterm zone="wpa_supplicant wpa_cli">
            <primary sortas="b-wpa_cli">wpa_cli</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
