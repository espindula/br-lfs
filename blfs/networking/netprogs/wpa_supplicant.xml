<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY wpa_supplicant-download-http
  "http://hostap.epitest.fi/releases/wpa_supplicant-&wpa_supplicant-version;.tar.gz">
  <!ENTITY wpa_supplicant-md5sum        "8650f6aa23646ef634402552d0669640">
  <!ENTITY wpa_supplicant-size          "1.9 Mio">
  <!ENTITY wpa_supplicant-buildsize     "16 Mio">
  <!ENTITY wpa_supplicant-time          "0.1 SBU">
]>

<sect1 id="wpa_supplicant" xreflabel="wpa_supplicant-&wpa_supplicant-version;">
  <?dbhtml filename="wpa_supplicant.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: andy $</othername>
    <date>$Date&nbsp;: 2012-05-10 13:31:30 +0200 (Thu, 10 May 2012) $</date>
  </sect1info>

  <title>wpa_supplicant-&wpa_supplicant-version;</title>

  <indexterm zone="wpa_supplicant">
    <primary sortas="a-wpa_supplicant">wpa_supplicant</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à wpa_supplicant</title>

    <para><application>wpa_supplicant</application> est un client d'accès au Wi-Fi protégé
    (WPA) et compatible IEEE 802.1X. Il implémente la négociation de clé WPA avec une authentification WPA
    et le protocole d'authentification étendue (EAP) avec un serveur d'authentification.
    De plus, il contrôle l'itinérance et l'authentification/association IEEE 802.11 des pilotes.
    Il est pratique pour se connecter à un point d'accès protégé par mot de passe.</para>

    &lfs71_checked;

    <bridgehead renderas="sect3">Information sur le paquet </bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;:
        <ulink url="&wpa_supplicant-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &wpa_supplicant-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &wpa_supplicant-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &wpa_supplicant-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &wpa_supplicant-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/wpa_supplicant-&wpa_supplicant-version;-libnl-3-fixes-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de wpa_supplicant</bridgehead>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended"><xref linkend="libnl"/> (requis pour utiliser l'interface nl80211 du noyau.
    L'utilisation de <application>wpa_supplicant</application>
    sans <application>libnl</application> n'a pas été testée).</para>

    <bridgehead renderas="sect4">Facultative</bridgehead>
    <para role="optional"><xref linkend="openssl"/>,
    <!-- using CONFIG_TLS=gnutls fails as
    src/crypto/tls_gnutls.c uses functions like gnutls_session_get_client_random
    et gnutls_session_get_server_random which have been removed from current
    <xref linkend="gnutls"/> -->
    <ulink url="http://libtom.org/">libtommath</ulink>,
    <xref linkend="libpcap"/>,
    <ulink url="http://libdnet.sourceforge.net/">libdnet</ulink>
    et <xref linkend="dbus"/>.</para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/wpa_supplicant"/></para>
  </sect2>

  <sect2 role="kernel" id="wpa_supplicant-kernel">
    <title>Configuration du noyau</title>

    <para>Activez les options suivantes dans la configuration du noyau et recompilez si nécessaire&nbsp;:</para>

<screen><literal>[*] Networking support  --->
  [*]   Wireless  --->
    [*]   cfg80211 - wireless configuration API
    [*]     cfg80211 wireless extensions compatibility
    [*]   Generic IEEE 802.11 Networking Stack (mac80211)

Device Drivers  --->
  [*] Network device support  --->
    [*]   Wireless LAN  --->
</literal></screen>

    <para>Selectionnez les options que supportent votre matériel&nbsp;:
    <command>lspci</command> de <xref linkend="pciutils"/> est votre ami ;)</para>

    <indexterm zone="wpa_supplicant wpa_supplicant-kernel">
      <primary sortas="d-wpa_supplicant">wpa_supplicant</primary>
    </indexterm>
  </sect2>

  <sect2 role="installation">
    <title>Installation de wpa_supplicant</title>

    <para>Installez <application>wpa_supplicant</application> en lancant les commandes suivantes&nbsp;:</para>

<screen><userinput>patch -p1 &lt; ../wpa_supplicant-0.7.3-libnl-3-fixes-1.patch &amp;&amp;
cd wpa_supplicant &amp;&amp;
cat &gt; .config &lt;&lt; "HERE_DOC" &amp;&amp;
CONFIG_DRIVER_WEXT=y
CONFIG_EAP_GPSK=y
CONFIG_EAP_GPSK_SHA256=y
CONFIG_EAP_GTC=y
CONFIG_EAP_IKEV2=y
CONFIG_EAP_LEAP=y
CONFIG_EAP_MD5=y
CONFIG_EAP_MSCHAPV2=y
CONFIG_EAP_OTP=y
CONFIG_EAP_PAX=y
CONFIG_EAP_PEAP=y
CONFIG_EAP_PSK=y
CONFIG_EAP_TLS=y
CONFIG_EAP_TTLS=y
CONFIG_PEERKEY=y
CONFIG_PKCS12=y
CONFIG_CTRL_IFACE=y
CONFIG_READLINE=y
CONFIG_IPV6=y
CONFIG_LIBNL20=y
CONFIG_DRIVER_NL80211=y
CFLAGS += -I/usr/include/libnl3

# Si vous n'avez pas installé openssl, décommentez la ligne suivante&nbsp;:
# CONFIG_TLS=internal

# si vous souhaitez utiliser le TLS interne et n'avez pas installé libtommath,
# décommentez la ligne suivante&nbsp;:
# CONFIG_INTERNAL_LIBTOMMATH=y

# Décommentez la ligne suivante si vous avez un chipset ralink&nbsp;:
# CONFIG_DRIVER_RALINK=y

# Décommentez la ligne suivante si vous avez un chipset Agere Hermes&nbsp;:
# CONFIG_DRIVER_HERMES=y

# Décommentez la ligne suivante si vous avez un chipset Atmel&nbsp;:
# CONFIG_DRIVER_ATMEL=y

# Décommentez la ligne suivante si vous avez installé dbus&nbsp;:
# CONFIG_CTRL_IFACE_DBUS_NEW=y

# Décommentez la ligne suivante si vous avez installé libpcap et libdnet&nbsp;:
# CONFIG_L2_PACKET=pcap
HERE_DOC
make</userinput></screen>

    <para>Ce paquet n'est pas livré avec une suite de tests.</para>

    <para>Maintenant en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>cp wpa_{cli,passphrase,supplicant} /sbin &amp;&amp;
cp doc/docbook/wpa_supplicant.conf.5 /usr/share/man/man5 &amp;&amp;
cp doc/docbook/wpa_{cli,passphrase,supplicant}.8 /usr/share/man/man8</userinput></screen>
  </sect2>

  <sect2 role="commands">
    <title>Explications des commandes</title>

    <para><command>cat > .config ...</command>&nbsp;: Cela va créer une configuration par défaut
    qui doit fonctionner dans la plupart des cas. Elle utilise le pilote du noyau WEXT
    que la plupart des cartes sans-fil semble utiliser. Pour une explication de ces options
    (et pour voir les autres options que vous pouvez choisir) lire le fichier
    <filename>wpa_supplicant/defconfig</filename> dans le source.</para>
  </sect2>

  <sect2 role="configuration">
    <title>Configuration de wpa_supplicant</title>

    <sect3 id="wpa_supplicant-config">
      <title>Fichier de Configuration</title>
      <para><filename>/etc/wpa_supplicant.conf</filename></para>

      <indexterm zone="wpa_supplicant wpa_supplicant-config">
        <primary
        sortas="e-etc-wpa_supplicant.conf">/etc/wpa_supplicant.conf</primary>
      </indexterm>
    </sect3>

    <sect3>
      <title>Information de Configuration</title>

      <para>Pour se connecter à un point d'acces qui utilise un mot de passe vous devez mettre
      la clé public dans <filename>/etc/wpa_supplicant.conf</filename>. Utilisez
      <command>wpa_passphrase</command> pour la générer. SSID est la chaîne que le point d'accès ou le routeur
      transmet pour s'identifier. En tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>wpa_passphrase <replaceable>SSID</replaceable> <replaceable>SECRET_PASSWORD</replaceable> &gt; /etc/wpa_supplicant.conf</userinput></screen>

      <para>/etc/wpa_supplicant.conf peut retenir les détails de plusieurs points d'accès.
      Quand vous lancez wpa_supplicant il scannera les SSIDs qu'il peut voir 
      et choisira le mot de passe approprié pour se connecter.</para>

      <para>Si vous souhaitez vous connecter à un point d'accès qui n'est pas protégé par un mot de passe,
	indiquez une entrée comme cela dans in
      <filename>/etc/wpa_supplicant.conf</filename>. Remplacez
      "Some-SSID" avec le SSID du point d'accès/routeur.</para>

<screen>network={
  ssid="<replaceable>Some-SSID</replaceable>"
  key_mgmt=NONE
}</screen>

      <para>Il y a beaucoup d'options que vous pouvez utiliser pour personnaliser la façon de se connecter
      à chaque point d'accès. Elles sont décrites en détails dans le fichier
      <filename>wpa_supplicant/wpa_supplicant.conf</filename> dans les sources.</para>

      <para>Pour utiliser <command>wpa_cli</command> pour contrôler le lancement du démon
      wpa_supplicant, ajoutez une interface de contrôle dans
      <filename>/etc/wpa_supplicant.conf</filename>. En tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>echo ctrl_interface=/run/wpa_supplicant &gt;&gt; /etc/wpa_supplicant.conf</userinput></screen>
    </sect3>

    <sect3>
      <title>Connexion à un point d'accès</title>

      <para>Si votre routeur/point d'accès utilise DHCP pour vous allouer une adresse IP vous pouvez
      installer <xref linkend="dhcpcd"/> et l'utiliser pour la connexion. En tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>wpa_supplicant -B -c/etc/wpa_supplicant.conf -iwlan0 -Dwext
sleep 2 # let it settle
dhcpcd</userinput></screen>

      <para>Sinon, vous pouvez utiliser une adresse statique de votre réseau local.
      L'avantage, c'est que vous pouvez mettre le nom d'hôte dans le fichier
      <filename>/etc/hosts</filename>. Remplacez 192.168.1.6 avec l'adresse statique que vous avez
      choisie. Remplacez 192.168.1.1 avec l'adresse IP de votre point d'accès/routeur. En tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>ip addr add 192.168.1.6 dev wlan0
ip link set wlan0 up
wpa_supplicant -B -c/etc/wpa_supplicant.conf -iwlan0 -Dwext
ip route add 192.168.1.1 dev wlan0
ip route add default via 192.168.1.1 dev wlan0</userinput></screen>

      <para>L'écriture de script de démarrage qui automatise le lancement de la connexion
	réseau est un exercice qui est laissé au lecteur ;).</para>
    </sect3>
  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>

      <seglistitem>
        <seg>wpa_supplicant, wpa_passphrase et wpa_cli</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Description courte</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="wpa_supplicant-prog">
        <term><command>wpa_supplicant</command></term>
        <listitem>
          <para>est un démon qui peut se connecter à un point d'accès protégé par un mot de passe.</para>
          <indexterm zone="wpa_supplicant wpa_supplicant-prog">
            <primary sortas="b-wpa_supplicant">wpa_supplicant</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="wpa_passphrase">
        <term><command>wpa_passphrase</command></term>
        <listitem>
          <para>prend un SSID et un mot de passe et génère une configuration simple
          que <command>wpa_supplicant</command> peut comprendre</para>
          <indexterm zone="wpa_supplicant wpa_passphrase">
            <primary sortas="b-wpa_passphrase">wpa_passphrase</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="wpa_cli">
        <term><command>wpa_cli</command></term>
        <listitem>
          <para>est une interface en ligen de commandes pour contrôler le lancement du démon
	  wpa_supplicant</para>
          <indexterm zone="wpa_supplicant wpa_cli">
            <primary sortas="b-wpa_cli">wpa_cli</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
