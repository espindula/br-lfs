<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>
<sect1 id="raid">
  <?dbhtml filename="raid.html"?>
  <sect1info>
    <othername>$LastChangedBy : randy $</othername>
    <date>$Date : 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>
  <title>A propos de RAID</title>
  <para>La technologie de stockage connue sous le nom de RAID (Redundant Array of 
  Independent Disks) combine plusieurs disques physiques dans une unité logique.
  Les disques peuvent généralement être combinés pour fournir une redondance des données
  ou augmenter la taille des unités logiques au delà des capacités des disques physiques ou les deux.
  La technologie permet également de fournir une maintenance matériel sans éteindre le système.</para>
  <para>Les types des organisations RAID sont décrites dans le <ulink
  url="https://raid.wiki.kernel.org/index.php/Overview#The_RAID_levels">
  Wiki RAID</ulink>.</para>
  <para>Notez que même si RAID fournit une protection contre les pannes de disques,
  il ne se substitue pas aux sauvegardes. Un fichier effacé sera effacé sur tout les disques
  de la grappe RAID. Les sauvegardes modernes sont généralement faites via <xref linkend='rsync'/>.</para>
  <para>Il y a trois types majeurs d'implémentation de RAID&nbsp;: 
  le RAID matériel, le RAID basé sur le BIOS, et le RAID logiciel.</para>
  <sect2 id="hwraid">
    <title>Le RAID matériel</title>
    <para>Le RAID matériel fournit les capacités au travers de matériels propriétaires
    et de couches de données. Le contrôle et la configuration sont généralement
    fait via le firmware en conjonction avec des programmes fait par le constructeur du périphérique.
    Les capacités sont généralement fournies via une carte PCI, cependant il y a quelqueq solutions
    de composants RAID intégrés sur la carte mère.
    Le RAID matériel peut également être disponible dans un boîtier dédié seul.</para>
    <para>Un avantage du RAID matériel est que les disques sont proposés au système d'exploitation
    comme un disque logique et pas de configuration dépendante du système d'exploitation est nécéssaire.</para>
    <para>Les désavantages inclus les difficultés pour transférer les disques
    d'un sytème à un autre, de mettre à jour le firmware, ou de remplacer un RAID matériel défectueux.</para>
  </sect2>
  <sect2 id="biosraid">
    <title>Le RAID basé sur le BIOS</title>
    <para>Quelques ordinateurs offrent une implémentations d'un RAID identique à celui matériel
    dans le BIOS. Parfois cela est mentionné comme un 'faux' RAID avec des capacités généralement
    incorporées dans un firmware sans aucunes accélérations matériel.</para>
    <para>Les avantages et les désavantages d'un RAID basé sur le BIOS sont généralement
    les mêmes que pour le RAID matériel avec le désavantage supplémentaire qu'il n'y a pas 
    d'accélération matériel.</para>
    <para>Dans quelques cas, le RAID basé sur le BIOS est activé par défaut (par exemple pour quelques
    systèmes DELL). Si le RAID logiciel est souhaité, cette option doit être explicitement désactiver dans
    le BIOS.</para>
  </sect2>
  <sect2 id="swraid">
  <title>Le RAID logiciel</title>
    <para>Le RAID logiciel est le plus flexible des solutions RAID. Il est facile à installer et à mettre à jour
    et il fournit l'ensemble des capacités de tous ou d'une partie des disques installés sur le système.
    Dans BLFS, le logiciel RAID est dans <xref linkend='mdadm'/>.</para>
    <para>Configuration d'un périphérique RAID est simple en utilisant
    <application>mdadm</application>. Les périphériques sont généralement créés dans le répertoire
    <filename class='directory'>/dev</filename> comme
    <filename>/dev/mdx</filename> ou <emphasis>x</emphasis> est un entier.
    </para>
    <para>La première étape dans la création de la grappe RAID est d'utiliser un logiciel de partitionnement
     comme <userinput>fdisk</userinput> ou <xref linkend='parted'/> pour définir les partitions nécessaires à 
     la grappe. Normalement, il devrait y avoir une seule partition sur chaque disque de la grappe RAID, mais
     cela n'est pas strictement nécessaire.
    Dans cette exemple, il y aura 4 disques&nbsp;:
    <filename>/dev/sda</filename>,
    <filename>/dev/sdb</filename>,
    <filename>/dev/sdc</filename>, et
    <filename>/dev/sdd</filename>.  Ils seront partitionnés comme suivant&nbsp;:</para>
<screen>
<literal>Partition Size     Type                Use
sda1:     100 MB   fd Linux raid auto  /boot    (RAID 1) /dev/md0
sda2:      10 GB   fd Linux raid auto  /        (RAID 1) /dev/md1
sda3:       2 GB   83 Linux swap       swap
sda4      300 GB   fd Linux raid auto  /home    (RAID 5) /dev/md2
sdb1:     100 MB   fd Linux raid auto  /boot    (RAID 1) /dev/md0
sdb2:      10 GB   fd Linux raid auto  /        (RAID 1) /dev/md1
sdb3:       2 GB   83 Linux swap       swap
sdb4      300 GB   fd Linux raid auto  /home    (RAID 5) /dev/md2
sdc1:      12 GB   fd Linux raid auto  /usr/src (RAID 0) /dev/md3
sdc2:     300 GB   fd Linux raid auto  /home    (RAID 5) /dev/md2
sdd1:      12 GB   fd Linux raid auto  /usr/src (RAID 0) /dev/md3
sdd2:     300 GB   fd Linux raid auto  /home    (RAID 5) /dev/md2 </literal>
</screen>
    <para>Dans cette solution, une partition de démarrage séparée est créée dans la première petite
      grappe RAID et un système de fichier racine dans la seconde grappe RAID, les deux étant dupliquées.
      La troisième partition est une grappe importante (environ 1 TB) pour le répertoire
    <filename class='directory'>/home</filename>. Cela permet une capacité à distribuer des données sur des 
    périphériques multiples, améliorant la vitesse à la fois pour la lecture et pour l'écriture des fichiers de grande
    taille. Finalement, une quatrième grappe est crée pour ajouter deux partitions dans un grand périphérique.</para>
    <note><para>Toutes les commandes <application>mdadm</application> doivent être faites en tant qu'utilisateur
    <systemitem class="username">root</systemitem>.</para></note>
    <para>Pour créer ces grappes RAID les commandes sont&nbsp;:</para>
<screen>
<userinput>/sbin/mdadm -Cv /dev/md0 --level=1 --raid-devices=2 /dev/sda1 /dev/sdb1
/sbin/mdadm -Cv /dev/md1 --level=1 --raid-devices=2 /dev/sda2 /dev/sdb2
/sbin/mdadm -Cv /dev/md3 --level=0 --raid-devices=2 /dev/sdc1 /dev/sdd1
/sbin/mdadm -Cv /dev/md2 --level=5 --raid-devices=4 \
        /dev/sda4 /dev/sdb4 /dev/sdc2 /dev/sdd2 </userinput>
</screen>
    <para>Les périphériques créés peuvent être examiné par périphérique. Par exemple,
    pour voir les détails de <filename>/dev/md1</filename>, utilisez 
    <userinput>/sbin/mdadm --detail /dev/md1</userinput>&nbsp;:  </para>
<screen>
<literal>        Version : 1.2
  Creation Time : Tue Feb  7 17:08:45 2012
     Raid Level : raid1
     Array Size : 10484664 (10.00 GiB 10.74 GB)
  Used Dev Size : 10484664 (10.00 GiB 10.74 GB)
   Raid Devices : 2
  Total Devices : 2
    Persistence : Superblock is persistent
    Update Time : Tue Feb  7 23:11:53 2012
          State : clean
 Active Devices : 2
Working Devices : 2
 Failed Devices : 0
  Spare Devices : 0
           Name : core2-blfs:0  (local to host core2-blfs)
           UUID : fcb944a4:9054aeb2:d987d8fe:a89121f8
         Events : 17
    Number   Major   Minor   RaidDevice State
       0       8        1        0      active sync   /dev/sda1
       1       8       17        1      active sync   /dev/sdb1</literal>
</screen>
 <para> A partir de maintenant, les partitions peuvent être formatées avec le système de fichier de votre choix
   (ex ext3, ext4, <xref linkend='xfsprogs'/>, <xref linkend='reiserfs'/>,
   etc). Les partitions peuvent être montées. Le fichier
   <filename>/etc/fstab</filename> peut être utilisé pour faire le montage au démarrage et
   la ligne de commande linux dans
   <filename>/boot/grub/grub.cfg</filename> peux spécifier
   <option>root=/dev/md1</option>.</para>
   <note><para>Les périphériques de swap peuvent être utilisés dans le fichier <filename>/etc/fstab</filename>
   comme d'habitude. Le noyau normalement distribue les données de swap dans différent fichiers de swap 
   et ils ne peuvent pas être une partie d'une grappe RAID.</para></note>
   <para>Pour plus d'options et les détails de gestion d'un périphérique RAID, se référer à
   <userinput>man mdadm</userinput>.</para>
   <para>Vous pouvez trouver des détails supplémentaires sur la surveillance des
   échelles RAID et le traitement des problèmes sur <ulink
    url="https://raid.wiki.kernel.org/index.php/Linux_Raid">Linux RAID
   Wiki</ulink> (le wiki RAID de Linux).</para>
  </sect2>
</sect1>
