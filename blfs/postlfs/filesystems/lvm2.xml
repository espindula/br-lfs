<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY lvm2-download-http " ">
  <!ENTITY lvm2-download-ftp  "ftp://sources.redhat.com/pub/lvm2/releases/LVM2.&lvm2-version;.tgz">
  <!ENTITY lvm2-md5sum        "d49eb6abaa4e35329ae256d53a7d3726">
  <!ENTITY lvm2-size          "1.8 Mo">
  <!ENTITY lvm2-buildsize     "31 Mo (during tests, transcient files can grow up to around 500 Mo)">
  <!ENTITY lvm2-time          "0.3 SBU (around 28 SBU avec les tests, see below)">
]>
<sect1 id="lvm2" xreflabel="lvm2-&lvm2-version;">
  <?dbhtml filename="lvm2.html"?>
  <sect1info>
    <othername>$LastChangedBy : randy $</othername>
    <date>$Date : 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>
  <title>lvm2-&lvm2-version;</title>
  <indexterm zone="lvm2">
    <primary sortas="a-lvm2">lvm2</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à lvm2</title>
    <para>Le paquet <application>lvm2</application> est un ensemble d'outils qui gère
    des partitions logiques. Il permet l'extension de systèmes de fichiers
    sur plusieurs disques physiques et plusieurs partitions de disque, il
    permet une navigation dynamique ou le bidouillage de partitions logiques, les miroirs et les images
    avec une empreinte disque faible.
    </para>
    &lfs78_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&lvm2-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&lvm2-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &lvm2-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &lvm2-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &lvm2-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &lvm2-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de LVM2</bridgehead>
    <bridgehead renderas="sect4">Facultative</bridgehead>
    <para role="optional">
      <xref linkend="mdadm"/>
      <xref linkend="reiserfs"/>,
      <xref linkend="valgrind"/>,
      <xref linkend="which"/>,
      <xref linkend="xfsprogs"/> (tous les cinq peuvent être utilisées, mais ne sont pas requises pour les tests) et
      <ulink url='https://github.com/jthornber/thin-provisioning-tools'>
        thin-provisioning-tools</ulink>
    </para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/lvm2"/></para>
    <note>
      <para>
        Les versions du noyau dans les séries 4.1 et 4.2 ont une implémentation cassée de RAID.
        Si vous voulez utiliser des LV de type RAID, vous devez installer un noyau avec une version supérieure
        à 4.2.4. Notez que plusieurs tests utilisent les volumes logiques RAID, et peuvent générer un
        <quote>kernel oops</quote> avec les mauvaises version de noyau, qui peuvent rendre parfois le système inutilisable.
      </para>
    </note>


  </sect2>
  <sect2 role="kernel" id="lvm2-kernel">
    <title>Configuration du noyau</title>
    <para>Activez les options suivantes dans la configuration du noyau
    et recompiler le noyau&nbsp;:</para>

      <note><para>
      Il y a d'autres options de mappage de périphérique dans le noyau après celles
      listées en dessous. Afin d'avoir des résultats raisonnables si les tests
      de régression sont lancés, tous doivent être activé soit en interne ou soit
      en module.
    </para></note>
<screen>
<literal>Device Drivers ---&gt;
  [*] Multiple devices driver support (RAID and LVM) ---&gt; [CONFIG_MD]
    &lt;*/M&gt;   Device mapper support                         [CONFIG_BLK_DEV_DM]
    &lt;*/M/ &gt;   Crypt target support                        [CONFIG_DM_CRYPT]
    &lt;*/M/ &gt;   Snapshot target                             [CONFIG_DM_SNAPSHOT]
    &lt;*/M/ &gt;   Mirror target                               [CONFIG_DM_MIRROR]</literal>
</screen>
    <indexterm zone="lvm2 lvm2-kernel">
      <primary sortas="d-lvm2">lvm2</primary>
    </indexterm>
  </sect2>
  <sect2 role="installation">
    <title>Installation de lvm2</title>
    <para>Installez <application>lvm2</application> en lançant les commandes
    suivantes&nbsp;:</para>
<screen>
<userinput>./configure --prefix=/usr                   --exec-prefix=                  --with-confdir=/etc             --enable-applib                 --enable-cmdlib                 --enable-pkgconfig              --enable-udev_sync  &amp;&amp;
make</userinput>
</screen>

    <para>
      Les tests utilisent <application>udev</application> pour la synchronisation des volumes logiques,
       donc les régles udev de LVM et quelques utilitaires doivent être installés avant de lancer les tests.
      Si vous avez installé
      <application>LVM2</application> pour la première fois, et ne voulez pas installer l'ensemble des paquets
      avant de lancer les tests, le minimun des utilitaires peut être installé en lançant les instructions
      suivantes en tant qu'utiisateur
      <systemitem class="username">root</systemitem>:
    </para>
<screen role="root"><userinput>make -C tools install_dmsetup_dynamic &amp;&amp;
make -C udev  install                 &amp;&amp;
make -C libdm install</userinput></screen>
     <para>
      Pour tester les résultats, tapez: <command>make check_local</command> en tant qu'utilisateur
      <systemitem class="username">root</systemitem>. d'autres cibles sont disponibles et peuvent être listées
      avec <command>make -C test help</command>.
      La durée des tests est très dépendante de la vitesse des disques, et du nombre d'options activées dans le noyau.
    </para>
    <para>
      Ces tests n'utilisent pas les possibilités de <quote>échac attendu</quote>,
      et un petit nombre de tests est attendu par les développeurs. Plus d'échecs peuvent arriver car des options
      du noyau sont manquantes. Par exemple, l'absence de la cible de périphérique
      <emphasis>dm-delay</emphasis> peut expliquer plus de 10 échecs.
      Certains tests sont incorrectement
      <quote>Avertissement</quote> si
      <ulink url='https://github.com/jthornber/thin-provisioning-tools'>
      thin-provisioning-tools</ulink> n'est pas installé. Un contournement est d'ajouter les drapeaux suivants à
      <command>configure</command>:
    </para>
<screen role="nodump"><userinput>     --with-thin-check=         --with-thin-dump=          --with-thin-repair=        --with-thin-restore=       --with-cache-check=        --with-cache-dump=         --with-cache-repair=       --with-cache-restore= </userinput></screen>
    <para>
      Quelques tests peuvent planter avec des versions de noyau
      des séries 4.1 et 4.2 (voir plus haut). Ils peuvent être supprimés si nécéssaire.
      Les tests génèrent beaucoup de messages du noyau, qui peuvent
      encombrer votre terminal. Vous pouvez les désactiver en tapant
      <command>dmesg -D</command> avant de lancer les tests (ne pas oublier de taper
      <command>dmesg -E</command> quand les tests sont terminés).
    </para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explications des commandes</title>
    <para>
      <command>pathappend /sbin:/usr/sbin</command>: Le path doit contenir
      <filename class="directory">/sbin</filename> et
      <filename class='directory'>/usr/sbin</filename> pour une détection correct des outils systèmes
      par le script <command>configure</command>. Ces instructions assurent que c'est correctement initialisé
      même si vous construisez en tant qu'utilisateur. Notez que vous devrez fournir des commandes équivalentes
      si vous n'avez pas initialisé vos fichiers de démarrage dans
      <xref linkend="postlfs-config-profile"/>.
    </para>
    <para>

    <parameter>--enable-applib</parameter>&nbsp;: Ce paramètre active la construction des
    bibliothèques partagées de l'application.</para>
    <para><parameter>--enable-cmdlib</parameter>&nbsp;: Ce paramètre construit la
    bibliothèque de commande partagée. Elle est nécessaire lors de la
    construction du démon.</para>
    <para><parameter>--enable-pkgconfig</parameter>&nbsp;: Ce paramètre installe
    le support de <command>pkg-config</command>.</para>
   <para><parameter>--enable-udev_sync</parameter>&nbsp;: Ce paramètre active
    la synchronisation avec <application>Udev</application>.</para>
   <para><option>--enable-dmeventd</option>&nbsp;: Cette option construit le démon
    d'événement <application>Device Mapper</application>.</para>
    <para>
      <option>--enable-lvmetad</option>: Ce paramètre active la construction du démon de métadonnées
      de <application>LVM</application> metadata daemon,
      qui permet de scanner tous les systèmes de fichiers quand une commande lvm est lancée.
    </para>

  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      	<segtitle>Bibliothèques installées</segtitle>
<segtitle>Répertoire installé</segtitle>
      <seglistitem>
        <seg>
          blkdeactivate, dmeventd (facultatif), dmsetup, fsadm, lvm, lvmconf, lvmdump, lvmetad (facultatif), et vgimportclone. Il y a également
	  de nombreux liens symboliques pour que lvm puisse implémenter des fonctinnalités spécifiques.
        </seg>
        <seg>
           libdevmapper.so, liblvm2app.so et liblvm2cmd.so; facultatif:
           libdevmapper-event.so, libdevmapper-event-lvm2.so,
           libdevmapper-event-lvm2mirror.so, libdevmapper-event-lvm2snapshot.so,
           libdevmapper-event-lvm2raid.so et libdevmapper-event-lvm2thin.so
        </seg>
      <seg>           /etc/lvm et
          /lib/device-mapper (facultatif)
      </seg>
	</seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="blkdeactivate">
        <term><command>blkdeactivate</command></term>
        <listitem>
          <para>
            utilitaire pour désactiver les périphériques blocs.
          </para>
          <indexterm zone="lvm2 blkdeactivate">
            <primary sortas="b-blkdeactivate">blkdeactivate</primary>
          </indexterm>
        </listitem>
      </varlistentry>
     <varlistentry id="dmeventd">
        <term><command>dmeventd</command></term>
        <listitem>
          <para>
            (facultatif) est le démon d'événement du Device Mapper.
          </para>
          <indexterm zone="lvm2 dmeventd">
            <primary sortas="b-dmeventd">dmeventd</primary>
          </indexterm>
       </listitem>
      </varlistentry>
       <varlistentry id="dmsetup">
        <term><command>dmsetup</command></term>
        <listitem>
          <para>est un outil de gestion de bas niveau de volumes logiques.</para>
          <indexterm zone="lvm2 dmsetup">
            <primary sortas="b-dmsetup">dmsetup</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="fsadm">
        <term><command>fsadm</command></term>
        <listitem>
          <para>est un outil pour redimensionner ou vérifier le système de
          fichiers d'un périphérique.</para>
          <indexterm zone="lvm2 fsadm">
            <primary sortas="b-fsadm">fsadm</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="lvm">
        <term><command>lvm</command></term>
        <listitem>
          <para>fournit les outils en ligne de commande pour <application>LVM2</application>. Les commandes
          sont implémentées via des liens sympoliques vers ce programme pour
          gérer des périphériques physiques (pv*), des groupes de volume (vg*),
          et de volumes logiques (lv*).</para>
          <indexterm zone="lvm2 lvm">
            <primary sortas="b-lvm">lvm</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="lvmconf">
        <term><command>lvmconf</command></term>
        <listitem>
          <para>est un script qui modifie le verrouillage d'une configuration
          dans un fichier de configuration <application>LVM2</application>.</para>
          <indexterm zone="lvm2 lvmconf">
            <primary sortas="b-lvmconf">lvmconf</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="lvmdump">
        <term><command>lvmdump</command></term>
        <listitem>
          <para>est un outil pour envoyer diverses
          informations concernant <application>LVM2</application>.</para>
          <indexterm zone="lvm2 lvmdump">
            <primary sortas="b-lvmdump">lvmdump</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="lvmetad">
        <term><command>lvmetad</command></term>
        <listitem>
          <para>
            (facultatif) est le démon de métadonnées de LVM.
          </para>
          <indexterm zone="lvm2 lvmetad">
            <primary sortas="b-lvmetad">lvmetad</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="vgimportclone">
        <term><command>vgimportclone</command></term>
        <listitem>
          <para>est utilisé pour importer un VG dupliqué (comme un dépôt
          matériel).</para>
          <indexterm zone="lvm2 vgimportclone">
            <primary sortas="b-vgimportclone">vgimportclone</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="libdevmapper">
        <term><filename class='libraryfile'>libdevmapper.so</filename></term>
        <listitem>
          <para>contient les fonctions de l'API de <application>device-mapper</application>.</para>
          <indexterm zone="lvm2 libdevmapper">
            <primary sortas="c-libdevmapper">libdevmapper.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
