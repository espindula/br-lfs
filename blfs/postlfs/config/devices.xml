<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
]>

<sect1 id="postlfs-devices" xreflabel="About Devices">
  <?dbhtml filename="devices.html"?>

  <sect1info>
    <othername>$LastChangedBy: bdubbs $</othername>
    <date>$Date: 2008-12-30 21:35:05 +0100 (mar 30 déc 2008) $</date>
  </sect1info>

  <title>À propos des périphériques</title>

  <indexterm zone="postlfs-devices">
    <primary sortas="e-etc-udev-rules">/etc/udev/rules.d</primary>
  </indexterm>


  <para>Bien que la plupart des périphériques dont ont besoin les paquets de BLFS
  ont été correctement paramétrés par <application>udev</application> en utilisant
  les règles par défaut installées par LFS dans <filename class="directory">/etc/udev/rules.d</filename>, 
  il y a des cas où il faut modifier ou ajouter des règles.</para>

  <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
  <ulink url="&blfs-wiki;/aboutdevices"/></para>

  <sect2>
    <title>Cartes sons multiples</title>

    <para>S'il y a plusieurs cartes sons sur un système, la carte son « default »
    (par défaut) devient aléatoire. La méthode pour établir un ordre dans les 
    cartes sons dépend du fait que les pilotes soient en modules ou pas. Si les
    pilotes de la carte son sont compilés dans le noyau, leur contrôle s'effectue
    via des paramètres de la ligne de commande du noyau. dans <filename>/boot/grub/menu.lst</filename>.  
    Par exemple, si un système contient une carte FM801 et une carte PCI
    SoundBlaster, ce qui suit peut être envoyé sur la ligne de commande&nbsp;:</para>

<screen><literal>snd-fm801.index=0 snd-ens1371.index=1</literal></screen>

    <para>Si les pilotes de la carte son sont construits en modules, on peut
    établir l'ordre dans le fichier <filename>/etc/modprobe.conf</filename> 
    avec&nbsp;:</para>

<screen><literal>options snd-fm801 index=0
options snd-ens1371 index=1</literal></screen>

  </sect2>

  <sect2>
    <title>Attributs de périphériques d'Udev</title>

    <para>Le peaufinement des attributs de périphériques tels que le nom du groupe 
    et les droits est possible en créant des règles <application>udev</application> 
    supplémentaires, correspondant à quelque chose de ce genre. On peut trouver
    le fabricant et le produit en cherchant les entrées du répertoire /sys/devices
    ou en utilisant <command>udevinfo</command> après avoir attaché le 
    périphérique. Voir la documentation dans le répertoire d'<application>udev</application>  
    actuel <filename class='directory'>/usr/share/doc</filename> pour des
    détails.</para>

<screen><literal>SUBSYSTEM=="usb_device", SYSFS{idVendor}=="05d8", SYSFS{idProduct}=="4002", \
  GROUP:="scanner", MODE:="0660"</literal></screen>

    <note><para>On n'utilise la ligne ci-dessus qu'à des fins descriptives.
    Les règles d'analyse d'<application>udev</application> sont mises
    en place lors de l'installation de <xref linkend='sane'/>.</para></note>

  </sect2>

  <sect2>
    <title>Problèmes de périphériques USB</title>

    <para>Certaines applications anciennes telles que <application>VMware</application>
    ont besoin de l'entrée obsolète suivante dans le fichier
    <filename>/etc/fstab</filename>. Elle n'est en principe pas nécessaire.</para>

<screen><literal>usbfs  /proc/bus/usb  usbfs  devgid=14,devmode=0660  0  0</literal></screen>

  </sect2>

<!--
  <sect2>
    <title>Interfaces réseaux multiples</title>


  </sect2>
-->

  <sect2>
    <title>Périphériques pour les serveurs</title>

    <para>Dans certains cas, il est utile de désactiver 
    <application>udev</application> complètement et de créer des périphériques 
    statiques. Les serveurs sont un exemple de cette situation. Est-ce qu'un
    serveur a besoin de la possibilité de gérer des périphériques dynamiques&nbsp;?
    Seul vadministrateur système peut répondre à cette question, mais dans de
    nombreux cas, la réponse est non.</para>

    <para>Si vous ne désirez pas de périphériques dynamiques, vous devez créer 
    des périphériques statiques sur le système. Dans la configuration par défaut,
    le script de démarrage <filename>/etc/rc.d/rcsysinit.d/S10udev</filename> 
    monte une partition <systemitem class="filesystem">tmpfs</systemitem> 
    dans le répertoire <filename class="directory">/dev</filename>. Ce problème
    peut être résolu en montant temporairement la partition racine&nbsp;:</para>

    <warning><para>Si vous ne suivez pas rigoureusement les instructions ci-dessous,
    votre système pourrait ne plus pouvoir démarrer.</para></warning>


<screen><userinput>mount --bind / /mnt
cp -a /dev/* /mnt/dev
rm /etc/rc.d/rcsysinit.d/{S10udev,S45udev_retry}
umount /mnt</userinput></screen>

    <para>Dès lors, le système utilisera des périphériques statiques lors du
    prochain redémarrage. Créez les périphériques supplémentaires désirés en 
    utilisant <command>mknod</command>.</para>

    <para>Si vous voulez restaurer les périphériques dynamiques, recréez les
    liens symboliques
    <filename>/etc/rc.d/rcsysinit.d/{S10udev,S45udev_retry}</filename> et
    redémarrez de nouveau. Il n'est pas nécessaire de supprimer les périphériques
    statiques (console et null sont toujours nécessaires) car ils sont recouverts
    par la partitcon <systemitem class="filesystem">tmpfs</systemitem>.
    L'utilisation du disque par des périphériques est négligible (environ
    20&ndash;30 octets par entrée.)</para>

  </sect2>

</sect1>
