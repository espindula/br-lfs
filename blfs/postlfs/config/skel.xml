<sect1 id="postlfs-config-skel">
<?dbhtml filename="skel.html" dir="postlfs"?>
<title>Configurer l'ajout d'utilisateurs</title>

<para>Ensemble, la commande <command>/usr/sbin/useradd</command> et le
répertoire <filename>/etc/skel</filename> (tous les deux simple à configurer et
à utiliser) sont un moyen de vous assurer que les nouveaux utilisateurs de votre
système <acronym>LFS</acronym> disposeront au départ des mêmes configurations
sur des éléments comme <envar>PATH</envar>, la gestion du clavier et les
variables d'environnement. Utiliser ces deux moyens rendra ceci plus facile et
vous assure de l'état initial de chaque nouvel utilisateur.</para>

<para>Le répertoire <filename>/etc/skel</filename> tient des copies de
différents fichiers d'initialisation et autres qui devront être copiés dans le
répertoire personnel du nouvel utilisateur lorsque le programme
<command>/usr/sbin/useradd</command> ajoutera cet utilisateur.</para>

<para>Useradd</para>

<para>Le programme <command>useradd</command> utilise une collection de valeurs
par défaut conservée dans <filename>/etc/default/useradd</filename>, si il
existe. S'il n'existe pas, alors il utilise quelques valeurs internes par
défaut. Vous pouvez voir les valeurs par défaut en lançant
<userinput><command>/usr/sbin/useradd -D</command></userinput>.
</para>

<para>Pour changer ces valeurs en quelque chose de nouveau, créez un fichier
<filename>/etc/default/useradd</filename> de base avec les mêmes valeurs que la
sortie de <userinput><command>/usr/sbin/useradd -D</command></userinput>. Voici
un exemple.</para>

<screen># Début /etc/default/useradd

GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=
SKEL=/etc/skel

# Fin /etc/default/useradd</screen>

<para>La seule chose manquant dans ce fichier est le shell par défaut.
Ajoutez-le en lançant:</para>

<screen><userinput><command>/usr/sbin/useradd -D -s/bin/bash</command></userinput></screen>

<para>Ceci va configurer la ligne <envar>SHELL</envar>= en
<envar>SHELL</envar>=/bin/bash.</para>

<para><command>Useradd</command> a beaucoup d'autres paramètres pouvant être
configurés dans le fichier <filename>/etc/default/useradd</filename>.
</para>

<para>Pour plus d'informations, voir <command>man useradd</command>.</para>

<para>/etc/skel</para>

<para>Pour commencer, créez un répertoire <filename>/etc/skel</filename> et
assurez-vous que seul l'administrateur système a le droit d'écrire dedans, donc
habituellement root. Créer le répertoire en tant que root est la meilleure façon
de procéder.</para>

<para>Les droits de tous les fichiers dans cette partie du livre doivent
permettre l'écriture uniquement par le propriétaire. De même, comme il n'y a 
aucune façon de savoir quel type d'informations sensibles un utilisateur
pourrait éventuelle placer dans leur copie de ces fichiers, vous devriez les
rendre illisible pour le groupe et les autres.</para>

<para>Vous pouvez aussi placer d'autres fichiers dans
<filename>/etc/skel</filename> et d'autres droits peuvent être nécessaires pour
ceux-là.</para>

<para>Décidez quels fichiers d'initialisation doivent être fournis à chaque
(ou tout) nouvel utilisateur. Les décisions que vous prenez affecteront ce que
vous ferez dans les trois prochaines sections, "/etc/inputrc", "Fichiers de
démarrage du Shell Bash" et "/etc/vimrc, ~/.vimrc". Certains ou tous ces
fichiers seront utiles à root, aux utilisateurs déjà existants et aux nouveaux
utilisateurs.</para>

<para>Les fichiers de ces sections que vous pourriez vouloir placer dans
<filename>/etc/skel</filename> incluent
<filename>.inputrc</filename>, <filename>.bash_profile</filename>,
<filename>.bashrc</filename>, <filename>.bash_logout</filename>,
<filename>.dircolors</filename> et <filename>.vimrc</filename>. Si vous n'êtes
pas sûr lesquels doivent y être mis, continuez simplement avec les sections
suivantes, lisez chaque section et toutes les références proposées, et enfin
décidez.</para>

<para>Vous lancerez un ensemble de commandes légèrement modifié des fichiers
placés dans <filename>/etc/skel</filename>. Chaque section vous le rappelera.
En bref, les commandes du livre ont été écrites pour des fichiers
<emphasis>non</emphasis> ajoutés dans <filename>/etc/skel</filename> et
envoient simplement les résultats dans le répertoire personnel de l'utilisateur.
Si le fichier se trouve être dans <filename>/etc/skel</filename>, changez les
commandes du livre pour envoyer la sortie là-bas et ensuite copiez le fichier
<filename>/etc/skel</filename> pour les répertoires appropriés, comme
<filename>/etc</filename>, <filename>~</filename> ou le répertoire personnel de
tout autre utilisateur existant déjà dans le système.</para>

<para>Lors de l'ajout d'un utilisateur</para>

<para>Lors de l'ajout d'un nouvel utilisateur avec <filename>useradd</filename>,
utilisez le paramètre <userinput>-m</userinput>, indiquant à
<filename>useradd</filename> de créer le répertoire personnel de l'utilisateur
et de copier les fichiers de <filename>/etc/skel</filename> (peut être
surchargé) dans le répertoire personnel du nouvel utilisateur. Par exemple:
</para>

<screen><command>useradd -m -s/bin/bash jwrober</command></screen>

</sect1>
