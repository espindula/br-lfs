<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY tripwire-download-http "&sourceforge-repo;/tripwire/tripwire-&tripwire-version;-src.tar.bz2">
  <!ENTITY tripwire-download-ftp  " ">
  <!ENTITY tripwire-md5sum        "2462ea16fb0b5ae810471011ad2f2dd6">
  <!ENTITY tripwire-size          "704 Ko">
  <!ENTITY tripwire-buildsize     "31 Mo">
  <!ENTITY tripwire-time          "1.3 SBU">
]>
<sect1 id="tripwire" xreflabel="Tripwire-&tripwire-version;">
  <?dbhtml filename="tripwire.html"?>
  <sect1info>
    <othername>$LastChangedBy : randy $</othername>
    <date>$Date : 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>
  <title>Tripwire-&tripwire-version;</title>
  <indexterm zone="tripwire">
    <primary sortas="a-Tripwire">Tripwire</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à Tripwire</title>
    <para>Le paquet <application>Tripwire</application> contient des programmes
    utilisés pour vérifier l'intégrité des fichiers sur un système donné.</para>
   &lfs75_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&tripwire-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&tripwire-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &tripwire-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &tripwire-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &tripwire-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &tripwire-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de Tripwire</bridgehead>
    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><xref linkend="openssl"/></para>
    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">An <xref linkend="server-mail"/></para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/tripwire"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de Tripwire</title>
    <para>Compilez <application>Tripwire</application> en lançant les commandes
    suivantes&nbsp;:</para>
<screen>
<userinput>sed -i -e 's@TWDB="${prefix}@TWDB="/var@' install/install.cfg            &amp;&amp;
sed -i -e 's/!Equal/!this->Equal/' src/cryptlib/algebra.h                &amp;&amp;
sed -i -e '/stdtwadmin.h/i#include &lt;unistd.h&gt;' src/twadmin/twadmincl.cpp &amp;&amp;
sed -i -e '/TWMAN/ s|${prefix}|/usr/share|' \
       -e '/TWDOCS/s|${prefix}|/usr/share|' install/install.cfg          &amp;&amp;
sed -i -e 's/eArchiveOpen e\([^)]*)\)/throw ( eArchiveOpen\1 )/' \
       -e '/throw e;/d' src/core/archive.cpp                             &amp;&amp;
./configure --prefix=/usr --sysconfdir=/etc/tripwire                     &amp;&amp;
make</userinput>
</screen>
    <warning><para>La configuration par défaut consiste à utiliser un MTA local.
    Si vous n'avez pas installé de MTA et si vous ne souhaitez pas en installer, 
    modifiez <filename>install/install.cfg</filename> pour utiliser plutôt un 
    serveur SMTP. Sans cela, l'installation échouera.</para></warning>
    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install &amp;&amp;
cp -v policy/*.txt /usr/share/doc/tripwire</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explication des commandes</title>
    <para><command>sed -i -e 's@TWDB="${prefix}@TWDB="/var@'
    install/install.cfg</command>&nbsp;: Cette commande dit au paquet d'installer
    la base de données et les rapports du programme dans
    <filename class="directory">/var/lib/tripwire</filename>.</para>
    <para><command>sed ... src/cryptlib/algebra.h</command>&nbsp;:
    Corrige la compilation avec gcc-4.7.</para>
    <para><command>sed ... src/twadmin/twadmincl.cpp</command>&nbsp;:
    Corrige la compilation avec gcc-4.7.</para>
    <para><command>sed ... install/install.cfg</command>:
    Corrige l'emplacement des répertoires man et doc.</para>
    <para><command>sed ... src/core/archive.cpp</command>:
    Corrige la compilation avec gcc-4.9.</para>
    <para><command>make install</command>&nbsp;: Cette commande crée les clés
    de sécurité <application>Tripwire</application> et installe les
    binaires. Il y a deux clés&nbsp;: une clé distante et une clé locale qui
    sont stockées dans <filename class="directory">/etc/tripwire/</filename>.</para>
    <note><para>Pendant <command>make install</command>, plusieurs questions sont posées,
    incluant les mots de passe. Si vous voulez faire un script, vous devez appliquer un 
    <application>sed</application> avant de lancer
    <command>make install</command>:</para>
    <para>
    <command>sed -i -e 's@install/install.sh@&amp; -n -s<replaceable>&lt;site-password&gt;</replaceable> -l<replaceable>&lt;local-password&gt;</replaceable>@' Makefile</command>
    </para>
    <para>biensur, vous devez faire cela avec des mots de passe triviaux et les changer ensuite.
    </para></note>
    <para><command>cp -v policy/*.txt /usr/doc/tripwire</command>&nbsp;: Cette
    commande installe les fichiers de politique modèle <application>tripwire</application> 
    avec le reste de la documentation de <application>tripwire</application>.</para>
  </sect2>
  <sect2 role="configuration">
    <title>Configuration de Tripwire</title>
    <sect3 id="tripwire-config">
      <title>Fichiers de configuration</title>
      <para><filename>/etc/tripwire/*</filename></para>
      <indexterm zone="tripwire tripwire-config">
        <primary sortas="e-etc-tripwire">/etc/tripwire/*</primary>
      </indexterm>
    </sect3>
    <sect3>
      <title>Informations de configuration</title>
      <para><application>Tripwire</application> utilise un fichier de règles
      pour déterminer les fichiers dont l'intégrité est à vérifier. Le fichier
      de règles par défaut (<filename>/etc/tripwire/twpol.txt</filename>) vaut
      pour une installation par défaut et devra être mis à jour selon votre
      système.</para>
      <para>Vous devriez adapter les fichiers de règles individuels à chaque 
      distribution et/ou installation. Vous pouvez trouver certains fichiers de
      règles d'exemples dans <filename class="directory">/usr/doc/tripwire/</filename>.
      </para>
      <para>Si vous le souhaitez, copiez le fichier de règles que vous aimeriez
      essayer dans <filename class="directory">/etc/tripwire/</filename> au lieu
      d'utiliser le fichier de règles par défaut, <filename>twpol.txt</filename>.  
      Néanmoins, on vous recommande d'éditer votre propre fichier de règles.
      Inspirez-vous des exemples ci-dessus et lisez <filename>/usr/share/doc/tripwire/policyguide.txt</filename>
      pour des informations supplémentaires. <filename>twpol.txt</filename> est
      un bon fichier de règles pour apprendre <application>Tripwire</application> 
      car il remarquera n'importe quelle modification dans le système de fichiers 
      et il peut même être utilisé comme une façon ennuyeuse de garder une
      trace des changements de désinstallation d'un logiciel.</para>
      <para>Après que votre fichier de règles a été éditez selon vos désirs, 
      vous pouvez commencer les étapes de configuration (effectuez
      en tant qu'utilisateur <systemitem
      class='username'>root</systemitem>) :</para>
<screen role="root">
<userinput>twadmin --create-polfile --site-keyfile /etc/tripwire/site.key \
    /etc/tripwire/twpol.txt &amp;&amp;
tripwire --init</userinput>
</screen>
    <para>Selon votre système et le contenu du fichier de règles, la phase
    d'initialisation ci-dessus peut prendre un temps relativement long.</para>
    </sect3>
    <sect3>
      <title>Informations d'utilisation</title>
      <para><application>Tripwire</application> identifiera les modifications 
      de fichiers dans les fichiers critiques du système indiqués dans le 
      fichier de règles. L'utilisation de 
      <application>Tripwire</application> si vous modifiez souvent ces
      répertoires marquera toutes ces modifications. C'est souvent utile après
      que le système a atteint une configuration considérée comme stable par
      l'utilisateur.</para>
      <para>Pour utiliser <application>Tripwire</application> après avoir créé 
      un fichier de règles pour lancer un signalement, utilisez la commande 
      suivante&nbsp;:</para>
<screen role="root">
<userinput>tripwire --check &gt; /etc/tripwire/report.txt</userinput>
</screen>
      <para>Observez la sortie pour vérifier l'intégrité de vos fichiers. Un 
      rapport automatique d'intégrité peut être obtenu en utilisant une 
      fonctionnalité cron pour programmer à l'avance les exécutions.</para>
      <para>Les rapports sont stockés en binaire et, si vous le désirez, chiffrés.
      Observez les rapports, en tant qu'utilisateur <systemitem class="username">root</systemitem>,
      avec&nbsp;:</para>
<screen role="root">
twprint --print-report -r /var/lib/tripwire/report/<replaceable>&lt;report-name.twr&gt;</replaceable>
</screen>
      <para>Après que vous avez lancé une vérification d'intégrité, vous devriez
      examiner le rapport (ou le message électronique) puis modifier la base de
      données <application>Tripwire</application> pour refléter les fichiers 
      modifiés sur votre système. Ceci pour que
      <application>Tripwire</application> ne vous notifie pas en permanence que
      des fichiers que vous avez volontairement modifiés sont une violation de
      sécurité. Pour faire cela, vous devez tout d'abord faire
      <command>ls -l /var/lib/tripwire/report/</command> et remarquer le nom du
      fichier le plus récent qui commence par le nom de votre système tel que
      présenté par la commande <userinput>uname -n</userinput> et qui finit par
      <filename>.twr</filename>. Ces fichiers ont été créés pendant la création
      du rapport et le plus actuel est nécessaire pour mettre à jour la base de 
      données <application>Tripwire</application> de votre système. En tant
      qu'utilisateur <systemitem class='username'>root</systemitem>, entrez
      la commande suivante en faisant le nom du rapport adéquat&nbsp;:</para>
<screen role="root">
<userinput>tripwire --update --twrfile /var/lib/tripwire/report/<replaceable>&lt;report-name.twr&gt;</replaceable></userinput>
</screen>
      <para>Vous serez mis dans <application>vim</application> avec une copie du
      rapport face à vous. Si tous les changements sont corrects, tapez  
      simplement <command>&nbsp;:wq</command> et après avoir entré votre clé locale,
      la base de données sera mise à jour. S'il y a des fichiers pour lesquels
      vous voulez encore être averti, supprimez le 'x' avant le nom du fichier
      dans le rapport et tapez <command>&nbsp;:wq</command>.</para>
    </sect3>
    <sect3>
      <title>Modifier le fichier de règles</title>
      <para>Si vous n'êtes pas content de votre fichier de règles et si vous
      aimeriez le modifier ou en utiliser un nouveau, modifiez le fichier de 
      règles puis exécutez les commandes suivantes en tant qu'utilisateur
       <systemitem class='username'>root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>twadmin --create-polfile /etc/tripwire/twpol.txt &amp;&amp;
tripwire --init</userinput>
</screen>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>siggen, tripwire, twadmin, et twprint</seg>
        <seg>Aucune</seg>
        <seg>/etc/tripwire, /var/lib/tripwire, et /usr/share/doc/tripwire</seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="siggen">
        <term><command>siggen</command></term>
        <listitem>
          <para>est un outil rassembleur de signatures qui affiche les valeurs
          de la fonction de hachage pour les fichiers spécifiés.</para>
          <indexterm zone="tripwire siggen">
            <primary sortas="b-siggen">siggen</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id='tripwire-program'>
        <term><command>tripwire</command></term>
        <listitem>
          <para>est le programme principal de vérification d'intégrité des 
          fichiers.</para>
          <indexterm zone="tripwire tripwire">
            <primary sortas="b-tripwire">tripwire</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id='twadmin'>
        <term><command>twadmin</command></term>
        <listitem>
          <para>outil d'administration utilisé pour effectuer 
          certaines fonctions administratives et certaines options de configuration
          liées aux fichiers <application>Tripwire</application>.</para>
          <indexterm zone="tripwire twadmin">
            <primary sortas="b-twadmin">twadmin</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id='twprint'>
        <term><command>twprint</command></term>
        <listitem>
          <para>affiche une base de données et des fichiers de rapport 
          <application>Tripwire</application> au format texte en clair.</para>
          <indexterm zone="tripwire twprint">
            <primary sortas="b-twprint">twprint</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
