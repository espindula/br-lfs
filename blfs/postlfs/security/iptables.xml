<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY iptables-download-http "http://www.netfilter.org/projects/iptables/files/iptables-&iptables-version;.tar.bz2">
  <!ENTITY iptables-download-ftp  "ftp://ftp.netfilter.org/pub/iptables/iptables-&iptables-version;.tar.bz2">
  <!ENTITY iptables-md5sum        "0a9209f928002e5eee9cdff8fef4d4b3">
  <!ENTITY iptables-size          "169 Kio">
  <!ENTITY iptables-buildsize     "4.0 Mio">
  <!ENTITY iptables-time          "0.1 SBU">
]>

<sect1 id="iptables" xreflabel="iptables-&iptables-version;">
  <?dbhtml filename="iptables.html"?>

  <sect1info>
    <othername>$LastChangedBy: randy $</othername>
    <date>$Date: 2008-05-09 14:42:27 +0200 (ven, 09 mai 2008) $</date>
  </sect1info>

  <title>Iptables-&iptables-version;</title>

  <indexterm zone="iptables">
    <primary sortas="a-Iptables">Iptables</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Iptables</title>

  <para>La partie suivante de ce chapitre traite des pare-feux. L'outil principal
  de pare-feu pour Linux, depuis la série 2.4 du noyau, est 
  <application>iptables</application>.  Il remplace 
  <application>ipchains</application> de la série 2.2 et 
  <application>ipfwadm</application> de la série 2.0. Vous devrez installer
  <application>iptables</application> si vous souhaitez utiliser une 
  forme de pare-feu.</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&iptables-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&iptables-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &iptables-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &iptables-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &iptables-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &iptables-time;</para>
      </listitem>
    </itemizedlist>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/iptables"/></para>

  </sect2>

  <sect2 role="kernel" id='iptables-kernel'>
    <title>Configuration du noyau</title>

    <para>Sur Linux, on a un pare-feu via une portion du noyau qui s'appelle
    netfilter. L'interface avec netfilter est
    <application>iptables</application>. Pour l'utiliser, vous trouverez les
    paramètres adéquats de configuration du noyau dans Networking &rArr;
    Networking Options &rArr; Network Packet Filtering &rArr;
    Core Netfilter Configuration (and) IP: Netfilter Configuration.</para>

    <indexterm zone="iptables iptables-kernel">
      <primary sortas="d-iptables">Iptables</primary>
    </indexterm>

  </sect2>

    <sect2 role="installation">
      <title>Installation d'Iptables</title>

    <note>
      <para>L'installation ci-dessous n'inclut pas la construction de quelques
      bibliothèques d'extension spécialisées qui exigent les en-têtes raw dans
      le code source de <application>Linux</application>. Si vous souhaitez
      construire des extensions supplémentaires (si vous n'êtes pas sûr, vous
      n'en avez probablement pas besoin), vous pouvez regarder le fichier
      <filename>INSTALL</filename> pour voir un exemple de la façon de modifier
      le paramètre <parameter>KERNEL_DIR=</parameter> pour pointer vers le code
      source de <application>Linux</application>. Remarquez que si vous mettez à
      jour la version du noyau, il se peut que vous deviez aussi recompiler 
      <application>iptables</application> et que l'équipe BLFS n'a pas testé
      d'utiliser les en-têtes du noyau raw.</para>

      <!-- <para>Installation de <application>iptables</application> will fail
      if raw kernel headers are found in <filename
      class='directory'>/usr/src/linux</filename> either as actual files
      or a symlink.  As of the Linux 2.6 kernel series, this directory
      should no longer exist because appropriate headers were installed
      from the <application>Linux-Libc-Headers</application> package during
      the base LFS installation.</para> -->

      <para>Pour certaines architectures non x86, il se peut qu'il faille les
      en-têtes du noyau raw. Dans ce cas, modifiez le paramètre
      <parameter>KERNEL_DIR=</parameter> pour pointer vers le code source de
      <application>Linux</application>.</para>
    </note>

    <para>Installez <application>iptables</application> en lançant les commandes
    suivantes&nbsp;:</para>

<screen><userinput>sed -i 's/name="$node/name="node/' iptables.xslt &amp;&amp;
make LIBDIR=/lib KERNEL_DIR=/usr</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make PREFIX=/usr LIBDIR=/lib BINDIR=/sbin \
    MANDIR=/usr/share/man install &amp;&amp;
install -v -m644 iptables.xslt /lib/iptables</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><command>sed -i 's/name="$node/name="node/' iptables.xslt</command>&nbsp;:
    Ceci corrige une erreur de syntaxe dans la feuille de style XSLT pour une
    utilisation avec <command>iptables-xml</command>.</para>

    <para><parameter>PREFIX=/usr LIBDIR=/lib BINDIR=/sbin</parameter>&nbsp;:
    Compile et installe des modules <application>iptables</application> dans
    <filename class="directory">/lib</filename>, des binaires dans
    <filename class="directory">/sbin</filename> et le reste dans la
    hiérarchie <filename class="directory">/usr</filename> au lieu de
    <filename class="directory">/usr/local</filename>. Les pare-feux sont
    en général activés lors du processus de démarrage et il se peut que
    <filename class="directory">/usr</filename> soit monté à ce moment-là.</para>

    <para><parameter>KERNEL_DIR=/usr</parameter>&nbsp;: Ce paramètre est
    utilisé pour pointer vers les lecteurs de noyau assainis dans 
    <filename class='directory'>/usr</filename> et pour ne pas utiliser les
    en-têtes de noyau raw dans <filename class='directory'>/usr/src/linux</filename>.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration d'Iptables</title>

    <para>Des instructions d'introduction de configuration de votre pare-feu
    sont présentées dans la prochaine section&nbsp;: <xref linkend="fw-firewall"/></para>

    <sect3  id="iptables-init">
      <title>Script de démarrage</title>

      <para>Pour paramétrer le pare-feu d'iptables au démarrage, installez le
      script d'initialisation <filename>/etc/rc.d/init.d/iptables</filename> 
      fourni dans le paquet <xref linkend="bootscripts"/>.</para>

      <indexterm zone="iptables iptables-init">
        <primary sortas="f-iptables">iptables</primary>
      </indexterm>

<screen role="root"><userinput>make install-iptables</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoire installé</segtitle>

      <seglistitem>
        <seg>iptables, iptables-restore, iptables-save, iptables-xml et
        ip6tables</seg>
        <seg>libip6t_*.so et libipt_*.so</seg>
        <seg>/lib/iptables</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="iptables-prog">
        <term><command>iptables</command></term>
        <listitem>
          <para>est utilisé pour paramétrer, maintenir et inspecter les tables 
          de règles de filtrage de paquets IP du noyau Linux.</para>
          <indexterm zone="iptables iptables-prog">
            <primary sortas="b-iptables">iptables</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-restore">
        <term><command>iptables-restore</command></term>
        <listitem>
          <para>est utilisé pour restaurer des tables IP à partir de données
          spécifiées sur STDIN. Utilise la redirection E/S fournie par votre
          shell pour lire un fichier.</para>
          <indexterm zone="iptables iptables-restore">
            <primary sortas="b-iptables-restore">iptables-restore</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-save">
        <term><command>iptables-save</command></term>
        <listitem>
          <para>est utilisé pour envoyer le contenu d'une table IP dans un
          format facilement parseable vers STDOUT. Utilisez la redirection E/S
          fournie par votre shell pour écrire dans un fichier.</para>
          <indexterm zone="iptables iptables-save">
            <primary sortas="b-iptables-save">iptables-save</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-xml">
        <term><command>iptables-xml</command></term>
        <listitem>
          <para>est utilisé pour convertir la sortie de <command>iptables-save</command> 
          au format XML. L'utilisation de la feuille de style
          <filename>iptables.xslt</filename> convertit le fond XML au format
          <command>iptables-restore</command>.</para>
          <indexterm zone="iptables iptables-xml">
            <primary sortas="b-iptables-xml">iptables-xml</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ip6tables">
        <term><command>ip6tables</command></term>
        <listitem>
          <para>est utilisé pour paramétrer, maintenir et inspecter les tables
          de règles filtrant des paquets IPV6 dans le noyau Linux. On peut
          définir plusieurs tables différent. Chaque table contient un certain
          nombre de chaínes intégrées et peut contenir aussi des chaînes
          définies par l'utilisateur.</para>
          <indexterm zone="iptables ip6tables">
            <primary sortas="b-ip6tables">ip6tables</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libip-iptables">
        <term><filename class='libraryfile'>libip*.so</filename></term>
        <listitem>
          <para>les modules de bibliothèque sont divers modules (implémentés 
          en tant que bibliothèques dynamiques) qui étendent la fonctionnalité
          de base d'<command>iptables</command>.</para>
          <indexterm zone="iptables libip-iptables">
            <primary sortas="c-libip-iptables">libip*.so</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
