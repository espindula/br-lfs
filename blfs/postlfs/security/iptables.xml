<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY iptables-download-http "http://www.netfilter.org/projects/iptables/files/iptables-&iptables-version;.tar.bz2">
  <!ENTITY iptables-download-ftp  "ftp://ftp.netfilter.org/pub/iptables/iptables-&iptables-version;.tar.bz2">
  <!ENTITY iptables-md5sum        "c3fb2ffd5b39d0d54b06ccc4c8660116">
  <!ENTITY iptables-size          "532 Ko">
  <!ENTITY iptables-buildsize     "18 Mo">
  <!ENTITY iptables-time          "0.2 SBU">
]>

<sect1 id="iptables" xreflabel="iptables-&iptables-version;">
  <?dbhtml filename="iptables.html"?>

  <sect1info>
    <othername>$LastChangedBy : krejzi $</othername>
    <date>$Date : 2013-01-05 23:47:05 +0100 (Sat, 05 Jan 2013) $</date>
  </sect1info>

  <title>Iptables-&iptables-version;</title>

  <indexterm zone="iptables">
    <primary sortas="a-Iptables">Iptables</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Iptables</title>

  <para>La partie suivante de ce chapitre traite des pare-feux. L'outil principal
  de pare-feu pour Linux est 
  <application>iptables</application>. Vous devrez installer
  <application>iptables</application> si vous souhaitez utiliser une 
  forme de pare-feu.</para>

   &lfs72_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&iptables-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&iptables-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &iptables-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &iptables-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &iptables-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &iptables-time;</para>
      </listitem>
    </itemizedlist>

<!--
   <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>
          Correctif requis&nbsp;:
          <ulink url="&patch-root;/iptables-&iptables-version;-missing-includes-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
    -->
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/iptables"/></para>

  </sect2>

  <sect2 role="kernel" id="iptables-kernel">
    <title>Configuration du noyau</title>

    <para>Sur Linux, on a un pare-feu via une portion du noyau qui s'appelle
    netfilter. L'interface avec netfilter est
    <application>iptables</application>. Pour l'utiliser, vous trouverez les
    paramètres adéquats de configuration du noyau dans Networking &rArr;
    Networking Options &rArr; Network Packet Filtering.</para>

    <indexterm zone="iptables iptables-kernel">
      <primary sortas="d-iptables">Iptables</primary>
    </indexterm>

  </sect2>

    <sect2 role="installation">
      <title>Installation d'Iptables</title>

    <note>
      <para>L'installation ci-dessous n'inclut pas la construction de quelques
      bibliothèques d'extension spécialisées qui exigent les en-têtes raw dans
      le code source de <application>Linux</application>. Si vous souhaitez
      construire des extensions supplémentaires (si vous n'êtes pas sûr, vous
      n'en avez probablement pas besoin), vous pouvez regarder le fichier
      <filename>INSTALL</filename> pour voir un exemple de la façon de modifier
      le paramètre <parameter>KERNEL_DIR=</parameter> pour pointer vers le code
      source de <application>Linux</application>. Remarquez que si vous mettez à
      jour la version du noyau, il se peut que vous deviez aussi recompiler 
      <application>iptables</application> et que l'équipe BLFS n'a pas testé
      l'utilisation des en-têtes du noyau raw.</para>

      <para>Pour certaines architectures non x86, il se peut qu'il faille les
      en-têtes du noyau raw. Dans ce cas, modifiez le paramètre
      <parameter>KERNEL_DIR=</parameter> pour pointer vers le code source de
      <application>Linux</application>.</para>
    </note>

    <para>Installez <application>iptables</application> en lançant les commandes
    suivantes&nbsp;:</para>

<screen><userinput>LDFLAGS="-L$PWD/libiptc/.libs"                     \
./configure --prefix=/usr                          \
   --exec-prefix=    \
   --bindir=/usr/bin  \
   --with-xtlibdir=/lib/xtables  \
   --with-pkgconfigdir=/usr/lib/pkgconfig \
   --enable-libipq      \
   --enable-devel &amp;&amp;
make</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
ln -sfv ../../sbin/xtables-multi /usr/bin/iptables-xml &amp;&amp;
for file in libip4tc libip6tc libipq libiptc libxtables
do
  ln -sfv ../../lib/`readlink /lib/${file}.so` /usr/lib/${file}.so &amp;&amp;
  rm -v /lib/${file}.so &amp;&amp;
  mv -v /lib/${file}.la /usr/lib &amp;&amp;
  sed -i "s@libdir='@&amp;/usr@g" /usr/lib/${file}.la
done</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>
    
    <para><parameter>--exec-prefix=</parameter>&nbsp;:  Assure que tous les binaires
    et les bibliothèques finissent dans l'arborescence de
    répertoires <filename class="directory">/</filename>.</para>

    <para><parameter>--with-xtlibdir=/lib/xtables</parameter>&nbsp;: Assure
    que les modules d'<application>Iptables</application> sont installés dans le répertoire
    <filename class="directory">/lib/xtables</filename>.</para>

    <para><parameter>--with-pkgconfigdir=/usr/lib/pkgconfig</parameter>>&nbsp;:nbsp;:
    Assure que tous les fichiers pkgconfig sont dans le repertoire standard.</para>
 
    <para>
      <option>--enable-libipq</option>&nbsp;: Ce paramètre active la construction
      de <filename class="libraryfile">libipq.so</filename> qui peut être utilisé
      par certains paquets extérieurs à BLFS.
    </para>

    <para>
      <option>--enable-devel</option>&nbsp;: Ce paramètre active l'installation
      des en-têtes de développement de <application>Iptables</application> qui
      peuvent être utilisées par certains paquets extérieurs à BLFS.
    </para>

    <para><command>ln -sfv ../../sbin/xtables-multi /usr/bin/iptables-xml</command>:
    Assure que le lien symbolique de <command>iptables-xml</command> est relatif.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration d'Iptables</title>

    <para>Des instructions d'introduction de configuration de votre pare-feu
    sont présentées dans la prochaine section&nbsp;: <xref linkend="fw-firewall"/></para>

    <sect3  id="iptables-init">
      <title>Script de démarrage</title>

      <para>Pour paramétrer le pare-feu d'iptables au démarrage, installez le
      script d'initialisation <filename>/etc/rc.d/init.d/iptables</filename> 
      fourni dans le paquet <xref linkend="bootscripts"/>.</para>

      <indexterm zone="iptables iptables-init">
        <primary sortas="f-iptables">iptables</primary>
      </indexterm>

<screen role="root"><userinput>make install-iptables</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>
          ip6tables, ip6tables-restore, ip6tables-save, iptables, iptables-restore,
          iptables-save, iptables-xml et xtables-multi
        </seg>
        <seg>
          libip4tc.so, libip6tc.so, libipq.so, libiptc.so et libxtables.so
        </seg>
        <seg>
          /lib/xtables and /usr/include/libiptc
        </seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="iptables-prog">
        <term><command>iptables</command></term>
        <listitem>
          <para>est utilisé pour paramétrer, maintenir et inspecter les tables 
          de règles de filtrage de paquets IP du noyau Linux.</para>
          <indexterm zone="iptables iptables-prog">
            <primary sortas="b-iptables">iptables</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-restore">
        <term><command>iptables-restore</command></term>
        <listitem>
          <para>est utilisé pour restaurer des tables IP à partir de données
          spécifiées sur STDIN. Utilise la redirection E/S fournie par votre
          shell pour lire un fichier.</para>
          <indexterm zone="iptables iptables-restore">
            <primary sortas="b-iptables-restore">iptables-restore</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-save">
        <term><command>iptables-save</command></term>
        <listitem>
          <para>est utilisé pour envoyer le contenu d'une table IP dans un
          format facilement parseable vers STDOUT. Utilisez la redirection E/S
          fournie par votre shell pour écrire dans un fichier.</para>
          <indexterm zone="iptables iptables-save">
            <primary sortas="b-iptables-save">iptables-save</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="iptables-xml">
        <term><command>iptables-xml</command></term>
        <listitem>
          <para>est utilisé pour convertir la sortie de <command>iptables-save</command> 
          au format XML. L'utilisation de la feuille de style
          <filename>iptables.xslt</filename> convertit le fond XML au format
          <command>iptables-restore</command>.</para>
          <indexterm zone="iptables iptables-xml">
            <primary sortas="b-iptables-xml">iptables-xml</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ip6tables">
        <term><command>ip6tables*</command></term>
        <listitem>
          <para>sont un ensemble de commandes pour IPV6 qui sont similaires aux commandes
	    iptables vu précédement.</para>
          <indexterm zone="iptables ip6tables">
            <primary sortas="b-ip6tables">ip6tables</primary>
          </indexterm>
        </listitem>
      </varlistentry>

   </variablelist>

  </sect2>

</sect1>
