<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY consolekit-download-http "https://github.com/Consolekit2/ConsoleKit2/releases/download/1.0.0/ConsoleKit2-&consolekit-version;.tar.bz2">
  <!ENTITY consolekit-download-ftp  " ">
  <!ENTITY consolekit-md5sum        "a89382ac18c11eda349053ed37114264">
  <!ENTITY consolekit-size          "1.3 Mo">
  <!ENTITY consolekit-buildsize     "13.2 Mo">
  <!ENTITY consolekit-time          "0.2 SBU">
]>
<sect1 id="consolekit" xreflabel="ConsoleKit2-&consolekit-version;">
  <?dbhtml filename="consolekit.html"?>
  <sect1info>
    <othername>$LastChangedBy : randy $</othername>
    <date>$Date : 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>
  <title>ConsoleKit2-&consolekit-version;</title>
  <indexterm zone="consolekit">
    <primary sortas="a-ConsoleKit">ConsoleKit2</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à ConsoleKit</title>
    <para>Le paquet <application>ConsoleKit</application> est un 
    environnement pour garder une trace des différents utilisateurs, des sessions, 
    et des places présents sur un système. Il offre aux logiciels un mécanisme
    pour réagir aux modifications de ces éléments ou d'une des métadonnées qui 
    y est associées.</para>
    &lfs77_checked; &gcc5_built;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&consolekit-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&consolekit-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &consolekit-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &consolekit-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &consolekit-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &consolekit-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de ConsoleKit</bridgehead>
    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">,
    <xref linkend="dbus-glib"/> et <xref linkend="xorg7-lib"/></para>
    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended"><xref linkend="linux-pam"/>
    and <xref linkend="polkit"/></para>
    <warning>
      <para>Si vous prévoyez de <emphasis role="strong">NE PAS</emphasis> 
      installer <application>polkit</application>, vous devrez éditer le fichier
      ConsoleKit.conf à la main pour déverrouiller le service. Un échec pour faire cela peut
      signifier un énorme TROU DE ECURITE.</para>
    </warning>
    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="xmlto"/></para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/consolekit"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de ConsoleKit</title>
    <para>Installez <application>ConsoleKit</application> en lançant les commandes
    suivantes&nbsp;:</para>
<screen>
<userinput>./configure --prefix=/usr                    --sysconfdir=/etc                --localstatedir=/var             --enable-udev-acl                --enable-pam-module              --with-systemdsystemunitdir=no &amp;&amp;
make</userinput>
</screen>
    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explications des commandes</title>
    <para>
      <parameter>--enable-udev-acl</parameter>&nbsp;: Ce paramètre active la construction des outils
      <command>udev-acl</command> qui sont utilisés pour autoriser les utilisateurs
      normaux à accéder aux noeuds de périphérique qui sont normalement accessibles
      seulement pas l'utilisateur
      <systemitem class="username">root</systemitem>.
    </para>
 
    <para><parameter>--enable-pam-module</parameter>&nbsp;: Ce paramètre
    active la construction du module <application>PAM</application> de
    <application>ConsoleKit</application> qui est nécessaire à
    <application>ConsoleKit</application> pour fonctionner correctement
    avec <application>Linux-PAM</application>. Supprimez cette option si
    <application>Linux-PAM</application> N'est
    <emphasis role="strong">PAS</emphasis> installé.</para>
     <para>
      <parameter>--enable-polkit</parameter>: Active le support PolicyKit.
    </para>
     <para>
      <parameter>--with-xinitrc-dir=/etc/X11/app-defaults/xinitrc.d</parameter>:
      Corrige l'emplacemnt du script 90-consolekit.sh. Notez que le script a été renommé, après l'installation
      car xinitrc source les noms de scripts se terminant avec l'extension <emphasis>.sh</emphasis>.
    </para>


     <para>
      <parameter>--with-systemdsystemunitdir=no</parameter>: Désactive la construction avec les bibliothèques
       systemd.
    </para>
    <para><option>--enable-docbook-docs</option>&nbsp;: Utilisez ce paramètre si
    <application>xmlto</application> est installé et si vous souhaitez construire
    la documentation de l'API.</para>
  
  </sect2>
  <sect2 role="configuration">
    <title>Configurer ConsoleKit</title>
    <sect3>
      <title>PAM Module Configuration</title>
     
      <para>Si vous utilisez <application>Linux PAM</application>, il est nécessaire de le configurer
       pour activer <application>ConsoleKit
      </application> lors de la connexion de l'utilisateur. Cela peut être fait en éditant le fichier
      <filename>/etc/pam.d/system-session</filename> en tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;&gt; /etc/pam.d/system-session &lt;&lt; "EOF"
<literal># Begin ConsoleKit addition
session   optional    pam_loginuid.so
session   optional    pam_ck_connector.so nox11
# End ConsoleKit addition</literal>
EOF</userinput>
</screen>
      <para>
        Vous aurez également besoin d'un script d'aide qui crée un fichier dans
        <filename class="directory">/var/run/console</filename>
        appelé avec l'utilisateur actuellement connecté et qui contient
	l'adresse
        <application>D-Bus</application> de la session. Vous pouvez créer le
        script avec les 
	commandes suivantes en tant qu'utilisateur
        <systemitem class="username">root</systemitem>&nbsp;:
      </para>
<screen role="root">
<userinput>cat &gt; /usr/lib/ConsoleKit/run-session.d/pam-foreground-compat.ck &lt;&lt; "EOF"
#!/bin/sh
TAGDIR=/var/run/console
[ -n "$CK_SESSION_USER_UID" ] || exit 1
[ "$CK_SESSION_IS_LOCAL" = "true" ] || exit 0
TAGFILE="$TAGDIR/`getent passwd $CK_SESSION_USER_UID | cut -f 1 -d:`"
if [ "$1" = "session_added" ]; then
    mkdir -p "$TAGDIR"
    echo "$CK_SESSION_ID" &gt;&gt; "$TAGFILE"
fi
if [ "$1" = "session_removed" ] &amp;&amp; [ -e "$TAGFILE" ]; then
    sed -i "%^$CK_SESSION_ID$%d" "$TAGFILE"
    [ -s "$TAGFILE" ] || rm -f "$TAGFILE"
fi
EOF
chmod -v 755 /usr/lib/ConsoleKit/run-session.d/pam-foreground-compat.ck</userinput>
</screen>
      <para>
        Voyer /usr/share/doc/ConsoleKit/spec/ConsoleKit.html pour plus de détails.
      </para>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>
          ck-history, ck-launch-session, ck-list-sessions,
          ck-log-system-restart, ck-log-system-start,
          ck-log-system-stop et console-kit-daemon
        </seg>
        <seg>
          libck-connector.so et pam_ck_connector.so
        </seg>
        <seg>
          /{etc,usr/{include,lib},var/{log,run}}/ConsoleKit et
          /usr/share/doc/ConsoleKit-&consolekit-version;
        </seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="ck-history">
        <term><command>ck-history</command></term>
        <listitem>
          <para>est un utilitaire qui fournit des informations sur la base de données ConsoleKit
                pour savoir qui est logués sur le système.</para>
          <indexterm zone="consolekit ck-history">
            <primary sortas="b-ck-history">ck-history</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="ck-launch-session">
        <term><command>ck-launch-session</command></term>
        <listitem>
          <para>est un utilitaire pour démarrer une commande dans sa propre session ConsoleKit.
          </para>
          <indexterm zone="consolekit ck-launch-session">
            <primary sortas="b-ck-launch-session">ck-launch-session</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="ck-list-sessions">
        <term><command>ck-list-sessions</command></term>
        <listitem>
          <para>liste les sessions avec leurs propriétées respectives.Egalement bien pour le déboguage.</para>
          <indexterm zone="consolekit ck-list-sessions">
            <primary sortas="b-ck-list-sessions">ck-list-sessions</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="ck-log-system-restart">
        <term><command>ck-log-system-restart</command></term>
        <listitem>
          <para>écrit le redémarrage du système dans le log.</para>
          <indexterm zone="consolekit ck-log-system-restart">
            <primary sortas="b-ck-log-system-restart">ck-log-system-restart</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="ck-log-system-start">
        <term><command>ck-log-system-start</command></term>
        <listitem>
          <para>écrit le démarrage du système dans le log.</para>
          <indexterm zone="consolekit ck-log-system-start">
            <primary sortas="b-ck-log-system-start">ck-log-system-start</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="ck-log-system-stop">
        <term><command>ck-log-system-stop</command></term>
        <listitem>
          <para>écrit l'arrêt du système dans le log.</para>
          <indexterm zone="consolekit ck-log-system-stop">
            <primary sortas="b-ck-log-system-stop">ck-log-system-stop</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="console-kit-daemon">
        <term><command>console-kit-daemon</command></term>
        <listitem>
          <para>est le démon <application>ConsoleKit</application>.</para>
          <indexterm zone="consolekit console-kit-daemon">
            <primary sortas="b-console-kit-daemon">console-kit-daemon</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
