<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY consolekit-download-http "&sources-anduin-http;/c/ConsoleKit-&consolekit-version;.tar.xz">
  <!ENTITY consolekit-download-ftp  " ">
  <!ENTITY consolekit-md5sum        "6aaadf5627d2f7587aa116727e2fc1da">
  <!ENTITY consolekit-size          "356 Ko">
  <!ENTITY consolekit-buildsize     "8.0 Mo">
  <!ENTITY consolekit-time          "0.3 SBU">
]>
<sect1 id="consolekit" xreflabel="ConsoleKit-&consolekit-version;">
  <?dbhtml filename="consolekit.html"?>
  <sect1info>
    <othername>$LastChangedBy : randy $</othername>
    <date>$Date : 2013-02-11 19:51:17 +0100 (Mon, 11 Feb 2013) $</date>
  </sect1info>
  <title>ConsoleKit-&consolekit-version;</title>
  <indexterm zone="consolekit">
    <primary sortas="a-ConsoleKit">ConsoleKit</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à ConsoleKit</title>
    <para>Le paquet <application>ConsoleKit</application> est un 
    environnement pour garder une trace des différents utilisateurs, des sessions, 
    et des places présents sur un système. Il offre aux logiciels un mécanisme
    pour réagir aux modifications de ces éléments ou d'une des métadonnées qui 
    y est associée.</para>
   &lfs75_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&consolekit-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&consolekit-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &consolekit-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &consolekit-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &consolekit-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &consolekit-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de ConsoleKit</bridgehead>
    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><xref linkend="acl"/>,
    <xref linkend="dbus-glib"/> et <xref linkend="xorg7-lib"/></para>
    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended"><xref linkend="linux-pam"/>
    and <xref linkend="polkit"/></para>
    <warning>
      <para>Si vous prévoyez de <emphasis role="strong">NE PAS</emphasis> 
      installer <application>polkit</application>, vous devrez éditer le fichier
      ConsoleKit.conf à la main pour déverrouiller le service. Un échec pour faire cela peut
      signifier un énorme TROU DE SÉCURITÉ.</para>
    </warning>
    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="xmlto"/></para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/consolekit"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de ConsoleKit</title>
    <para>Installez <application>ConsoleKit</application> en lançant les commandes
    suivantes&nbsp;:</para>
<screen>
<userinput>./configure --prefix=/usr        \
            --sysconfdir=/etc    \
            --localstatedir=/var \
            --enable-udev-acl    \
            --enable-pam-module  &amp;&amp;
make</userinput>
</screen>
    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explications des commandes</title>
    <para>
      <option>--enable-udev-acl</option>&nbsp;: Ce paramètre active la construction des outils
      <command>udev-acl</command> qui sont utilisés pour autoriser les utilisateurs
      normaux à accéder aux noeuds de périphérique qui sont normalement accessibles
      seulement pas l'utilisateur
      <systemitem class="username">root</systemitem>.
    </para>
 
    <para><parameter>--enable-pam-module</parameter>&nbsp;: Ce paramètre
    active la construction du module <application>PAM</application> de
    <application>ConsoleKit</application> qui est nécessaire à
    <application>ConsoleKit</application> pour fonctionner correctement
    avec <application>Linux-PAM</application>. Supprimez cette option si
    <application>Linux-PAM</application> N'est
    <emphasis role="strong">PAS</emphasis> installé.</para>
    <para><option>--enable-docbook-docs</option>&nbsp;: Utilisez ce paramètre si
    <application>xmlto</application> est installé et si vous souhaitez construire
    la documentation de l'API.</para>
  
    <para><option>--libexecdir=/usr/lib/ConsoleKit</option>: Cette option
    crée un répertoire <filename class="directory">ConsoleKit</filename> dans
    <filename class="directory">/usr/lib</filename> au lieu de placer les exécutables privés du paquet dans  <filename
    class="directory">/usr/libexec</filename> en accord avec l'ancienne version de FHS utilisée
      avant LFS-7.5.</para>
  
  </sect2>
  <sect2 role="configuration">
    <title>Configurer ConsoleKit</title>
    <sect3>
      <title>PAM Module Configuration</title>
     
      <para>Si vous utilisez <application>Linux PAM</application> vous devez configurer
      <application>Linux PAM</application> pour activer <application>ConsoleKit
      </application> lors de la connexion de l'utilisateur. Cela peut être fait en éditant le fichier
      <filename>/etc/pam.d/system-session</filename> en tant qu'utilisateur
      <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;&gt; /etc/pam.d/system-session &lt;&lt; "EOF"
# Begin ConsoleKit addition
session   optional    pam_loginuid.so
session   optional    pam_ck_connector.so nox11
# End ConsoleKit addition
EOF</userinput>
</screen>
      <para>
        Vous aurez également besoin d'un script d'aide qui crée un fichier dans
        <filename class="directory">/var/run/console</filename>
        appelé avec l'utilisateur actuellement connecté et qui contient
	l'adresse
        <application>D-Bus</application> de la session. Vous pouvez créer le
        script avec les 
	commandes suivantes en tant qu'utilisateur
        <systemitem class="username">root</systemitem>&nbsp;:
      </para>
<screen role="root">
<userinput>cat &gt; /usr/lib/ConsoleKit/run-session.d/pam-foreground-compat.ck &lt;&lt; "EOF"
#!/bin/sh
TAGDIR=/var/run/console
[ -n "$CK_SESSION_USER_UID" ] || exit 1
[ "$CK_SESSION_IS_LOCAL" = "true" ] || exit 0
TAGFILE="$TAGDIR/`getent passwd $CK_SESSION_USER_UID | cut -f 1 -d:`"
if [ "$1" = "session_added" ]; then
    mkdir -p "$TAGDIR"
    echo "$CK_SESSION_ID" &gt;&gt; "$TAGFILE"
fi
if [ "$1" = "session_removed" ] &amp;&amp; [ -e "$TAGFILE" ]; then
    sed -i "\%^$CK_SESSION_ID\$%d" "$TAGFILE"
    [ -s "$TAGFILE" ] || rm -f "$TAGFILE"
fi
EOF
chmod -v 755 /usr/lib/ConsoleKit/run-session.d/pam-foreground-compat.ck</userinput>
</screen>
      <para>
        Voyer /usr/share/doc/ConsoleKit/spec/ConsoleKit.html pour plus de détails.
      </para>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>
          ck-history, ck-launch-session, ck-list-sessions,
          ck-log-system-restart, ck-log-system-start,
          ck-log-system-stop et console-kit-daemon
        </seg>
        <seg>
          libck-connector.so et pam_ck_connector.so
        </seg>
        <seg>
          /etc/ConsoleKit,
          /usr/include/ConsoleKit,
          /usr/lib/ConsoleKit,
          /usr/share/doc/ConsoleKit et
          /var/log/ConsoleKit
        </seg>
      </seglistitem>
    </segmentedlist>
  </sect2>
</sect1>
