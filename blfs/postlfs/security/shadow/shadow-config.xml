<sect2>
<title>Configurer <application><acronym>PAM</acronym></application> pour fonctionner avec <application>shadow</application></title>

<sect3><title>Fichiers de configuration</title>
<para><filename>/etc/pam.d/login</filename>,
<filename>/etc/pam.d/passwd</filename>,
<filename>/etc/pam.d/su</filename>,
<filename>/etc/pam.d/shadow</filename>,
<filename>/etc/pam.d/useradd</filename></para>
</sect3>

<sect3><title>Informations de configuration</title>

<para>Ajoutez les fichiers de configuration
<application><acronym>PAM</acronym></application> suivants dans
<filename class="directory">/etc/pam.d</filename> (ou ajoutez-les dans
<filename>/etc/pam.conf</filename> avec le champ additionnel pour le programme).
</para>
<screen><userinput><command>cat &gt; /etc/pam.d/login &lt;&lt; "EOF"</command>
# Début /etc/pam.d/login

auth        requisite      pam_securetty.so
auth        requisite      pam_nologin.so
auth        required       pam_env.so
auth        required       pam_unix.so
account     required       pam_access.so
account     required       pam_unix.so
session     required       pam_motd.so
session     required       pam_limits.so
session     optional       pam_mail.so     dir=/var/mail standard
session     optional       pam_lastlog.so
session     required       pam_unix.so

# Fin /etc/pam.d/login
<command>EOF
cat &gt; /etc/pam.d/passwd &lt;&lt; "EOF"</command>
# Début /etc/pam.d/passwd

password    required       pam_unix.so     md5 shadow 

# Fin /etc/pam.d/passwd
<command>EOF
cat &gt; /etc/pam.d/shadow &lt;&lt; "EOF"</command>
# Début /etc/pam.d/shadow

auth        sufficient      pam_rootok.so
auth        required        pam_unix.so
account     required        pam_unix.so
session     required        pam_unix.so
password    required        pam_permit.so

# Fin /etc/pam.d/shadow
<command>EOF
cat &gt; /etc/pam.d/su &lt;&lt; "EOF"</command>
# Début /etc/pam.d/su

auth        sufficient      pam_rootok.so
auth        required        pam_unix.so
account     required        pam_unix.so
session     required        pam_unix.so

# Fin /etc/pam.d/su
<command>EOF
cat &gt; /etc/pam.d/useradd &lt;&lt; "EOF"</command>
# Début /etc/pam.d/useradd

auth        sufficient      pam_rootok.so
auth        required        pam_unix.so
account     required        pam_unix.so
session     required        pam_unix.so
password    required        pam_permit.so

# Fin /etc/pam.d/useradd
<command>EOF
cat &gt; /etc/pam.d/chage &lt;&lt; "EOF"</command>
# Début /etc/pam.d/chage

auth        sufficient      pam_rootok.so
auth        required        pam_unix.so
account     required        pam_unix.so
session     required        pam_unix.so
password    required        pam_permit.so

# Fin /etc/pam.d/chage
<command>EOF</command></userinput></screen>

<para>Actuellement, <filename>/etc/pam.d/other</filename> est configuré pour
permettre à ceux disposant d'un compte sur la machine d'utiliser les programmes
qui n'ont pas un fichier de configuration spécifique. Après avoir testé
<application><acronym>PAM</acronym></application> pour vérifier que sa
configuration est correcte, il peut être changé par ceci:</para>

<screen><userinput><command>cat &gt; /etc/pam.d/other &lt;&lt; "EOF"</command>
# Begin /etc/pam.d/other

auth        required        pam_deny.so
auth        required        pam_warn.so
account     required        pam_deny.so
session     required        pam_deny.so
password    required        pam_deny.so
password    required        pam_warn.so

# End /etc/pam.d/other
<command>EOF</command></userinput></screen>

<para>Enfin, éditez <filename>/etc/login.defs</filename> en ajoutant '#' au
début des lignes suivantes:</para>
<screen>DIALUPS_CHECK_ENAB
LASTLOG_ENAB
MAIL_CHECK_ENAB
PORTTIME_CHECKS_ENAB
CONSOLE
MOTD_FILE
NOLOGINS_FILE
PASS_MIN_LEN
SU_WHEEL_ONLY
MD5_CRYPT_ENAB
CONSOLE_GROUPS
ENVIRON_FILE</screen>

<para>Ceci fait que <command>login</command> arrête de réaliser ces fonctions,
car elles seront maintenant réalisées par les modules
<application><acronym>PAM</acronym></application>.</para>

</sect3>

</sect2>

