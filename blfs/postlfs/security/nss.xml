<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY nspr-version      "4.6.7">
  <!ENTITY nss-download-http "http://ftp.mozilla.org/pub/mozilla.org/security/nss/releases/NSS_3_11_7_RTM/src/nss-&nss-version;-with-nspr-&nspr-version;.tar.gz">
  <!ENTITY nss-download-ftp  "ftp://ftp.mozilla.org/pub/mozilla.org/security/nss/releases/NSS_3_11_7_RTM/src/nss-&nss-version;-with-nspr-&nspr-version;.tar.gz">
  <!ENTITY nss-md5sum        "0b0c6bdf63c442d68453e470b8747a9d">
  <!ENTITY nss-size          "5.0 Mio">
  <!ENTITY nss-buildsize     "71 Mio">
  <!ENTITY nss-time          "0.8 SBU (additional 0.9 SBU to run the test suite)">
]>

<sect1 id="nss" xreflabel="NSS-&nss-version;">
  <?dbhtml filename="nss.html"?>

  <sect1info>
    <othername>$LastChangedBy: randy $</othername>
    <date>$Date: 2007-07-15 17:53:33 +0200 (dim, 15 jui 2007) $</date>
  </sect1info>

  <title>NSS-&nss-version;</title>

  <indexterm zone="nss">
    <primary sortas="a-NSS">NSS</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à NSS</title>

    <para>Le paquet <foreignphrase>Network Security Services</foreignphrase> (services
    de sécurité réseau) (<application>NSS</application>) est un ensemble de
    bibliothèques conçues pour supporter le développement en plateforme croisée 
    d'applications et de serveurs sécurisés. Les applications construites avec
    NSS peuvent supporter SSL v2 et v3, TLS, les certificats PKCS #5,
    PKCS #7, PKCS #11, PKCS #12, S/MIME, X.509 v3 et d'autres 
    standards de sécurité. C'est utile pour implémenter SSL et S/MIME ou d'autres
    standards de sécurité sur Internet dans une application.</para>

    <para>Le paquet <application>NSS</application> a pour prérequis de 
    construction les bibliothèques <foreignphrase>Netscape
    Portable Runtime</foreignphrase> (d'exécution portables) (NSPR). L'archive
    tar du paquet <application>NSS</application> contient le code nécessaire à la
    construction des bibliothèques NSPR. Ces bibliothèques sont construites et 
    installées en utilisant les instructions ci-dessous. Le paquet
    <application>NSS</application> est essentiellement une installation combinée
    de <application>NSS</application>/NSPR.</para>


    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&nss-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&nss-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &nss-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &nss-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &nss-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &nss-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/nss-&nss-version;-with-nspr-&nspr-version;-fedora_fixes-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/nss"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de NSS</title>

    <para>Installez <application>NSS</application> en lançant les commandes
    suivantes&nbsp;:</para>

<screen><userinput>bash

export WORKINGDIR=$PWD &amp;&amp;
export BUILD_OPT=1 &amp;&amp;

patch -Np1 -i ../nss-&nss-version;-with-nspr-&nspr-version;-fedora_fixes-1.patch &amp;&amp;

cd mozilla/security/nss &amp;&amp;
make nss_build_all &amp;&amp;
cd ../.. &amp;&amp;

export NSS_LINUXDIR=$(basename `ls -d $WORKINGDIR/mozilla/dist/Linux*`)</userinput></screen>

    <para>Pour tester les résultats, vous devrez régler le nom de domaine de 
    votre système dans la variable d'environnement <envar>DOMSUF</envar>. La
    plupart des tests échoueront si vous ne fournissez pas le bon nom de 
    domaine. Un fichier journal auto-généré sera parsé en fin de test pour 
    afficher la façon dont les tests se sont passés. Il devrait retourner 800. 
    Pour lancer les tests, assurez-vous de remplacer la commande 
    <command>export DOMSUF</command> ci-dessous avec la valeur adéquate, 
    par exemple <parameter>mydomain.com</parameter> et lancez les commandes
    suivantes&nbsp;:</para>

<screen><userinput>bash

export DOMSUF=<replaceable>&lt;validdomain.name&gt;</replaceable> &amp;&amp;
export PATH=$PATH:$WORKINGDIR/mozilla/dist/$NSS_LINUXDIR/bin &amp;&amp;
export TEST_RESULTSDIR=$WORKINGDIR/mozilla/tests_results/security &amp;&amp;

cd security/nss/tests &amp;&amp;
sed -i 's/gmake/make/' common/init.sh &amp;&amp;
./all.sh &amp;&amp;

grep Passed $TEST_RESULTSDIR/$(hostname).1/results.html | wc -l &amp;&amp;

exit</userinput></screen>

    <caution>
      <para>Si vous passez en utilisateur <systemitem class="username">root</systemitem>
      par une méthode non issue de l'environnement de l'u!ilisateur non 
      privilégié, assurez-vous que la variable d'environnement
      <envar>NSS_LINUXDIR</envar> de 
      <systemitem class="username">root</systemitem> est bien paramétrée avant
      de lancer les commandes d'installation.</para>
    </caution>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m755 nsprpub/$NSS_LINUXDIR/config/nspr-config \
                 security/nss/cmd/config/nss-config \
    /usr/bin &amp;&amp;
install -v -m755 -d /usr/lib/pkgconfig &amp;&amp;
install -v -m644 nsprpub/lib/pkgconfig/nspr.pc \
                 security/nss/lib/pkgconfig/nss.pc \
    /usr/lib/pkgconfig &amp;&amp;

cd dist &amp;&amp;

install -v -m755 $NSS_LINUXDIR/lib/*.so /usr/lib &amp;&amp;
install -v -m644 $NSS_LINUXDIR/lib/{*.chk,libcrmf.a} /usr/lib &amp;&amp;

install -v -m755 -d /usr/include/{nss,nspr} &amp;&amp;
install -v -m644 {public,private}/nss/* /usr/include/nss &amp;&amp;
cp -v -RL $NSS_LINUXDIR/include/* /usr/include/nspr &amp;&amp;
chmod -v 644 /usr/include/nspr/prvrsion.h</userinput></screen>

    <para>Maintenant, en tant qu'utilisateur non privilégié, quittez le shell 
    <command>bash</command> ouvert au début de l'installation pour restaurer 
    l'environnement dans son état d'origine.</para>

<screen><userinput>exit</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><command>bash</command>&nbsp;: Autant de sells que de variables
    d'environnement sont ouverts lors du processus d'installation. Quitter les 
    shells a pour but de restaurer l'environnement et de revenir au répertoire
    de départ quand l'installation est finie.</para>

    <para><command>export WORKINGDIR=$PWD</command>&nbsp;: Cette variable est
    paramétrée car beaucoup de commandes dépendent de la connaissance du chemin
    complet vers certains répertoires. <envar>WORKINGDIR</envar> établit un
    chemin connu pour que les autres puissent être déterminés de façon relative.</para>

    <para><command>export BUILD_OPT=1</command>&nbsp;: Cette variable est
    réglée pour que la construction se fasse sans symboles de débogage dans les
    binaires et pour que les optimisations du compilateur par défaut soient
    utilisées.</para>

    <para><command>export NSS_LINUXDIR=...</command>&nbsp;: Cette variable est
    réglée pour pouvoir déterminer le nom exact des répertoires spécifiques à 
    l'architecture où sont stoclés les binaires dans l'arborescence des sources.</para>

    <para><command>make nss_build_all</command>&nbsp;: Cette commande construit
    les bibliothèques NSPR et <application>NSS</application> et crée un 
    répertoire <filename class='directory'>dist</filename> qui abrite tous les
    programmes, les bibliothèques et les en-têtes d'interface. Aucun programme cré
    par ce processus n'est installé sur le système en utilisant les instructions
    par défaut. Si un de ces programmes doit être installé, vous pouvez les 
    trouver dans le répertoire
    <filename class='directory'>mozilla/dist/bin</filename> de l'arborescence des
    sources.</para>

    <para><command>export PATH=...</command>&nbsp;: Cette commande règle la 
    variable d'environnement <envar>PATH</envar> pour inclure les exécutables 
    dans l'arborescence des sources vu que certains d'entre eux sont nécessaires
    pour lancer la suite de tests.</para>

    <para><command>sed -i 's/gmake/make/' common/init.sh</command>&nbsp;: Cette
    commande modifie la commande utilisée pour compiler des programmes de test.</para>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>nspr-config et nss-config</seg>
        <seg>libcrmf.a, libfreebl3.so, libnspr4.so, libnss3.so, libnssckbi.so,
        libplc4.so, libplds4.so, libsmime3.so, libsoftokn3.so et
        libssl3.so</seg>
        <seg>/usr/include/nspr et /usr/include/nss</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="nspr-config">
        <term><command>nspr-config</command></term>
        <listitem>
          <para>est utilisé pour déterminer les paramètres d'installation NSPR 
          des bibliothèques  NSPR installées.</para>
          <indexterm zone="nss nspr-config">
            <primary sortas="b-nspr-config">nspr-config</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="nss-config">
        <term><command>nss-config</command></term>
        <listitem>
          <para>est utilisé pour déterminer les paramètres de la bibliothèque
          NSS et des bibliothèques NSS installées.</para>
          <indexterm zone="nss nss-config">
            <primary sortas="b-nss-config">nss-config</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>

      <para>Les bibliothèques <filename class='libraryfile'>libnspr4.so</filename>,
      <filename class='libraryfile'>libplc4.so</filename> et
      <filename class='libraryfile'>libplds4.so</filename> libraries make up the
      Netscape Portable Runtime (NSPR). Ces bibliothèques offrent une API neutre
      côté plateforme au niveau szstème et des fonctions de type libc. L'API est
      utilisée dans le client Mozilla, dans la plupart des offres
      Netscape/AOL/iPlanet et dans d'autres logiciels.</para>

      <para>Les bibliothèques <filename class='libraryfile'>libcrmf.a</filename>,
      <filename class='libraryfile'>libfreebl.so</filename>,
      <filename class='libraryfile'>libnss3.so</filename>,
      <filename class='libraryfile'>libnssckbi.so</filename>,
      <filename class='libraryfile'>libsmime3.so</filename>,
      <filename class='libraryfile'>libsoftokn3.so</filename> et
      <filename class='libraryfile'>libnssl3.so</filename> activent les
      bibliothèques <application>NSS</application>.</para>

  </sect2>

</sect1>
