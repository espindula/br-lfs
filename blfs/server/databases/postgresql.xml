<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN"
   "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY postgresql-download-http "http://gd.tuwien.ac.at/db/postgresql/source/v&postgresql-version;/postgresql-&postgresql-version;.tar.bz2">
  <!ENTITY postgresql-download-ftp  "ftp://ftp.fr.postgresql.org/source/v&postgresql-version;/postgresql-&postgresql-version;.tar.bz2">
  <!ENTITY postgresql-md5sum        "f0ea2b372a7bdaf2613e92176ebf5e0f">
  <!ENTITY postgresql-size          "10.2 MB">
  <!ENTITY postgresql-buildsize     "236 MB">
  <!ENTITY postgresql-time          "1.21 SBU">
]>

<sect1 id="postgresql" xreflabel="PostgreSQL-&postgresql-version;">
<sect1info>
<othername>$LastChangedBy: randy $</othername>
<date>$Date: 2008-11-16 21:28:02 $</date>
</sect1info>
<?dbhtml filename="postgresql.html"?>
<title>Postgre<acronym>SQL</acronym>-&postgresql-version;</title>

<sect2>
<title>Introduction à <application>Postgre<acronym>SQL</acronym></application>
</title>

<para><application>Postgre<acronym>SQL</acronym></application> est un système
de gestion de bases de données relationnels objets (<acronym>ORDBMS</acronym>),
dérivé du système de gestion de bases de données Postgres de Berkeley.</para>

<sect3><title>Informations sur le paquetage</title>
<itemizedlist spacing='compact'>
<listitem><para>Téléchargement (HTTP)&nbsp;: 
<ulink url="&postgresql-download-http;"/></para></listitem>
<listitem><para>Téléchargement (FTP)&nbsp;: 
<ulink url="&postgresql-download-ftp;"/></para></listitem>
<listitem><para>Téléchargement de la somme MD5&nbsp;: &postgresql-md5sum;</para></listitem>
<listitem><para>Taille du téléchargement&nbsp;:&postgresql-size;</para></listitem>
<listitem><para>Estimation de l'espace disque requis&nbsp;: 
&postgresql-buildsize;</para></listitem>
<listitem><para>Estimation du temps de construction&nbsp;: 
&postgresql-time;</para></listitem></itemizedlist>
</sect3>

<sect3><title>Téléchargements supplémentaires</title>
<itemizedlist spacing='compact'>
<listitem><para>Correctif requis&nbsp;: <ulink 
url="&patch-root;/postgresql-&postgresql-version;-dsssl_fix-1.patch"/></para>
</listitem></itemizedlist>
</sect3>

<sect3><title><application>Postgre<acronym>SQL</acronym></application> 
dependencies</title>
<sect4><title>Optionnel</title>
<para><xref linkend="python"/>, 
<xref linkend="tcl"/>,
<xref linkend="tk"/>,
<xref linkend="openssl"/>,
<xref linkend="Linux_PAM"/>,
<xref linkend="sgml-dtd-3"/>, 
<xref linkend="docbook-dsssl"/>,
<xref linkend="openjade"/>,
<xref linkend="perl-modules"/>: SGMLSpm-&SGMLSpm-version;, 
<ulink url="http://www.pdc.kth.se/kth-krb/">krb4</ulink>,
<xref linkend="mitkrb"/> ou <xref linkend="heimdal"/>,
<xref linkend="apache-ant"/> et
<ulink url="http://rendezvous.sourceforge.net/">Rendezvous</ulink></para>
</sect4>
</sect3>

</sect2>

<sect2>
<title>Installation de <application>Postgre<acronym>SQL</acronym></application>
</title>

<para>Pour que <command>configure</command> découvre correctement
<application>Docbook <acronym>SGML</acronym> 
<acronym>DTD</acronym></application> (v3.1), vous pourriez avoir besoin de
supprimer les définitions de catalogues d'<application>OpenSP</application>
depuis les catalogues <acronym>SGML</acronym>. Utilisez la commande suivante
avant de construire le paquetage pour accomplir ceci&nbsp;:</para>

<screen><userinput><command>sed -i.orig \
    -e "/CATALOG \/etc\/sgml\/OpenSP-1.5.1.cat/d" \
    /etc/sgml/catalog \
    /etc/sgml/sgml-docbook.cat</command></userinput></screen>

<para>Installez <application>Postgre<acronym>SQL</acronym></application> avec
les commandes suivantes&nbsp;:</para>

<screen><userinput><command>patch -Np1 -i ../postgresql-&postgresql-version;-dsssl_fix-1.patch &amp;&amp;
./configure --prefix=/usr --enable-thread-safety &amp;&amp;
make &amp;&amp;
make install &amp;&amp;
chown -R root:root /usr/share/doc/postgresql/html</command></userinput></screen>

<para>L'installation standard fournit seulement les fichiers d'en-tête
nécessaires au développement d'applications clientes. Les applications
côté serveur requièrent la hiérarchie complète des fichiers includes de
<application>Postgre<acronym>SQL</acronym></application>, hiérarchie
pouvant être installée en utilisant la commande suivante&nbsp;:</para>

<screen><userinput><command>make install-all-headers</command></userinput></screen>

<note><para>Si vous mettez à jour un système existant et que vous allez
installer les nouveaux fichiers sur les anciens, alors vous devriez mettre
à jour vos données, arrêter l'ancien serveur et suivre les instructions
sur <ulink
url="http://www.postgresql.org/docs/7.4/static/install-upgrading.html">la
documentation officielle de
<application>Postgre<acronym>SQL</acronym></application></ulink>.</para></note>

<para>Initialisez un groupe de bases de données avec les commandes
suivantes&nbsp;:</para>

<screen><userinput><command>mkdir -p /srv/pgsql/data &amp;&amp;
useradd -d /srv/pgsql/data postgres &amp;&amp;
chown postgres /srv/pgsql/data &amp;&amp;
su - postgres -c '/usr/bin/initdb -D /srv/pgsql/data'</command></userinput></screen>

<para>Lancez le serveur de bases de données avec la commande suivante&nbsp;:</para>

<screen><userinput><command>su - postgres -c '/usr/bin/postmaster -D /srv/pgsql/data > \
    /srv/pgsql/data/logfile 2&gt;&amp;1 &amp;'</command></userinput></screen>

<para>Créez une base de données et vérifiez l'installation&nbsp;:</para>

<screen><userinput><command>su - postgres -c '/usr/bin/createdb test' &amp;&amp;
echo "create table t1 ( name varchar(20), state_province varchar(20) );" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Billy', 'NewYork');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Evanidus', 'Quebec');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "insert into t1 values ('Jesse', 'Ontario');" \
    | (su - postgres -c '/usr/bin/psql test ') &amp;&amp;
echo "select * from t1;" | (su - postgres -c '/usr/bin/psql test')</command></userinput></screen>

</sect2>

<sect2>
<title>Explications des commandes</title>

<para><parameter>--enable-thread-safety</parameter>&nbsp;: cette option assure
la compatibilité des bibliothèques clientes avec les threads en autorisant les
threads concurrents dans les programmes <filename
class='libraryfile'>libpq</filename> et <acronym>ECPG</acronym> pour contrôler
de façon propre leur connexions privées.</para>

<para><command>chown -R root:root /usr/share/doc/postgresql/html</command>&nbsp;: 
cette commande corrige le propriétaire des quelques fichiers de la documentation.
</para>

<para><command>useradd -d /srv/pgsql/data postgres</command>&nbsp;: ajoute un
utilisateur non privilégié pour exécuter le serveur de bases de données.</para>

<para><command>createdb test, create table t1 , insert into t1 values..., 
select * from t1</command>&nbsp;: crée une base de données, lui ajoute une
table, insère quelques lignes dans la table et les sélectionne pour vérifier
que l'installation fonctionne correctement.</para>

</sect2>

<sect2>
<title>Configurer <application>Postgre<acronym>SQL</acronym></application>
</title>

<sect3>
<title>Fichiers de configuration</title>

<para><filename>$PGDATA/pg_ident.con</filename>, 
<filename>$PGDATA/pg_hba.conf</filename> et
<filename>$PGDATA/postgresql.conf</filename></para>

<para>La variable d'environnement <envar>PGDATA</envar> est utilisé pour
distinguer les groupes de bases de données en la configurant à la valeur
du répertoire contenant le groupe désiré. Les trois fichiers de
configuration existent dans chaque répertoire <filename
class="directory">PGDATA/</filename>. Les détails sur le format des fichiers
et sur les options pouvant être configurées sont disponibles dans <ulink
url="file:///usr/share/doc/postgresql/html/index.html"/>.</para>

<para>Installez le script de démarrage <filename>/etc/rc.d/init.d/postgresql</filename>
inclus dans le paquetage <xref linkend="intro-important-bootscripts"/>.</para>

<screen><userinput><command>make install-postgresql</command></userinput></screen>

</sect3>

</sect2>

<sect2>
<title>Contenu</title>

<para>Le paquetage <application>Postgre<acronym>SQL</acronym></application>
contient <command>clusterdb</command>,
<command>createdb</command>,
<command>createlang</command>,
<command>createuser</command>,
<command>dropdb</command>,
<command>droplang</command>,
<command>dropuser</command>,
<command>ecpg</command>,
<command>initdb</command>,
<command>initlocation</command>,
<command>ipcclean</command>,
<command>pg_config</command>,
<command>pg_controldata</command>,
<command>pg_ctl</command>,
<command>pg_dump</command>,
<command>pg_dumpall</command>,
<command>pg_encoding</command>,
<command>pg_id</command>,
<command>pg_resetxlog</command>,
<command>pg_restore</command>,
<command>pgtclsh</command>,
<command>pgtksh</command>,
<command>pltcl_delmod</command>,
<command>pltcl_listmod</command>,
<command>pltcl_loadmod</command>,
<command>postgres</command>,
<command>postmaster</command>,
<command>psql</command>,
<command>vacuumdb</command>,
<filename class="libraryfile">libecpg</filename>,
<filename class="libraryfile">libpgtcl</filename>,
<filename class="libraryfile">libpgtypes</filename>,
<filename class="libraryfile">libpq</filename> et différents modules d'ensembles
de caractères.</para>

</sect2>

<sect2><title>Description</title>

<sect3><title>clusterdb</title>
<para><command>clusterdb</command> est un outil pour grouper des tables dans une
base de données <application>Postgre<acronym>SQL</acronym></application>.
</para></sect3>

<sect3><title>createdb</title>
<para><command>createdb</command> crée une nouvelle base de données
<application>Postgre<acronym>SQL</acronym></application>.</para>
</sect3>

<sect3><title>createlang</title>
<para><command>createlang</command> définit un nouveau langage de
procédures <application>Postgre<acronym>SQL</acronym></application>.
</para></sect3>

<sect3><title>createuser</title>
<para><command>createuser</command> définit un nouveau compte utilisateur
<application>Postgre<acronym>SQL</acronym></application>.</para>
</sect3>

<sect3><title>dropdb</title>
<para><command>dropdb</command> supprime une base de données
<application>Postgre<acronym>SQL</acronym></application>.</para>
</sect3>

<sect3><title>droplang</title>
<para><command>droplang</command> supprime un langage de procédures
<application>Postgre<acronym>SQL</acronym></application>.</para></sect3>

<sect3><title>dropuser</title>
<para><command>dropuser</command> supprime un compte utilisateur
<application>Postgre<acronym>SQL</acronym></application>.</para>
</sect3>

<sect3><title>ecpg</title>
<para><command>ecpg</command> est le préprocesseur embarqué
<acronym>SQL</acronym>.</para></sect3>

<sect3><title>initdb</title>
<para><command>initdb</command> crée un nouveau groupe de bases de données.
</para></sect3>

<sect3><title>initlocation</title>
<para><command>initlocation</command> crée une seconde aire de stockage.
</para></sect3>

<sect3><title>ipcclean</title>
<para><command>ipcclean</command> supprime la mémoire partagée et les sémaphores
laissées par un serveur de bases de données arrêté.</para></sect3>

<sect3><title>pg_config</title>
<para><command>pg_config</command> récupère les informations de version
de <application>Postgre<acronym>SQL</acronym></application>.</para></sect3>

<sect3><title>pg_controldata</title>
<para><command>pg_controldata</command> renvoit des informations initialisées
durant <command>initdb</command>, comme la version du catalogue et la locale du
serveur.</para></sect3> 

<sect3><title>pg_ctl</title>
<para><command>pg_ctl</command> contrôle l'arrêt et le démarrage du serveur de
bases de données.</para></sect3>

<sect3><title>pg_dump</title>
<para><command>pg_dump</command> sauvegarde les données et les métadonnées d'une
base dans des scripts utilisés pour recréer la base de données.</para></sect3>

<sect3><title>pg_dumpall</title>
<para><command>pg_dumpall</command> appelle de façon récursive
<command>pg_dump</command> pour chaque base de données d'un groupe.</para></sect3>

<sect3><title>pg_resetxlog</title>
<para><command>pg_resetxlog</command> efface les WAL et réinitialise en option
quelques champs dans le fichier <filename>pg_control</filename>.</para></sect3>

<sect3><title>pg_restore</title>
<para><command>pg_restore</command> crée des bases de données à partir de
fichiers de sauvegardé créés par <command>pg_dump</command>.</para></sect3>

<sect3><title>pgtclsh</title>
<para><command>pgtclsh</command> est une interface shell <application>Tcl</application>
étendue avec les fonctions d'accès aux bases de données
<application>Postgre<acronym>SQL</acronym></application>.</para></sect3>

<sect3><title>pgtksh</title>
<para><command>pgtksh</command> est une interface shell
<application>Tcl</application>/<application>Tk</application> étendue avec les
fonctions d'accès aux bases de données
<application>Postgre<acronym>SQL</acronym></application>.</para></sect3>

<sect3><title>postgres</title>
<para><command>postgres</command> est un serveur de bases de données en simple
utilisateur, généralement utilisé pour du débogage.</para></sect3>

<sect3><title>postmaster</title>
<para><command>postmaster</command> est le démon de bases de données
multiutilisateur.</para>
</sect3>

<sect3><title>psql</title>
<para><command>psql</command> est un shell de bases de données basé sur la
console.</para></sect3>

<sect3><title>vacuumdb</title>
<para><command>vacuumdb</command> compacte les bases de données et génère des
statistiques pour l'analyseur de requêtes.</para></sect3>

</sect2>

</sect1>
