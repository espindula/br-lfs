<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY mysql-download-http "&sources-anduin-http;/m/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-download-ftp  "&sources-anduin-ftp;/m/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-md5sum        "dcb6a06e68c5e8f30f57b15300730c9c">
  <!ENTITY mysql-size          "23 Mio">
  <!ENTITY mysql-buildsize     "883 Mio (ajouter 200 Mio pour exécuter la suite de tests)">
  <!ENTITY mysql-time          "3.9 SBU (La suite de tests ajoute 55 minutes qui dépendent seulement partiellement CPU)">
 
]>

<sect1 id="mysql" xreflabel="MySQL-&mysql-version;">
  <?dbhtml filename="mysql.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: rthomsen $</othername>
    <date>$Date&nbsp;: 2012-03-25 15:22:56 +0200 (Sun, 25 Mar 2012) $</date>
  </sect1info>

  <title>MySQL-&mysql-version;</title>

  <indexterm zone="mysql">
    <primary sortas="a-MySQL">MySQL</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à MySQL</title>

    <para><application>MySQL</application> est un serveur de base de données rapide et
    largement utilisé. C'est une implémentation client/serveur consistant dans 
    un démon serveur et de nombreux programmes et bibliothèques différents.</para>

    <para>Il se peut qu'il existe une version plus récente disponible sur
    la page d'accueil de <application>MySQL</application>. Vous pouvez regarder
    <ulink url="http://dev.mysql.com/"/> et probablement utiliser les instructions
    BLFS existantes. Remarquez que des versions différentes de celle indiquée
    aux adresses de téléchargement n'ont pas été testées dans un environnement
    BLFS.</para>

    &lfs70_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&mysql-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&mysql-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &mysql-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &mysql-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &mysql-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &mysql-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif facultatif&nbsp;: <ulink
	url="&patch-root;/mysql-&mysql-version;-embedded-library-shared-1.patch"/></para>
      </listitem>
      <listitem>
        <para>Documentation optionelle (voir l'astuce ci-dessous):
          <ulink url="http://dev.mysql.com/doc/"/>
        </para>      
		</listitem>
    </itemizedlist>

    <note><para>Le correctif est requis seulement si vous planifiez d'installer <application>
    Amarok</application>.</para></note>
 
    <bridgehead renderas="sect3">Dépendances de MySQL</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="optional"><xref linkend="cmake"/></para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="optional"><xref linkend="openssl"/></para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
  
    <para role="optional"><xref linkend="tcpwrappers"/> et
    <ulink url="http://packages.debian.org/squeeze/libaio-dev">libaio</ulink></para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/mysql"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de MySQL</title>

    <para>Pour des raisons de sécurité, vous êtes fortement encouragé à exécuter
    le serveur en tant qu'utilisateur et groupe non privilégiés&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 40 mysql &amp;&amp;
useradd -c "MySQL Server" -d /dev/null -g mysql -s /bin/false -u 40 mysql</userinput></screen>
    <note><para>Il y a énormément d'options disponibles pour
    <userinput>ckake</userinput>.  Regardez la sortie de 
    `<userinput>cmake . -LH</userinput>` pour des options ce personnalisation
    supplémentaires. Voir la <ulink
    url="http://dev.mysql.com/doc/refman/5.5/en/source-configuration-options.html">MySQL
    Documentation</ulink> pour une liste complète des options.</para></note>

 <note><para>Si vous prévoyez d'installer <application>Amarok</application>, vous devez appliquer le correctif
 facultatif, ajoutez l'option cmake
 <userinput>-DWITH_EMBEDDED_SERVER=ON</userinput> et ajoutez
 <userinput>Embedded</userinput> dans la variable <userinput>SEGMENTS</userinput> ci-dessous.</para></note>

    <para>Appliquez le correctif facultatif:</para>

<screen><userinput>patch -Np1 -i ../mysql-&mysql-version;-embedded-library-shared-1.patch</userinput></screen>


    <para>Construisez et installez <application>MySQL</application> en
    lançant les commandes suivantes&nbsp;:</para>

<screen><userinput>cmake .                                     \
   -DSYSCONFDIR=/etc                           \
   -DMYSQL_DATADIR=/srv/mysql                  \
   -DINSTALL_MYSQLDATADIR=/srv/mysql           \
   -DCMAKE_INSTALL_PREFIX=/usr                 \
   -DINSTALL_BINDIR=bin                        \
   -DINSTALL_SBINDIR=sbin                      \
   -DINSTALL_DOCDIR=share/doc/mysql            \
   -DINSTALL_DOCREADMEDIR=share/doc/mysql      \
   -DINSTALL_INCLUDEDIR=include/mysql          \
   -DINSTALL_INFODIR=share/info                \
   -DINSTALL_LIBDIR=lib                        \
   -DINSTALL_MANDIR=share/man                  \
   -DINSTALL_MYSQLSHAREDIR=share/mysql         \
   -DINSTALL_MYSQLTESTDIR=share/mysql-test     \
   -DINSTALL_PLUGINDIR=lib/plugin              \
   -DINSTALL_SCRIPTDIR=bin                     \
   -DINSTALL_SHAREDIR=share/mysql              \
   -DINSTALL_SQLBENCHDIR=share/mysql-bench     \
   -DINSTALL_SUPPORTFILESDIR=share/mysql/support-files \
   -DWITH_ZLIB=system                          \
   -DWITH_SSL=system                           \
   -DWITH_READLINE=system                      \
   -DMYSQL_UNIX_ADDR=/var/run/mysql/mysql.sock \
   -DWITH_ARCHIVE_STORAGE_ENGINE=1             \
   -DWITH_FEDERATED_STORAGE_ENGINE=1           \
   -DWITH_BLACKHOLE_STORAGE_ENGINE=1           \
   -DMYSQL_MAINTAINER_MODE=OFF                 \
   -DWITH_DEBUG=OFF                            &amp;&amp;
make</userinput></screen>

    <para>Pour tester les résultats, lancez&nbsp;: <command>make test-force 2>&amp;1 | tee
	test.log</command>.Cela force le test à lancer au départ le log de toutes les sorties de tests.
	Il y a beaucoup de tests qui ne sont pas lancés a cause des options de configuraton et de 
	considérations des programmeurs. Remarquez que si vous utilisez TCP Wreappers et avez un 
	<filename>/etc/hosts.deny</filename> restreint, vous devrez ajouter une entrée adéquate au fichier
    <filename>/etc/hosts.allow</filename> pour le démon <command>mysqld</command>. 
	Sans cela, beaucoup de tests échoueront.</para>

    <note><para>Il se peut que les tests ssl échouent à cause de certificts
    expirés.</para></note>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>SEGMENTS="Client Server IniFiles ManPages SharedLibraries"
SEGMENTS="$SEGMENTS Development Documentation Info Readme"

for segment in $SEGMENTS; do
   cmake -DCMAKE_INSTALL_COMPONENT=$segment -P cmake_install.cmake
done

unset SEGMENTS</userinput></screen>

    <tip>
      <para>La seule documentation incluse dans l'archive tar des sources est
      dans des fichiers <filename>mysql.info</filename> et dans les man pages.
	  Vous pouvez télécharger différents formats du manuel de référence de 
	  <application>MySQL</application> sur <ulink url="http://dev.mysql.com/doc/"/>.
	  </para>
    </tip>

    <note><para>Si vous ne voulez construire ou installer que le client
      <command>mysql</command>, utilisezqnbsp;:</para>

      <screen><userinput>cmake . &amp;&amp;
make mysqlclient libmysql</userinput></screen>

      <para>Poursuivez, en tant que root&nbsp;:</para>

      <screen role="root"><userinput>make install</userinput></screen>
    </note>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><command>cmake -DCMAKE_INSTALL_COMPONENT=$segment ...</command>&nbsp;:
    Cette commande installe le bon morceau du paquet. On peut ajouter ou supprimer
    des segemnts différents en fonction de ce qu'on veut. Les segments valides
    sont listés avec `<command>make list_install_components</command>`. 
    Remarquez que le segment d'installation 'DataFiles' n'honore pas les
    déclarations -DMYSQL_DATADIR ou
    -DINSTALL_MYSQLDATADIR.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de MySQL</title>

    <sect3 id="mysql-config">
      <title>Fichiers de configuration</title>

      <para><filename>/etc/my.cnf</filename> et
      <filename>~/.my.cnf</filename></para>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-AA.my.cnf">~/.my.cnf</primary>
      </indexterm>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-etc-my.cnf">/etc/my.cnf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Vous pouvez utiliser plusieurs fichiers de configuration sont 
      disponibles dans <filename class="directory">/usr/share/mysql</filename>.
      Créez <filename>/etc/my.cnf</filename> en utilisant la commande suivante
      en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m644 /usr/share/mysql/support-files/my-medium.cnf /etc/my.cnf</userinput></screen>

      <para>Vous pouvez maintenant installer une base de données et modifier 
      l'appartenance en faveur de l'utilisateur et du groupe non privilégiés 
      (effectuez en tant qu'utilisateur <systemitem
      class="username">root</systemitem> user)&nbsp;:</para>

<screen role="root"><userinput>mysql_install_db --basedir=/usr --datadir=/srv/mysql --user=mysql &amp;&amp;
chgrp -v mysql /srv/mysql{,/test,/mysql}</userinput></screen>

      <para>La configuration supplémentaire exige que le serveur
      <application>MySQL</application> soit en fonction. Démarrez le serveur en
      utilisant les commandes suivantes en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m755 -o mysql -g mysql -d /var/run/mysql &amp;&amp;
mysqld_safe --user=mysql 2&gt;&amp;1 &gt;/dev/null &amp;</userinput></screen>

      <para>Une installation par défakt n'initialise pas de mot de passe pour
      l'administrateur, utilisez donc la commande suivante en tant qu'utilisateur 
      <systemitem class="username">root</systemitem> pour en régler un. Remplacez
      <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable> par le
      vôtre.</para>

<screen role="root"><userinput>mysqladmin -u root password <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable></userinput></screen>

      <para>La configuration du serveur est maintenant terminée. Éteignez le
      serveur en utilisant la commande suivante en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>mysqladmin -p shutdown</userinput></screen>

    </sect3>

    <sect3  id="mysql-init">
      <title>Script de démarrage</title>

      <para>Installez le script de démarrage <filename>/etc/rc.d/init.d/mysql</filename> 
      inclu dans le paquet <xref linkend="bootscripts"/> en tant qu'utilisateur
      <systemitem class="username">root</systemitem> pour démarrer le serveur
      <application>MySQL</application> au moment du démarrage du système.</para>

      <indexterm zone="mysql mysql-init">
        <primary sortas="f-mysql">mysql</primary>
      </indexterm>

<screen role="root"><userinput>make install-mysql</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>comp_err, innochecksum, msql2mysql, my_print_defaults,
        myisam_ftdump, myisamchk, myisamlog, myisampack, mysql,
        mysql_client_test, mysql_config, mysql_convert_table_format,
        mysql_create_system_tables, mysql_explain_log, mysql_find_rows,
        mysql_fix_extensions, mysql_fix_privilege_tables, mysql_install_db,
        mysql_secure_installation, mysql_setpermission, mysql_tableinfo,
        mysql_tzinfo_to_sql, mysql_waitpid, mysql_zap, mysqlaccess, mysqladmin,
        mysqlbinlog, mysqlbug, mysqlcheck, mysqld, mysqld_multi, mysqld_safe,
        mysqldump, mysqldumpslow, mysqlhotcopy, mysqlimport, mysqlmanager,
        mysqlshow, mysqltest, mysqltestmanager, mysqltestmanager-pwgen,
        mysqltestmanagerc, perror, replace, resolve_stack_dump, et
        resolveip</seg>
        <seg>libdbug.a, libheap.a, libmyisam.a, libmyisammrg.a,
        libmysqlclient.{so,a}, libmysqlclient_r.{so,a}, libmystrings.a,
        libmysys.a, et libvio.a</seg>
        <seg>/srv/mysql, /usr/include/mysql, /usr/lib/plugin, /usr/share/mysql, et
        /var/run/mysql</seg>
      </seglistitem>
    </segmentedlist>

    <bridgehead renderas="sect3">Descriptions courtes</bridgehead>

    <para>Des descriptions de tous les programmes et de toutes les bibliothèques
     prendraient plusieurs pages. Consultez plutôt la documentation de
     <filename>mysql.info</filename> ou le manuel de référence en ligne sur <ulink
    url="http://dev.mysql.com/doc/refman/5.1/en/index.html"/>.</para>

    <para>Les modules DBI de <application>Perl</application> doivent être
    installés pour avoir des programmes de support de <application>MySQL</application> 
    pour fonctionner correctement.</para>

  </sect2>

</sect1>
