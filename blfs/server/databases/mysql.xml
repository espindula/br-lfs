<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!-- <!ENTITY mysql-download-http "http://mysql.mirrors.hoobly.com/Downloads/MySQL-5.0/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-download-ftp  "ftp://ftp.fu-berlin.de/unix/databases/mysql/Downloads/MySQL-5.0/mysql-&mysql-version;.tar.gz"> -->
  <!ENTITY mysql-download-http "&sources-anduin-http;/m/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-download-ftp  "&sources-anduin-ftp;/m/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-md5sum        "43c11ad3dded693393c4815d24e2b0a5">
  <!ENTITY mysql-size          "23.8 Mio">
  <!ENTITY mysql-buildsize     "500 MB (ajouter 200 MB pour exécuter la suite de tests)">
  <!ENTITY mysql-time          "5.3 SBU (La suite de tests ajoute 55 minutes qui dépendent seulement partiellement CPU)">
 
]>

<sect1 id="mysql" xreflabel="MySQL-&mysql-version;">
  <?dbhtml filename="mysql.html"?>

  <sect1info>
    <othername>$LastChangedBy: randy $</othername>
    <date>$Date: 2010-11-13 02:06:55 +0100 (sam 13 nov 2010) $</date>
  </sect1info>

  <title>MySQL-&mysql-version;</title>

  <indexterm zone="mysql">
    <primary sortas="a-MySQL">MySQL</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à MySQL</title>

    <para><application>MySQL</application> est un serveur de base de données rapide et
    largement utilisé. C'est une implémentation client/serveur consistant dans 
    un démon serveur et de nombreux programmes et bibliothèques différents.</para>

    <para>Il se peut qu'il existe une version plus récente disponible sur
    la page d'accueil de <application>MySQL</application>. Vous pouvez regarder
    <ulink url="http://dev.mysql.com/"/> et probablement utiliser les instructions
    BLFS existantes. Remarquez que des versions différentes de celle indiquée
    aux adresses de téléchargement n'ont pas été testées dans un environnement
    BLFS.</para>

    <para>&lfssvn_checked;20101029&lfssvn_checked2;</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&mysql-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&mysql-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &mysql-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &mysql-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &mysql-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &mysql-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif requis:
          <ulink url="&patch-root;/mysql-&mysql-version;-makefile-1.patch"/>
        </para>
       </listitem>
      <listitem>
        <para>Documentation optionelle (voir l'astuce ci-dessous):
          <ulink url="http://dev.mysql.com/doc/"/>
        </para>      
		</listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de MySQL</bridgehead>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="optional"><xref linkend="openssl"/></para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
  
    <!-- Removing libedit because it causes more problems than it solves.

    <ulink url="http://sourceforge.net/projects/libedit/">libedit</ulink>
    (as an alternative to readline)-->

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/mysql"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de MySQL</title>

    <para>Pour des raisons de sécurité, vous êtes fortement encouragé à exécuter
    le serveur en tant qu'utilisateur et groupe non privilégiés&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 40 mysql &amp;&amp;
useradd -c "MySQL Server" -d /dev/null -g mysql -s /bin/false \
        -u 40 mysql</userinput></screen>

    <note><para>Il y a énormément d'options disponibles pour
    <userinput>./configure</userinput>.  Regardez la sortie de 
    <option>--help</option> option pour des options ce personnalisation
    supplémentaires.</para></note>

    <para>Construisez et installez <application>MySQL</application> en
    lançant les commandes suivantes&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../mysql-&mysql-version;-makefile-1.patch &amp;&amp;
CFLAGS="-O3" \
CXX=gcc \
CXXFLAGS="-O3 -felide-constructors -fno-exceptions -fno-rtti" \
./configure --prefix=/usr \
            --sysconfdir=/etc \
            --libexecdir=/usr/sbin \
            --localstatedir=/srv/mysql \
            --enable-thread-safe-client \
            --enable-assembler \
            --enable-local-infile \
            --with-unix-socket-path=/var/run/mysql/mysql.sock \
            --without-debug \
            --without-readline \
            --with-plugins=innobase,myisam \
            --with-extra-charsets=all \
            --with-ssl=/ &amp;&amp;
make</userinput></screen>

    <para>Pour tester les résultats, lancez&nbsp;: <command>make test-force 2>&amp;1 | tee
	test.log</command>.Cela force le test à lancer au départ le log de toutes les sorties de tests.
	Il y a beaucoup de tests qui ne sont pas lancés a cause des options de configuraton et de 
	considérations des programmeurs. Remarquez que si vous utilisez TCP Wreappers et avez un 
	<filename>/etc/hosts.deny</filename> restreint, vous devrez ajouter une entrée adéquate au fichier
    <filename>/etc/hosts.allow</filename> pour le démon <command>mysqld</command>. 
	Sans cela, beaucoup de tests échoueront.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make benchdir_root=/tmp \
          testroot=/tmp install &amp;&amp;
rm -rf /tmp/mysql-test /tmp/sql-bench &amp;&amp;
pushd /usr/lib &amp;&amp;
ln -v -sf mysql/libmysqlclient{,_r}.so* . &amp;&amp;
popd &amp;&amp;

pushd /usr/share/info &amp;&amp;
rm -v dir &amp;&amp;
for FILENAME in *; do
    install-info $FILENAME dir 2>/dev/null
done &amp;&amp;
popd</userinput></screen>

    <tip>
      <para>La seule documentation incluse dans l'archive tar des sources est
      dans des fichiers <filename>mysql.info</filename> et dans les man pages.
	  Vous pouvez télécharger différents formats du manuel de référence de 
	  <application>MySQL</application> sur <ulink url="http://dev.mysql.com/doc/"/>.
	  </para>
    </tip>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><parameter>CFLAGS="-O3" CXX=gcc CXXFLAGS="-O3 -felide-constructors 
    -fno-exceptions -fno-rtti"</parameter>>:nbsp;: Ces optimisations sont recommendées
    par les programmeurs.</para>

    <para><parameter>--libexecdir=/usr/sbin</parameter>&nbsp;: Ce paramètre
    installe le démon <command>mysqld</command> et le programme
    <command>mysqlmanager</command> à un endroit approprié.</para>

    <para><parameter>--localstatedir=/srv/mysql</parameter>&nbsp;: Ce paramètre
    oblige <application>MySQL</application> à utiliser 
    <filename class='directory'>/srv/mysql</filename> pour les fichiers de base
    de données et d'autres données de variable.</para>

    <para><parameter>--enable-thread-safe-client</parameter>&nbsp;: Ce paramètre
    compile une bibliothèque client <application>MySQL</application> 
    en enfilade de manière sécurisée.</para>

    <para><parameter>--enable-assembler</parameter>&nbsp;: Ce paramètre permet
    d'utiliser des versions de l'assembleur de certaines fonctions en chaîne.</para>

    <para><parameter>--enable-local-infile</parameter>&nbsp;: Ce paramètre
    active les états SQL <quote>LOAD DATA INFILE</quote>.</para>

    <para><parameter>--with-unix-socket-path=/var/run/mysql</parameter>&nbsp;:
    Ce paramètre met le socket de domaine unix dans le répertoire
    <filename class="directory">/var/run/mysql</filename> et non dans celui
    <filename class="directory">/tmp</filename> par défaut.</para>

    <para><parameter>--without-readline</parameter>&nbsp;: Ce paramètre oblige
    la construction à utiliser la copie sur le système de
    <application>readline</application> et non celle interne.</para>

    <para><parameter>--with-extra-charsets=all</parameter>&nbsp;: Ce paramètre
    active les encodages internationaux dans la suite.</para>

    <para><parameter>--with-plugins=innobase,myisam</parameter>&nbsp;: Ce
    paramètre active deux types utiles de tables. Lisez <command>./configure --help</command> 
    pour avoir les autres types de tables.</para>

    <para><parameter>--with-ssl</parameter>&nbsp;: Ce paramètre active la
    communication chiffrée entre le client et le serveur utilisant OpenSSL.</para>

    <para><command>make  benchdir_root=... install</command>&nbsp;: Ceci installe les
    suites d'évaluation et de tests à un endroit non système.</para>

    <para><command>ln -v -sf mysql/libmysqlclient{,_r}.so* .</command>&nbsp;: 
    Cette commande rend les bibliothèques partagées de <application>MySQL</application>
    disponibles pour d'autres paquets au moment de leur exécution.</para>

    <para><option>--with-libwrap</option>&nbsp;: Ce paramètre ajoute le
    support des enveloppes tcp à <application>MySQL</application>.</para>

    <para><command>pushd ... popd</command>>:nbsp;: Cet ensemble de commandes reconstruit le fichier
    <filename>/usr/share/info/dir</filename> quand l'installation echoue pour le faire.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de MySQL</title>

    <sect3 id="mysql-config">
      <title>Fichiers de configuration</title>

      <para><filename>/etc/my.cnf</filename> et
      <filename>~/.my.cnf</filename></para>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-AA.my.cnf">~/.my.cnf</primary>
      </indexterm>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-etc-my.cnf">/etc/my.cnf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Vous pouvez utiliser plusieurs fichiers de configuration sont 
      disponibles dans <filename class="directory">/usr/share/mysql</filename>.
      Créez <filename>/etc/my.cnf</filename> en utilisant la commande suivante
      en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m644 /usr/share/mysql/my-medium.cnf /etc/my.cnf</userinput></screen>

      <para>Vous pouvez maintenant installer une base de données et modifier 
      l'appartenance en faveur de l'utilisateur et du groupe non privilégiés 
      (effectuez en tant qu'utilisateur <systemitem
      class="username">root</systemitem> user)&nbsp;:</para>

<screen role="root"><userinput>mysql_install_db --user=mysql &amp;&amp;
chgrp -v mysql /srv/mysql{,/test,/mysql}</userinput></screen>

      <para>La configuration supplémentaire exige que le serveur
      <application>MySQL</application> soit en fonction. Démarrez le serveur en
      utilisant les commandes suivantes en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m755 -o mysql -g mysql -d /var/run/mysql &amp;&amp;
mysqld_safe --user=mysql 2&gt;&amp;1 &gt;/dev/null &amp;</userinput></screen>

      <para>Une installation par défakt n'initialise pas de mot de passe pour
      l'administrateur, utilisez donc la commande suivante en tant qu'utilisateur 
      <systemitem class="username">root</systemitem> pour en régler un. Remplacez
      <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable> par le
      vôtre.</para>

<screen role="root"><userinput>mysqladmin -u root password <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable></userinput></screen>

      <para>La configuration du serveur est maintenant terminée. Éteignez le
      serveur en utilisant la commande suivante en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>mysqladmin -p shutdown</userinput></screen>

    </sect3>

    <sect3  id="mysql-init">
      <title>Script de démarrage</title>

      <para>Installez le script de démarrage <filename>/etc/rc.d/init.d/mysql</filename> 
      inclu dans le paquet <xref linkend="bootscripts"/> en tant qu'utilisateur
      <systemitem class="username">root</systemitem> pour démarrer le serveur
      <application>MySQL</application> au moment du démarrage du système.</para>

      <indexterm zone="mysql mysql-init">
        <primary sortas="f-mysql">mysql</primary>
      </indexterm>

<screen role="root"><userinput>make install-mysql</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>comp_err, innochecksum, msql2mysql, my_print_defaults,
        myisam_ftdump, myisamchk, myisamlog, myisampack, mysql,
        mysql_client_test, mysql_config, mysql_convert_table_format,
        mysql_create_system_tables, mysql_explain_log, mysql_find_rows,
        mysql_fix_extensions, mysql_fix_privilege_tables, mysql_install_db,
        mysql_secure_installation, mysql_setpermission, mysql_tableinfo,
        mysql_tzinfo_to_sql, mysql_waitpid, mysql_zap, mysqlaccess, mysqladmin,
        mysqlbinlog, mysqlbug, mysqlcheck, mysqld, mysqld_multi, mysqld_safe,
        mysqldump, mysqldumpslow, mysqlhotcopy, mysqlimport, mysqlmanager,
        mysqlshow, mysqltest, mysqltestmanager, mysqltestmanager-pwgen,
        mysqltestmanagerc, perror, replace, resolve_stack_dump, et
        resolveip</seg>
        <seg>libdbug.a, libheap.a, libmyisam.a, libmyisammrg.a,
        libmysqlclient.{so,a}, libmysqlclient_r.{so,a}, libmystrings.a,
        libmysys.a, et libvio.a</seg>
        <seg>/srv/mysql, /usr/include/mysql, /usr/lib/mysql, /usr/share/mysql, et
        /var/run/mysql</seg>
      </seglistitem>
    </segmentedlist>

    <bridgehead renderas="sect3">Descriptions courtes</bridgehead>

    <para>Des descriptions de tous les programmes et de toutes les bibliothèques
     prendraient plusieurs pages. Consultez plutôt la documentation de
     <filename>mysql.info</filename> ou le manuel de référence en ligne sur <ulink
    url="http://dev.mysql.com/doc/refman/5.1/en/index.html"/>.</para>

    <para>Les modules DBI de <application>Perl</application> doivent être
    installés pour avoir des programmes de support de <application>MySQL</application> 
    pour fonctionner correctement.</para>

  </sect2>

</sect1>
