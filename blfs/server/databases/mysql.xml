<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY mysql-download-http "http://cdn.mysql.com/Downloads/MySQL-5.5/mysql-&mysql-version;.tar.gz">
  <!ENTITY mysql-download-ftp  " ">
  <!ENTITY mysql-md5sum        "da8ddb3d00e6e159153d2444360f52a8">
  <!ENTITY mysql-size          "24 Mo">
  <!ENTITY mysql-buildsize     "932 Mo (additional 170 Mo to run the test suite)">
  <!ENTITY mysql-time          "4.0 SBU (Test suite is an additional 45 minutes, only partially CPU dependent)">
]>

<sect1 id="mysql" xreflabel="MySQL-&mysql-version;">
  <?dbhtml filename="mysql.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: bdubbs $</othername>
    <date>$Date&nbsp;: 2012-09-09 04:44:43 +0200 (Sun, 09 Sep 2012) $</date>
  </sect1info>

  <title>MySQL-&mysql-version;</title>

  <indexterm zone="mysql">
    <primary sortas="a-MySQL">MySQL</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à MySQL</title>

    <para><application>MySQL</application> est un serveur de base de données rapide et
    largement utilisé. C'est une implémentation client/serveur consistant dans 
    un démon serveur et de nombreux programmes et bibliothèques différents.</para>

   &lfs72_checked;

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&mysql-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&mysql-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &mysql-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &mysql-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &mysql-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &mysql-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif facultatif (requis si vous construisez pour Amarok)&nbsp;: <ulink
        url="&patch-root;/mysql-&mysql-version;-embedded_library_shared-1.patch"/></para>
      </listitem>
      <listitem>
        <para>Correctif facultatif (requis si vous construisez seulement le
        client)&nbsp;: <ulink
        url="&patch-root;/mysql-&mysql-version;-fix_client_only-1.patch"/></para>
      </listitem>
      <listitem>
        <para>Documentation optionelle (voir l'astuce ci-dessous):
          <ulink url="http://dev.mysql.com/doc/"/>
        </para>      
		</listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances de MySQL</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="optional"><xref linkend="cmake"/></para>

    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="optional"><xref linkend="openssl"/></para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <ulink url="http://packages.debian.org/source/sid/libaio">libaio</ulink>
    </para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/mysql"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de MySQL</title>

    <sect3>
    <title>Construction</title>

    <para>Pour des raisons de sécurité, vous êtes fortement encouragé à exécuter
    le serveur en tant qu'utilisateur et groupe non privilégiés. Lancez ce
    qui suit (en tant qu'utilisateur <systemitem class="username">root</systemitem>)
    pour créer l'utilisateur et le groupe&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 40 mysql &amp;&amp;
useradd -c "MySQL Server" -d /dev/null -g mysql -s /bin/false -u 40 mysql</userinput></screen>

    <para>Si le serveur MySQL n'est pas nécessaire, il est possible de ne
    construire que les bibliothèques clients de MySQL. Pour cela, vous devez
    appliquer le correctif facultatif, utilisez l'option <parameter>-DWITHOUT_SERVER=ON</parameter> 
    de cmake et les instructions d'installation du client-seulement ci-dessous.</para>

    <para>MySQL contient une bibliothèque serveur embarquée qui peut être activée
    par l'option <parameter>-DWITH_EMBEDDED_SERVER=ON</parameter> de cmake.
    Par défaut, ce serveur est construit comme bibliothèque liée de façon
    statique, <filename>libmysqld.a</filename>, mais en appliquant le
    correctif facultatif, on peut construire une version partagée de cette
    bibliothèque. La bibliothèque partagée est nécessaire pour certaines
    applications, telles que <application>Amarok</application>.</para>
     
    <para>Beaucoup d'options sont disponibles avec
    <userinput>cmake</userinput>. Vérifiez la sortie de `<userinput>cmake .
    -LH</userinput>` pour des options supplémentaires de personnalisation. Voir
    la <ulink
    url="http://dev.mysql.com/doc/refman/5.5/en/source-configuration-options.html">
    Documentation MySQL </ulink> pour une liste complète des options.</para>
     
    <para>Si vous voulez la version partagée de la bibliothèque serveur
    embarquée, appliquez le correctif&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../mysql-&mysql-version;-embedded_library_shared-1.patch</userinput></screen>

     <para>Si vous ne construisez que le client, appliquez le correctif&nbsp;:</para>
<screen><userinput>patch -Np1 -i ../mysql-&mysql-version;-fix_client_only-1.patch</userinput></screen>
    
    <para>Configurez et construisez <application>MySQL</application> en
    lançant les commandes suivantes&nbsp;:</para>
     
<screen><userinput>mkdir build &amp;&amp;
cd build &amp;&amp;
cmake -DCMAKE_INSTALL_PREFIX=/usr                         -DINSTALL_DOCDIR=share/doc/mysql                    -DINSTALL_DOCREADMEDIR=share/doc/mysql              -DINSTALL_INCLUDEDIR=include/mysql                  -DINSTALL_INFODIR=share/info                        -DINSTALL_MANDIR=share/man                          -DINSTALL_MYSQLDATADIR=/srv/mysql                   -DINSTALL_MYSQLSHAREDIR=share/mysql                 -DINSTALL_MYSQLTESTDIR=share/mysql/test             -DINSTALL_PLUGINDIR=lib/mysql                       -DINSTALL_SBINDIR=sbin                              -DINSTALL_SCRIPTDIR=bin                             -DINSTALL_SQLBENCHDIR=share/mysql/bench             -DINSTALL_SUPPORTFILESDIR=share/mysql/support       -DMYSQL_DATADIR=/srv/mysql                          -DMYSQL_UNIX_ADDR=/var/run/mysql/mysql.sock         -DSYSCONFDIR=/etc                                   -DWITH_PARTITION_STORAGE_ENGINE=OFF                 -DWITH_PERFSCHEMA_STORAGE_ENGINE=OFF                -DWITH_READLINE=system                              -DWITH_SSL=system                                   .. &amp;&amp;
make</userinput></screen>

    <para>Pour tester les résultats, lancez&nbsp;: <command>make test-force 2>&amp;1 | tee
	test.log</command>.Cela force le test à lancer au départ le log de toutes les sorties de tests.
	Il y a beaucoup de tests qui ne sont pas lancés a cause des options de configuraton et de 
	considérations des programmeurs. Remarquez que si vous utilisez TCP Wreappers et avez un 
	<filename>/etc/hosts.deny</filename> restreint, vous devrez ajouter une entrée adéquate au fichier
    <filename>/etc/hosts.allow</filename> pour le démon <command>mysqld</command>. 
	Sans cela, beaucoup de tests échoueront.</para>

    <note><para>Il se peut que les tests SSL échouent à cause de certificts
    expirés.</para></note>

    </sect3>

     <sect3>
     <title>Installation (serveur et client)</title>
    
      <para>Pour installer le serveur et le client, lancez la commande suivante
      (en tant qu'utilisateur <systemitem class="username">root</systemitem>)&nbsp;:</para>

<screen role="root"><userinput>SEGMENTS="Client Server IniFiles ManPages SharedLibraries"
SEGMENTS="$SEGMENTS Development Documentation Info Readme"

for segment in $SEGMENTS; do
   cmake -DCMAKE_INSTALL_COMPONENT=$segment -P cmake_install.cmake
done

unset SEGMENTS</userinput></screen>

      <note><para>Si vous avez construit la bibliothèque serveur embarquée,
      ajoutez <userinput>Embedded</userinput> à la variable
      <userinput>SEGMENTS</userinput> ci-dessus.</para></note>

    <tip>
      <para>La seule documentation incluse dans l'archive tar des sources est
      dans des fichiers <filename>mysql.info</filename> et dans les man pages.
	  Vous pouvez télécharger différents formats du manuel de référence de 
	  <application>MySQL</application> sur <ulink url="http://dev.mysql.com/doc/"/>.
	  </para>
    </tip>
   </sect3>

    <sect3>
      <title>Installation (client seulement)</title>

      <para>Si vous voulez n'installer que le logiciel client, lancez ce qui suit
      (en tant qu'utilisateur <systemitem class="username">root</systemitem>)&nbsp;:</para>

<screen role="root"><userinput>SEGMENTS="Client ManPages SharedLibraries"
SEGMENTS="$SEGMENTS Development Documentation Info Readme"
for segment in $SEGMENTS; do
   cmake -DCMAKE_INSTALL_COMPONENT=$segment -P cmake_install.cmake
done
 
unset SEGMENTS</userinput></screen>
    </sect3>
   </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><parameter>-DWITH_&lt;engine&gt;_STORAGE_ENGINE=ON</parameter>&nbsp;:
    Les instructions par défaut ne construisent que le moteur de stockage
    innobase (InnoDB). Si vous désirez d'autres moteurs de stockage, utilisez
    ce paramètre pour les activer. Les choix valides sont ARCHIVE, BLACKHOLE, 
    EXAMPLE, FEDERATED, INNOBASE, NDBCLUSTER,
    PARTITION et PERFSCHEMA.</para>

    <para><parameter>-DWITHOUT_SERVER=ON</parameter>&nbsp;: Utilisez ce
    paramètre si vous ne voulez pas le serveur et si vous ne voulez construire
    que le client.</para>

    <para><parameter>-DWITH_EMBEDDED_SERVER=ON</parameter>&nbsp;: Utilisez ce
    paramètre pour construire la bibliothèque serveur embarquée.</para>
    
    <para><parameter>-DWITH_SSL=system</parameter>&nbsp;: Utilisez ce paramètre
    pour construire contre une version de SSL du système.</para>

    <para><command>cmake -DCMAKE_INSTALL_COMPONENT=$segment ...</command>&nbsp;:
    Cette commane installe la partie adéquate du paquet. Vous pouvez ajouter
    ou supprimer différents segments comme vous le voulez. Les segments
    valides sont listés  `<command>make list_install_components</command>`.
    Remarquez que le segmentation d'installation 'DataFiles' n'accepte pas les
    déclarations -DMYSQL_DATADIR ou -DINSTALL_MYSQLDATADIR et il installe les
    fichiers de données dans <filename class="directory">/usr/data</filename>.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de MySQL</title>

    <sect3 id="mysql-config">
      <title>Fichiers de configuration</title>

      <para><filename>/etc/my.cnf</filename> et
      <filename>~/.my.cnf</filename></para>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-AA.my.cnf">~/.my.cnf</primary>
      </indexterm>

      <indexterm zone="mysql mysql-config">
        <primary sortas="e-etc-my.cnf">/etc/my.cnf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Vous pouvez utiliser plusieurs fichiers de configuration sont 
      disponibles dans <filename class="directory">/usr/share/mysql</filename>.
      Quand vous créez le fichier, assurez vous que les journaux binaires sont
      désactivés à moins que vous fassiez une copie de la base de données.
      Créez <filename>/etc/my.cnf</filename> en utilisant la commande suivante
      en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m644 /usr/share/mysql/support/my-medium.cnf /etc/my.cnf
sed -i 's/^log-bin/#log-bin/' /etc/my.cnf</userinput></screen>

      <para>Vous pouvez maintenant installer une base de données et modifier 
      l'appartenance en faveur de l'utilisateur et du groupe non privilégiés 
      (effectuez en tant qu'utilisateur <systemitem
      class="username">root</systemitem> user)&nbsp;:</para>

<screen role="root"><userinput>mysql_install_db --basedir=/usr --datadir=/srv/mysql --user=mysql &amp;&amp;
chgrp -v mysql /srv/mysql{,/test,/mysql}</userinput></screen>

      <para>La configuration supplémentaire exige que le serveur
      <application>MySQL</application> soit en fonction. Démarrez le serveur en
      utilisant les commandes suivantes en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>install -v -m755 -o mysql -g mysql -d /var/run/mysql &amp;&amp;
mysqld_safe --user=mysql 2&gt;&amp;1 &gt;/dev/null &amp;</userinput></screen>

      <para>Une installation par défaut n'initialise pas de mot de passe pour
      l'administrateur, utilisez donc la commande suivante en tant qu'utilisateur 
      <systemitem class="username">root</systemitem> pour en régler un. Remplacez
      <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable> par le
      vôtre.</para>

<screen role="root"><userinput>mysqladmin -u root password <replaceable>&lt;nouveau-mot-de-passe&gt;</replaceable></userinput></screen>

      <para>La configuration du serveur est maintenant terminée. Éteignez le
      serveur en utilisant la commande suivante en tant qu'utilisateur <systemitem
      class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>mysqladmin -p shutdown</userinput></screen>

    </sect3>

    <sect3  id="mysql-init">
      <title>Script de démarrage</title>

      <para>Installez le script de démarrage <filename>/etc/rc.d/init.d/mysql</filename> 
      inclu dans le paquet <xref linkend="bootscripts"/> en tant qu'utilisateur
      <systemitem class="username">root</systemitem> pour démarrer le serveur
      <application>MySQL</application> au moment du démarrage du système.</para>

      <indexterm zone="mysql mysql-init">
        <primary sortas="f-mysql">mysql</primary>
      </indexterm>

<screen role="root"><userinput>make install-mysql</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>innochecksum, msql2mysql, my_print_defaults, myisam_ftdump,
        myisamchk, myisamlog, myisampack, mysql, mysql_client_test,
        mysql_config, mysql_convert_table_format, mysql_find_rows,
        mysql_fix_extensions, mysql_install_db, mysql_plugin,
        mysql_secure_installation, mysql_setpermission, mysql_tzinfo_to_sql,
        mysql_upgrade, mysql_waitpid, mysql_zap, mysqlaccess, mysqladmin,
        mysqlbinlog, mysqlbug, mysqlcheck, mysqld, mysqld_multi, mysqld_safe,
        mysqldump, mysqldumpslow, mysqlhotcopy, mysqlimport, mysqlshow,
        mysqlslap, mysqltest, perror, replace, resolve_stack_dump et
        resolveip</seg>
        <seg>libmysqlclient.{so,a}, libmysqlclient_r.{so,a}, libmysqlservices.a
        et plusieurs dans /usr/lib/mysql</seg>
        <seg>/srv/mysql, /usr/include/mysql, /usr/lib/mysql, /usr/share/mysql et
         /var/run/mysql</seg>
       </seglistitem> 
    </segmentedlist>

    <bridgehead renderas="sect3">Descriptions courtes</bridgehead>

    <para>Des descriptions de tous les programmes et de toutes les bibliothèques
     prendraient plusieurs pages. Consultez plutôt la documentation de
     <filename>mysql.info</filename> ou le manuel de référence en ligne sur <ulink
    url="http://dev.mysql.com/doc/refman/5.5/en/index.html"/>.</para>

    <para>Les modules DBI de <application>Perl</application> doivent être
    installés pour avoir des programmes de support de <application>MySQL</application> 
    pour fonctionner correctement.</para>

  </sect2>

</sect1>
