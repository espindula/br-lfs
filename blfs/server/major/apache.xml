<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!-- <!ENTITY apache-download-http "http://www.apache.org/dist/httpd/httpd-&apache-version;.tar.bz2"> -->
  <!ENTITY apache-download-http "http://archive.apache.org/dist/httpd/httpd-&apache-version;.tar.bz2">
  <!ENTITY apache-download-ftp  "ftp://apache.mirrors.pair.com/httpd/httpd-&apache-version;.tar.bz2">
  <!ENTITY apache-md5sum        "1696ae62cd879ab1d4dd9ff021a470f2">
  <!ENTITY apache-size          "6.8 Mio">
  <!ENTITY apache-buildsize     "105 MB (en construisant tous les modules DSO disponibles)">
  <!ENTITY apache-time          "1.2 SBU (en construisant tous les modules DSO disponibles)">
]>

<sect1 id="apache" xreflabel="Apache-&apache-version;">
  <?dbhtml filename="apache.html"?>

  <sect1info>
    <othername>$LastChangedBy: bdubbs $</othername>
    <date>$Date: 2011-12-12 21:16:56 +0100 (lun. 12 dÃ©c. 2011) $</date>
  </sect1info>

  <title>Apache-&apache-version;</title>

  <indexterm zone="apache">
    <primary sortas="a-Apache">Apache</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Apache</title>

    <para>Le paquet <application>Apache</application> contient un serveur
    HTTP open-source. C'est utile pour créer des sites Internet d'Intranet locaux
    ou lancer d'immenses opérations de service Internet.</para>

    &lfs70_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&apache-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&apache-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &apache-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &apache-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &apache-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &apache-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing='compact'>
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/httpd-&apache-version;-config-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances d'Apache</bridgehead>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="openldap"/>,
    <xref linkend="openssl"/> (aussi utilisé dans APR-util),
    <xref linkend="pcre"/>,
	<xref linkend="rsync"/>,
    <xref linkend="lynx"/>,
    <ulink url="http://apr.apache.org/">APR</ulink>,
    <ulink url="http://apr.apache.org/">APR-util</ulink> et
    <ulink url="http://www.distcache.org/">distcache</ulink></para>

    <bridgehead renderas="sect4">Facultatives (Only if Using the Bundled
    APR-util)</bridgehead>
    <para role="optional"><!-- <xref linkend="pkgconfig"/> -->,
    <xref linkend="expat"/>,
    <!-- <xref linkend="gdbm"/>, -->
    <xref linkend="db"/>,
    <xref linkend="unixodbc"/>,
    <xref linkend="mysql"/>,
    <xref linkend="postgresql"/>,
    <xref linkend="sqlite"/>,
    <ulink url="http://www.oracle.com/us/products/database/index.html">Oracle 11g</ulink>, et
    <ulink url="http://www.freetds.org/">FreeTDS</ulink></para>

    <para>Bien que vous puissiez installer APR et APR-util comme des composants
    séparés, les versions incluses fournies avec l'archive tar de HTTPD Apache
    sont recommandées.</para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/apache"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation d'Apache</title>

    <para>Pour des raisons de sécurité, l'exécution du serveur en tant
    q'utilisateur et groupe non privilégiés est fortement conseillée. Créez le
    groupe et l'utilisateur suivant en utilisant les commandes suivantes (en
    tant qu'utilisateur <systemitem class="username">root</systemitem>)&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 25 apache &amp;&amp;
useradd -c "Apache Server" -d /dev/null -g apache \
        -s /bin/false -u 25 apache</userinput></screen>

    <note><para>La commande ci-dessus redirige le répertoire <application>Apache</application>
    du home de l'utilisateur vers <filename>/dev/null</filename>.  Il se peut que
    cela ne fonctionne pas pour certains suppléments tels que <ulink
    url='http://www.viewvc.org/'><application>ViewVC</application></ulink>, une
    interface de navigation pour les dépôts de contrôle de version CVS et Subversion.
    Voir les notes utilisateur pour des détails sur des applications
    spécifiques.</para></note>

    <para>Le correctif suivant modifie l'agencement des répertoires de
    destination et entre autres, il met le répertoire de construction dans
    <filename class="directory">/usr/lib/apache/build</filename>. Cela permettra
    aux modules ajoutés à <application>Apache</application> de se configurer
    sans erreurs. Appliquez le correctif&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../httpd-&apache-version;-config-1.patch</userinput></screen>

    <note>
      <para>Il se peut que vous souhaitiez relire la sortie de 
      <command>./configure --help</command> et ajouter les paramètres 
      nécessaires à la commande <command>configure</command> ci-dessous pour
      construire les modules nécessaires à votre installation. Il n'existe pas
      moins de 65 paramètres supplémentaires que vous pouvez ajouter au à la
      commande <command>configure</command> pour construire des modules 
      supplémentaires. Certains paramètres supplémentaires nrn décrits ou non 
      indiqués dans les informations de <parameter>--help</parameter> sont listés
      dans la section <quote>Explication des commandes</quote> ci-dessous.</para>

      <para>Si vous utilisez la version intégrée de 
      <application>APR-util</application> et si vous allez installer
      <application>Subversion</application> avec le support de la fondation
      <application>Berkeley DB</application>, assurez-vous d'utiliser les
      paramètres indiqués dans la section <quote>Explication des commandes</quote>
      ci-dessous.</para>

      <para>Bien qu'il n'est pas construit par défaut lors de l'utilisation des
      commandes suivantes, le module ISAPI DSO peut être créé en ajoutant l'option
      <option>--enable-isapi</option>. Même si le module compilera, s'installera
      et se chargera très bien, le module n'est supporté et opérationnel
      <emphasis>que</emphasis> dans des environnements Win32.</para>
    </note>

    <para>Construisez et installez <application>Apache</application> en lançant
    les commandes suivantes&nbsp;:</para>

<screen><userinput>./configure --enable-layout=FHS      \
                               --enable-mods-shared=all \
                               --enable-so &amp;&amp;
make</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
chown -v root:root /usr/lib/apache/httpd.exp                     \
    /usr/sbin/{apxs,apachectl,dbmmanage,envvars{,-std}}          \
    /usr/share/man/man1/{dbmmanage,ht{dbm,digest,passwd}}.1      \
    /usr/share/man/man8/{ab,apachectl,apxs,htcacheclean,httpd}.8 \
    /usr/share/man/man8/{logresolve,rotatelogs,suexec}.8 &amp;&amp;
chown -v -R apache:apache /srv/www</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><parameter>--enable-mods-shared=all</parameter>&nbsp;: Les modules
    devraient être compilés et utilisés comme objets partageables dymamiquement
    (<foreignphrase>Dynamic Shared Objects</foreignphrase>, DSOs) pour pouvoir
    être inclus et exclus du serveur qui utilise les lignes de 
    configuration au moment de l'exécution.</para>

    <para><option>--enable-ssl</option>&nbsp;: Utilisez ce paramètre pour créer
    le module <filename class="libraryfile">mod_ssl</filename> et activer le 
    support SSL. Ce paramètre est indiqué comme faisant partie des nombreux 
    paramètres qu'on peut passer à la commande <command>configure</command> pour
    créer des modules DSO supplémentaires.<!-- Note that it really only affects the
         APR-Util sub-package, which the HTTPD installation then uses.--></para>

    <para><option>--with-pcre</option>&nbsp;: Ajoutez ce paramètre pour utiliser
    la version installée sur le système de la bibliothèque
    <application>PCRE</application>.</para>

    <para><option>--with-z</option>&nbsp;: Ajoutez ce paramètre pour utiliser
        la version installée sur le système de la bibliothèque
        <application>Zlib</application>.</para>

    <para><option>--with-ldap</option>&nbsp;: Ce paramètre est nécessaire si
    vous avez passé les options <option>--enable-authnz-ldap</option> ou
    <option>--enable-ldap</option> à <command>configure</command>
    et si vous avez activé les modules <application>OpenLDAP</application>.</para>

    <para><option>--with-dbm=db4 --with-berkeley-db</option>&nbsp;: Utilisez
    ces paramètres si vous avez besoin du support
    <application>Berkeley DB</application> dans la version incluse de
    <application>APR-util</application> (requis pour le support de la fondation
    <application>Berkeley DB</application> dans
    <application>Subversion</application>). Si vous utilisez
    <application>Berkeley DB</application>-5.1, modifiez le premier paramètre en
    <option>--with-dbm=db51</option>.</para>

    <para><option>--with-mysql</option>>:nbsp;: Ajoutez ce paramètre pour utiliser la version installée
	de <application>MySQL</application>.</para>

    <para><option>--with-included-apr</option>>:nbsp;: Ajoutez ce paramètre pour utiliser la version 
	incluse du système APR. Par défaut, une version installée sera utilisée si elle est disponible
	Utilisez ce paramètre pour forcer la construction à utiliser et ensuite installer
	(en remplaçant le APR existant) la copy interne (incluse) de APR.</para>

    <para><command>chown root:root ...</command>&nbsp;: Cette commande modifie
    l'appartenance de certains fichiers installés, le résultat de la construction
    du paques appartenant à un utilisateur différent de
    <systemitem class="username">root</systemitem>.</para>

    <para><command>chown -R apache:apache /srv/www</command>&nbsp;: Par défaut,
    le processus d'installation installe des fichierss (documentation, messages
    d'erreur, icônes par défaut, etc.) avec l'appartenance à l'utilisateur qui a
    extrait les fichiers du fichier tar. Si vous voulez modifier l'appartenance
    pour un autre utilisateur, vous devriez le faire à ce moment. La seule
    exigence est que les répertoires de document doivent être accessibles pour
    le processus <command>httpd</command> avec les droits
    (r-x) et les fichiers doivent être lisibles (r--) par l'utilisateur
    <systemitem class="username">apache</systemitem>.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration d'Apache</title>

    <sect3 id="apache-config">
      <title>Fichiers de configuration</title>

      <para><filename>/etc/apache/*</filename></para>

      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-apache">/etc/apache/*</primary>
      </indexterm>

      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-apache-httpd.conf">/etc/apache/httpd.conf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Le fichier de configuration principal se nomme
      <filename>/etc/apache/httpd.conf</filename>. Modifiez-le pour que le
      serveur HTTP se lance en tant qu'utilisateur et groupe dédiés&nbsp;:</para>

<screen role="root"><userinput>sed -i -e "s/User daemon/User apache/" \
       -e "s/Group daemon/Group apache/" \
    /etc/apache/httpd.conf</userinput></screen>

      <para>Voir <ulink url="http://httpd.apache.org/docs-2.2/configuring.html"/>
      pour des instructions détaillées sur la personnalisation de votre fichier
      configuration du servur HTTP <application>Apache</application>.</para>

    </sect3>

    <sect3  id="httpd-init">
      <title>Script de démarrage</title>

      <para>Si vous voulez que le serveur <application>Apache</application> 
      démarre automatiquement quand le système se lance, installez le script
      de démarrage <filename>/etc/rc.d/init.d/httpd</filename> inclu dans le
      paquet <xref linkend="bootscripts"/>.</para>

      <indexterm zone="apache httpd-init">
        <primary sortas="f-apache">apache</primary>
      </indexterm>

<screen role="root"><userinput>make install-httpd</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>ab, apachectl, apr-1-config, apu-1-config, apxs, checkgid,
        dbmmanage, htcacheclean, htdbm, htdigest, htpasswd, httpd, httxt2dbm,
        logresolve, rotatelogs, et suexec</seg>
        <seg>libapr-1.{so,a}, libaprutil-1.{so,a}, apr_{dbd,ldap} database
        modules, et numerous DSO modules</seg>
        <seg>/etc/apache, /srv/www, /usr/include/apache, /usr/lib/apache,
        /usr/lib/apr-util-1, et /var/log/apache</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="ab">
        <term><command>ab</command></term>
        <listitem>
          <para>est un outil d'évaluation de votre serveur HTTP
          <application>Apache</application>.</para>
          <indexterm zone="apache ab">
            <primary sortas="b-ab">ab</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apachectl">
        <term><command>apachectl</command></term>
        <listitem>
          <para>est une interface avec le serveur HTTP <application>Apache</application>
          conçue pour aider l'administrateur à contrôler le fonctionnement du
          démon httpd d'<application>Apache</application>.</para>
          <indexterm zone="apache apachectl">
            <primary sortas="b-apachectl">apachectl</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apr-1-config">
        <term><command>apr-1-config</command></term>
        <listitem>
          <para>est un script simple qui donne des informations sur le programme APR
		  installé.</para>
          <indexterm zone="apache apr-1-config">
            <primary sortas="b-apr-1-config">apr-1-config</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apu-1-config">
        <term><command>apu-1-config</command></term>
        <listitem>
          <para>est un script simple qui donne des informations sur le programme APR
		  installé.</para>
          <indexterm zone="apache apu-1-config">
            <primary sortas="b-apu-1-config">apu-1-config</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apxs">
        <term><command>apxs</command></term>
        <listitem>
          <para>est un outil pour construire et installer les modules pour le
          serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache apxs">
            <primary sortas="b-apxs">apxs</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="checkgid">
        <term><command>checkgid</command></term>
        <listitem>
          <para>est un programme qui vérifie s'il peut initialiser le gid du groupe
		   spécifié. C'est pour voir si un groupe valide existe pour Apache2 afin de 
		   l'utiliser à l'éxécution. Si l'utilisateur (doit être lancé en superutilisateur)
		   est dans ce groupe, ou peut être initialisé dans ce groupe, le programme retournera 0.</para>
          <indexterm zone="apache checkgid">
            <primary sortas="b-checkgid">checkgid</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="dbmmanage">
        <term><command>dbmmanage</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers au format 
          DBM utilisés pour stocker les noms d'utilisateur et les mots de passe
          pour l'authentication de base des utilisateurs HTTP.</para>
          <indexterm zone="apache dbmmanage">
            <primary sortas="b-dbmmanage">dbmmanage</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htcacheclean">
        <term><command>htcacheclean</command></term>
        <listitem>
          <para>est utilisé pour nettoyer le cache disque.</para>
          <indexterm zone="apache htcacheclean">
            <primary sortas="b-htcacheclean">htcacheclean</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htdbm">
        <term><command>htdbm</command></term>
        <listitem>
          <para>est utilisé pour manipuler la basse de données DBM des mots de passe.</para>
          <indexterm zone="apache htdbm">
            <primary sortas="b-htdbm">htdbm</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htdigest">
        <term><command>htdigest</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats 
          utilisés pour stocker les noms d'utilisateur, les realms et les mots 
          de passe pour une authentication digest des utilisateurs HTTP.</para>
          <indexterm zone="apache htdigest">
            <primary sortas="b-htdigest">htdigest</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htpasswd">
        <term><command>htpasswd</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats 
          utilisés pour stocker les noms d'utilisateur et les mots de passe pour
          une authentication des utilisateurs HTTP.</para>
          <indexterm zone="apache htpasswd">
            <primary sortas="b-htpasswd">htpasswd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="httpd">
        <term><command>httpd</command></term>
        <listitem>
          <para>est le serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache httpd">
            <primary sortas="b-httpd">httpd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="httxt2dbm">
        <term><command>httxt2dbm</command></term>
        <listitem>
          <para>est utilisé pour générer les fichiers DBM depuis des entrées textes, qui seront
		  utilisés dans RewriteMap.</para>
          <indexterm zone="apache httxt2dbm">
            <primary sortas="b-httxt2dbm">httxt2dbm</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="logresolve">
        <term><command>logresolve</command></term>
        <listitem>
          <para>est un programme de post-traitement pour résoudre des adresses
          IP dans des fichiers journaux d'accès d'<application>Apache</application>.</para>
          <indexterm zone="apache logresolve">
            <primary sortas="b-logresolve">logresolve</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="rotatelogs">
        <term><command>rotatelogs</command></term>
        <listitem>
          <para>est un programme simple pour une utilisation conjointe avec la
          fonctionnalité de redirection du fichier journal
           d'<application>Apache</application>.</para>
          <indexterm zone="apache rotatelogs">
            <primary sortas="b-rotatelogs">rotatelogs</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="suexec">
        <term><command>suexec</command></term>
        <listitem>
          <para>est utilisé par le serveur <application>Apache HTTP</application>
          pour basculer sur un autre utilisateur avant l'exécution d'un programme CGI.</para>
          <indexterm zone="apache suexec">
            <primary sortas="b-suexec">suexec</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
