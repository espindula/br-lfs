<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY apache-download-http
           "https://archive.apache.org/dist/httpd/httpd-&apache-version;.tar.bz2">
  <!ENTITY apache-download-ftp  " ">
  <!ENTITY apache-md5sum        "cf4dfee11132cde836022f196611a8b7">
  <!ENTITY apache-size          "4.9 Mo">
  <!ENTITY apache-buildsize     "75 Mo">
  <!ENTITY apache-time          "0.7 SBU">
]>
<sect1 id="apache" xreflabel="Apache-&apache-version;">
  <?dbhtml filename="apache.html"?>
  <sect1info>
    <othername>$LastChangedBy&nbsp;: krejzi $</othername>
    <date>$Date&nbsp;: 2013-04-27 20:04:22 +0200 (sam. 27 avril 2013) $</date>
  </sect1info>
  <title>Apache-&apache-version;</title>
  <indexterm zone="apache">
    <primary sortas="a-Apache">Apache</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à Apache HTTPD</title>
    <para>Le paquet <application>Apache HTTPD</application> contient un serveur
    HTTP open-source. C'est utile pour créer des sites Internet d'Intranet locaux
    ou lancer d'immenses opérations de service Internet.</para>
    &lfs78_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&apache-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&apache-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &apache-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &apache-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &apache-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &apache-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
       <para>
          Correctifs requis:
         <ulink url="&patch-root;/httpd-&apache-version;-blfs_layout-1.patch"/>
        </para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances d'Apache HTTPD</bridgehead>
    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required">
      <xref linkend="apr-util"/> et
      <xref linkend="pcre"/>
    </para>
    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="openssl"/>
    </para>
    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional">
      <xref linkend="db"/>,
      <xref linkend="doxygen"/>,
      <xref linkend="libxml2"/>,
      <xref linkend="lynx"/> ou
      <xref linkend="Links"/> ou
      <ulink url="http://elinks.or.cz/">ELinks</ulink>,
      <xref linkend="openldap"/> (<xref linkend="apr-util"/> doit être installé avec
       le support ldap),
      <xref linkend="rsync"/>,
      <ulink url="http://www.distcache.org/">Distcache</ulink> et
      <xref linkend="lua"/>
    </para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/apache"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation d'Apache HTTPD</title>
    <para>Pour des raisons de sécurité, l'exécution du serveur en tant
    qu'utilisateur et groupe non privilégiés est fortement conseillée. Créez le
    groupe et l'utilisateur suivant en utilisant les commandes suivantes (en
    tant qu'utilisateur <systemitem class="username">root</systemitem>)&nbsp;:</para>
<screen role="root">
<userinput>groupadd -g 25 apache &amp;&amp;
useradd -c "Apache Server" -d /srv/www -g apache         -s /bin/false -u 25 apache</userinput>
</screen>
    <para>Construisez et installez <application>Apache HTTPD</application> en lançant
    les commandes suivantes&nbsp;:</para>
<screen>
<userinput>patch -Np1 -i ../httpd-&apache-version;-blfs_layout-1.patch           &amp;&amp;
sed '/dir.*CFG_PREFIX/s@^@#@'     -i support/apxs.in        &amp;&amp;
./configure --enable-authnz-fcgi                                        --enable-layout=BLFS                                        --enable-mods-shared="all cgi"                              --enable-mpms-shared=all                                    --enable-suexec=shared                                      --with-apr=/usr/bin/apr-1-config                            --with-apr-util=/usr/bin/apu-1-config                       --with-suexec-bin=/usr/lib/httpd/suexec                     --with-suexec-caller=apache                                 --with-suexec-docroot=/srv/www                              --with-suexec-logfile=/var/log/httpd/suexec.log             --with-suexec-uidmin=100                                    --with-suexec-userdir=public_html               &amp;&amp;
make</userinput>
</screen>
    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;
(notez que DESTDIR ne fonctionne pas correctement en tant qu'utilisateur sans privilège):</para>
<screen role="root">
<userinput>make install                                 &amp;&amp;
mv -v /usr/sbin/suexec /usr/lib/httpd/suexec &amp;&amp;
chgrp apache           /usr/lib/httpd/suexec &amp;&amp;
chmod 4754             /usr/lib/httpd/suexec &amp;&amp;
chown -v -R apache:apache /srv/www</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explication des commandes</title>
    <para>
      <command>sed '/dir.*CFG_PREFIX/s@^@#@'...</command>: Force l'utilitaire
      <application>apxs</application> à utiliser les chemins absolus pour les modules quand les instructions le font.
    </para>
     <para>
      <parameter>--enable-authnz-fcgi</parameter>: construit les authentifications
      basées sur FastCGI authorizer et les autorisations (module fast CGI mod_authnz_fcgi.so).
    </para>
    <para>
      <parameter>--enable-mods-shared="all cgi"</parameter>&nbsp;: Les modules
    devraient être compilés et utilisés comme objets partageables dymamiquement
    (<foreignphrase>Dynamic Shared Objects</foreignphrase>, DSOs) pour pouvoir
    être inclus et exclus du serveur qui utilise les lignes de
    configuration au moment de l'exécution.</para>
    <para>
      <parameter>--enable-mpm-shared=all</parameter>&nbsp;: CE paramètre assure que tous les
      MPM (Multi Processing Modules) sont constuit en tant que Dynamic Shared Objects (DSOs),
      pour que l'utilisateur puisse choisir lequel utiliser à l'éxécution.
    </para>

     <para>
        <parameter>--enable-suexec</parameter>&nbsp;: Ce paramètre active la construction du module suEXEC de
     <application>Apache</application> qui peut être utilisé pour autoriser les utilisateurs à lancer des scripts
     CGI et SSI avec un ID différent de l'ID de l'utilisateur du serveur web appelant.
     </para>
    <para>
     <parameter>--with-suexec-*</parameter>&nbsp;: Ces paramètres contrôlent le comportement du module suEXEC,
      comme le document racine par défaut, l'UID minimal qui peut être utilisé pour lancer des scripts dans le
      suEXEC. Merci de noter qu'avec un UID minimal de 100, vous ne pouvez pas lancer de scripts CGI ou SSI dans suEXEC en tant
      qu'utilisateur <systemitem class="username">apache</systemitem>.
    </para>
    <para>
      <command>... /usr/lib/httpd/suexec</command>&nbsp;: Ces commandes mettent l'enveloppe
      <command>suexec</command> au bon endroit, car il n'est pas destiné à être exécuté directement.
      Ils ajustent aussi les permissions pour le binaire, mettant sont segid à
      <systemitem class="username">apache</systemitem>.
    </para>
    <para>
       <command>chown -R apache:apache /srv/www</command>&nbsp;: Par défaut, le
      processus d'installation installe des fichiers (documentation, messages
      d'erreur, icônes par défaut, etc.) avec comme propriétaire l'utilisateur
      qui a extrait les fichiers de l'archive tar. Si vous voulez modifier la
      propriété au profit d'un autre utilisateur, vous devriez le faire à ce
      moment. La seule exigence est que les répertoires des documents soient
      accessibles par le processus <command>httpd</command> avec les droits
      (r-x) et il faut que les fichiers soient lisibles (r--) par l'utilisateur
      <systemitem class="username">apache</systemitem>.
    </para>
  </sect2>
  <sect2 role="configuration">
    <title>Configuration d'Apache</title>
    <sect3 id="apache-config">
      <title>Fichiers de configuration</title>
      <para>
      <filename>/etc/httpd/httpd.conf</filename> et
        <filename>/etc/httpd/extra/*</filename></para>
      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-httpd-httpd.conf">/etc/httpd/httpd.conf*</primary>
      </indexterm>
      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-httpd-extra-star">/etc/httpd/extra/*</primary>
      </indexterm>
    </sect3>
    <sect3>
      <title>Informations de configuration</title>
      <para>Voir <ulink url="file:///usr/share/httpd/manual/configuring.html"/>
      pour des instructions détaillées sur la personnalisation de votre fichier
      configuration du servur HTTP <application>Apache</application>.</para>
    </sect3>
    <sect3  id="httpd-init">
      <title>Script de démarrage</title>
      <para>Si vous voulez que le serveur <application>Apache HTTPD</application>
      démarre automatiquement quand le système se lance, installez le script
      de démarrage <filename>/etc/rc.d/init.d/httpd</filename> inclu dans le
      paquet <xref linkend="bootscripts"/>.</para>
      <indexterm zone="apache httpd-init">
        <primary sortas="f-apache">apache</primary>
      </indexterm>
<screen role="root">
<userinput>make install-httpd</userinput>
</screen>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèque installée</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>
           ab,           apachectl, apxs,     checkgid, dbmmanage, fcgistarter,
           htcacheclean, htdbm,     htdigest, htpasswd, httpd,
          httxt2dbm,    logresolve,      rotatelogs, et suexec
        </seg>
         <seg>
           Plusieurs bibliothèques sous  /usr/lib/httpd/modules/
         </seg>
          <seg>
          /etc/httpd,
          /srv/www,
          /usr/include/httpd,
          /usr/lib/httpd,
          /usr/share/httpd
          /var/log/httpd et
          /var/run/httpd
        </seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="ab">
        <term><command>ab</command></term>
        <listitem>
          <para>est un outil d'évaluation de votre serveur HTTP
          <application>Apache</application>.</para>
          <indexterm zone="apache ab">
            <primary sortas="b-ab">ab</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="apachectl">
        <term><command>apachectl</command></term>
        <listitem>
          <para>est une interface avec le serveur HTTP <application>Apache</application>
          conçue pour aider l'administrateur à contrôler le fonctionnement du
          démon httpd d'<application>Apache</application>.</para>
          <indexterm zone="apache apachectl">
            <primary sortas="b-apachectl">apachectl</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="apxs">
        <term><command>apxs</command></term>
        <listitem>
          <para>est un outil pour construire et installer les modules pour le
          serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache apxs">
            <primary sortas="b-apxs">apxs</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="checkgid">
        <term><command>checkgid</command></term>
        <listitem>
          <para>est un programme qui vérifie s'il peut initialiser le gid du groupe
		   spécifié. C'est pour voir si un groupe valide existe pour Apache2 afin de
		   l'utiliser à l'éxécution. Si l'utilisateur (doit être lancé en superutilisateur)
		   est dans ce groupe, ou peut être initialisé dans ce groupe, le programme retournera 0.</para>
          <indexterm zone="apache checkgid">
            <primary sortas="b-checkgid">checkgid</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="dbmmanage">
        <term><command>dbmmanage</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers au format
          DBM utilisés pour stocker les noms d'utilisateur et les mots de passe
          pour l'authentication de base des utilisateurs HTTP.</para>
          <indexterm zone="apache dbmmanage">
            <primary sortas="b-dbmmanage">dbmmanage</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="fcgistarter">
        <term><command>fcgistarter</command></term>
        <listitem>
          <para>
            est un outil pour démarrer un programme FastCGI.
          </para>
          <indexterm zone="apache fcgistarter">
            <primary sortas="b-fcgistarter">fcgistarter</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="htcacheclean">
        <term><command>htcacheclean</command></term>
        <listitem>
          <para>est utilisé pour nettoyer le cache disque.</para>
          <indexterm zone="apache htcacheclean">
            <primary sortas="b-htcacheclean">htcacheclean</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="htdbm">
        <term><command>htdbm</command></term>
        <listitem>
          <para>est utilisé pour manipuler la basse de données DBM des mots de passe.</para>
          <indexterm zone="apache htdbm">
            <primary sortas="b-htdbm">htdbm</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="htdigest">
        <term><command>htdigest</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats
          utilisés pour stocker les noms d'utilisateur, les realms et les mots
          de passe pour une authentication digest des utilisateurs HTTP.</para>
          <indexterm zone="apache htdigest">
            <primary sortas="b-htdigest">htdigest</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="htpasswd">
        <term><command>htpasswd</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats
          utilisés pour stocker les noms d'utilisateur et les mots de passe pour
          une authentication des utilisateurs HTTP.</para>
          <indexterm zone="apache htpasswd">
            <primary sortas="b-htpasswd">htpasswd</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="httpd">
        <term><command>httpd</command></term>
        <listitem>
          <para>est le serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache httpd">
            <primary sortas="b-httpd">httpd</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="httxt2dbm">
        <term><command>httxt2dbm</command></term>
        <listitem>
          <para>est utilisé pour générer les fichiers DBM depuis des entrées textes, qui seront
		  utilisés dans RewriteMap.</para>
          <indexterm zone="apache httxt2dbm">
            <primary sortas="b-httxt2dbm">httxt2dbm</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="logresolve">
        <term><command>logresolve</command></term>
        <listitem>
          <para>est un programme de post-traitement pour résoudre des adresses
          IP dans des fichiers journaux d'accès d'<application>Apache</application>.</para>
          <indexterm zone="apache logresolve">
            <primary sortas="b-logresolve">logresolve</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="rotatelogs">
        <term><command>rotatelogs</command></term>
        <listitem>
          <para>est un programme simple pour une utilisation conjointe avec la
          fonctionnalité de redirection du fichier journal
           d'<application>Apache</application>.</para>
          <indexterm zone="apache rotatelogs">
            <primary sortas="b-rotatelogs">rotatelogs</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="suexec">
        <term><command>suexec</command></term>
        <listitem>
          <para>
            permet aux utilisateurs de lancer des applications CGI et SSI avec un utilisateur différent.
          </para>
          <indexterm zone="apache suexec">
            <primary sortas="b-suexec">suexec</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
