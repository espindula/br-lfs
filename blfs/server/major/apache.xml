<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!-- <!ENTITY apache-download-http "http://www.apache.org/dist/httpd/httpd-&apache-version;.tar.bz2"> -->
  <!ENTITY apache-download-http "http://archive.apache.org/dist/httpd/httpd-&apache-version;.tar.bz2">
  <!ENTITY apache-download-ftp  "ftp://apache.mirrors.pair.com/httpd/httpd-&apache-version;.tar.bz2">
  <!ENTITY apache-md5sum        "3e98bcb14a7122c274d62419566431bb">
  <!ENTITY apache-size          "4.9 Mio">
  <!ENTITY apache-buildsize     "83 Mio">
  <!ENTITY apache-time          "2.1 SBU">
]>

<sect1 id="apache" xreflabel="Apache-&apache-version;">
  <?dbhtml filename="apache.html"?>

  <sect1info>
    <othername>$LastChangedBy: randy $</othername>
    <date>$Date: 2009-07-19 16:13:01 +0200 (dim 19 jui 2009) $</date>
  </sect1info>

  <title>Apache-&apache-version;</title>

  <indexterm zone="apache">
    <primary sortas="a-Apache">Apache</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à Apache</title>

    <para>Le paquet <application>Apache</application> contient un serveur
    HTTP open-source. C'est utile pour créer des sites Internet d'Intranet locaux
    ou lancer d'immenses opérations de service Internet.</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&apache-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&apache-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &apache-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &apache-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &apache-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &apache-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing='compact'>
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/httpd-&apache-version;-config-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Dépendances d'Apache</bridgehead>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="db"/>,
    <xref linkend="openssl"/>,
    <xref linkend="openldap"/>,
    <xref linkend="pcre"/>,
    <ulink url="http://apr.apache.org/">APR</ulink>,
    <ulink url="http://apr.apache.org/">APR-util</ulink> et
    <ulink url="http://www.distcache.org/">distcache</ulink></para>

    <bridgehead renderas="sect4">Facultatives (Only if Using the Bundled
    APR-util)</bridgehead>
    <para role="optional"><xref linkend="pkgconfig"/>,
    <xref linkend="expat"/>,
    <!-- <xref linkend="gdbm"/>, -->
    <xref linkend="postgresql"/> et
    <ulink url="http://sqlite.org/">SQLite</ulink></para>

    <para>Bien que vous puissiez installer APR et APR-util comme des composants
    séparés, il est recommandé d'utiliser les versions mixées fournies avec
    l'archive tar HTTPD Apache.</para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/apache"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation d'Apache</title>

    <para>Pour des raisons de sécurité, l'exécution du serveur en tant
    q'utilisateur et groupe non privilégiés est fortement conseillée. Créez le
    groupe et l'utilisateur suivant en utilisant les commandes suivantes (en
    tant qu'utilisateur <systemitem class="username">root</systemitem>)&nbsp;:</para>

<screen role="root"><userinput>groupadd -g 25 apache &amp;&amp;
useradd -c "Apache Server" -d /dev/null -g apache \
        -s /bin/false -u 25 apache</userinput></screen>

    <note><para>La commande ci-dessus redirige le répertoire <application>Apache</application>
    du home de l'utilisateur vers <filename>/dev/null</filename>.  Il se peut que
    cela ne fonctionne pas pour certains suppléments tels que <ulink
    url='http://www.viewvc.org/'><application>ViewVC</application></ulink>, une
    interface de navigation pour les dépôts de contrôle de version CVS et Subversion.
    Voir les notes utilisateur pour des détails sur des applications
    spécifiques.</para></note>

    <para>Le correctif suivant modifie l'agencement des répertoires de
    destination et entre autres, il met le répertoire de construction dans
    <filename class="directory">/usr/lib/apache/build</filename>. Cela permettra
    aux modules ajoutés à <application>Apache</application> de se configurer
    sans erreurs. Appliquez le correctif&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../httpd-&apache-version;-config-1.patch</userinput></screen>

    <note>
      <para>Il se peut que vous souhaitiez relire la sortie de 
      <command>./configure --help</command> et ajouter les paramètres 
      nécessaires à la commande <command>configure</command> ci-dessous pour
      construire les modules nécessaires à votre installation. Il n'existe pas
      moins de 62 paramètres supplémentaires que vous pouvez ajouter au à la
      commande <command>configure</command> pour construire des modules 
      supplémentaires. Certains paramètres supplémentaires nrn décrits ou non 
      indiqués dans les informations de <parameter>--help</parameter> sont listés
      dans la section <quote>Explication des commandes</quote> ci-dessous.</para>

      <para>Si vous utilisez la version intégrée de 
      <application>APR-util</application> et si vous allez installer
      <application>Subversion</application> avec le support de la fondation
      <application>Berkeley DB</application>, assurez-vous d'utiliser les
      paramètres indiqués dans la section <quote>Explication des commandes</quote>
      ci-dessous.</para>

      <para>Bien qu'il n'est pas construit par défaut lors de l'utilisation des
      commandes suivantes, le module ISAPI DSO peut être créé en ajoutant l'option
      <option>--enable-isapi</option>. Même si le module compilera, s'installera
      et se chargera très bien, le module n'est supporté et opérationnel
      <emphasis>que</emphasis> dans des environnements Win32.</para>
    </note>

    <para>Construisez et installez <application>Apache</application> en lançant
    les commandes suivantes&nbsp;:</para>

<screen><userinput>./configure --enable-layout=FHS --enable-mods-shared=all &amp;&amp;
make</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
chown -v root:root /usr/lib/apache/httpd.exp \
    /usr/sbin/{apxs,apachectl,dbmmanage,envvars{,-std}} \
    /usr/share/man/man1/{dbmmanage,ht{dbm,digest,passwd}}.1 \
    /usr/share/man/man8/{ab,apachectl,apxs,htcacheclean,httpd}.8 \
    /usr/share/man/man8/{logresolve,rotatelogs,suexec}.8 &amp;&amp;
chown -v -R apache:apache /srv/www</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <!-- This is not required any longer. Finds et uses system installed
         version of Expat without any issues
    <para><option>-with-expat=/usr</option>: Uses the system installed
    <application>expat</application>. <emphasis role="strong">If you have
    installed  <application>expat</application> et do not use this switch, the
    <application>Apache</application> installation may overwrite some files
    from the <application>expat</application> installation.</emphasis></para>
    -->

    <para><parameter>--enable-mods-shared=all</parameter>&nbsp;: Les modules
    devraient être compilés et utilisés comme objets partageables dymamiquement
    (<foreignphrase>Dynamic Shared Objects</foreignphrase>, DSOs) pour pouvoir
    être inclus et exclus du serveur qui utilise les lignes de 
    configuration au moment de l'exécution.</para>

    <para><option>--enable-ssl</option>&nbsp;: Utilisez ce paramètre pour créer
    le module <filename class="libraryfile">mod_ssl</filename> et activer le 
    support SSL. Ce paramètre est indiqué comme faisant partie des nombreux 
    paramètres qu'on peut passer à la commande <command>configure</command> pour
    créer des modules DSO supplémentaires.</para>

    <para><option>--with-pcre</option>&nbsp;: Ajoutez ce paramètre pour utiliser
    la version installée sur le système de la bibliothèque
    <application>PCRE</application>.</para>

    <para><option>--with-z</option>&nbsp;: Ajoutez ce paramètre pour utiliser
        la version installée sur le système de la bibliothèque
        <application>Zlib</application>.</para>

    <para><option>--with-ldap</option>&nbsp;: Ce paramètre est nécessaire si
    vous avez passé les options <option>--enable-authnz-ldap</option> ou
    <option>--enable-ldap</option> à <command>configure</command>
    et si vous avez activé les modules <application>OpenLDAP</application>.</para>

    <para><option>--with-dbm=db45 --with-berkeley-db</option>&nbsp;: Utilisez
    ces paramètres si vous avez besoin du support
    <application>Berkeley DB</application> dans la version incluse de
    <application>APR-util</application> (requis pour le support de la fondation
    <application>Berkeley DB</application> dans
    <application>Subversion</application>).</para>

    <para><command>chown root:root ...</command>&nbsp;: Cette commande modifie
    l'appartenance de certains fichiers installés, le résultat de la construction
    du paques appartenant à un utilisateur différent de
    <systemitem class="username">root</systemitem>.</para>

    <para><command>chown -R apache:apache /srv/www</command>&nbsp;: Par défaut,
    le processus d'installation installe des fichierss (documentation, messages
    d'erreur, icônes par défaut, etc.) avec l'appartenance à l'utilisateur qui a
    extrait les fichiers du fichier tar. Si vous voulez modifier l'appartenance
    pour un autre utilisateur, vous devriez le faire à ce moment. La seule
    exigence est que les répertoires de document doivent être accessibles pour
    le processus <command>httpd</command> avec les droits
    (r-x) et les fichiers doivent être lisibles (r--) par l'utilisateur
    <systemitem class="username">apache</systemitem>.</para>

  </sect2>

  <sect2 role="configuration">
    <title>Configuration d'Apache</title>

    <sect3 id="apache-config">
      <title>Fichiers de configuration</title>

      <para><filename>/etc/apache/*</filename></para>

      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-apache">/etc/apache/*</primary>
      </indexterm>

      <indexterm zone="apache apache-config">
        <primary sortas="e-etc-apache-httpd.conf">/etc/apache/httpd.conf</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Le fichier de configuration principal se nomme
      <filename>/etc/apache/httpd.conf</filename>. Modifiez-le pour que le
      serveur HTTP se lance en tant qu'utilisateur et groupe dédiés&nbsp;:</para>

<screen role="root"><userinput>sed -i -e "s/User daemon/User apache/" \
       -e "s/Group daemon/Group apache/" \
    /etc/apache/httpd.conf</userinput></screen>

      <para>Voir <ulink url="http://httpd.apache.org/docs-2.2/configuring.html"/>
      pour des instructions détaillées sur la personnalisation de votre fichier
      configuration du servur HTTP <application>Apache</application>.</para>

<!--
      <para>There's a problem with the ISAPI DSO module caused from compiling
      with <application>GCC</application>-&gcc-version;. If you included the
      parameter to build the module, comment out the module's load command
      in the configuration file with the following command:</para>

<screen role="root"><userinput>sed -i "s/^LoadModule isapi_module/# &amp;/" \
    /etc/apache/httpd.conf</userinput></screen>
-->
    </sect3>

    <sect3  id="apache-init">
      <title>Script de démarrage</title>

      <para>Si vous voulez que le serveur <application>Apache</application> 
      démarre automatiquement quand le système se lance, installez le script
      de démarrage <filename>/etc/rc.d/init.d/apache</filename> inclu dans le
      paquet <xref linkend="bootscripts"/>.</para>

      <indexterm zone="apache apache-init">
        <primary sortas="f-apache">apache</primary>
      </indexterm>

<screen role="root"><userinput>make install-apache</userinput></screen>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>ab, apachectl, apr-config, apu-config, apxs, checkgid, dbmmanage,
        htdbm, htdigest, htpasswd, httpd, instdso.sh, logresolve, et
        rotatelogs</seg>
        <seg>libapr-1.{so,a}, libaprutil-1.{so,a}, et /usr/lib/apache/*.so</seg>
        <seg>/etc/apache, /srv/www, /usr/include/apache, /usr/lib/apache, et
        /var/log/apache</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="ab">
        <term><command>ab</command></term>
        <listitem>
          <para>est un outil d'évaluation de votre serveur HTTP
          <application>Apache</application>.</para>
          <indexterm zone="apache ab">
            <primary sortas="b-ab">ab</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apachectl">
        <term><command>apachectl</command></term>
        <listitem>
          <para>est une interface avec le serveur HTTP <application>Apache</application>
          conçue pour aider l'administrateur à contrôler le fonctionnement du
          démon httpd d'<application>Apache</application>.</para>
          <indexterm zone="apache apachectl">
            <primary sortas="b-apachectl">apachectl</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="apxs">
        <term><command>apxs</command></term>
        <listitem>
          <para>est un outil pour construire et installer les modules pour le
          serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache apxs">
            <primary sortas="b-apxs">apxs</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="dbmanage">
        <term><command>dbmanage</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers au format 
          DBM utilisés pour stocker les noms d'utilisateur et les mots de passe
          pour l'authentication de base des utilisateurs HTTP.</para>
          <indexterm zone="apache dbmanage">
            <primary sortas="b-dbmanage">dbmanage</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htdigest">
        <term><command>htdigest</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats 
          utilisés pour stocker les noms d'utilisateur, les realms et les mots 
          de passe pour une authentication digest des utilisateurs HTTP.</para>
          <indexterm zone="apache htdigest">
            <primary sortas="b-htdigest">htdigest</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="htpasswd">
        <term><command>htpasswd</command></term>
        <listitem>
          <para>est utilisé pour créer et mettre à jour les fichiers plats 
          utilisés pour stocker les noms d'utilisateur et les mots de passe pour
          une authentication des utilisateurs HTTP.</para>
          <indexterm zone="apache htpasswd">
            <primary sortas="b-htpasswd">htpasswd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="httpd">
        <term><command>httpd</command></term>
        <listitem>
          <para>est le serveur HTTP <application>Apache</application>.</para>
          <indexterm zone="apache httpd">
            <primary sortas="b-httpd">httpd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="instdso.sh">
        <term><command>instdso.sh</command></term>
        <listitem>
          <para>est un script qui installe les modules DSO
          <application>Apache</application>.</para>
          <indexterm zone="apache instdso.sh">
            <primary sortas="b-instdso.sh">instdso.sh</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="logresolve">
        <term><command>logresolve</command></term>
        <listitem>
          <para>est un programme de post-traitement pour résoudre des adresses
          IP dans des fichiers journaux d'accès d'<application>Apache</application>.</para>
          <indexterm zone="apache logresolve">
            <primary sortas="b-logresolve">logresolve</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="rotatelogs">
        <term><command>rotatelogs</command></term>
        <listitem>
          <para>est un programme simple pour une utilisation conjointe avec la
          fonctionnalité de redirection du fichier journal
           d'<application>Apache</application>.</para>
          <indexterm zone="apache rotatelogs">
            <primary sortas="b-rotatelogs">rotatelogs</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
