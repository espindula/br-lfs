<sect2>
<title>Configurer postfix</title>

<sect3><title>Fichiers de configuration</title>
<para><userinput>/etc/aliases, /etc/postfix/main.cf</userinput> et
<userinput>/etc/postfix/master.cf</userinput></para>
</sect3>

<sect3><title>Informations de configuration</title>

<para><screen><userinput>cat &gt; /etc/aliases &lt;&lt; "EOF"</userinput>
# Début /etc/aliases

MAILER-DAEMON:    postmaster
postmaster:       root

root:             LOGIN
# Fin /etc/aliases
<userinput>EOF</userinput></screen></para>

<para>Le fichier /etc/aliases qui vient juste d'être créé, le main.cf et le
master.cf doivent être personnalisés pour votre système. Le fichier aliases a
besoin de connaître l'identité de votre login non-root pour que les messages
adressées à root vous soient transférés au niveau simple utilisateur. Le fichier
main.cf a besoin de votre nom d'hôte pleinement qualifié. master.cf doit être
modifié pour empêcher votre machine de devenir un relais pour des entités non
autorisées. Toutes ces éditions peuvent être faites avec des commandes sed
entrées à la console avec des substitutions de votre nom de login différent de
root par [utilisateur] et de votre nom d'hôte pleinement qualifié par
[localhost.localdomain]. Ces éditions vont créer un système de mail sur un
hôte seul, d'autres éditions sont nécessaires pour modifier les nombreuses
autres options disponibles. Vous trouverez le fichier main.cf auto-documenté,
donc chargez-le sur votre éditeur pour réaliser les modifications que votre
situation exige.</para>

<para><screen><userinput>cp /etc/aliases /etc/aliases.bak
cp /etc/postfix/main.cf /etc/postfix/main.cf.bak
cp /etc/postfix/master.cf /etc/postfix/master.cf.bak
sed "s/LOGIN/[user]/" /etc/aliases.bak > /etc/aliases
sed "s/#myhostname = host.domain.tld/myhostname = \ 
	[localhost.localdomain]/" \
	/etc/postfix/main.cf.bak > /etc/postfix/main.cf
sed '/^smtp.*smtpd$/s/inet/unix/' /etc/postfix/master.cf.bak > \
	/etc/postfix/master.cf
/usr/bin/newaliases
/usr/sbin/postfix start</userinput></screen></para></sect3>

<sect3><title>Script init.d postfix</title>

<para>Pour automatiser le lancement de postfix, utilisez les commandes suivantes
pour créer le script init.d:</para>

<para><screen><userinput>cat &gt; /etc/rc.d/init.d/postfix &lt;&lt; "EOF"</userinput>
#!/bin/sh
# Début $rc_base/init.d/postfix

# Basé sur le script sysklogd de LFS-3.1 et précédents.
# Réécrit par Gerard Beekmans  - gerard@linuxfromscratch.org

source /etc/sysconfig/rc
source $rc_functions

case "$1" in

        start)
        echo "Starting Postfix..."
        loadproc postfix start
        ;;

        stop)
        echo "Stopping Postfix..."
        loadproc postfix stop
        ;;
		
        reload)
        echo "Reloading Postfix..."
        loadproc postfix reload
        ;;

        restart)
        $0 stop
        sleep 1
        $0 start
        ;;

        *)
        echo "Usage: $0 {start|stop|reload|restart}"
        exit 1
        ;;
esac

# Fin $rc_base/init.d/postfix
<userinput>EOF
chmod 755 /etc/rc.d/init.d/postfix</userinput></screen></para>

<para>Créez les liens symboliques vers ce fichier dans le répertoire rc.d avec
les commandes suivantes:

<screen><userinput>cd /etc/rc.d/init.d &amp;&amp;
ln -sf ../init.d/postfix ../rc0.d/K25postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc1.d/K25postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc2.d/K25postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc3.d/S35postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc4.d/S35postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc5.d/S35postfix &amp;&amp;
ln -sf ../init.d/postfix ../rc6.d/K25postfix</userinput></screen></para>
</sect3>

</sect2>
