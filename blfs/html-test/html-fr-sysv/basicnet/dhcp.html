<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      DHCP-4.4.2-P1
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;14.&nbsp;Se connecter à un réseau
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="dhcpcd.html" title=
          "dhcpcd-9.4.0">Précédent</a>
          <p>
            dhcpcd-9.4.0
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="netprogs.html" title=
          "Programmes de réseau">Suivant</a>
          <p>
            Programmes de réseau
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="connect.html" title=
          "Chapitre&nbsp;14.&nbsp;Se connecter à un réseau">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="dhcp" name="dhcp"></a>DHCP-4.4.2-P1
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à ISC DHCP
        </h2>
        <p>
          Le paquet <span class="application">ISC DHCP</span> contient le
          client et le serveur DHCP. <span class=
          "command"><strong>dhclient</strong></span> (le client) est utile
          pour connecter votre ordinateur à un réseau utilisant DHCP pour
          attribuer des adresses réseau. <span class=
          "command"><strong>dhcpd</strong></span> (le serveur) est utile pour
          affecter des adresses réseau sur votre réseau privé.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.0
          platform.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://ftp.isc.org/isc/dhcp/4.4.2-P1/dhcp-4.4.2-P1.tar.gz">https://ftp.isc.org/isc/dhcp/4.4.2-P1/dhcp-4.4.2-P1.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=
                "ftp://ftp.isc.org/isc/dhcp/4.4.2-P1/dhcp-4.4.2-P1.tar.gz">ftp://ftp.isc.org/isc/dhcp/4.4.2-P1/dhcp-4.4.2-P1.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                3089a1ebd20a802ec0870ae337d43907
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 9.4&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 115&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0.4&nbsp;SBU
              </p>
            </li>
          </ul>
        </div>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/dhcp">https://wiki.linuxfromscratch.org/blfs/wiki/dhcp</a>
        </p>
      </div>
      <div class="kernel" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="dhcp-kernel" name="dhcp-kernel"></a>Configuration du noyau
        </h2>
        <p>
          Vous devez avoir la prise en charge de Packet Socket. Celle d'IPv6
          est facultative.
        </p>
        <pre class="screen"><code class=
        "literal">[*] Networking support ---&gt;        [CONFIG_NET]
      Networking options ---&gt;
        &lt;*&gt; Packet socket          [CONFIG_PACKET]
        &lt;*&gt; The IPv6 Protocol ---&gt; [CONFIG_IPV6]</code></pre>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de ISC DHCP
        </h2>
        <p>
          Tout d'abord, corrigez un problème de construction avec GCC 10 et
          supérieur&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -i '/o.*dhcp_type/d' server/mdb.c &amp;&amp;
sed -r '/u.*(local|remote)_port/d'    \
    -i client/dhclient.c              \
       relay/dhcrelay.c</kbd></pre>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Ce paquet ne supporte pas la compilation parallèle.
          </p>
        </div>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Faite attention avec les instructions qui suivent. Les guillemets
            simples et doubles sont importants car les variables définies
            sont utilisées mot pour mot dans le code.
          </p>
        </div>
        <p>
          Installez <span class="application">ISC DHCP</span> en lançant les
          commandes suivantes&nbsp;:
        </p>
        <pre class="userinput">
<kbd class=
"command">( export CFLAGS="${CFLAGS:--g -O2} -Wall -fno-strict-aliasing                 \
        -D_PATH_DHCLIENT_SCRIPT='\"/usr/sbin/dhclient-script\"'     \
        -D_PATH_DHCPD_CONF='\"/etc/dhcp/dhcpd.conf\"'               \
        -D_PATH_DHCLIENT_CONF='\"/etc/dhcp/dhclient.conf\"'"        &amp;&amp;

./configure --prefix=/usr                                           \
            --sysconfdir=/etc/dhcp                                  \
            --localstatedir=/var                                    \
            --with-srv-lease-file=/var/lib/dhcpd/dhcpd.leases       \
            --with-srv6-lease-file=/var/lib/dhcpd/dhcpd6.leases     \
            --with-cli-lease-file=/var/lib/dhclient/dhclient.leases \
            --with-cli6-lease-file=/var/lib/dhclient/dhclient6.leases
) &amp;&amp;
make -j1</kbd></pre>
        <p>
          Ce paquet n'est pas fourni avec une suite de tests.
        </p>
        <p>
          Si vous ne souhaitez installer que le client <span class=
          "application">ISC DHCP</span>, lancez les commandes suivantes en
          tant qu'utilisateur <code class="systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">make -C client install             &amp;&amp;
install -v -m755 client/scripts/linux /usr/sbin/dhclient-script</kbd></pre>
        <p>
          Passez à la section intitulée <a class="xref" href=
          "dhcp.html#dhclient-config" title="Configuration du client">la
          section intitulée «&nbsp;Configuration du client&nbsp;»</a> pour
          configurer le client
        </p>
        <p>
          Si vous ne voulez installer que le serveur <span class=
          "application">ISC DHCP</span>, lancez la commande suivante en tant
          qu'utilisateur <code class="systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">make -C server install</kbd></pre>
        <p>
          Passez à la section intitulée <a class="xref" href=
          "dhcp.html#dhcpd-config" title="Configuration du serveur">la
          section intitulée «&nbsp;Configuration du serveur&nbsp;»</a> pour
          configurer le serveur.
        </p>
        <p>
          Vous pouvez aussi installer tout le paquet, incluant le client, le
          serveur, le relai, les bibliothèques statiques et les en-têtes de
          développement, en lançant les commandes suivantes en tant
          qu'utilisateur <code class="systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
install -v -m755 client/scripts/linux /usr/sbin/dhclient-script</kbd></pre>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration d'ISC DHCP
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dhcp-config" name="dhcp-config"></a>Fichiers de
            configuration
          </h3>
          <p>
            <code class="filename">/etc/dhcp/dhclient.conf</code> et
            <code class="filename">/etc/dhcp/dhcpd.conf</code>
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dhclient-config" name="dhclient-config"></a>Configuration
            du client
          </h3>
          <p>
            Créez un <code class="filename">/etc/dhcp/dhclient.conf</code> de
            base en lançant la commande suivante en tant qu'utilisateur
            <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">install -vdm755 /etc/dhcp &amp;&amp;
cat &gt; /etc/dhcp/dhclient.conf &lt;&lt; "EOF"
<code class="literal"># Begin /etc/dhcp/dhclient.conf
#
# Basic dhclient.conf(5)

#prepend domain-name-servers 127.0.0.1;
request subnet-mask, broadcast-address, time-offset, routers,
        domain-name, domain-name-servers, domain-search, host-name,
        netbios-name-servers, netbios-scope, interface-mtu,
        ntp-servers;
require subnet-mask, domain-name-servers;
#timeout 60;
#retry 60;
#reboot 10;
#select-timeout 5;
#initial-interval 2;

# End /etc/dhcp/dhclient.conf</code>
EOF</kbd></pre>
          <p>
            Voir <span class="command"><strong>man 5
            dhclient.conf</strong></span> pour des options supplémentaires.
          </p>
          <p>
            Maintenant, créez le répertoire <code class=
            "filename">/var/lib/dhclient</code> qui contiendra les baux du
            client DHCP en lançant la commande suivante en tant
            qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">install -v -dm 755 /var/lib/dhclient</kbd></pre>
          <p>
            Maintenant, vous pouvez tester si <span class=
            "command"><strong>dhclient</strong></span> se comporte comme
            prévu en lançant la commande suivante en tant qu'utilisateur
            <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class="command">dhclient <em class=
          "replaceable"><code>&lt;eth0&gt;</code></em></kbd></pre>
          <p>
            Remplacez <em class="replaceable"><code>&lt;eth0&gt;</code></em>
            par votre interface désirée. Si vous voulez une sortie plus
            verbeuse, ajoutez le paramètre <span class=
            "command"><strong>-v</strong></span> à la commande ci-dessus.
          </p>
          <p>
            <a id="dhclient-service" name="dhclient-service"></a> Si vous
            voulez configurer des interfaces réseaux au démarrage en
            utilisant <span class="command"><strong>dhclient</strong></span>,
            vous devez installer le script <code class=
            "filename">/lib/services/dhclient</code> inclus dans le paquet
            <a class="xref" href="../introduction/bootscripts.html" title=
            "Scripts de démarrage BLFS">blfs-bootscripts-20210826</a>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">make install-service-dhclient</kbd></pre>
          <p>
            <a id="dhclient-ifconfig" name="dhclient-ifconfig"></a> Ensuite,
            créez le fichier de configuration <code class=
            "filename">/etc/sysconfig/ifconfig.eth0</code> avec les commandes
            suivantes en tant qu'utilisateur <code class=
            "systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/sysconfig/ifconfig.eth0 &lt;&lt; "EOF"
<code class="literal">ONBOOT="yes"
IFACE="eth0"
SERVICE="dhclient"
DHCP_START=""
DHCP_STOP=""

# Set PRINTIP="yes" to have the script print
# the DHCP assigned IP address
PRINTIP="no"

# Set PRINTALL="yes" to print the DHCP assigned values for
# IP, SM, DG, and 1st NS. This requires PRINTIP="yes".
PRINTALL="no"</code>
EOF</kbd></pre>
          <p>
            Ajustez le fichier pour correspondre à vos besoins.
          </p>
          <p>
            Pour plus d'informations sur les bonnes valeurs de <code class=
            "envar">DHCP_START</code> et <code class=
            "envar">DHCP_STOP</code>, voir <span class="command"><strong>man
            8 dhclient</strong></span>.
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            <a id="dhcpd-config" name="dhcpd-config"></a>Configuration du
            serveur
          </h3>
          <p>
            Remarquez que vous n'avez du serveur DHCP que si vous voulez
            donner des adresses LAN sur votre réseau. Le client DHCP n'a pas
            besoin de serveur pour bien fonctionner.
          </p>
          <p>
            Commencez par créer <code class=
            "filename">/etc/dhcp/dhcpd.conf</code> en lançant la commande
            suivante en tant qu'utilisateur <code class=
            "systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/dhcp/dhcpd.conf &lt;&lt; "EOF"
<code class="literal"># Begin /etc/dhcp/dhcpd.conf
#
# Example dhcpd.conf(5)

# Use this to enable / disable dynamic dns updates globally.
ddns-update-style none;

# option definitions common to all supported networks...
option domain-name "example.org";
option domain-name-servers ns1.example.org, ns2.example.org;

default-lease-time 600;
max-lease-time 7200;

# This is a very basic subnet declaration.
subnet 10.254.239.0 netmask 255.255.255.224 {
  range 10.254.239.10 10.254.239.20;
  option routers rtr-239-0-1.example.org, rtr-239-0-2.example.org;
}

# End /etc/dhcp/dhcpd.conf</code>
EOF</kbd></pre>
          <p>
            Ajustez le fichier pour correspondre à vos besoins. Voir
            <span class="command"><strong>man 5 dhcpd.conf</strong></span>
            pour des options supplémentaires.
          </p>
          <p>
            Créez maintenant le répertoire <code class=
            "filename">/var/lib/dhcpd</code> qui contiendra les interfaces du
            serveur DHCP en lançant la commande suivante en tant
            qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">install -v -dm 755 /var/lib/dhcpd</kbd></pre>
          <p>
            Si vous voulez démarrer le serveur DHCP au démarrage, installez
            <span class="phrase">le script de démarrage <code class=
            "filename">/etc/rc.d/init.d/dhcpd</code> inclus</span> dans le
            paquet <a class="xref" href="../introduction/bootscripts.html"
            title=
            "Scripts de démarrage BLFS">blfs-bootscripts-20210826</a>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">make install-dhcpd</kbd></pre>
          <p>
            Vous devrez éditer <span class="phrase"><code class=
            "filename">/etc/sysconfig/dhcpd</code></span> pour régler
            l'interface sur laquelle <span class=
            "command"><strong>dhcpd</strong></span> répondra aux requêtes
            DHCP.
          </p>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">dhclient, dhclient-script, dhcpd,
              dhcrelay et omshell</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">libdhcpctl.a et libomapi.a</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/etc/dhcp, /usr/include/dhcpctl,
              /usr/include/isc-dhcp, /usr/include/omapip, /var/lib/dhclient
              et /var/lib/dhcpd</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="dhclient" name="dhclient"></a><span class=
                    "term"><span class=
                    "command"><strong>dhclient</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est l'implémentation du client DHCP
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="dhclient-script" name=
                    "dhclient-script"></a><span class="term"><span class=
                    "command"><strong>dhclient-script</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est utilisé par dhclient pour (re)configurer les
                    interfaces. Il peut faire des modifications
                    supplémentaires en appelant un
                    dhclient-{entry,exit}-hooks personnalisé
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="dhcpd" name="dhcpd"></a><span class=
                    "term"><span class=
                    "command"><strong>dhcpd</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    implémente les requêtes Dynamic Host Configuration
                    Protocol (DHCP, protocole de configuration d'hôte
                    dynamique) et Internet Bootstrap Protocol (BOOTP) pour
                    les adresses réseaux
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="dhcrelay" name="dhcrelay"></a><span class=
                    "term"><span class=
                    "command"><strong>dhcrelay</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    offre un moyen d'accepter des requêtes DHCP et BOOTP sur
                    un sous-réseau sans serveur DHCP et les relayer vers le
                    serveur DHCP d'un autre sous-réseau
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="omshell" name="omshell"></a><span class=
                    "term"><span class=
                    "command"><strong>omshell</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    fournit une façon interactive de se connecter, de
                    chercher et éventuellement de modifier, l'état du serveur
                    ISC DHCP via OMAPI Object Management API (l'API de
                    gestion des objets)
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="dhcpcd.html" title=
          "dhcpcd-9.4.0">Précédent</a>
          <p>
            dhcpcd-9.4.0
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="netprogs.html" title=
          "Programmes de réseau">Suivant</a>
          <p>
            Programmes de réseau
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="connect.html" title=
          "Chapitre&nbsp;14.&nbsp;Se connecter à un réseau">Niveau
          supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
