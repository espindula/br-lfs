<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      make-ca-1.7
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;4.&nbsp;Sécurité
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="vulnerabilities.html" title=
          "Failles de sécurité">Précédent</a>
          <p>
            Failles de sécurité
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="cracklib.html" title=
          "CrackLib-2.9.7">Suivant</a>
          <p>
            CrackLib-2.9.7
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title=
          "Chapitre&nbsp;4.&nbsp;Sécurité">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="make-ca" name="make-ca"></a>make-ca-1.7
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à make-ca
        </h2>
        <p>
          Une Infrastructure à Clés Publiques (PKI) est une méthode pour
          valider l'authenticité d'une entité autrement inconnue au travers
          de réseaux qui ne sont pas de confiance. La PKI fonctionne en
          établissant une chaîne de confiance, plutôt que de faire confiance
          individuellement à chaque hôte ou entité de manière explicite. Pour
          qu'un certificat présenté par une entité distante soit reconnu, le
          certificat doit présenter une chaîne complète de certificats qui
          peuvent être validé en utilisant le certificat racine d'une
          autorité de certification (CA) en laquelle la machine locale a
          confiance.
        </p>
        <p>
          L'établissement de la confiance avec une CA nécessite de valider
          des choses comme l'adresse de la compagnie, la propriété, les
          informations de contact, etc, et de s'assurer que la CA a suivi les
          bonnes pratiques, comme des audits de sécurité périodiques par des
          enquêteurs indépendants et le maintient d'une liste de révocation
          de certificats toujours disponible. Ceci est bien au delà de la
          portée de BLFS (comme pour la plupart des distributions Linux). Le
          magasin de certificats fournit ici est emprunté à la fondation
          Mozilla, qui ont établit une politique d'inclusion très stricte
          décrite <a class="ulink" href=
          "https://www.mozilla.org/en-US/about/governance/policies/security-group/certs/">
          ici</a>.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.0
          platform.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://github.com/djlucas/make-ca/releases/download/v1.7/make-ca-1.7.tar.xz">
                https://github.com/djlucas/make-ca/releases/download/v1.7/make-ca-1.7.tar.xz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 28.5&nbsp;Ko
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme MD5 du téléchargement&nbsp;:
                e0356f5ae5623f227a3f69b5e8848ec6
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 6.6 Mo (avec
                toutes les dépendances à l'exécution)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0.1 SBU (avec
                toutes les dépendances à l'exécution)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de make-ca
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="p11-kit.html" title=
          "p11-kit-0.24.0">p11-kit-0.24.0</a> (requis à l'exécution pour
          générer des banques de certificats à partir d'ancres de confiance)
        </p>
        <h4>
          Facultatives (exécution)
        </h4>
        <p class="optional">
          <a class="xref" href="nss.html" title="NSS-3.69">NSS-3.69</a> (pour
          générer un NSSDB partagé)
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/make-ca">https://wiki.linuxfromscratch.org/blfs/wiki/make-ca</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de make-ca
        </h2>
        <p>
          Le script <span class="application">make-ca</span> téléchargera et
          adaptera les certificats inclus dans le fichier <code class=
          "filename">certdata.txt</code> pour l'utiliser comme ancre de
          confiance dans le module de confiance de <a class="xref" href=
          "p11-kit.html" title="p11-kit-0.24.0">p11-kit-0.24.0</a>. En plus,
          il générera les banques de certificats du système utilisées par les
          application de BLFS (si les applications recommandées et
          facultatives sont présentes sur le système). Tout certificat local
          stocké dans <code class="filename">/etc/ssl/local</code> sera
          importé dans les ancres de confiance et dans les banques de
          certificats générées (en remplaçant la confiance de Mozilla). En
          plus, toute valeur de confiance modifiée sera copiée des ancres de
          confiance vers <code class="filename">/etc/ssl/local</code> avant
          toute mise à jour, ce qui préservera les modifications de valeurs
          de confiance différentes de celles de Mozilla lorsque vous
          utiliserez l'utilitaire <span class=
          "command"><strong>trust</strong></span> de <span class=
          "application">p11-kit</span> pour effectuer des opération sur la
          banque de certificats.
        </p>
        <p>
          Pour installer les divers magasins de certificats, installez le
          script <span class="application">make-ca</span> au bon endroit. En
          tant qu'utilisateur <code class="systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class="command">make install &amp;&amp;
install -vdm755 /etc/ssl/local</kbd></pre>
        <p>
          En tant qu'utilisateur <code class="systemitem">root</code>, après
          l'installation de <a class="xref" href="p11-kit.html" title=
          "p11-kit-0.24.0">p11-kit-0.24.0</a>, téléchargez la banque de
          certificats et préparez-la à être utilisée par le système avec la
          commande suivante&nbsp;:
        </p>
        <div class="admon note">
          <img alt="[Note]" src="../images/note.png" />
          <h3>
            Note
          </h3>
          <p>
            Si vous lancez le script une deuxième fois avec la même version
            de <code class="filename">certdata.txt</code>, par exemple pour
            ajouter des banques supplémentaires parce que le logiciel requis
            est installé, ajoutez l'option <em class=
            "parameter"><code>-r</code></em> à la ligne de commande. Si vous
            créez un paquet, lancez <span class="command"><strong>make-ca
            --help</strong></span> pour voir toutes les options de la ligne
            de commande disponibles.
          </p>
        </div>
        <pre class="root"><kbd class=
        "command">/usr/sbin/make-ca -g</kbd></pre>
        <p>
          Vous devriez mettre à jour régulièrement la banque de certificats
          avec la commande ci-dessus soit manuellement, soit via <span class=
          "phrase">une tâche cron.</span><span class="phrase">Si vous avez
          installé <a class="xref" href="../general/fcron.html" title=
          "Fcron-3.2.1">Fcron-3.2.1</a> et complété la section sur les
          travaux périodiques, exécutez</span> les commandes suivantes, en
          tant qu'utilisateur <code class="systemitem">root</code> pour
          <span class="phrase">créer une tache cron
          hebdomadaire&nbsp;:</span>
        </p>
        <pre class="userinput"><kbd class=
        "command">cat &gt; /etc/cron.weekly/update-pki.sh &lt;&lt; "EOF" &amp;&amp;
<code class="literal">#!/bin/bash
/usr/sbin/make-ca -g</code>
EOF
chmod 754 /etc/cron.weekly/update-pki.sh</kbd></pre>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="make-ca-config" name="make-ca-config"></a>Configuration de
          make-ca
        </h2>
        <p>
          Pour la plupart des utilisateurs, aucune configuration
          supplémentaire n'est nécessaire, cependant le fichier <code class=
          "filename">certdata.txt</code> par défaut fournit par make-ca est
          obtenu à partir de la branche mozilla-release, et est modifié pour
          fournir une révision Mercurial. Ce sera la bonne version pour la
          plupart des systèmes. Il y a plusieurs variantes du fichier
          disponibles à l'utilisation que vous pourriez préférer pour une
          raison ou une autre, incluses dans les produits Mozilla dans ce
          livre. RedHat et OpenSUSE par exemple utilisent la version incluse
          dans <a class="xref" href="nss.html" title="NSS-3.69">NSS-3.69</a>.
          Des emplacements de téléchargement supplémentaires sont disponibles
          dans les liens inclus dans <code class=
          "filename">/etc/make-ca.conf.dist</code>. Copiez simplement ce
          fichier vers <code class="filename">/etc/make-ca.conf</code> et
          modifiez-le comme vous le voulez.
        </p>
        <h3>
          À propos des arguments sur la confiance
        </h3>
        <p>
          Il y a trois types de confiances reconnues par le script
          <span class="application">make-ca</span>, SSL/TLS, S/Mime et
          signature de code. Pour <span class="application">OpenSSL</span>,
          il s'agit de <em class="parameter"><code>serverAuth</code></em>,
          <em class="parameter"><code>emailProtection</code></em> et
          <em class="parameter"><code>codeSigning</code></em> respectivement.
          Si un argument trust en omis, le certificat n'est ni reconnu ni
          rejeté pour ce rôle. Les clients qui utilisent <span class=
          "application">OpenSSL</span> ou <span class=
          "application">NSS</span> rencontrant ce certificat renverront un
          avertissement à l'utilisateur. Les clients qui utilisent
          <span class="application">GnuTLS</span> sans le support de
          <span class="application">p11-kit</span> ne sont pas conscient des
          certificats de confiance. Pour inclure cette CA dans les fichiers
          <code class="filename">ca-bundle.crt</code>, <code class=
          "filename">email-ca-bundle.crt</code> ou <code class=
          "filename">objsign-ca-bundle.crt</code> (les anciens lots de
          <span class="application">GnuTLS</span>), il doit avoir l'argument
          de confiance approprié.
        </p>
        <h3>
          Ajouter des certificats de CA supplémentaires
        </h3>
        <p>
          Le répertoire <code class="filename">/etc/ssl/local</code> est
          disponible pour ajouter des certificats de CA supplémentaires sur
          le système. Par exemple, vous pourriez avoir besoin d'ajouter une
          CA d'une organisation ou d'un gouvernement. Les fichiers de ce
          répertoire doivent être au format de certification de confiance
          d'<span class="application">OpenSSL</span>. Pour créer un
          certificat de confiance <span class="application">OpenSSL</span>
          depuis un fichier normal encodé en PEM, vous devrez ajouter des
          arguments «&nbsp;trust&nbsp;» à la commande <span class=
          "command"><strong>openssl</strong></span> et créer un nouveau
          certificat. Par exemple, si vous souhaitez utiliser les racines
          <a class="ulink" href="http://www.cacert.org/">CAcert</a> pour que
          les deux soient de confiance pour ces trois rôles, les commandes
          suivantes créeront des certificats de confiance OpenSSL approprié
          (à lancer en tant qu'utilisateur <code class=
          "systemitem">root</code> après l'installation de <a class="xref"
          href="../basicnet/wget.html" title=
          "Wget-1.21.1">Wget-1.21.1</a>)&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">wget http://www.cacert.org/certs/root.crt &amp;&amp;
wget http://www.cacert.org/certs/class3.crt &amp;&amp;
openssl x509 -in root.crt -text -fingerprint -setalias "CAcert Class 1 root" \
        -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
        &gt; /etc/ssl/local/CAcert_Class_1_root.pem &amp;&amp;
openssl x509 -in class3.crt -text -fingerprint -setalias "CAcert Class 3 root" \
        -addtrust serverAuth -addtrust emailProtection -addtrust codeSigning \
        &gt; /etc/ssl/local/CAcert_Class_3_root.pem &amp;&amp;
/usr/sbin/make-ca -r -f</kbd></pre>
        <h3>
          Remplacer la confiance de Mozilla
        </h3>
        <p>
          Parfois, il peut arriver que vous ne soyez pas d'accord avec
          l'inclusion d'une autorité de certification particulière. Si vous
          voulez remplacer la confiance par défaut d'une CA particulière,
          créez simplement une copie du certificat existant dans <code class=
          "filename">/etc/ssl/local</code> avec des arguments de confiances
          différents. Par exemple, si vous ne voulez pas faire confiance au
          fichier «&nbsp;Makebelieve_CA_Root&nbsp;», lancez les commandes
          suivantes&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">openssl x509 -in /etc/ssl/certs/Makebelieve_CA_Root.pem \
             -text \
             -fingerprint \
             -setalias "Disabled Makebelieve CA Root" \
             -addreject serverAuth \
             -addreject emailProtection \
             -addreject codeSigning \
       &gt; /etc/ssl/local/Disabled_Makebelieve_CA_Root.pem &amp;&amp;
/usr/sbin/make-ca -r -f</kbd></pre>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">make-ca</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoires installés:</strong>
              <span class="segbody">/etc/ssl/{certs,local} et
              /etc/pki/{nssdb,anchors,tls/{certs,java}}</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="make-ca-bin" name="make-ca-bin"></a><span class=
                    "term"><span class=
                    "command"><strong>make-ca</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un script shell qui adapte une version actuelle de
                    <code class="filename">certdata.txt</code> et le prépare
                    pour l'utiliser comme banque de confiance du système
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="vulnerabilities.html" title=
          "Failles de sécurité">Précédent</a>
          <p>
            Failles de sécurité
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="cracklib.html" title=
          "CrackLib-2.9.7">Suivant</a>
          <p>
            CrackLib-2.9.7
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="security.html" title=
          "Chapitre&nbsp;4.&nbsp;Sécurité">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
