<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      fop-2.6
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;50.&nbsp;PostScript
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="epdfview.html" title=
          "ePDFView-0.1.8">Précédent</a>
          <p>
            ePDFView-0.1.8
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="mupdf.html" title="MuPDF-1.18.0">Suivant</a>
          <p>
            MuPDF-1.18.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="ps.html" title=
          "Chapitre&nbsp;50.&nbsp;PostScript">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="fop" name="fop"></a>fop-2.6
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction à fop
        </h2>
        <p>
          Le paquet <span class="application">FOP</span> (Formatting Objects
          Processor) contient un formateur d'impression guidé par les objets
          de formatage XSL (XSL-FO). C'est une application <span class=
          "application">Java</span> qui lit une arborescence d'objets de
          formatage et qui produit les pages qui en résultent vers une sortie
          spécifique. Les formats de sortie actuellement supportés
          comprennent le PDF, PCL, PostScript, SVG, XML (représentation en
          arborescence de zone), print, AWT, MIF et le texte ASCII. La cible
          de sortie principale est le PDF.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.0
          platform.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Téléchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://archive.apache.org/dist/xmlgraphics/fop/source/fop-2.6-src.tar.gz">
                https://archive.apache.org/dist/xmlgraphics/fop/source/fop-2.6-src.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Téléchargement (FTP)&nbsp;: <a class="ulink" href=""></a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrôle MD5 du téléchargement&nbsp;:
                1d6bc84d2ab7f971bbc628080e3c307f
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du téléchargement&nbsp;: 26 Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 522 Mo (dont les
                fichiers téléchargés dans le répertoire personnel de
                l'utilisateur qui construit)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0.4&nbsp;SBU
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Téléchargements supplémentaires
        </h3>
        <div class="itemizedlist">
          <p class="title">
            <strong>Téléchargements supplémentaires requis&nbsp;:</strong>
          </p>
          <ul class="compact">
            <li class="listitem">
              <p>
                PDFBox&nbsp;:<br />
                <a class="ulink" href=
                "http://archive.apache.org/dist/pdfbox/2.0.24/pdfbox-2.0.24.jar">
                http://archive.apache.org/dist/pdfbox/2.0.24/pdfbox-2.0.24.jar</a><br />

                9e97fc59c662738a5fb82dcc447d1e2f<br />
                2.7&nbsp;Mo<br />
              </p>
            </li>
            <li class="listitem">
              <p>
                Polices PDFBox&nbsp;:<br />
                <a class="ulink" href=
                "http://archive.apache.org/dist/pdfbox/2.0.24/fontbox-2.0.24.jar">
                http://archive.apache.org/dist/pdfbox/2.0.24/fontbox-2.0.24.jar</a><br />

                6c2066df0d706d85e950fe8c73d52ed8<br />
                1.5 Mo<br />
              </p>
            </li>
            <li class="listitem">
              <p>
                Système de construction Maven&nbsp;:<br />
                <a class="ulink" href=
                "http://archive.apache.org/dist/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz">
                http://archive.apache.org/dist/maven/maven-3/3.6.3/binaries/apache-maven-3.6.3-bin.tar.gz</a><br />

                9792c717f5845d952907d5144b8253c3<br />
                9.1 Mo (en plus, environ 82 Mo sont téléchargés das le
                répertoire personnel de l'utilisateur qui construit)<br />
              </p>
            </li>
          </ul>
        </div>
        <div class="itemizedlist">
          <p class="title">
            <strong>Paquets recommandés</strong>
          </p>
          <ul class="compact">
            <li class="listitem">
              <p>
                Les patrons de césure OFFO (Objets pour formater des
                objets)&nbsp;:<br />
                <a class="ulink" href=
                "https://downloads.sourceforge.net/offo/2.2/offo-hyphenation.zip">
                https://downloads.sourceforge.net/offo/2.2/offo-hyphenation.zip</a><br />

                bf9c09bf05108ef9661b8f08d91c2336<br />
                862 Ko<br />
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de fop
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="../general/apache-ant.html" title=
          "apache-ant-1.10.11">apache-ant-1.10.11</a>
        </p>
        <h4>
          Facultatives
        </h4>
        <p class="optional">
          <a class="xref" href="../x/installing.html" title=
          "Chapitre&nbsp;24.&nbsp;Environnement X Window System">Système X
          Window</a> (pour lancer les tests), <a class="ulink" href=
          "http://jai-tools.blogspot.com/">JAI Image I/O Tools</a> et
          <a class="ulink" href="http://jeuclid.sourceforge.net/">JEuclid</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/fop">https://wiki.linuxfromscratch.org/blfs/wiki/fop</a>
        </p>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de fop
        </h2>
        <p>
          Assurez-vous que <code class="envar">$JAVA_HOME</code> est
          correctement paramétré avant de commencer la construction. Pour
          construire les classes d'extension <span class="application">JIMI
          SDK</span> et <span class="application">XMLUnit</span>,
          assurez-vous que les fichiers <code class="filename">.jar</code>
          correspondants peuvent être trouvés par la variable d'environnement
          <code class="envar">CLASSPATH</code>.
        </p>
        <div class="sect3">
          <h3 class="sect3">
            Installation des patrons de césure OFFO
          </h3>
          <p>
            Copiez les patrons de césure XML dans l'arborescence des sources
            de fop en lançant les commandes suivantes&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">unzip ../offo-hyphenation.zip &amp;&amp;
cp offo-hyphenation/hyph/* fop/hyph &amp;&amp;
rm -rf offo-hyphenation</kbd></pre>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            Installer un binaire Maven temporaire
          </h3>
          <p>
            À partir de fop-2.5, le système de construction Maven est requis.
            Nous utilisons le binaire fournit par apache, que nous installons
            à un emplacement temporaire&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">tar -xf ../apache-maven-3.6.3-bin.tar.gz -C /tmp</kbd></pre>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            Installer les composants fop
          </h3>
          <p>
            La commande <span class="command"><strong>javadoc</strong></span>
            venant avec OpenJDK 10 et suivants est devenue plus stricte
            qu'avant à propos de la conformité des commentaires javadoc dans
            le code source vers l'HTML. La documentation de FOP ne respecte
            pas ces standards, aussi les tests de conformité ont été
            désactivés. Cela peut être fait avec la commande suivante&nbsp;:
          </p>
          <pre class="userinput"><kbd class="command">sed -i '\@&lt;/javad@i\
&lt;arg value="-Xdoclint:none"/&gt;\
&lt;arg value="--allow-script-in-comments"/&gt;\
&lt;arg value="--ignore-source-errors"/&gt;' \
    fop/build.xml</kbd></pre>
          <p>
            Corrigez la construction avec JDK-16 à cause d'un greffon Apache
            Maven trop vieux&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">sed -i 's/&lt;war.plugin.version&gt;2.2/&lt;war.plugin.version&gt;3.3.1/' pom.xml</kbd></pre>
          <p>
            Le fichier <code class="filename">build.xml</code> appelle une
            ancienne version des composants <span class=
            "application">PDFBox</span> qui ne sont plus disponibles. Copiez
            les composants PDFBox récents dans l'arborescence des
            sources&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">cp ../{pdf,font}box-2.0.24.jar fop/lib</kbd></pre>
          <p>
            Compilez <span class="application">fop</span> en lançant les
            commandes suivantes&nbsp;:
          </p>
          <pre class="userinput"><kbd class="command">cd fop &amp;&amp;

LC_ALL=en_US.UTF-8                     \
PATH=$PATH:/tmp/apache-maven-3.6.3/bin \
ant all javadocs &amp;&amp;

mv build/javadocs .</kbd></pre>
          <p>
            Ce paquet possède une suite de tests, mais l'infrastructure java
            installée dans ce livre ne permet pas de les lancer.
          </p>
          <p>
            Maintenant, installez <span class="application">Fop</span> en
            tant qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">install -v -d -m755 -o root -g root          /opt/fop-2.6 &amp;&amp;
cp -vR build conf examples fop* javadocs lib /opt/fop-2.6 &amp;&amp;
chmod a+x /opt/fop-2.6/fop                                &amp;&amp;
ln -v -sfn fop-2.6 /opt/fop</kbd></pre>
          <p>
            Il reste à nettoyer ce que nous avons fait&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">rm -rf /tmp/apache-maven-3.6.3</kbd></pre>
        </div>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <span class="command"><strong>sed -i ...
          build.xml</strong></span>&nbsp;: cela ajoute deux paramètres à la
          commande <span class="command"><strong>javadoc</strong></span>,
          empêchant certaines erreurs de se produire en construisant la
          documentation.
        </p>
        <p>
          <span class="command"><strong>export
          LC_ALL=en_US.UTF-8</strong></span>&nbsp;: le compilateur échoue si
          vous utilisez une locale ASCII.
        </p>
        <p>
          <span class="command"><strong>ant <code class=
          "option">target</code></strong></span>&nbsp;: Ceci lit le fichier
          <code class="filename">build.xml</code> et construit la
          cible&nbsp;: <code class="option">compile</code> compile les
          sources java, <code class="option">jar-main</code> génère les
          archives jar, <code class="option">jar-hyphenation</code> génère
          les patrons de césure pour FOP, <code class="option">junit</code>
          lance les tests <span class="application">junit</span> et
          <code class="option">javadocs</code> construit la documentation. La
          cible <code class="option">all</code> lance toutes les cibles
          précédentes.
        </p>
        <p>
          <span class="command"><strong>ln -v -sf fop-2.6
          /opt/fop</strong></span>&nbsp;: Ceci est facultatif et crée un lien
          symbolique pratique pour que <code class="envar">$FOP_HOME</code>
          n'ait pas besoin d'être changé à chaque changement de version du
          paquet.
        </p>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration de fop
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="fop-config" name="fop-config"></a>Fichiers de
            configuration
          </h3>
          <p>
            <code class="filename">~/.foprc</code>
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            Informations sur la configuration
          </h3>
          <p>
            Utiliser <span class="application">fop</span> pour traiter de
            gros FO (dont les FO dérivés des sources XML de LFS) peut
            conduire à des erreurs de mémoire. À moins d'ajouter un paramètre
            à la commande <span class="command"><strong>java</strong></span>
            utilisée dans le script <span class=
            "command"><strong>fop</strong></span> vous pouvez obtenir des
            messages similaires à ceci&nbsp;:
          </p>
          <p>
            <code class="computeroutput">Exception in thread "main"
            java.lang.OutOfMemoryError: Java heap space</code>
          </p>
          <p>
            Pour éviter de telles erreurs, vous devez passer un argument
            supplémentaire à la commande <span class=
            "command"><strong>java</strong></span> utilisée dans le script
            <span class="command"><strong>fop</strong></span>. Ceci peut se
            faire en créant un fichier <code class="filename">~/.foprc</code>
            (qui est sourcé par le script <span class=
            "command"><strong>fop</strong></span>) et en ajoutant le
            paramètre à la variable d'environnement <code class=
            "envar">FOP_OPTS</code>.
          </p>
          <p>
            Le script <span class="command"><strong>fop</strong></span>
            cherche une variable d'environnement <code class=
            "envar">FOP_HOME</code> pour localiser les bibliothèques de
            classe <span class="application">fop</span>. Vous pouvez créer
            cette variable en utilisant le fichier <code class=
            "filename">~/.foprc</code> aussi. Créez un fichier <code class=
            "filename">~/.foprc</code> avec les commandes suivantes&nbsp;:
          </p>
          <pre class="userinput"><kbd class=
          "command">cat &gt; ~/.foprc &lt;&lt; "EOF"
<code class="literal">FOP_OPTS="-Xmx<em class=
"replaceable"><code>&lt;RAM_Installed&gt;</code></em>m"
FOP_HOME="/opt/fop"</code>
EOF</kbd></pre>
          <p>
            Remplacez <em class=
            "replaceable"><code>&lt;RAM_Installed&gt;</code></em> avec un
            nombre représentant la quantité de RAM installée dans votre
            ordinateur (en mégaoctets). Par exemple, <strong class=
            "userinput"><code>FOP_OPTS="-Xmx768m"</code></strong>.
          </p>
          <p>
            Pour inclure le script <span class=
            "command"><strong>fop</strong></span> dans votre path, mettez à
            jour le profil système avec la commande suivante en tant
            qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt; /etc/profile.d/fop.sh &lt;&lt; "EOF"
<code class="literal"># Begin /etc/profile.d/fop.sh

pathappend /opt/fop

# End /etc/profile.d/fop.sh</code>
EOF</kbd></pre>
          <div class="admon note">
            <img alt="[Note]" src="../images/note.png" />
            <h3>
              Note
            </h3>
            <p>
              L'exécution de <span class=
              "command"><strong>fop</strong></span> peut être assez verbeuse.
              Par défaut le niveau de journalisation est INFO et peut être
              changé en FINEST, FINER, FINE, CONFIG, INFO, WARNING, SEVERE,
              ALL ou OFF. Pour ce faire, éditez <code class=
              "filename">$JAVA_HOME/jre/lib/logging.properties</code> et
              changez les entrées pour <code class="option">.leval</code> et
              <code class=
              "option">java.util.logging.ConsoleHandler.level</code> à la
              valeur désirée.
            </p>
          </div>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contenu
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installés:</strong>
              <span class="segbody">fop</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothèques installées:</strong>
              <span class="segbody">fop.jar et de nombreuses bibliothèques
              support de classes situées dans <code class=
              "filename">/opt/fop/{build,lib}</code>&nbsp;; Les composants
              JAI contiennent libmlib_jai.so, jai_codec.jar, jai_core.jar et
              mlibwrapper_jai.jar</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Répertoire installé:</strong>
              <span class="segbody">/opt/fop-2.6</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="fop-prog" name="fop-prog"></a><span class=
                    "term"><span class=
                    "command"><strong>fop</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est un script enveloppe pour la commande <span class=
                    "command"><strong>java</strong></span> qui initialise
                    l'environnement <span class="application">fop</span> et
                    passe les paramètres requis
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="fop.jar" name="fop.jar"></a><span class=
                    "term"><code class="filename">fop.jar</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    contient toutes les classes <span class=
                    "application">Java</span> de <span class=
                    "application">fop</span>
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="epdfview.html" title=
          "ePDFView-0.1.8">Précédent</a>
          <p>
            ePDFView-0.1.8
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="mupdf.html" title="MuPDF-1.18.0">Suivant</a>
          <p>
            MuPDF-1.18.0
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="ps.html" title=
          "Chapitre&nbsp;50.&nbsp;PostScript">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
