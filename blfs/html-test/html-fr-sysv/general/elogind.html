<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8" />
    <title>
      elogind-246.10
    </title>
    <link rel="stylesheet" type="text/css" href="../stylesheets/lfs.css" />
    <meta name="generator" content="DocBook XSL Stylesheets V1.79.1" />
    <link rel="stylesheet" href="../stylesheets/lfs-print.css" type=
    "text/css" media="print" />
  </head>
  <body class="blfs" id="blfs-r10.1-1007+">
    <div class="navheader">
      <h4>
        Au-delà de Linux<sup>®</sup> From Scratch (édition <span class=
        "phrase">System V)</span> - Version r10.1-1007+
      </h4>
      <h3>
        Chapitre&nbsp;12.&nbsp;Outils systèmes
      </h3>
      <ul>
        <li class="prev">
          <a accesskey="p" href="dbus.html" title=
          "dbus-1.12.20">Précédent</a>
          <p>
            dbus-1.12.20
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="blocaled.html" title=
          "blocaled-0.3">Suivant</a>
          <p>
            blocaled-0.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
    <div class="sect1" lang="fr" xml:lang="fr">
      <h1 class="sect1">
        <a id="elogind" name="elogind"></a>elogind-246.10
      </h1>
      <div class="package" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Introduction elogind
        </h2>
        <p>
          <span class="application">elogind</span> est le
          «&nbsp;logind&nbsp;» du projet <span class=
          "application">systemd</span> extrait pour en faire un démon
          autonome. Il s'intègre avec <a class="xref" href=
          "../postlfs/linux-pam.html" title=
          "Linux-PAM-1.5.1">Linux-PAM-1.5.1</a> pour connaître l'ensemble des
          utilisateurs qui sont connectés sur un système et s'ils sont
          connectés graphiquement, sur la console ou à distance. <span class=
          "application">Elogind</span> expose ces informations via
          l'interface <span class="application">D-Bus</span>
          org.freedesktop.login1 standard, ainsi qu'à travers le système de
          fichier dans la hiérarchie standard de systemd dans <code class=
          "filename">/run/systemd</code>.
        </p>
        <p>
          This package is known to build and work properly using an LFS-11.0
          platform.
        </p>
        <h3>
          Informations sur le paquet
        </h3>
        <div class="itemizedlist">
          <ul class="compact">
            <li class="listitem">
              <p>
                Tlchargement (HTTP)&nbsp;: <a class="ulink" href=
                "https://github.com/elogind/elogind/archive/v246.10/elogind-246.10.tar.gz">
                https://github.com/elogind/elogind/archive/v246.10/elogind-246.10.tar.gz</a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Tlchargement (FTP)&nbsp;: <a class="ulink" href=""></a>
              </p>
            </li>
            <li class="listitem">
              <p>
                Somme de contrle MD5 du tlchargement&nbsp;:
                32ab2201281f14738d9c045f3669c14d
              </p>
            </li>
            <li class="listitem">
              <p>
                Taille du tlchargement&nbsp;: 1.5&nbsp;Mo
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation de l'espace disque requis&nbsp;: 41&nbsp;Mo (avec
                les tests)
              </p>
            </li>
            <li class="listitem">
              <p>
                Estimation du temps de construction&nbsp;: 0,2 SBU (avec
                parallélisme = 4)
              </p>
            </li>
          </ul>
        </div>
        <h3>
          Dépendances de elogind
        </h3>
        <h4>
          Requises
        </h4>
        <p class="required">
          <a class="xref" href="dbus.html" title=
          "dbus-1.12.20">dbus-1.12.20</a>
        </p>
        <h4>
          Recommandes
        </h4>
        <p class="recommended">
          <a class="xref" href="../postlfs/linux-pam.html" title=
          "Linux-PAM-1.5.1">Linux-PAM-1.5.1</a> (requis pour Xorg), <a class=
          "xref" href="../postlfs/polkit.html" title=
          "Polkit-0.119">Polkit-0.119</a> (à l'exécution), <a class="xref"
          href="../pst/docbook.html" title=
          "docbook-xml-4.5">docbook-xml-4.5</a> et <a class="xref" href=
          "../pst/docbook-xsl.html" title=
          "docbook-xsl-nons-1.79.2">docbook-xsl-1.79.2</a> et <a class="xref"
          href="libxslt.html" title="libxslt-1.1.34">libxslt-1.1.34</a> (tous
          trois pour construire les pages de manuel)
        </p>
        <h4>
          Facultatives
        </h4>
        <p class="optional">
          Pour les tests&nbsp;: <a class="xref" href=
          "python-modules.html#lxml" title="lxml-4.6.3">lxml-4.6.3</a>,
          <a class="xref" href="gobject-introspection.html" title=
          "gobject-introspection-1.68.0">gobject-introspection-1.68.0</a>,
          <a class="xref" href="../postlfs/zsh.html" title=
          "zsh-5.8">zsh-5.8</a>, <a class="xref" href="valgrind.html" title=
          "Valgrind-3.17.0">Valgrind-3.17.0</a>, <a class="ulink" href=
          "https://github.com/linux-audit/audit-userspace">audit-userspace</a>,
          <a class="ulink" href=
          "https://github.com/scop/bash-completion">bash-completion</a>,
          <a class="ulink" href=
          "https://mirrors.edge.kernel.org/pub/linux/utils/kernel/kexec/">kexec</a>
          et <a class="ulink" href=
          "http://www.selinuxproject.org/page/Main_Page">SELinux</a>
        </p>
        <p class="usernotes">
          Notes utilisateur&nbsp;: <a class="ulink" href=
          "https://wiki.linuxfromscratch.org/blfs/wiki/elogind">https://wiki.linuxfromscratch.org/blfs/wiki/elogind</a>
        </p>
      </div>
      <div class="kernel" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          <a id="elogind-kernel" name="elogind-kernel"></a>Configuration du
          noyau
        </h2>
        <p>
          Activez les options suivantes dans la configuration du noyau et
          recompilez le noyau si nécessaire&nbsp;:
        </p>
        <pre class="screen">
<code class="literal">General setup ---&gt;
    [*]     Control Group support                        [CONFIG_CGROUPS]
File systems ---&gt;
    [*]     Inotify support for userspace                [CONFIG_INOTIFY_USER]
            Pseudo filesystems ---&gt;
                [*]    Tmpfs POSIX Access Control Lists  [CONFIG_TMPFS_POSIX_ACL]</code></pre>
        <p>
          En plus, certains tests ont besoin de l'API noyau de cryptographie
          en espace utilisateur qui s'active avec&nbsp;:
        </p>
        <pre class="screen"><code class=
        "literal">-*- Cryptographic API ---&gt;                               [CONFIG_CRYPTO]
   &lt;M/*&gt; Userspace cryptographic algorithm configuration [CONFIG_CRYPTO_USER]
   &lt;M/*&gt; User-space interface for hash algorithms        [CONFIG_CRYPTO_USER_API_HASH]</code></pre>
      </div>
      <div class="installation" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Installation de elogind
        </h2>
        <p>
          Installez <span class="application">elogind</span> en lanant les
          commandes suivantes&nbsp;:
        </p>
        <pre class="userinput"><kbd class=
        "command">sed -i '/Disable polkit/,+8 d' meson.build &amp;&amp;

mkdir build &amp;&amp;
cd    build &amp;&amp;

meson --prefix=/usr                        \
      --buildtype=release                  \
      -Dcgroup-controller=elogind          \
      -Ddbuspolicydir=/etc/dbus-1/system.d \
      -Dman=auto                           \
      ..  &amp;&amp;
ninja</kbd></pre>
        <p>
          Pour tester les résultats, lancez&nbsp;: <span class=
          "command"><strong>ninja test</strong></span>. Quelques tests sont
          passés si vous n'utilisez pas les privilèges <code class=
          "systemitem">root</code>.
        </p>
        <p>
          Maintenant, en tant qu'utilisateur <code class=
          "systemitem">root</code>&nbsp;:
        </p>
        <pre class="root"><kbd class=
        "command">ninja install                                           &amp;&amp;
ln -sfv  libelogind.pc /usr/lib/pkgconfig/libsystemd.pc &amp;&amp;
ln -sfvn elogind /usr/include/systemd</kbd></pre>
      </div>
      <div class="commands" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Explication des commandes
        </h2>
        <p>
          <span class="command"><strong>sed ...
          meson.build</strong></span>&nbsp;: ce changement permet au paquet
          d'être construit sans avoir installé polkit (il est quand même
          requis à l'exécution) mais de lui permettre d'utiliser polkit après
          l'installation du paquet.
        </p>
        <p>
          <em class=
          "parameter"><code>-Dcgroup-controller=elogind</code></em>&nbsp;: ce
          paramètre s'assure qu'<span class="application">elogind</span> est
          choisi comme contrôleur cgroup, même s'il est démarré avec un autre
          contrôleur cgroup.
        </p>
        <p>
          <em class=
          "parameter"><code>-Ddbuspolicydir=/etc/dbus-1/system.d</code></em>&nbsp;:
          ce paramètre choisi l'emplacement du répertoire de politique
          <span class="application">D-Bus</span>.
        </p>
        <p>
          <em class="parameter"><code>-Dman=auto</code></em>&nbsp;: la valeur
          par défaut de ce paramètre est <span class=
          "emphasis"><em>false</em></span>. Le mettre à <span class=
          "emphasis"><em>auto</em></span> permet de construire et d'installer
          les pages de manuel si les dépendances recommandées sont
          installées.
        </p>
        <p>
          <code class=
          "option">-Ddefault-kill-user-processes=false</code>&nbsp;: indique
          si les processus d'un utilisateurs devraient être tués lorsqu'il se
          déconnecte. La valeur par défaut est <span class=
          "emphasis"><em>true</em></span>, mais cela contredit l'utilisation
          traditionnelle de <span class=
          "command"><strong>screen</strong></span> ou <span class=
          "command"><strong>tmux</strong></span>. Cela peut aussi se changer
          dans le fichier de configuration (voir plus bas).
        </p>
        <p>
          <span class="command"><strong>ln -s …</strong></span>&nbsp;: ces
          commandes installent les liens symboliques pour que les paquets
          logiciels trouvent des bibliothèques et des en-têtes compatibles
          avec systemd.
        </p>
      </div>
      <div class="configuration" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Configuration de elogind
        </h2>
        <div class="sect3">
          <h3 class="sect3">
            <a id="elogind-config" name="elogind-config"></a>Fichier de
            configuration
          </h3>
          <p>
            <code class="filename">/etc/elogind/logind.conf</code>
          </p>
        </div>
        <div class="sect3">
          <h3 class="sect3">
            Informations sur la configuration
          </h3>
          <p>
            Le fichier <code class="filename">/etc/elogind/logind.conf</code>
            installé contient toutes les options possibles avec leurs valeurs
            par défaut, commentées. Vous pourriez vouloir désactiver le fait
            de tuer les processus utilisateurs à la déconnexion, en lançant,
            en tant qu'utilisateur <code class=
            "systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">sed -e '/\[Login\]/a KillUserProcesses=no' \
    -i /etc/elogind/logind.conf</kbd></pre>
          <p>
            Chaque utilisateur devra enregistrer une session utilisateur avec
            <span class="application">Linux-PAM</span> à la connexion. Le
            fichier <code class="filename">/etc/pam.d/system-session</code>
            doit être modifié et un nouveau fichier doit être créé pour
            qu'<span class="command"><strong>elogind</strong></span>
            fonctionne correctement. Lancez les commandes suivante en tant
            qu'utilisateur <code class="systemitem">root</code>&nbsp;:
          </p>
          <pre class="root"><kbd class=
          "command">cat &gt;&gt; /etc/pam.d/system-session &lt;&lt; "EOF" &amp;&amp;
<code class="literal"># Begin elogind addition
    
session  required    pam_loginuid.so
session  optional    pam_elogind.so

# End elogind addition</code>
EOF
cat &gt; /etc/pam.d/elogind-user &lt;&lt; "EOF"
<code class="literal"># Begin /etc/pam.d/elogind-user

account  required    pam_access.so
account  include     system-account

session  required    pam_env.so
session  required    pam_limits.so
session  required    pam_unix.so
session  required    pam_loginuid.so
session  optional    pam_keyinit.so force revoke
session  optional    pam_elogind.so

auth     required    pam_deny.so
password required    pam_deny.so

# End /etc/pam.d/elogind-user</code>
EOF</kbd></pre>
        </div>
      </div>
      <div class="content" lang="fr" xml:lang="fr">
        <h2 class="sect2">
          Contents
        </h2>
        <div class="segmentedlist">
          <div class="seglistitem">
            <div class="seg">
              <strong class="segtitle">Programmes installs:</strong>
              <span class="segbody">busctl, elogind-inhibit et
              loginctl</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Bibliothque installe:</strong>
              <span class="segbody">libelogind.so</span>
            </div>
            <div class="seg">
              <strong class="segtitle">Rpertoires installs:</strong>
              <span class="segbody">/lib/elogind, /etc/elogind,
              /usr/include/elogind et /usr/share/doc/elogind-246.10</span>
            </div>
          </div>
        </div>
        <div class="variablelist">
          <h3>
            Descriptions courtes
          </h3>
          <table border="0" class="variablelist">
            <colgroup>
              <col align="left" valign="top" />
              <col />
            </colgroup>
            <tbody>
              <tr>
                <td>
                  <p>
                    <a id="busctl" name="busctl"></a><span class=
                    "term"><span class=
                    "command"><strong>busctl</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est utilisé pour inspecter et surveiller le bus D-Bus
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="elogind-inhibit" name=
                    "elogind-inhibit"></a><span class="term"><span class=
                    "command"><strong>elogind-inhibit</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est utilisé pour exécuter un programme avec un verrou
                    contre l'extinction, la veille ou l'hibernation
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="loginctl" name="loginctl"></a><span class=
                    "term"><span class=
                    "command"><strong>loginctl</strong></span></span>
                  </p>
                </td>
                <td>
                  <p>
                    est utilisé pour inspecter et contrôler l'état du
                    gestionnaire de connexion elogind
                  </p>
                </td>
              </tr>
              <tr>
                <td>
                  <p>
                    <a id="libelogind" name="libelogind"></a><span class=
                    "term"><code class="filename">libelogind.so</code></span>
                  </p>
                </td>
                <td>
                  <p>
                    est la bibliothèque d'utilitaires principale d'elogind
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
      <p class="updated">
        Last updated on
      </p>
    </div>
    <div class="navfooter">
      <ul>
        <li class="prev">
          <a accesskey="p" href="dbus.html" title=
          "dbus-1.12.20">Précédent</a>
          <p>
            dbus-1.12.20
          </p>
        </li>
        <li class="next">
          <a accesskey="n" href="blocaled.html" title=
          "blocaled-0.3">Suivant</a>
          <p>
            blocaled-0.3
          </p>
        </li>
        <li class="up">
          <a accesskey="u" href="sysutils.html" title=
          "Chapitre&nbsp;12.&nbsp;Outils systèmes">Niveau supérieur</a>
        </li>
        <li class="home">
          <a accesskey="h" href="../index.html" title=
          "Au-delà de Linux® From Scratch (édition System V) - Version r10.1-1007+">
          Sommaire</a>
        </li>
      </ul>
    </div>
  </body>
</html>
