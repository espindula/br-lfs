<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY php-download-http "http://www.php.net/distributions/php-&php-version;.tar.xz">
  <!--<!ENTITY php-download-ftp  "ftp://ftp.isu.edu.tw/pub/Unix/Web/PHP/distributions/php-&php-version;.tar.xz">-->
  <!ENTITY php-download-ftp  " ">
  <!ENTITY php-md5sum        "ce5964672e4ec0b66ff088a6bafde8c7">
  <!ENTITY php-size          "11 Mo">
  <!ENTITY php-buildsize     "564 Mo (with the tests). Documentation adds 106 Mo">
  <!ENTITY php-time          "6.3 SBU (with the tests)">
]>
<sect1 id="php" xreflabel="PHP-&php-version;">
  <?dbhtml filename="php.html"?>
  <sect1info>
    <othername>$LastChangedBy&nbsp;: bdubbs $</othername>
    <date>$Date&nbsp;: 2013-03-14 02:39:01 +0100 (Thu, 14 Mar 2013) $</date>
  </sect1info>
  <title>PHP-&php-version;</title>
  <indexterm zone="php">
    <primary sortas="a-PHP">PHP</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à PHP</title>
    <para><application>PHP</application> est le <foreignphrase>PHP Hypertext
    Preprocessor</foreignphrase>. Utilisé à l'origine sur des sites Internet
    dynamiques, il permet au code d'être directement embarqué dans la balise
    HTML. Il sert aussi de langage de script généraliste.</para>
    &lfs78_checked;
    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&php-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&php-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &php-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &php-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &php-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &php-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Documentation précompilée (facultatif)&nbsp;: <ulink
        url="http://www.php.net/download-docs.php"/></para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendances de PHP</bridgehead>
    <bridgehead renderas="sect4">Recommandées</bridgehead>
    <para role="recommended">
      <xref linkend="apache"/> et
      <xref linkend="libxml2"/>
    </para>
    <bridgehead renderas="sect4">Outils et bibliothèques systèmes facultatifs</bridgehead>
    <para role="optional">
      <xref linkend="aspell"/>,
      <xref linkend="enchant"/>,
    <xref linkend="libxslt"/>,
      un <xref linkend="server-mail"/> (qui fournit une commande
      <command>sendmail</command>),
    <xref linkend="pcre"/>,
    <xref linkend="pth"/>,
    <ulink url="http://www.ossp.org/pkg/lib/mm/">OSSP mm</ulink>,
      <ulink url="http://dmalloc.com/">Dmalloc</ulink>,
      <ulink url="http://www.net-snmp.org/">Net-SNMP</ulink>,
      <ulink url="http://re2c.org/">re2c</ulink>, et
      <ulink url="http://xmlrpc-epi.sourceforge.net/main.php?t=php_about">XMLRPC-EPI</ulink>
     </para>
    <bridgehead renderas="sect4">Outils et bibliothèques graphiques facultatifs</bridgehead>
    <para role="optional">
      <xref linkend="freetype2"/>,
      <xref linkend="libexif"/>
    <xref linkend="libjpeg"/>,
      <xref linkend="libpng"/>,
    <xref linkend="libtiff"/>,
    <xref linkend="x-window-system"/>,
      <ulink url="http://www.adobe.com/devnet/acrobat/fdftoolkit.html">FDF Toolkit</ulink>,
      <ulink url="https://bitbucket.org/libgd/gd-libgd/downloads">GD</ulink>, et
      <ulink url="http://fossies.org/linux/misc/t1lib-5.1.2.tar.gz/">t1lib</ulink>
     </para>
    <bridgehead renderas="sect4">Outils Internet facultatifs</bridgehead>
    <para role="optional"><xref linkend="curl"/>,
    <xref linkend="tidy-html"/>,
      <ulink url="http://sourceforge.net/projects/caudium/">Caudium</ulink>,
      <ulink url="http://www.hyperwave.com/">Hyperwave</ulink>,
    <ulink url="http://www.mnogosearch.org/">mnoGoSearch</ulink>,
      <ulink url="http://www.roxen.com/products/webserver/">Roxen WebServer</ulink>, et
    <ulink url="https://wddxnet.codeplex.com/">WDDX</ulink></para>
    <bridgehead renderas="sect4">Outils et bibliothèques de gestion de données facultatifs</bridgehead>
    <para role="optional">
    <xref linkend="db"/>,
    <xref linkend="mariadb"/> ou <ulink url="http://www.mysql.com/">MySQL</ulink>,
    <xref linkend="openldap"/>,
    <xref linkend="postgresql"/>,
    <xref linkend="sqlite"/>,
    <xref linkend="unixodbc"/>,
      <ulink url="http://www.softwareag.com/">Adabas</ulink>,
      <ulink url="http://www.birdstep.com/">Birdstep</ulink>,
       <ulink url="http://cr.yp.to/cdb.html">cdb</ulink>,
      <ulink url="http://www.dbmaker.com/">DBMaker</ulink>,
      <ulink url="http://www.empress.com/">Empress</ulink>,
      <ulink url="http://www.frontbase.com/cgi-bin/WebObjects/FBWebSite">FrontBase</ulink>,
       <ulink url="http://www.hughes.com.au/products/msql/">Mini SQL</ulink>,
      <ulink url="http://www.monetra.com/">Monetra</ulink>, et
      <ulink url="http://sourceforge.net/projects/qdbm">QDBM</ulink>
     </para>
    <para><application>PHP</application> fournit aussi un support pour
    de nombreux outils commerciaux de base de données tels que
    <application>Oracle</application>,
    <application>SAP</application> et
    <application>ODBC Router</application>.</para>
    <bridgehead renderas="sect4">Outils et bibliothèques de sécurité/chiffrement Facultatifs</bridgehead>
    <para role="optional"><xref linkend="openssl"/>,
    <xref linkend="cyrus-sasl"/>,
    <xref linkend="mitkrb"/>,
    <ulink url="http://mcrypt.sourceforge.net/">libmcrypt</ulink> et
    <ulink url="http://mhash.sourceforge.net/">mhash</ulink></para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/php"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de PHP</title>
    <para>Vous pouvez utiliser <application>PHP</application> pour faire
    des scripts côté serveur, des scripts en ligne de commande ou des applications
    graphiques côté client. Ce livre fournit des instructions pour paramétrer
    <application>PHP</application> pour faire des scripts côté serveur car c'est
    sa forme la plus courante.</para>
    <note>
      <para><application>PHP</application> dispose de beaucoup plus d'options
      <command>configure</command> qui activeront le support de divers éléments. Vous
      pouvez utiliser <command>./configure --help</command> pour voir une liste
      complète des options disponibles. En outre, l'utilisation du
      <ulink url="http://www.php.net/">site Internet de PHP</ulink> est fortement
      recommandée vu que leurs docs en ligne sont très bonnes. Vous pouvez
      trouver un exemple d'une commande <command>configure</command> qui utilise
      beaucoup d'éléments parmi les dépendances les plus courantes sur <ulink
      url="&sources-anduin-http;/files/php_configure.txt"/>.
      </para>
      <para>Si, pour une raison quelconque, vous n'avez pas installé <xref linkend="libxml2"/>,
      vous devez ajouter <option>--disable-libxml</option> à la commande
      <command>configure</command> dans les instructions ci-dessous. Remarquez
      que cela empêchera la commande <command>pear</command> d'être construite.</para>
    </note>
     <para>
      Si vous voulez construire <application>PHP</application> avec la bibliothèque
      <application>tidy-html5</application>, à cause de modification dans l'API, dans les sources de 
      <application>PHP</application>, l'entête <filename>buffio.h</filename>
      doit être changé par <filename>tidybuffio.h</filename> dans le fichier <filename>ext/tidy/tidy.c</filename>:
    </para>
<screen><userinput>sed -i 's/buffio.h/tidy&amp;/' ext/tidy/*.c</userinput></screen>
    <para>Installez <application>PHP</application> en
    lançant les commandes suivantes&nbsp;:</para>
<screen>
<userinput>./configure --prefix=/usr                            --sysconfdir=/etc                        --localstatedir=/var                     --datadir=/usr/share/php                 --mandir=/usr/share/man                  --enable-fpm                             --with-fpm-user=apache                   --with-fpm-group=apache                  --with-config-file-path=/etc             --with-zlib                              --enable-bcmath                          --with-bz2                               --enable-calendar                        --enable-dba=shared                      --with-gdbm                              --with-gmp                               --enable-ftp                             --with-gettext                           --enable-mbstring                        --with-readline              &amp;&amp;
make</userinput>
</screen>
    <para>Pour tester les résultats, lancez&nbsp;: <command>make test</command>.
    Quelques tests peuvent échouer, dans certains cas vous serez interrogez si vous voulez envoyer un rapport aux
    developpeurs de PHP. Si vous voulez automatiser les tests, vous pouvez préfixer la commande avec
    <command>yes "n" | </command>.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>make install                                         &amp;&amp;
install -v -m644 php.ini-production /etc/php.ini     &amp;&amp;
mv -v /etc/php-fpm.conf{.default,}                   &amp;&amp;
install -v -m755 -d /usr/share/doc/php-&php-version; &amp;&amp;
install -v -m644    CODING_STANDARDS EXTENSIONS INSTALL NEWS README* UPGRADING* php.gif                     /usr/share/doc/php-&php-version; &amp;&amp;
ln -v -sfn          /usr/lib/php/doc/Archive_Tar/docs/Archive_Tar.txt                     /usr/share/doc/php-&php-version; &amp;&amp;
ln -v -sfn          /usr/lib/php/doc/Structures_Graph/docs                     /usr/share/doc/php-&php-version;</userinput>
</screen>
    <para>La documentation HTML précompilée est emballée sous deux formes&nbsp;:
    un archive tar contenant beaucoup de fichiers individuels, utile pour être
    chargés rapidement dans votre navigateur, et un gros fichier individuel, qui
    est utile pour une utilisation de l'outil de recherche de votre navigateur.
    Si vous avez téléchargé un des deux ou les deux fichiers de documentation,
    exécutez les commandes suivantes en tant qu'utilisateur
    <systemitem class='username'>root</systemitem> pour les installer (remarquez
    que ces instructions supposent des docs en anglais, modifiez le nom des archives
    tar ci-dessous si nécessaire).</para>
    <para>Pour le fichier <quote>Unique en HTML</quote>&nbsp;:</para>
<screen role="root">
<userinput>install -v -m644 ../php_manual_en.html.gz     /usr/share/doc/php-&php-version; &amp;&amp;
gunzip -v /usr/share/doc/php-&php-version;/php_manual_en.html.gz</userinput>
</screen>
    <para>Pour l'archive tar <quote>beaucoup de fichiers HTML</quote>&nbsp;:</para>
<screen role="root">
<userinput>tar -xvf ../php_manual_en.tar.gz     -C /usr/share/doc/php-&php-version; --no-same-owner</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
      <title>Explication des commandes</title>
      <para><parameter>--with-datadir=/usr/share/php</parameter>: Ce travail contourne un bogue
      dans la machine de construction qui installe quelques données dans un mauvais endroit.</para>
      <para><parameter>--enable-fpm</parameter>: Ce paramètre permet de construire
      le gestionnaire de processus fastCGI.</para>
      <para><parameter>--with-config-file-path=/etc</parameter>&nbsp;: Ce
      paramètre amène <application>PHP</application> à chercher le fichier de
      configuration <filename>php.ini</filename> dans
      <filename class='directory'>/etc</filename>.</para>
      <para><parameter>--with-zlib</parameter>&nbsp;: Ce paramètre ajoute le
      support pour la compression <application>Zlib</application>.</para>
      <para><parameter>--enable-bcmath</parameter>&nbsp;: Active les fonctions
      mathématiques <command>bc</command> de précision de style.</para>
      <para><parameter>--with-bz2</parameter>&nbsp;: Ajoute le support pour
      les fonctions <application>Bzip2</application> de compression.</para>
      <para><parameter>--enable-calendar</parameter>&nbsp;: Ce paramètre offre un
      support pour la conversion de calendrier.</para>
      <para><parameter>--enable-dba=shared</parameter>&nbsp;: Ce paramètre active
      le support pour les fonctions de la couche d'abstraction de base de
      données (dbm-style).</para>
      <para><parameter>--enable-ftp</parameter>&nbsp;: Ce paramètre active
      les fonctions FTP.</para>
      <para><parameter>--with-gettext</parameter>&nbsp;: Active les fonctions
      qui utilisent la traduction de texte <application>Gettext</application>.</para>
      <para><parameter>--enable-mbstring</parameter>&nbsp;: Ce paramètre active
      le support des chaînes multioctets.</para>
      <para><parameter>--with-readline</parameter>&nbsp;: Ce paramètre active le
      support <application>Readline</application> en ligne de commande.</para>
      <para><option>--disable-libxml</option>&nbsp;: Cette option permet
      de construire PHP sans que <application>libxml2</application> ne soit
      installé.</para>
      <para><option>--with-apxs2</option>: au lieu de construire le gestionnaire de processus fastCGI
      , il est possible de construire un module <application>apache</application>.
      cela pénalise un peu les performances pour des serveurs fortement chargés, mais peut être plus facile à
      initialiser. Ce paramètre est incompatible avec
      <parameter>--enable-fpm</parameter> et <parameter>--with-fpm-...</parameter>
      .</para>
      <para>
        <option>--with-mysqli=shared</option>: Cette option ajoute le support MySQLi.
      </para>
      <para>
        <option>--with-mysql-sock=/run/mysqld/mysqld.sock</option>: Emplacement du pointeur de socket unix MySQL.
      </para>
      <para>
        <option>--with-pdo-mysql=shared</option>: Cette option ajoute le support PDO: MySQL.
      </para>
      <para>
        <option>--with-tidy=shared</option>: cette option ajoute le support de la bibliothèque tidy.
       </para>

  </sect2>
  <sect2 role="configuration">
    <title>Configuration de PHP</title>
    <sect3 id="php-config">
      <title>Fichiers de configuration</title>
      <para>
      <filename>/etc/php.ini</filename>,
        <filename>/etc/pear.conf</filename>,
        <filename>/etc/php-fpm.conf</filename>, et
        <filename>/etc/php-fpm.d/www.conf</filename>
     </para>
     <indexterm zone="php php-config">
        <primary sortas="e-etc-php.ini">/etc/php.ini</primary>
      </indexterm>
      <indexterm zone="php php-config">
        <primary sortas="e-etc-pear.conf">/etc/pear.conf</primary>
      </indexterm>
       <indexterm zone="php php-config">
        <primary sortas="e-etc-php-fpm.d-www.conf">
        /etc/php-fpm.d/www.conf</primary>
      </indexterm>
      <indexterm zone="php php-config">
        <primary sortas="e-etc-php-fpm.conf">/etc/php-fpm.conf</primary>
      </indexterm>
    </sect3>
    <sect3>
      <title>Informations de configuration</title>
       <para>
       Sans le fichier <filename>/etc/php-fpm.d/www.conf</filename>,
       le gestionnaire de processus ne démarre pas. Cependant, c'est le fichier
       <filename>/etc/php-fpm.d/www.conf.default</filename>, qui est installé. Pour résoudre cela, tapez
      en tant qu'utilisateur
       <systemitem class="username">root</systemitem> :
      </para>
<screen role="root">
<userinput>cp -v /etc/php-fpm.d/www.conf.default /etc/php-fpm.d/www.conf</userinput>
</screen>
      <para>Le fichier utilisé en tant que fichier de configuration
      <filename>/etc/php.ini</filename> par défaut est recommandé par l'équipe
      de développement de <application>PHP</application>. Ce fichier modifie le
      comportement par défaut de <application>PHP</application>. Si vous
      n'utilisez pas de <filename>/etc/php.ini</filename>, tous les paramètres de
      configuration retombent sur ceux par défaut. Vous devriez observer les
      commentaires dans ce fichier et vous assurer que les modifications sont
      acceptables pour votre environnement particulier.</para>
      <para>Il se peut que vous ayez noté la suite de la sortie de la commande
      <command>make install</command>&nbsp;:</para>
<screen>
<computeroutput>You may want to add: /usr/lib/php to your php.ini include_path</computeroutput>
</screen>
      <para>Si désiré, ajoutez l'entrée en utilisant la commande suivante en
      tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>sed -i 's@php/includes"@&amp;ninclude_path = ".:/usr/lib/php"@'     /etc/php.ini</userinput>
</screen>
      <para>Pour activer le support fastCGI dans un serveur web <application>Apache</application>
      , deux directives de chargement LoadModule doivent être ajoutées dans le fichier
      <filename>httpd.conf</filename>. Elles sont commentées, donc il suffit de taper la commande suivante
      en tant qu'utilisateur <systemitem class="username">root</systemitem> :</para>
<screen role="root">
<userinput>sed -i -e '/proxy_module/s/^#//'             -e '/proxy_fcgi_module/s/^#//'        /etc/httpd/httpd.conf</userinput>
</screen>
      <para>Ces modules acceptent différentes directives <command>ProxyPass</command>.
      Une possibilité est (en tant qu'utilisateur
      <systemitem class="username">root</systemitem>):</para>
<screen role="root">
<userinput>echo 'ProxyPassMatch ^/(.*.php)$ fcgi://127.0.0.1:9000/srv/www/$1' >> /etc/httpd/httpd.conf</userinput>
</screen>
      <para>En outre, il peut être utile d'ajouter une entrée pour
      <filename>index.php</filename> à la ligne DirectoryIndex du fichier
      <filename>httpd.conf</filename>. Enfin, l'ajout d'une ligne pour
      paramétrer l'extension <filename class='extension'>.phps</filename> pour
      montrer un surlignement <application>PHP</application> peut être
      désirable&nbsp;:</para>
<screen>
<literal>AddType application/x-httpd-php-source .phps</literal>
</screen>
      <para>Vous devrez redémarrer le serveur Internet <application>Apache</application>
      après avoir apporté une modification au fichier <filename>httpd.conf</filename>.</para>
    </sect3>
    <sect3  id="php-init">
      <title>Script de démarrage</title>
      <para>
        Pour automatiquement démarrer le démon <command>php-fpm</command> quand le système est redémarré,
         installez le script de démarrage e
        <filename>/etc/rc.d/init.d/php</filename> depuis le paquet
        <xref linkend="bootscripts"/> en tant qu'utilisateur
        <systemitem class="username">root</systemitem> :
      </para>
      <indexterm zone="php php-init">
        <primary sortas="f-php">php</primary>
      </indexterm>
<screen role="root">
<userinput>make install-php</userinput>
</screen>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>pear, peardev, pecl, phar (symlink), phar.phar, php,
        php-cgi, php-config, php-fpm, phpdbg, et phpize</seg>
        <seg>dba.{so,a} et opcache.{so,a} dans
       /usr/lib/php/extensions/no-debug-non-zts-20151012</seg>
        <seg>/etc/php-fpm.d, /usr/{include,lib,share}/php et
       /usr/share/doc/php-&php-version;</seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="php-prog">
        <term><command>php</command></term>
        <listitem>
          <para>est une interface en ligne de commande qui vous permet de parser
          et d'exécuter du code PHP.</para>
          <indexterm zone="php php-prog">
            <primary sortas="b-php">php</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="pear">
        <term><command>pear</command></term>
        <listitem>
          <para>est l'extension PHP et le gestionnaire de paquet
          PHP Extension and Application
          Repository (PEAR, dépôt des extensions et des applications PHP).</para>
          <indexterm zone="php pear">
            <primary sortas="b-pear">pear</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="php-fpm">
        <term><command>php-fpm</command></term>
        <listitem>
          <para>est le gestionnaire de processus fastCGI pour PHP.</para>
          <indexterm zone="php php-fpm">
            <primary sortas="b-php-fpm">php-fpm</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="phpdbg">
        <term><command>phpdbg</command></term>
        <listitem>
          <para>
            est le debogueur intéractif de PHP.
          </para>
          <indexterm zone="php phpdbg">
            <primary sortas="b-phpdbg">phpdbg</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
