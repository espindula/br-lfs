<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!ENTITY mc-download-http "http://www.ibiblio.org/pub/Linux/utils/file/managers/mc/mc-&mc-version;.tar.gz">
  <!ENTITY mc-download-ftp  "ftp://ftp.uni-koeln.de/util/shell/mc-&mc-version;.tar.gz">
  <!ENTITY mc-md5sum        "18b20db6e40480a53bac2870c56fc3c4">
  <!ENTITY mc-size          "3.8 Mio">
  <!ENTITY mc-buildsize     "29 Mio">
  <!ENTITY mc-time          "0.4 SBU">
]>

<sect1 id="mc" xreflabel="MC-&mc-version;">
  <?dbhtml filename="mc.html"?>

  <sect1info>
    <othername>$LastChangedBy&nbsp;: ken $</othername>
    <date>$Date&nbsp;: 2012-03-09 21:31:04 +0100 (ven. 09 mars 2012) $</date>
  </sect1info>

  <title>MC-&mc-version;</title>

  <indexterm zone="mc">
    <primary sortas="a-MC">MC</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction à MC</title>

    <para><application>MC</application> (Midnight Commander) est un gestionnaire
    de fichiers plein-écran en mode texte et un shell visuel. Il offre une interface
    sobre, conviviale et quelque peu protégée, avec un système Unix, tout en
    rendant plus efficaces de nombreuses opérations courantes avec les fichiers
    et en préservant toute la puissance de l'invite de commande.</para>

    <bridgehead renderas="sect3">Informations sur le paquet</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&mc-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&mc-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle MD5 du téléchargement&nbsp;: &mc-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &mc-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &mc-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &mc-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Téléchargements supplémentaires</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Correctif requis&nbsp;: <ulink
        url="&patch-root;/mc-&mc-version;-bash32-1.patch"/></para>
      </listitem>
      <listitem>
        <para>Correctif recommandé&nbsp;: <ulink
        url="&patch-root;/mc-&mc-version;-debian_fixes-1.patch"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Ai-je besoin du correctif Debian&nbsp;?</bridgehead>
    <para>Midnight Commander sans le correctif Debian est complètement inutilisable
    avec des locales multibytes, car il suppose que les caractères les bytes désignent
    la même chose. Le problème se traduit par une énorme corruption du contenu de
    l'écran similaire à ce que l'on peut voir sur
    <ulink url="&files-anduin;/mc-bad.png">cet aperçu d'écran</ulink>
    (pris dans la locale ru_RU.UTF-8). Pour un traitement général sur le
    type du problème, voir la section <xref linkend="locale-wrong-multibyte-characters"/>
    de la page <xref linkend="locale-issues"/>. Le correctif Debian corrige
    en général ce problème et il ajoute le support du réencodage des noms de 
    fichiers FTP distants. Debian a également corrigé des problèmes de 64 bits, 
    de rares erreurs de segmentation dans <command>mcedit</command> et amélioré
    le surlignement de la syntaxe.</para>

    <para>Si vous n'utilisez pas de locale multibyte et que vous n'avez besoin d'aucune
    nouvelle fonctionnalité ni correction, le correctif reste recommandé. Par
    contre, le correctif modifie les dépendances et les instructions de construction
    et il provoquait, dans le passé, des régressions inacceptables pour les 
    utilisateurs de locales non UTF-8. On a ainsi laissé dans le livre, au cas 
    où, des instructions sans le correctif. Du fait de la taille et du
    caractère non officiel du correctif, merci de ne pas signaler de bogues du
    <application>MC</application> corrigé aux développeurs du
    <application>MC</application> d'origine.</para>

    <bridgehead renderas="sect3">Dépendances de MC</bridgehead>

    <bridgehead renderas="sect4">Requises</bridgehead>
    <para role="required"><!-- <xref linkend="GLib"/> (untested with Debian patch) or -->
    <xref linkend="pkgconfig"/></para>

    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="gpm"/>,
    <xref linkend="x-window-system"/>,
    <xref linkend="samba3"/>,
    <xref linkend="slang"/> (required when building with Debian patch),
    <xref linkend="zip"/>,
    <xref linkend="unzip"/> et
    <!-- <xref linkend="gnome-libs"/> -->
    <ulink url="&gnome-download-http;/gnome-libs/1.4/">GNOME
    Libraries-1.4</ulink></para>

    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/MC"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de MC</title>

    <para>Corrigez l'incompatibilité de <application>MC</application>-&mc-version;
    avec <application>Bash</application>-3.2&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../mc-&mc-version;-bash32-1.patch</userinput></screen>

    <para>Si désiré, appliquez les corrections de Debian&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../mc-&mc-version;-debian_fixes-1.patch</userinput></screen>

    <para>Installez <application>MC</application> en 
    lançant les commandes suivantes&nbsp;:</para>

<screen><userinput>CPPFLAGS="-DUTF8" ./configure --prefix=/usr \
            --enable-charset &amp;&amp;
make</userinput></screen>

    <para><application>MC</application> avec les correctifs de Debian s'attend
    à ce que sa documentation soit stockée dans l'encodage UTF-8 sur
    le disque et il la convertit automatiquement dans l'encodage de la locale
    au moment de l'affichage sur le terminal. C'est différent de ce à quoi
    s'attend le <application>MC</application> non corrigé, donc il faut
    convertir les fichiers de documentation si (et seulement si) on applique le
    correctif Debian&nbsp;:</para>
    
<!-- La solution proposée (non testée) fix... Merci à quelqun qui utilise MV de vérifier -->
<screen><userinput>for file in lib/mc.hint{,.es,.it,.nl} doc/{es,it}/mc.hlp.*
do
    iconv -f ISO-8859-1 -t UTF-8 ${file} > ${file}.utf8 &amp;&amp;
    mv ${file}.utf8 ${file}
done &amp;&amp;
for file in lib/mc.hint{.cs,.hu,.pl} doc/{hu,pl}/mc.hlp.*
do
    iconv -f ISO-8859-2 -t UTF-8 ${file} > ${file}.utf8 &amp;&amp;
    mv ${file}.utf8 ${file}
done &amp;&amp;
for file in lib/mc.hint.sr doc/sr/mc.hlp.sr
do
    iconv -f ISO-8859-5 -t UTF-8 ${file} > ${file}.utf8 &amp;&amp;
    mv ${file}.utf8 ${file}
done &amp;&amp;
for file in doc/ru/mc.hlp.ru lib/mc.hint.ru
do
    iconv -f KOI8-R -t UTF-8 ${file} > ${file}.utf8 &amp;&amp;
    mv ${file}.utf8 ${file}
done &amp;&amp;
iconv -f KOI8-U -t UTF-8 lib/mc.hint.uk > lib/mc.hint.uk.utf8 &amp;&amp;
mv lib/mc.hint.uk.utf8 lib/mc.hint.uk &amp;&amp;
iconv -f BIG5 -t UTF-8 lib/mc.hint.zh > lib/mc.hint.zh.utf8 &amp;&amp;
mv lib/mc.hint.zh.utf8 lib/mc.hint.zh</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>

<screen role="root"><userinput>make install &amp;&amp;
chmod 1755 /usr/lib/mc/cons.saver</userinput></screen>

  </sect2>

  <sect2 role="commands">
    <title>Explication des commandes</title>

    <para><parameter>CPPFLAGS="-DUTF8"</parameter>&nbsp;: Ce paramètre active
    le support d'UTF-8 dans le correctif Debian et n'a aucun effet sans ce
    correctif.</para>

    <para><parameter>--enable-charset</parameter>&nbsp;: Cette option ajoute
    un support à <command>mcedit</command> pour éditer des fichiers dans des
    encodages diffçrents de celui induit par la locale actuelle.
    Cette fonctionnalité ne fonctionne que dans des locales non 
    nUTF-8, même avec le correctif Debian.</para>

    <para><parameter>--with-screen=(slang|mcslang|ncurses)</parameter>&nbsp;:
    Ce paramètre sélectionne la bibliothèque d'écran utilisée par 
    <application>MC</application>.
    Le support de <application>NCurses</application> est actuellement bogué
    (MC ne gère pas bien les événements de la souris dans xterm). Le
    support d'UTF-8 dans le correctif Debian ne fonctionne que quand le
    <xref linkend="slang"/> est utilisé comme bibliothèque d'écran (c'est ainsi
    par défaut).</para>

    <para><parameter>--with-codepagedir=DIR</parameter>&nbsp;: Ce paramètre
    n'était utile qu'avec <application>SAMBA</application>-2.x. Les nouvelles
    versions de <application>SAMBA</application> n'ont pas de fichiers codepage.</para>

    <para><command>chmod 1755 /usr/lib/mc/cons.saver</command>&nbsp;: Le programme
    <command>cons.saver</command> doit être installé avec les paramètres
    utilisateur de root, car sur LFS, les utilisateurs réguliers n'accèdent pas
    aux périphériques <filename>/dev/vcsa*</filename>. Cette étape est
    facultative, seulement si <application>MC</application> sera démarré à partir des
    émulateurs de terminal X ou de sessions <command>ssh</command> (rendant
    ainsi le binaire <command>cons.saver</command> complètement inutile).</para>

    <!-- Other distributions make the devices owned by the vcsa group
         et make the cons.saver program setgid vcsa instead -->

  </sect2>

  <sect2 role="configuration">
    <title>Configuration de MC</title>

    <sect3 id="mc-config">
      <title>Fichiers de configuration</title>

      <para><filename>~/.mc/*</filename></para>

      <indexterm zone="mc mc-config">
        <primary sortas="e-AA..mc/*">~/..mc/*</primary>
      </indexterm>

    </sect3>

    <sect3>
      <title>Informations de configuration</title>

      <para>Le répertoire <filename class="directory">~/.mc</filename> et son
      contenu sont créés quand vous démarrez <command>mc</command> pour la
      première fois. Vous pouvez alors éditer le fichier priniipal de 
      configuration <filename>~/.mc/ini</filename> à la main ou à travers le shell
      <application>MC</application>. Consultez la page de man de mc(1) pour
      des détails.</para>

    </sect3>

  </sect2>

  <sect2 role="content">
    <title>Contenu</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>

      <seglistitem>
        <seg>cons.saver, mc, mcedit, mcmfmt, et mcview</seg>
        <seg>Aucune</seg>
        <seg>/usr/share/mc et /usr/lib/mc</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="conssaver">
        <term><command>cons.saver</command></term>
        <listitem>
          <para>est utilisé en interne par <command>mc</command> pour
          sauvegarder et restaurer le texte derrière les panneaux sur une console
          texte Linux.</para>
          <indexterm zone="mc conssaver">
            <primary sortas="b-conssaver">cons.saver</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="mc-prog">
        <term><command>mc</command></term>
        <listitem>
          <para>est un shell virtuel.</para>
          <indexterm zone="mc mc-prog">
            <primary sortas="b-mc">mc</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="mcedit">
        <term><command>mcedit</command></term>
        <listitem>
          <para>est un éditeur de fichier interne.</para>
          <indexterm zone="mc mcedit">
            <primary sortas="b-mcedit">mcedit</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="mcmfmt">
        <term><command>mcmfmt</command></term>
        <listitem>
          <para>est utilisé en interne par <command>mcview</command> lors
          de la visualisation des fichiers de boîtes aux lettres.</para>
          <indexterm zone="mc mcmfmt">
            <primary sortas="b-mcmfmt">mcmfmt</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="mcview">
        <term><command>mcview</command></term>
        <listitem>
          <para>est un visualiseur de fichiers interne.</para>
          <indexterm zone="mc mcview">
            <primary sortas="b-mcview">mcview</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
