<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;
  <!ENTITY ppp-download-http "http://samba.org/ftp/ppp/ppp-&ppp-version;.tar.gz">
  <!ENTITY ppp-download-ftp  "&gentoo-ftp-repo;/ppp-&ppp-version;.tar.gz">
  <!ENTITY ppp-md5sum        "4621bc56167b6953ec4071043fe0ec57">
  <!ENTITY ppp-size          "920 Ko">
  <!ENTITY ppp-buildsize     "6.4 Mo">
  <!ENTITY ppp-time          "0.1 SBU">
]>
<sect1 id="ppp" xreflabel="PPP-&ppp-version;">
  <?dbhtml filename="ppp.html"?>
  <sect1info>
    <othername>$LastChangedBy: andy $</othername>
    <date>$Date: 2011-11-17 18:27:16 +0100 (jeu. 17 nov. 2011) $</date>
  </sect1info>
  <title>PPP-&ppp-version;</title>
  <indexterm zone="ppp">
    <primary sortas="a-PPP">PPP</primary>
  </indexterm>
  <sect2 role="package">
    <title>Introduction à PPP</title>
 <para>Le paquet <application><acronym>PPP</acronym></application> contient
    le démon <command>pppd</command> et le programme <command>chat</command>. Ils
    sont utilisés pour la connexion vers d'autres machines&nbsp;; souvent pour se
    connecter à Internet via une connexion commutée ou via une connexion
    PPPoE vers un FAI.</para>
    &lfs70_checked;
    <bridgehead renderas="sect3">Package Information</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>Téléchargement (HTTP)&nbsp;: <ulink url="&ppp-download-http;"/></para>
      </listitem>
      <listitem>
        <para>Téléchargement (FTP)&nbsp;: <ulink url="&ppp-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>Somme de contrôle du téléchargement&nbsp;: &ppp-md5sum;</para>
      </listitem>
      <listitem>
        <para>Taille du téléchargement&nbsp;: &ppp-size;</para>
      </listitem>
      <listitem>
        <para>Estimation de l'espace disque requis&nbsp;: &ppp-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimation du temps de construction&nbsp;: &ppp-time;</para>
      </listitem>
    </itemizedlist>
    <bridgehead renderas="sect3">Dépendancies de PPP</bridgehead>
    <bridgehead renderas="sect4">Facultatives</bridgehead>
    <para role="optional"><xref linkend="libpcap"/> (nécessare pour faire du
    du filtrage PPP) et <xref linkend="linux-pam"/> (pour authentifier les appels
    entrant en utilisant PAM -
    exigé seulement par le FAIs).
    </para>
    <para condition="html" role="usernotes">Notes utilisateur&nbsp;:
    <ulink url="&blfs-wiki;/PPP"/></para>
  </sect2>
  <sect2 role="installation">
    <title>Installation de PPP</title>
    <note id="ppp-kernel">
      <para>Le support <application>PPP</application> (CONFIG_PPP),
      <foreignphrase>asynchronous line discipline</foreignphrase> (CONFIG_PPP_ASYNC), le
      pilote de votre périphérique de port série et/ou le pilote
      du protocole <foreignphrase>PPP over Ethernet</foreignphrase>
      (PPPoE) protocol driver (CONGIG_PPPOE)
      doivent être compilés dans le noyau ou être disponible comme un module du noyau.
      Udev ne charge pas automatiquement les modules ppp_generic et pppoe. Si
      vous les avez compilés en tant que modules, ils peuvent être chargés par 
      le script de démarrage modules s'ils sont indiqués dans
      <filename>/etc/sysconfig/modules</filename>.</para>
    </note>
    <indexterm zone="ppp ppp-kernel">
      <primary sortas="d-PPP-support">PPP support</primary>
    </indexterm>
    <para>Créez (en tant que <systemitem class="username">root</systemitem>)
    le groupe pour les utilisateurs qui peuvent lancer <application>PPP</application>&nbsp;:</para>
<screen role="root">
<userinput>groupadd -g 52 pppusers</userinput>
</screen>
    <para>Compilez <application>PPP</application> en lançant les
    commandes suivantes&nbsp;:</para>
<screen>
<userinput>rm include/linux/if_pppol2tp.h &amp;&amp;
./configure --prefix=/usr &amp;&amp;
make</userinput>
</screen>
    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>
    <para>Maintenant, en tant qu'utilisateur <systemitem class="username">root</systemitem>&nbsp;:</para>
<screen role='root'>
<userinput>make install &amp;&amp;
install -d /etc/ppp/peers</userinput>
</screen>
  </sect2>
  <sect2 role="commands">
    <title>Explication des commandes</title>
   <para><command>rm include/linux/if_pppol2tp.h</command>&nbsp;: 
   <application>PPP-&ppp-version;</application> contient une copie obsolète de 
   l'en-tête <filename>linux/if_pppol2tp.h</filename> du noyau. Il faut la 
   supprimer pour l'<emphasis>obliger</emphasis> à utiliser celui installé
   dans <filename class="directory">/usr</filename>. Si vous ne supprimez pas 
   ce fichier, la construction réussira quand même grâce à un <filename>Makefile</filename> 
   mal écrit), mais elle ne parviendra pas à compiler les plugins 
   <filename class="libraryfile">openl2tp.so</filename>,
   <filename class="libraryfile">pppol2tp.so</filename>,
   and <filename class="libraryfile">rp-pppoe.so</filename> plugins:</para>
    <para><command>install -d /etc/ppp/peers</command>&nbsp;: Cette commande crée
    un répertoire pour les fichiers de configuration peer de PPP.</para>
    <para><parameter>USE_PAM=y</parameter>&nbsp;: Ajoute cet argument à
    la commande <command>make</command> pour compiler en dur le support pour PAM,
    généralement nécessaire pour l'authentification des appels inbound auprès d'une
    base de données centrale.</para>
    <para><parameter>HAVE_INET6=y</parameter>&nbsp;: Ajoute cet argument à
    la commande <command>make</command> pour compiler en dur le support d'IPv6.</para>
    <para><parameter>CBCP=y</parameter>&nbsp;: Ajoute cet argument à
    la commande <command>make</command> pour compiler en dur le support du protocole
    de contrôle des appels propriétaires de Microsoft.</para>
  </sect2>
  <sect2 role="configuration">
    <title>Configurer PPP</title>
    <sect3 id="ppp-config">
      <title>Fichiers de configuration</title>
      <para><filename>/etc/ppp/*</filename></para>
      <indexterm zone="ppp ppp-config">
        <primary sortas="e-etc-ppp-star">/etc/ppp/*</primary>
      </indexterm>
    </sect3>
    <sect3>
      <title>Informations de configuration</title>
      <para>Ajoutez les utilisateurs qui peuvent lancer <application>PPP</application> au groupe
      <systemitem class="groupname">pppusers</systemitem>&nbsp;:</para>
<screen role="root">
<userinput>usermod -a -G pppusers <replaceable>&lt;username&gt;</replaceable></userinput>
</screen>
 
      <para>La plupart des fournisseurs d'accès à Internet qui utilisent ppp
      vous donnent un nom d'utilisateur et un mot de passe pour vous authentifier
      lorsque vous vous connectez à leurs serveurs. Ces secrets sont contenus
      dans les fichiers 
      <filename>/etc/ppp/pap-secrets</filename> ou
      <filename>/etc/ppp/chap-secrets</filename>. Si vous ne savez pas
      si votre fournisseur d'accès utilise CHAP ou PAP, créez les deux fichiers et
      mettez dedans le même contenu.</para>
      <para>Si vous avez plus d'un compte chez un fournisseur d'accès, la
      deuxième colonne (remotename) sert à différencier les noms d'utilisateur
      et les mots de passe de chaque FAI. Si vous n'avez qu'un compte chez un
      FAI, une astérisque ira très bien dans la deuxième colonne.</para>
      <para>Dans cet exemple le nom d'utilisateur donné par le FAI est
      <quote>jdoe</quote>, le mot de passe est <quote>guessit</quote>, le
      FAI utilise PAP et l'utilisateur veut donner à son compte le nom distant
      <quote>dialup</quote> pour le différencier des autres comptes PPP&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;&gt;/etc/ppp/pap-secrets &lt;&lt;"EOF"</userinput>
<literal># username      remotename    password
jdoe            dialup        guessit</literal>
<userinput>EOF
chmod 600 /etc/ppp/pap-secrets</userinput>
</screen>
    <sect4>
      <title>Configuration du serveur DNS</title>
      <para>Si vous ne lancez pas votre propre serveur de DNS (comme
      <xref linkend="bind"/>), <command>pppd</command> peut demander à votre FAI ses serveurs de 
      nom de domaine pour les mettre dans <filename>/etc/ppp/resolv.conf</filename>. 
      Si vous voulez utiliser leurs serveurs de noms de domaine&nbsp;:</para>
      
<screen role="root">
<userinput>mv /etc/resolv.conf{,.orig}
ln -s ppp/resolv.conf /etc</userinput>
</screen>
     </sect4>
    <sect4>
      <title>connexions PPPoE</title>
      <para>Afin de configurer une connexion PPoE, créez un
      fichier peer qui contient les détails de connexion&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;/etc/ppp/peers/<replaceable>peername</replaceable> &lt;&lt;"EOF"</userinput>
<literal>plugin rp-pppoe.so <replaceable>eth0</replaceable>
# Your username at the ISP. This is the same as the first
# column in /etc/ppp/*-secrets:
user "<replaceable>jdoe</replaceable>"
# remotename is not needed if you only have one ISP account and
# hence an asterisk in the second column in pap or chap-secrets:
# remotename "<replaceable>adsl</replaceable>"
# If it's not working and you want pppd to be
# more verbose in /var/log/sys.log, add debug:
# debug
# If you have a static IP address (eg, 12.34.56.78) you
# can specify it by following it with a colon:
# 12.34.56.78:
# Otherwise accept whatever IP address the ISP gives you:
noipdefault
# The settings below usually don't need to be changed
noauth
hide-password
updetach
defaultroute
# create /etc/ppp/resolv.conf:
usepeerdns
### For more details (and more options)
### read man pppd</literal>
<userinput>EOF
chmod 600 /etc/ppp/peers/<replaceable>peername</replaceable></userinput>
</screen>
    </sect4>
 
    <sect4>
      <title>Connexions PPPoATM</title>
      <para>Les connexions PPPoA ressemblent beaucoup à PPPoE, les principales
      différences sont que vous utilisez le plugin pppoatm.so au lieu de rp-pppoe.so,
      vous n'indiquez pas d'interface ethernet (elle utilise ppp0) et vous
      devez VP/VC des numéros utilisés par votre FAI (il existe une liste des 
      numéros VP/VC
      <ulink url="http://www.linux-usb.org/SpeedTouch/faq/index.html#q12">ici
      </ulink>)</para>
<screen role="root">
<userinput>cat &gt;/etc/ppp/peers/<replaceable>peername</replaceable> &lt;&lt;"EOF"</userinput>
<literal>plugin pppoatm.so
# Your VP/VC numbers. eg, in Britain it is 0.38, in
# France they use 8.35. Google is your friend :)
0.38
# Your username at the ISP. This is the same as the
# first column in /etc/ppp/*-secrets:
user "<replaceable>jdoe</replaceable>"
# remotename is not needed if you only have one ISP account and
# hence an asterisk in the second column in pap or chap-secrets:
# remotename "<replaceable>adsl</replaceable>"
# If it's not working and you want pppd to be
# more verbose in /var/log/sys.log, add debug:
# debug
# If you have a static IP address (eg, 12.34.56.78) you
# can specify it by following it with a colon:
# 12.34.56.78:
# Otherwise accept whatever IP address the ISP gives you:
noipdefault
# The settings below usually don't need to be changed
noauth
hide-password
updetach
defaultroute
# create /etc/ppp/resolv.conf:
usepeerdns
### For more details (and more options)
### read man pppd</literal>
<userinput>EOF
chmod 600 /etc/ppp/peers/<replaceable>peername</replaceable></userinput>
</screen>
    </sect4>
    <sect4>
      <title>Connexion par un modem Dialup</title>
      <para>Les connexions Dialup sont établies à l'aide d'un modem connecté à un
      ordinateur et à la ligne téléphonique. Le modem compose
      un numéro de téléphone du modem du FAI et ils échangent des données
      en utilisant les fréquences de signal 300-4000 Hz. En principe,
      la vitesse de transfert est de 40-50 kilo-octets par seconde, et le temps de ping de la passerelle 
      (latency) est de plus de 300-400 ms. Afin de configurer la connexion
      dialup, il faut connaître le numéro de téléphone du modem du FAI,
      le nom d'utilisateur et le mot de passe.</para>
      <para>Pour configurer une connexion dialup, vous devez créer
      deux fichiers&nbsp;: un script chat qui automatise la
      procédure de connexion (commun à tous les comptes dialup), et un fichier peer
      qui fournit les informations de configuration concernant
      une connexion particulière à <command>pppd</command>&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;/etc/ppp/dialup.chat &lt;&lt;"EOF"</userinput>
<literal>ABORT BUSY ABORT 'NO CARRIER' ABORT VOICE ABORT 'NO DIALTONE'
ABORT 'NO DIAL TONE' ABORT 'NO ANSWER' ABORT DELAYED
ABORT ERROR ABORT BLACKLISTED
TIMEOUT 5
'' AT
# \T is the phone number, passed from /etc/ppp/peers/<replaceable>dialup</replaceable>
OK-+++\dATH0-OK ATD\T
TIMEOUT 75
CONNECT \d\c</literal>
<userinput>EOF
cat &gt;/etc/ppp/peers/<replaceable>dialup</replaceable> &lt;&lt;"EOF"</userinput>
<literal># Your username at the ISP
user "<replaceable>jdoe</replaceable>"
# What should be in the second column in /etc/ppp/*-secrets
remotename "<replaceable>dialup</replaceable>"
# Replace <replaceable>TTTTTTT</replaceable> with the ISP phone number
connect "/usr/sbin/chat -T <replaceable>TTTTTTT</replaceable> -f /etc/ppp/dialup.chat"
# Specify your modem serial port and speed below
<replaceable>/dev/ttyS0</replaceable>
<replaceable>115200</replaceable>
# The settings below usually don't need to be changed
updetach
noauth
hide-password
debug
lock
defaultroute
noipdefault
usepeerdns</literal>
<userinput>EOF</userinput>
</screen>
      <para>Les trois premières lignes du fihier
      <filename>/etc/ppp/dialup.chat</filename> tuent
      le sc!ipt lorsqu'il reçoit du modem l'indication d'une erreur. Puis le
      temps d'attente est fixé à 5 secondes et le script vérifie que le modem 
      répond à la commande dummy AT. Sinon, des mesures sont prises pour le
      débloquer 
      (en interrompant le transfert de données et en continuant le script). Puis,
      on compose le numéro de téléphone et le script attend la réponse pendant
      75 secondes. La connexion série est considérée comme établie 
      quand le modem envoie la chaîne CONNECT.</para>
    </sect4>
    <sect4>
      <title>Connexions GPRS et EDGE</title>
      <para>Les connexions GPRS et EDGE sont établies à l'aide d'un téléphone 
      mobile connecté à un ordinateur en port série, USB ou 
      Bluetooth. Le téléphone échange des paquets de données avec le centre de 
      base le plus proche, jusqu'à 35 kilomètres. 
      
      La vitesse de transfert de données maximale est de
      170 kilo-octets par seconde pour GPRS et de 474 kilo-octets par seconde
      pour EDGE, mais beaucoup d'opérateurs de téléphonie mobile
      posent des limites plus faibles, comme 64 kilo-bits par 
      seconde. Le temps de réponse de la passerelle est de 900 ms pour GPRS, ce
      qui rend impossible de jouer à beaucoup de jeux en ligne et peu fiable
      la connexion à ICQ. Afin de configurer une connexion GPRS et EDGE,
      il faut connaître le nom du point d'accès (APN) et, rarement, le
      nom d'utilisateur et le mot de passe. Dans la plupart des cas,
      la facturation se fonde sur le numéro de téléphone et le couple
      nom d'utilisateur/mot de passe n'est pas nécessaire, comme le suppose
      l'exemple ci-dessous.</para>
      <para>Afin de configurer une connexion GPRS, vous devez créer deux
      fichiers&nbsp;: un script chat qui automatise la procédure de connexion
      (commun à tous les comptes GPRS), et un fichier peer qui fournit
      des informations de configuration sur une connexion particulière 
      à <command>pppd</command>&nbsp;:</para>
<screen role="root">
<userinput>cat &gt;/etc/ppp/gprs.chat &lt;&lt;"EOF"</userinput>
<literal>ABORT BUSY ABORT 'NO CARRIER' ABORT VOICE ABORT 'NO DIALTONE'
ABORT 'NO DIAL TONE' ABORT 'NO ANSWER' ABORT DELAYED
ABORT ERROR ABORT BLACKLISTED
TIMEOUT 5
'' AT
OK-+++\dATH0-OK ATZ
# \T is the APN, passed from /etc/ppp/peers/<replaceable>gprs</replaceable>
# This example stores the APN as profile #1 in the phone.
# The "telephone number", *99***&lt;profile_number&gt;#, is always the same.
# If you want to store this as profile #2, change 1 to 2 in the
# following two lines.
OK AT+CGDCONT=<replaceable>1</replaceable>,"IP","\T"
OK "ATD*99***<replaceable>1</replaceable>#"
CONNECT \d\c</literal>
<userinput>EOF
cat &gt;/etc/ppp/peers/<replaceable>gprs</replaceable> &lt;&lt;"EOF"</userinput>
<literal># Replace <replaceable>inet.example.com</replaceable> with the proper APN for your provider
connect "/usr/sbin/chat -T <replaceable>inet.example.com</replaceable> -f /etc/ppp/gprs.chat"
# Specify your cellphone serial port and speed below
# Note: you must manually send some vendor-specific AT commands
# to certain old cellular phones (such as Sony-Ericsson T200)
# in order to achieve connection speed more than 9600 bits per second.
<replaceable>/dev/ttyS1</replaceable>
<replaceable>115200</replaceable>
# The settings below usually don't need to be changed
noccp
noauth
updetach
debug
lock
defaultroute
noipdefault
usepeerdns</literal>
<userinput>EOF</userinput>
</screen>
    </sect4>
    <sect4>
      <title>Etablir manuellement la connexion</title>
      <para>Afin d'établir une connexion PPP, décrite par le fichier
      <filename>/etc/ppp/peers/<replaceable>peername</replaceable></filename>
      lancez (en tant que <systemitem class="username">root</systemitem> ou en
      tant que membre du groupe 
      <systemitem class="groupname">pppusers</systemitem>)&nbsp;:</para>
<screen>
<userinput>pppd call <replaceable>peername</replaceable></userinput>
</screen>
      <para>Afin d'arrêter la connexion, lancez&nbsp;:</para>
<screen>
<userinput>killall pppd</userinput>
</screen>
    
      <para>Écrire un script de démarrage qui active la connexion lors du processus
      de démarrage est un exercice que nous donnons au lecteur ;)</para>
    </sect4>
    </sect3>
  </sect2>
  <sect2 role="content">
    <title>Contenu</title>
    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>
      <segtitle>Répertoires installés</segtitle>
      <seglistitem>
        <seg>chat, pppd, pppdump, pppoe-discovery et pppstats</seg>
        <seg>Plusieurs modules de plugin installés dans
        <filename class='directory'>/usr/lib/pppd/&ppp-version;</filename></seg>
        <seg>/etc/ppp, /usr/include/pppd and /usr/lib/pppd</seg>
      </seglistitem>
    </segmentedlist>
    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>
      <varlistentry id="chat">
        <term><command>chat</command></term>
        <listitem>
          <para>définit une échange de conversation entre l'ordinateur et 
          le modem. Son but primaire est d'établir la connexion entre le
          <foreignphrase>Point-to-Point Protocol Daemon</foreignphrase> (PPPD) 
          et le processus <command>pppd</command> distant.</para>
          <indexterm zone="ppp chat">
            <primary sortas="b-chat">chat</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="pppd">
        <term><command>pppd</command></term>
        <listitem>
          <para>est le démon du protocole point à point.</para>
          <indexterm zone="ppp pppd">
            <primary sortas="b-pppd">pppd</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="pppdump">
        <term><command>pppdump</command></term>
        <listitem>
          <para>est utilisé pour convertir les fichiers d'enregistrement de
          <application>PPP</application> en
          format lisible.</para>
          <indexterm zone="ppp pppdump">
            <primary sortas="b-pppdump">pppdump</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="pppoe-discovery">
        <term><command>pppoe-discovery</command></term>
        <listitem>
          <para>effectue le même processus de recherche que le plugin pppoe, mais
          n'initialise pas de session <application>PPP</application>.</para>
          <indexterm zone="ppp pppoe-discovery">
            <primary sortas="b-pppoe-discovery">pppoe-discovery</primary>
          </indexterm>
        </listitem>
      </varlistentry>
      <varlistentry id="pppstats">
        <term><command>pppstats</command></term>
        <listitem>
          <para>est utilisé pour afficher les statistiques de
          <application>PPP</application>.</para>
          <indexterm zone="ppp pppstats">
            <primary sortas="b-pppstats">pppstats</primary>
          </indexterm>
        </listitem>
      </varlistentry>
    </variablelist>
  </sect2>
</sect1>
