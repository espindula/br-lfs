# SOME DESCRIPTIVE TITLE
# Copyright (C) YEAR Free Software Foundation, Inc.
# This file is distributed under the same license as the PACKAGE package.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"POT-Creation-Date: 2019-09-02 09:14+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <LL@li.org>\n"
"Language: \n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:2
msgid "AUTHOR: Stef Bon <stef at bononline dot nl>"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:4
msgid "DATE: 2006-09-09"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:6
msgid "LICENSE: GNU Free Documentation License Version 1.2"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:8
msgid "SYNOPSIS: Starting and stopping DBUS at a KDE-session using KDM."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:13
msgid ""
"DESCRIPTION: This hint is about starting the sessionpart of the "
"dbusdaemon. This is based on my hint \"Execute scripts at begin and end of a "
"KDE-session using KDM\"."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:16
msgid ""
"In this hint is described in general how scripts and commands are started at "
"the begin and end of a KDE session using KDM."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:18
msgid "It's very possible to use this construction with oher loginmanagers as well."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:21
msgid "ATTACHMENT:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:25
msgid ""
"PREREQUISITES: This hint requires sufficient knowledge of LINUX in general, "
"and scripts in particular.  Futher sudo should be installed, and you should "
"start KDE via KDM."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:27
msgid "HINT:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:29
msgid "Content:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:36
#, no-wrap
msgid ""
"1. Starting the sessiondaemon of dbus and make environmentvariables "
"available.\n"
"1.1 About the startupfiles of Bash.\n"
"1.2 Starting the sessionbus part of dbus\n"
"1.3 Stopping the sessionbus part of dbus\n"
"1.4 Installation of Sudo 1.6.8p12\n"
"1.5 One user is more than one time logged in\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:39
#, no-wrap
msgid ""
"1. Starting the sessiondaemon of dbus and make the environmentvariables "
"available\n"
"---------------------------------------------------------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:45
msgid ""
"The dbus package is split up in two parts: one systemwide part and one for "
"(each) session/user. The systemwide part (a daemon) is started at boottime, "
"with special privileges of a dedicated user. The sessionwide part (also a "
"daemon)  has to started when a session for a user begins, and stopped when "
"the session ends."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:49
msgid ""
"The construction with kdm I'm using here is ideal for this. One script in "
"the startup directory to start the sessiondaemon for a user, running with "
"the privileges of that user, and one in the reset directory an other script "
"has to stop that daemon."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:55
msgid ""
"But is not so simple as that. Some variables (DBUS_SESSION_BUS_ADDRESS and "
"DBUS_SESSION_BUS_PID) have to be available in the environment to every "
"application which works with dbus. IMHO the setting of these variables "
"should go in the bash-startupscripts. Then whatever script or application "
"you're running, these variables are set to the right value."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:59
#, no-wrap
msgid ""
"1.1 About the startupfiles of Bash\n"
"----------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:63
msgid ""
"The sessiondaemon of dbus creates a file which contains the "
"environmentvariables.  As stated above this file should be read (sourced) by "
"bash when it starts for this user."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:67
msgid ""
"When bash is started by \"login\" as an interactive login shell, it reads "
"/etc/profile and ~/.bash_profile. Bash is also started by \"kdm\", and the "
"files /etc/profile and ~/.bash_profile are sourced."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:69
msgid "My idea is to store the output of the command"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:71
msgid "dbus-launch --auto-syntax"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:73
msgid "in the file"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:75
msgid "$HOME/.dbus-session"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:78
msgid ""
"This file is \"sourced\" when bash start. This happens not automatically, "
"but you will have to add the following script to /etc/profile.d :"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:80
msgid "cat >> dbus-session.sh << \"EOF\""
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:82
msgid "if [ -f $HOME/.dbus-session ]; then"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:84
#, no-wrap
msgid "\t. $HOME/.dbus-session\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:87
msgid "fi; EOF"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:89
msgid "This way, the environment variables are made available when Bash starts."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:92
#, no-wrap
msgid ""
"1.2  Starting the sessionbus part of dbus\n"
"-----------------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:98
msgid ""
"I assume that dbus is installed, and that it is started at boottime.  "
"Compiling and installing it is described in the latest versions of BLFS "
"(beginning 200510..)."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:100
msgid ""
"Create a script in the /etc/session.d/kdm/startup directory "
"dbus-session-start.sh:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:102
msgid "cd /etc/session.d/kdm/startup"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:105
msgid "cat >> dbus-session-start.sh << \"EOF\" #!/bin/bash"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:107 origin/starting-and-stopping-dbus-with-kdm.txt:219
msgid "retcode=0;"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:113 origin/starting-and-stopping-dbus-with-kdm.txt:225
msgid ""
"userid=$1 userproperties=$(getent passwd | grep -m 1 -E \"^$userid\")  "
"homedir=$(echo $userproperties | cut -d \":\" -f 6); gidnr=$(echo "
"$userproperties | cut -d \":\" -f 4); uidnr=$(echo $userproperties | cut -d "
"\":\" -f 3);"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:116
msgid "if [ -d $homedir ]; then"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:121
#, no-wrap
msgid ""
"    #\n"
"    # do a check whether dbus-daemon is already running\n"
"    # dbus-daemon needs to be started by the user (uidnr) logging in\n"
"    #\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:123
#, no-wrap
msgid "    if [ -f $homedir/.dbus-session ]; then\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:126
#, no-wrap
msgid ""
"        # do a check the dbus-daemon for this user is running with the pid\n"
"        # in the .dbus-session file\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:130
#, no-wrap
msgid ""
"\t# pid according to the ps command\n"
"\tps_dbus_session_pid=$(ps aux | grep -m 1 -E "
"\"^$userid.*dbus-daemon.*session.*\" \\\n"
"\t| grep -v \"grep\" | sed 's@[[:space:]][[:space:]]*@ @g' | cut -d \" \" -f "
"2)\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:133
#, no-wrap
msgid ""
"\t# read the pid from the .dbus-session file\n"
"\t. $homedir/.dbus-session\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:137
#, no-wrap
msgid ""
"\t# check they are the same\t\n"
"\tif [ -z \"$ps_dbus_session_pid\" ]; then\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:140
#, no-wrap
msgid ""
"\t    # dbus for this user not running\n"
"\t    rm $homedir/.dbus-session\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:142
#, no-wrap
msgid "\telif [ $DBUS_SESSION_BUS_PID -ne $ps_dbus_session_pid ]; then\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:147
#, no-wrap
msgid ""
"            # there is something wrong: stop dbus-daemon for this user \n"
"            # and remove .dbus-session file\n"
"\t    if [ $(id -u) -eq 0 ]; then\n"
"                sudo -H -u $userid sh -c \"kill $ps_dbus_session_pid\"\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:151
#, no-wrap
msgid ""
"\t    elif [ $(id -u) -eq $uidnr ]; then\n"
"\t\tkill -SIGTERM $ps_dbus_session_pid;\n"
"\t    fi\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:153
#, no-wrap
msgid "\t    rm $homedir/.dbus-session\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:155
#, no-wrap
msgid "\tfi\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:157
#, no-wrap
msgid "    fi\t\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:159
#, no-wrap
msgid "    if [ ! -f $homedir/.dbus-session ]; then\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:162
#, no-wrap
msgid ""
"\t# only start a dbus session if .dbus-session file it not found\n"
"\t# in users homedirectory \n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:171
#, no-wrap
msgid ""
"\tif [ $(id -u) -eq 0 ]; then\n"
" \t    sudo -u $userid -H /bin/sh -c \"dbus-launch --auto-syntax > "
"$homedir/.dbus-session\"\n"
"\t    retcode=$?\n"
"\t    chown $uidnr:$gidnr $homedir/.dbus-session\n"
"\telif [ $(id -u) -eq $uidnr ]; then \n"
"    \t    dbus-launch --auto-syntax > $homedir/.dbus-session\n"
"\t    retcode=$?\n"
"\tfi\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:173
#, no-wrap
msgid "    fi\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:175
msgid "fi;"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:179 origin/starting-and-stopping-dbus-with-kdm.txt:248
#, no-wrap
msgid ""
"if [ $retcode -ne 0 ]; then\n"
"    echo \"An error with dbus ($retcode).\"\n"
"fi;\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:182 origin/starting-and-stopping-dbus-with-kdm.txt:251
msgid "exit $retcode EOF"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:184
msgid "chmod 755 /etc/session.d/kdm/startup/dbus-session-start.sh"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:189
msgid ""
"This script, executed by KDM at startup will start the dbus session daemon "
"for this user, and will create the .dbus-session file in the homedirectory "
"of this user, containing all the dbusvariables.  It will only do this when "
"dbus is not already running for this user."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:191
msgid "Now when bash starts at login, it reads (sources) this file."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:195
msgid ""
"As you can see, I've split the start of dbus up into two parts: - "
"dbus-kdm.sh, started when a (kdm)session starts, should be run once - "
".dbus-session, sourced when a (bash)session starts, could be sourced "
"multiple times"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:198
msgid ""
"Futher, I use the --auto-syntax parameter, where I assume Bash is used. So I "
"could use here --sh-syntax, but it works."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:202
msgid ""
"And Sudo is needed to run dbus-launcher as the user who's logging in, and "
"the script is run as root. This is the case with KDM, the Xstartup file is "
"run as root.  Installation of Sudo in chapter 1.4."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:207
#, no-wrap
msgid ""
"1.3  Stopping the sessionbus part of dbus\n"
"-----------------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:211
msgid "Creating the dbus-session-stop.sh script in the reset directory:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:214
msgid "cd /etc/session.d/kdm/reset"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:217
msgid "cat >> dbus-session-stop.sh << \"EOF\" #!/bin/bash"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:227
msgid "if [ -f $homedir/.dbus-session ]; then"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:229
#, no-wrap
msgid "\t. $homedir/.dbus-session\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:240
#, no-wrap
msgid ""
"\tif [ -n \"$DBUS_SESSION_BUS_PID\" ]; then\n"
"\t\tif [ $(id -u) -eq 0 ]; then\n"
"\t\t    sudo -u $userid -H /bin/sh -c \"kill $DBUS_SESSION_BUS_PID\"\n"
"\t\t    retcode=$?\n"
"\t\t    rm $homedir/.dbus-session\n"
"\t\telif [ $(id -u) -eq $uidnr ]; then\n"
"\t\t    kill $DBUS_SESSION_BUS_PID\n"
"\t\t    retcode=$?\n"
"\t\t    rm $homedir/.dbus-session\n"
"\t\tfi\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:243
#, no-wrap
msgid ""
"\tfi\n"
"fi;\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:253
msgid "chmod 755 /etc/session.d/kdm/reset/dbus-session-stop.sh"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:255
msgid "This script stops the session part of the dbus-daemon."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:260
#, no-wrap
msgid ""
"1.4 Installation of Sudo 1.6.8p12\n"
"---------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:264
msgid ""
"With sudo it's possible to execute a script or command as a normal user, "
"being root."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:267
msgid ""
"Since some time now sudo is in the BLFS book. Install it as described "
"there.  Notes:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:271
msgid ""
"- documentation you'll find only in the basedirectory of the source: README, "
"README.LDAP, PORTING, RUNSON, BUGS, INSTALL, CHANGES and so on.  If you want "
"you can copy this to the usual directory in:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:273
msgid "/usr/share/doc/sudo-1.6.8p12"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:276
msgid ""
"- Authentication can be done via PAM. This is not needed here, because the "
"default behaviour of sudo allows root to run any script and command."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:279
msgid ""
"- for other purposes, like mount.cifs, you just need root privileges. Here "
"you use sudo again, but then the other way around."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:284
#, no-wrap
msgid ""
"1.5 One user is more than one time logged in\n"
"--------------------------------------------\n"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:290
msgid ""
"For most of the situations this construction is good enough. Most users have "
"one session at a time. Now what happens when a user has more than one "
"sessions at the same time? Is it nessacary to start the sessionpart of dbus "
"for every session, or is one instance sufficient?"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:293
msgid ""
"This construction does not allow more than one dbus-daemon per user.  I "
"think that should be good enough."
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:296
msgid "ACKNOWLEDGEMENTS:"
msgstr ""

#. type: Plain text
#: origin/starting-and-stopping-dbus-with-kdm.txt:306
#, no-wrap
msgid ""
"CHANGELOG:\n"
"[2006-01-18]\n"
"  * Initial hint.\n"
"[2006-07-18]\n"
"  * Changed the bash scripts\n"
"  * changed from sudo-1.6.8p7 to sudo-1.6.8p12\n"
"[2006-09-09]\n"
"  * add check to see dbus-daemon is already running for this user\n"
"    and the information found in .dbus-session is right\n"
msgstr ""
