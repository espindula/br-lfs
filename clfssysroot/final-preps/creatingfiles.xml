<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-final-preps-creatingfiles">
  <?dbhtml filename="creatingfiles.html"?>

  <title>Création des fichiers passwd, group et des journaux</title>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/etc/passwd">/etc/passwd</primary>
  </indexterm>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/etc/group">/etc/group</primary>
  </indexterm>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/var/run/utmp">/var/run/utmp</primary>
  </indexterm>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/var/log/btmp">/var/log/btmp</primary>
  </indexterm>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/var/log/lastlog">/var/log/lastlog</primary>
  </indexterm>

  <indexterm zone="ch-final-preps-creatingfiles">
    <primary sortas="e-/var/log/wtmp">/var/log/wtmp</primary>
  </indexterm>

  <para>Pour que l'utilisateur <systemitem class="username">root</systemitem> puisse se 
  connecter et être reconnus, les entrées correspondantes 
  doivent figurer dans les fichiers <filename>/etc/passwd</filename> et
  <filename>/etc/group</filename>.</para>

  <para>Créez le fichier <filename>/etc/passwd</filename> en éxecutant la commande 
  suivante :</para>

<screen><userinput>cat &gt; ${CLFS}/etc/passwd &lt;&lt; "EOF"
<literal>root::&uid-root;:&gid-root;:root:/root:/bin/bash</literal>
EOF</userinput></screen>

  <para>Le mot de passe actuel pour l'utilisateur <systemitem class="username">root</systemitem>
  (le <quote>::</quote> utilisé ici signifie que root se connectera sans mot de passe) sera définis plus tard.</para>

  <variablelist os="b">

    <title>Les utilisateurs supplémentaires que vous pourriez désirer ajouter :</title>

    <varlistentry>
      <term><literal>bin:x:&uid-bin;:&gid-bin;:bin:/bin:/bin/false</literal></term>
      <listitem>
        <para>Peut être utile pour la compatibilité avec d'anciennes applications.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>daemon:x:&uid-daemon;:&uid-daemon;:daemon:/sbin:/bin/false</literal></term>
      <listitem>
        <para>Il est souvent recommandé d'utiliser un User ID/Groupe ID non privilégié pour 
        les démons afin de limiter leur accès au système.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>adm:x:&uid-adm;:&gid-adm;:adm:/var/adm:/bin/false</literal></term>
      <listitem>
        <para>Était utilisée pour des programmes qui effectuaient des tâches administratives.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>lp:x:&uid-lp;:&gid-lp;:lp:/var/spool/lp:/bin/false</literal></term>
      <listitem>
        <para>Utilisé par les programmes d'impression.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>mail:x:&uid-mail;:&gid-mail;:mail:/var/mail:/bin/false</literal></term>
      <listitem>
        <para>Souvent utilisé par les programmes d'email.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>news:x:&uid-news;:&gid-news;:news:/var/spool/news:/bin/false</literal></term>
      <listitem>
        <para>Souvent utilisé pour les serveurs de nouvelles.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>operator:x:&uid-operator;:&gid-root;:operator:/root:/bin/bash</literal></term>
      <listitem>
        <para>Souvent utilisé pour autoriser les opérateurs système à acceder au système.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>postmaster:x:&uid-postmaster;:&gid-mail;:postmaster:/var/spool/mail:/bin/false</literal></term>
      <listitem>
        <para>Génerallement utilisé comme un compte pour recevoir toutes les informations concernant les problèmes avec le serveur de mail.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nobody:x:&uid-nobody;:&gid-nobody;:nobody:/:/bin/false</literal></term>
      <listitem>
        <para>Utilisé par NFS.</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <para>Créez le fichier <filename>/etc/group</filename> en executant la commande suivante :</para>

<screen><userinput>cat &gt; ${CLFS}/etc/group &lt;&lt; "EOF"
<literal>root:x:&gid-root;:
bin:x:&gid-bin;:
sys:x:&gid-sys;:
kmem:x:&gid-kmem;:
tty:x:&gid-tty;:
tape:x:&gid-tape;:
daemon:x:&gid-daemon;:
floppy:x:&gid-floppy;:
disk:x:&gid-disk;:
lp:x:&gid-lp;:
dialout:x:&gid-dialout;:
audio:x:&gid-audio;:
video:x:&gid-video;:
utmp:x:&gid-utmp;:
usb:x:&gid-usb;:
cdrom:x:&gid-cdrom;:</literal>
EOF</userinput></screen>

  <variablelist os="c">

    <title>Additional groups you may want to add</title>

    <varlistentry>
      <term><literal>adm:x:&gid-adm;:root,adm,daemon</literal></term>
      <listitem>
        <para>Tous les utilisateurs dans ce groupe sont autorisé à effectuer des taches administratives</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>console:x:&gid-console;:</literal></term>
      <listitem>
        <para>Ce groupe a un accès direct à la console</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>cdrw:x:&gid-cdrw;:</literal></term>
      <listitem>
        <para>Ce groupe est autorisé à utilise le lecteur CD-RW</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>mail:x:&gid-mail;:mail</literal></term>
      <listitem>
        <para>Utilisé par les MTAs (Mail Transport Agents)</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>news:x:&gid-news;:news</literal></term>
      <listitem>
        <para>Utilisé par les serveurs de nouvelles</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>users:x:&gid-users;:</literal></term>
      <listitem>
        <para>Le GID par défaut utilisé par shadow pour les nouveaux utilisateurs</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nogroup:x:&gid-nogroup;:</literal></term>
      <listitem>
        <para>C'est un groupe par défaut utilisé par certain porgramme 
        qui ne requier pas un groupe</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term><literal>nobody:x:&gid-nobody;:</literal></term>
      <listitem>
        <para>Utilisé par NFS</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <para>Les groupes crées ne font pas partie de normes&mdash;ce sont des groupes 
  décidés en partie en fonction des exigences de configuration d'Udev, 
  et en partie selon les conventions habituelles utilisées par un grand nombre 
  de distributions Linux existantes. Le Linux Standard Base (LSB, disponnible sur
  <ulink url="http://www.linuxbase.org"/>) recommande seulement que, à coté du groupe
  <systemitem class="groupname">root</systemitem> avec un Group ID (GID) de 0,
  un groupe <systemitem class="groupname">bin</systemitem> avec un GID de 1 soit
  présent. Tout les autres noms de groupes et GIDs peuvent être choisit librement
  par l'administrateur du système depuis que les programmes écrit proprement 
  ne dépendent plus du GID, mais utilise le nom du groupe.</para>

  <para>Les programmes <command>login</command>, <command>agetty</command>, et
  <command>init</command> (et autres) utilisent un nombre de fichier journaux
  pour enregistrer certaines informations comme qui est authentifié dans 
  le système et quand when. Cependant, ces programmes n'écriront pas dans 
  les fichiers journaux si ils n'existent pas déjà. Initialisez les fichiers 
  journaux et donnez leur les bonnes permissions :</para>

<screen><userinput>touch ${CLFS}/var/run/utmp ${CLFS}/var/log/{btmp,lastlog,wtmp}
chmod -v 664 ${CLFS}/var/run/utmp ${CLFS}/var/log/lastlog
chmod -v 600 ${CLFS}/var/log/btmp</userinput></screen>

  <para>le fichier <filename>/var/run/utmp</filename> enregistre les utilisateurs
  qui sont actuellement autentifié. Le fichier <filename>/var/log/wtmp</filename>
  enregistre toutes les connexion et déconnexions. Le fichier
  <filename>/var/log/lastlog</filename> Enregistre quand un utilisateur s'est 
  connecté pour la dernière fois. Le fichier <filename>/var/log/btmp</filename> 
  enregistre les tentatives de connexion ratés.</para>

</sect1>
