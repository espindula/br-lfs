<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-chroot">
  <?dbhtml filename="chroot.html"?>

  <title>Entrer dans l'environnement chroot</title>

  <para>Il est temps d'entrer dans l'environnement chroot pour commencer la
	construction et l'installation du système final HLFS. En tant que
	<systemitem class="username">root</systemitem>, lancez la commande suivante 
	pour entrer dans ce petit monde peuplé seulement, pour le moment, des outils 
	temporaires&nbsp;:</para>

<screen><userinput>chroot "$HLFS" /tools/bin/env -i \
    HOME=/root TERM="$TERM" PS1='\u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin \
    /tools/bin/bash --login +h</userinput></screen>

  <para>L'option <parameter>-i</parameter> donnée à la commande
	<command>env</command> effacera toutes les variables de
	l'environnement chroot. Après cela, seules les variables <envar>HOME</envar>,
	<envar>TERM</envar>, <envar>PS1</envar> et <envar>PATH</envar> sont toujours
	initialisées. La construction <parameter>TERM=$TERM</parameter> initialisera 
	la variable <envar>TERM</envar> à l'intérieur du chroot avec la même valeur 
	qu'à l'extérieur&nbsp;; cette variable est nécessaire pour que des programmes
	comme <command>vim</command> et <command>less</command> fonctionnent 
	correctement. Si vous avez besoin de la présence d'autres variables, telles 
	que <envar>CFLAGS</envar> or <envar>CXXFLAGS</envar>, c'est le bon moment pour
	les initialiser de nouveau.</para>

  <para>À partir de maintenant, il n'est plus nécessaire d'utiliser la variable
	<envar>HLFS</envar> parce que tout le travail sera restreint au système de
	fichiers HLFS, car on a dit au shell Bash que
	<filename class="directory">$HLFS</filename> est maintenant le répertoire
	racine (<filename class="directory">/</filename>).</para>

  <para>Remarquez que <filename class="directory">/tools/bin</filename> 
	arrive dernier dans le <envar>PATH</envar>. Ceci signifie qu'un outil 
	temporaire ne sera plus utilisé une fois que la version finale sera installée.
	Ceci survient quand le shell ne se <quote>rappelle</quote> plus des 
	emplacements des binaires exécutés&mdash; Pour cette raison, le hachage est 
	désactivé en passant l'option <parameter>+h</parameter> à 
	<command>bash</command>.</para>

  <para>Notez que l'invite <command>bash</command> dira
	<computeroutput>I have no name!</computeroutput>. Ceci est normal car le fichi
	<filename>/etc/passwd</filename> n'a pas encore été créé.</para>

  <note>
    <para>Il est important que toutes les commandes pour le reste de ce
		chapitre et les chapitres suivants sont lancés à l'intérieur de
		l'environnement chroot. Si vous devez quitter cet environnement pour une
		quelconque raison (un redémarrage par exemple), assurez-vous que les
		systèmes de fichiers virtuels sont montés comme expliqué aux
		<xref linkend="ch-system-bindmount"/> et
		<xref linkend="ch-system-kernfsmount"/> et entrez de nouveau dans 
		chroot avant de continuer l'installation.</para>
  </note>

</sect1>
