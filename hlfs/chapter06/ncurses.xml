<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-ncurses" role="wrap">
  <?dbhtml filename="ncurses.html"?>

  <title>Ncurses-&ncurses-version;</title>

  <indexterm zone="ch-system-ncurses">
    <primary sortas="a-Ncurses">Ncurses</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet Ncurses contient les bibliothèques de gestion des
		écrans type caractère indépendant du terminal.</para>

    <para>Notes utilisateur&nbsp;: <ulink url="&hlfs-wiki;/ncurses"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Ncurses</title>

    <para>Appliquez le correctif suivant pour corriger un certain nombre de
		problèmes non gérés par l'outil d'analyse statique de code, 
		Coverity&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../&ncurses-coverity_fixes-patch;</userinput></screen>

    <para>Ncurses est fourni avec beaucoup de fonctionnalités de débogage telles
    que <parameter>--with-trace</parameter> et
    <parameter>--enable-assertions</parameter>. Voir la sortie de 
    <command>./configure --help</command> et le fichier
    <filename>INSTALL</filename> pour plus d'informations.</para>


    <para>Préparez la compilation de Ncurses&nbsp;:</para>

<screen><userinput>./configure --prefix=/usr --with-shared --without-normal \
    --enable-widec --without-cxx-binding --enable-symlinks \
    --without-debug --disable-root-environ</userinput></screen>

    <variablelist>
      <title>Voici la signification des options de configure&nbsp;:</title>

      <varlistentry>
        <term><parameter>--without-normal</parameter></term>
        <listitem>
          <para>Ce paramètre dit à Ncurses de ne pas construire les 
					bibliothèques statiques.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--enable-widec</parameter></term>
        <listitem>
          <para>Cette option amène les bibliothèques
					<quote>wide-character</quote> (comme <filename
					class="libraryfile">libncursesw.so.&ncurses-version;</filename>)
					à être compilée au lieu de celles normales (comme <filename
					class="libraryfile">libncurses.so.&ncurses-version;</filename>).
					Ces bibliothèques <quote>wide-character</quote> sont utilisables à
					la fois en locales multibyte et 8-bit traditionnelles, alors que
					les bibliothèques normales ne fonctionnent correctement que dans les
			    locales 8-bit. Les bibliothèques <quote>Wide-character</quote> et
					normales sont compatibles entre leurs sources mais pas entre leurs
					binaires.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--without-cxx-binding</parameter></term>
        <listitem>
          <para>Cette option a pour effet que la bibliothèque
          <filename class="libraryfile">libncurses++w.a</filename> n'est pas 
          compilée. Rien dans LFS et BLFS n'utilise cette bibliothèque.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--enable-symlinks</parameter></term>
        <listitem>
          <para>Cette option fait installer à Ncurses le programme
					<command>tic</command> en tant que lien symbolique plutôt qu'en lien
					dur.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--disable-root-environ</parameter></term>
        <listitem>
          <para>Cette option restreint les variables d'environnement comme     
          <envar>TERMINFO</envar> lors de l'exécution en tant que root afin que 
          le chemin de recherche de l'entrée terminfo ou termcap ne puisse pas
					être personnalisé.</para>
        </listitem>
      </varlistentry>

    </variablelist>

    <para>Compilez le paquet&nbsp;:</para>

<screen><userinput>make</userinput></screen>

    <para>Installez le paquet&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

    <para>Ce paquet a une suite de tests inhabituelle qui nécessite aussi que
		Ncurses soit d'abord installé pour fonctionner. Lisez 
    <filename>test/README</filename> pour des descriptions des tests. Elles
    peuvent être exécutées avec une commande comme&nbsp;:</para>

<screen role="nodump"><userinput>./test/tclock</userinput></screen>

   <para>Vous pouvez quitter le test <quote>tclock</quote> en appuyant sur
	 la touche 'q'. D'autres tests auront besoin que vous fassiez ctrl-c et
   afficheront un menu interactif.</para>

    <para>Déplacez les bibliothèques dans le répertoire
		<filename class="directory">/lib</filename> où elles sont supposées
		être&nbsp;:</para>

<screen><userinput>mv -v /usr/lib/libncursesw.so.5* /lib</userinput></screen>

    <para>Comme les bibliothèques ont été déplacées, un lien symbolique
		pointe vers un fichier inexistant. Re-créez le&nbsp;:</para>

<screen><userinput>ln -vsf ../../lib/libncursesw.so.5 /usr/lib/libncursesw.so</userinput></screen>

    <para>Beaucoup d'applications s'attendent encore à ce que l'éditeur
		de liens puisse trouver les bibliothèques Ncurses non
		<quote>wide-character</quote>. Faites croire à de telles applications
		au lien vers les bibliothèques <quote>with wide-character</quote> par
		des liens symboliques et des scripts d'édition de
		liens&nbsp;:</para>

<screen><userinput>for lib in curses ncurses form panel menu ; do \
    rm -vf /usr/lib/lib${lib}.so ; \
    echo "INPUT(-l${lib}w)" &gt;/usr/lib/lib${lib}.so ; \
done</userinput></screen>

    <para>Finalement, assurez-vous que les vieilles applications qui
		cherchent <filename class="libraryfile">-lcurses</filename> lors de
		la compilation sont encore compilables&nbsp;:</para>

<screen><userinput>echo "INPUT(-lncursesw)" &gt;/usr/lib/libcursesw.so
ln -vsf libncurses.so /usr/lib/libcurses.so</userinput></screen>

  </sect2>

  <sect2 id="contents-ncurses" role="content">
    <title>Contenu de Ncurses</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>

      <seglistitem>
        <seg>captoinfo (lien vers tic), clear, infocmp, infotocap (lien vers tic),
        reset (lien vers tset), tack, tic, toe, tput et tset</seg>
        <seg>libcursesw.{a,so} (symlink and linker script to libncursesw.{a,so}),
        libformw.{a,so}, libmenuw.{a,so}, libncurses++w.a, libncursesw.{a,so},
        libpanelw.{a,so} et leur équivalent non multi-octets sans "w" dans
				le nom de la la bibliothèque.</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="captoinfo">
        <term><command>captoinfo</command></term>
        <listitem>
          <para>Convertit une description termcap en description terminfo</para>
          <indexterm zone="ch-system-ncurses captoinfo">
            <primary sortas="b-captoinfo">captoinfo</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="clear">
        <term><command>clear</command></term>
        <listitem>
          <para>Efface l'écran si possible</para>
          <indexterm zone="ch-system-ncurses clear">
            <primary sortas="b-clear">clear</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="infocmp">
        <term><command>infocmp</command></term>
        <listitem>
          <para>Compare ou affiche les descriptions terminfo</para>
          <indexterm zone="ch-system-ncurses infocmp">
            <primary sortas="b-infocmp">infocmp</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="infotocap">
        <term><command>infotocap</command></term>
        <listitem>
          <para>Convertit une description terminfo en description termcap</para>
          <indexterm zone="ch-system-ncurses infotocap">
            <primary sortas="b-infotocap">infotocap</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="reset">
        <term><command>reset</command></term>
        <listitem>
          <para>Réinitialise un terminal avec ses valeurs par défaut</para>
          <indexterm zone="ch-system-ncurses reset">
            <primary sortas="b-reset">reset</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tack">
        <term><command>tack</command></term>
        <listitem>
          <para>Vérificateur d'actions terminfo&nbsp;; il est principalement
					utilisé pour tester la précision d'une entrée dans la base de données
					terminfo</para>
          <indexterm zone="ch-system-ncurses tack">
            <primary sortas="b-tack">tack</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tic">
        <term><command>tic</command></term>
        <listitem>
          <para>Le compilateur d'entrée de description terminfo, traduisant un
					fichier terminfo au format source dans un format binaire nécessaire
					pour les routines des bibliothèques ncurses. Un fichier terminfo
					contient des informations sur les capacités d'un terminal particulier</para>
          <indexterm zone="ch-system-ncurses tic">
            <primary sortas="b-tic">tic</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="toe">
        <term><command>toe</command></term>
        <listitem>
          <para>Liste tous les types de terminaux disponibles, donnant pour
					chacun d'entre eux son nom principal et sa description</para>
          <indexterm zone="ch-system-ncurses toe">
            <primary sortas="b-toe">toe</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tput">
        <term><command>tput</command></term>
        <listitem>
          <para>Rend les valeurs de capacités dépendant du terminal disponibles
					au shell&nbsp;; il peut aussi être utilisé pour réinitialiser un
					terminal ou pour afficher son nom long</para>
          <indexterm zone="ch-system-ncurses tput">
            <primary sortas="b-tput">tput</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tset">
        <term><command>tset</command></term>
        <listitem>
          <para>Peut être utilisé pour initialiser des terminaux</para>
          <indexterm zone="ch-system-ncurses tset">
            <primary sortas="b-tset">tset</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libcurses">
        <term><filename class="libraryfile">libcurses</filename></term>
        <listitem>
          <para>Un lien vers <filename>libncurses</filename></para>
          <indexterm zone="ch-system-ncurses libcurses">
            <primary sortas="c-libcurses">libcurses</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libncurses">
        <term><filename class="libraryfile">libncurses</filename></term>
        <listitem>
          <para>Contient des fonctions pour afficher du texte de plusieurs
					façons compliquées sur un écran de terminal&nbsp;; un bon exemple
					d'utilisation de ces fonctions est le menu affiché par le
					<command>make menuconfig</command></para>
          <indexterm zone="ch-system-ncurses libncurses">
            <primary sortas="c-libncurses">libncurses</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libform">
        <term><filename class="libraryfile">libform</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des formes</para>
          <indexterm zone="ch-system-ncurses libform">
            <primary sortas="c-libform">libform</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libmenu">
        <term><filename class="libraryfile">libmenu</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des menus</para>
          <indexterm zone="ch-system-ncurses libmenu">
            <primary sortas="c-libmenu">libmenu</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libpanel">
        <term><filename class="libraryfile">libpanel</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des panneaux</para>
          <indexterm zone="ch-system-ncurses libpanel">
            <primary sortas="c-libpanel">libpanel</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
