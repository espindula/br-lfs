<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-strippingagain">
  <?dbhtml filename="strippingagain.html"?>

  <title>Supprimer de nouveau les symboles des fichiers objets</title>

Si l'utilisateur initial n'est pas un développeur et ne pense
  pas faire de débogage sur les logiciels du système, la taille du
  système peut être diminué d'environ 200&nbsp;Mo en supprimant les
  symboles de débogage contenus dans les binaires et dans les
  bibliothèques. Ceci ne pose pas de problème autre que le fait de ne
  plus pouvoir vraiment les déboguer.</para>

  <para>La plupart des personnes qui utilisent la commande mentionnée
  ci-dessous ne rencontrent aucune difficulté. Néanmoins, il est facile
  de faire une erreur de saisie et rendre le nouveau système
  complètement inutilisable, donc avant d'exécuter la commande
  <command>strip</command>, il est recommandé de faire une sauvegarde de
  l'état actuel.</para>

  <para>Avant d'exécuter la suppression de ces symboles, faites
  particulièrement attention qu'aucun des binaires concernés ne sont en cours
  d'exécution. Si vous n'êtes pas sûr que l'utilisateur est entré dans chroot avec la
  commande donnée dans
  <xref linkend="ch-system-chroot" role=","/>
  quittez le chroot&nbsp;:</para>

<screen role="nodump"><userinput>logout</userinput></screen>

<para>Puis, retournez-y avec&nbsp;:</para>

<screen role="nodump"><userinput>chroot $HLFS /tools/bin/env -i \
    HOME=/root TERM=$TERM PS1='\u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin \
    /tools/bin/bash --login</userinput></screen>

  <para>Nettoyez les bibliothèques. Iouvenez-vous que le nettoyage
  <quote>unneeded</quote> ou <quote<all</quote> depuis les bibliothèques va les
  détruire&nbsp;:</para>

<screen><userinput>/tools/bin/find /{,usr}/lib -type f \
    -exec /tools/bin/strip --strip-debug '{}' ';'</userinput></screen>

  <para>Puis, nettoyez les programmes&nbsp;:</para>

<screen><userinput>/tools/bin/strip --strip-all /{,usr/}{bin,sbin}/*</userinput></screen>

  <para>Un grand nombre de fichiers seront rapportés comme ayant un
  format non reconnu. Ces messages d'avertissement indiquent que ces
  fichiers sont des scripts et non pas des binaires.</para>

  <para>Gawk met deux programmes dans <filename class="directory">/usr/lib</filename>,
  vous pouvez les nettoyer complètement&nbsp;:</para>

<screen><userinput>/tools/bin/strip --strip-all /usr/lib/awk/{grcat,pwcat}</userinput></screen>

  <para>Deux  programmes GCC sont placés dans 
  <filename class="directory">/usr/lib</filename>, vous pouvez entièrement les 
  nettoyer&nbsp;:</para>

<screen condition="glibc"><userinput>/tools/bin/strip --strip-all \
    /usr/lib/gcc/$(uname -m)-pc-linux-gnu/&gcc-version;/{cc1*,collect2}</userinput></screen>

<screen condition="uclibc"><userinput>/tools/bin/strip --strip-all \
    /usr/lib/gcc/$(uname -m)-pc-linux-uclibc/&gcc-version;/{cc1*,collect2}</userinput></screen>

</sect1>

