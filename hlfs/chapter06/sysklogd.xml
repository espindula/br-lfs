<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-sysklogd" role="wrap">
  <?dbhtml filename="sysklogd.html"?>

  <title>Sysklogd-&sysklogd-version;</title>

  <indexterm zone="ch-system-sysklogd">
    <primary sortas="a-Sysklogd">Sysklogd</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet Sysklogd contient des programmes pour journaliser
		les traces système comme celles données par le noyau lorsque des
		événements inhabituels surviennent.</para>

    <para>Notes utilisateur&nbsp;: <ulink url="&hlfs-wiki;/sysklogd"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Sysklogd</title>

    <para>Le correctif suivant s'occupe d'un problème lors de la compilation
		de Sysklogd avec <option>-D_FORTIFY_SOURCE=2</option>&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../&sysklogd-disable__syslog_chk-patch;</userinput></screen>

    <para role="misc">Ce correctif ajoute la séparation des privilèges pour
		les démons <command>syslogd</command> et <command>klogd</command> afin
		qu'ils puissent modifier leurs racines et réduire leurs privilèges à ceux d'un utilisateur régulier 
		après ouverture des fichiers journaux et des sockets 
		réseau&nbsp;:</para>

<screen role="misc"><userinput>patch -Np1 -i ../&sysklogd-priv_sep-patch;</userinput></screen>

    <para role="misc">La séparation des privilèges exigera aussi l'ajout de 
		nouveaux utilisateurs, de nouveaux groupes et de nouveaux répertoires. Ces
		utilisateurs n'ont pas besoin de privilèges pour se connecter ou lire leur
    répertoire racine&nbsp;:</para>

<screen role="misc"><userinput>cat &gt;&gt; /etc/passwd &lt;&lt; "EOF"
<literal>syslogd:x:16:16:System Log Daemon:/var/lib/syslogd:/sbin/nologin
klogd:x:17:17:Kernel Log Daemon:/var/lib/klogd:/sbin/nologin</literal>
EOF
cat &gt;&gt; /etc/group &lt;&lt; "EOF"
<literal>syslogd:x:16:
klogd:x:17:</literal>
EOF
install -d -m0000 /var/lib/syslogd
install -d -m0000 /var/lib/klogd</userinput></screen>

    <para>Les droits par défaut du fichier journal sont 644 (écriture par le
		propriétaire, lecture par tout le monde). Vous pouvez aussi modifier cela
    avec la commande <command>chmod</command>. La commande
    suivante va rendre les nouveaux fichiers lisibles uniquement par leur
    propriétaire (en principe root)&nbsp;:</para>

<screen><userinput>sed 's/644/600/' -i.orig syslogd.c</userinput></screen>

    <para>Compilez le paquet&nbsp;:</para>

<screen><userinput>make</userinput></screen>

    <para>Ce paquet n'est pas fourni avec une suite de tests.</para>

    <para>Installez le paquet&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

  </sect2>

  <sect2 id="conf-sysklogd" role="configuration">
    <title>Configuration de Sysklogd</title>

    <indexterm zone="conf-sysklogd">
      <primary sortas="a-Sysklogd">Sysklogd</primary>
      <secondary>configuration</secondary>
    </indexterm>

    <indexterm zone="conf-sysklogd">
      <primary sortas="e-/etc/syslog.conf">/etc/syslog.conf</primary>
    </indexterm>

    <para>Créez un nouveau fichier <filename>/etc/syslog.conf</filename> 
	  en lançant ce qui suit&nbsp;:</para>

<screen><userinput>cat &gt; /etc/syslog.conf &lt;&lt; "EOF"
<literal># Début de /etc/syslog.conf

auth,authpriv.* -/var/log/auth.log
*.*;auth,authpriv.none -/var/log/sys.log
daemon.* -/var/log/daemon.log
kern.* -/var/log/kern.log
mail.* -/var/log/mail.log
user.* -/var/log/user.log
*.emerg *

# Fin de /etc/syslog.conf</literal>
EOF</userinput></screen>

  </sect2>

  <sect2 id="contents-sysklogd" role="content">
    <title>Contenu de Sysklogd</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>

      <seglistitem>
        <seg>klogd et syslogd</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="klogd">
        <term><command>klogd</command></term>
        <listitem>
          <para>Un démon système pour intercepter et tracer les messages du noyau</para>
          <indexterm zone="ch-system-sysklogd klogd">
            <primary sortas="b-klogd">klogd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="syslogd">
        <term><command>syslogd</command></term>
        <listitem>
          <para>Trace les messages que les programmes systèmes donnent. Chaque
          message tracé contient au moins une date et un nom d'hôte, et normalement
          aussi le nom du programme, mais cela dépend de la façon dont le
          démon de traçage effectue sa surveillance</para>
          <indexterm zone="ch-system-sysklogd syslogd">
            <primary sortas="b-syslogd">syslogd</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
