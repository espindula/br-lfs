<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-linux-headers" role="wrap">
  <?dbhtml filename="linux-headers.html"?>

  <title><package vendor="2.4">Linux-&linux24-version;</package>
  <package vendor="2.6">Linux-&linux26-version;</package> API Headers</title>

  <indexterm zone="ch-system-linux-headers">
    <primary sortas="a-Linux">Linux</primary>
    <secondary>en-têtes API</secondary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Les en-têtes de l'API Linux montrent l'API du noyau pour qu'il soit utilisé
		par Libc.</para>

    <para>Notes utilisateur&nbsp;: <ulink url="&hlfs-wiki;/linux-kernel"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Linux API Headers</title>

    <para>Le noyau linux a besoin de montrer une interface de programmation
		de l'application (Application Programming Interface, API) à utiliser par la
		bibliothèque C du système (Glibc dans LFS). Cela se fait en nettoyant les
		fichiers d'en-tête C qui sont contenus dans l'archive des sources du noyau
		Linux.</para>

    <para vendor="2.6">Appliquez une substitution sed pour supprimer 
		l'installation des fichiers d'en-tête dans /usr/include/scsi. Les versions 
		fournies par libc seront utilisées à la place&nbsp;:</para>

<screen vendor="2.6"><userinput>sed '/scsi/d' -i.orig include/Kbuild</userinput></screen>

    <para role="aslr" vendor="2.4">Ce correctif modifie l'en-tête
		asm-i386/unistd.h pour utiliser le code assemblé en position indépendante
		si le compilateur définit __PIC__. Ceci est nécessaire afin que le logiciel 
		qui utilise cette en-tête soit PIC. Cette en-tête  a été considérée comme
		obsolète et a été supprimée de la série 2.6.19 du noyau Linux, ce 
    problème ne sera donc jamais corrigé à la source. Appliquez ce correctif 
    avec la commande suivante&nbsp;:</para>

<screen role="aslr" vendor="2.4"><userinput>patch --no-backup-if-mismatch -Np1 -i \
    ../&linux24-unistd_x86_PIC-patch;</userinput></screen>

    <variablelist role="aslr" vendor="2.4">
      <title>Voici la signification de l'option de la commande&nbsp;:</title>

      <varlistentry>
        <term><parameter>--no-backup-if-mismatch</parameter></term>
        <listitem>
          <para>L'option dit à <command>patch</command> de ne pas créer de
          fichiers de sauvegarde afin qu'on ne les copie pas dans 
          <filename class="directory">/tools/include</filename> lorsqu'on 
          installera les en-têtes du noyau à l'étape suivante.</para>
        </listitem>
      </varlistentry>

    </variablelist>

    <para>Installez les fichiers d'en-tête&nbsp;:</para>

<screen vendor="2.6"><userinput>make mrproper
make headers_check
make INSTALL_HDR_PATH=dest headers_install
cp -rv dest/include/* /usr/include</userinput></screen>

<screen vendor="2.4"><userinput>make mrproper
make include/linux/version.h
make symlinks
cp -vHR include/asm /usr/include
cp -vR include/asm-generic /usr/include
cp -vR include/linux /usr/include
touch /usr/include/linux/autoconf.h</userinput></screen>

  </sect2>

  <sect2 id="contents-linux-headers" role="content">
    <title>Contenu de Linux API Headers</title>

    <segmentedlist>
      <segtitle>En-têtes installées</segtitle>

      <seglistitem>
        <seg>/usr/include/{asm,linux}/*.h</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="linux-headers">
        <term><filename class="headerfile">/usr/include/{asm,linux}/*.h</filename></term>
        <listitem>
          <para>Les en-têtes de l'API de Linux</para>
          <indexterm zone="ch-system-linux-headers linux-headers">
            <primary sortas="e-/usr/include/{asm,linux}/*.h">/usr/include/{asm,linux}/*.h</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
