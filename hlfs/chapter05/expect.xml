<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-tools-expect" role="wrap">
  <?dbhtml filename="expect.html"?>

  <title>Expect-&expect-version;</title>

  <indexterm zone="ch-tools-expect">
    <primary sortas="a-Expect">Expect</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet Expect contient un programme pour réaliser des dialogues
		scriptés avec d'autres programmes interactifs.</para>

    <para>Notes utilisateur&nbsp;: <ulink url="&hlfs-wiki;/expect"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Expect</title>

    <para>Tout d'abord, corrigez un bogue aboutissant à de nombreux faux
		positifs lors de l'exécution de la suite de tests de GCC&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../&expect-spawn-patch;</userinput></screen>

    <para>Ensuite, forcez le script configure de expect à utiliser
		<filename>/bin/stty</filename> au lieu d'un
    <filename>/usr/local/bin/stty</filename> qu'il pourrait trouver sur le
		système hôte. Cela garantira que notre suite de test demeure propre
		pour les constructions finales de la chaîne d'outils&nbsp;:</para>

<screen><userinput>cp -v configure{,.bak}
sed 's:/usr/local/bin:/bin:' configure.bak &gt; configure</userinput></screen>

    <para condition="uclibc">Le fichier <filename>config.sub</filename> de ce
		paquet ne rconnnaît pas uClibc. Ajustez cela avec la commande suivante&nbsp;:</para>

<screen condition="uclibc"><userinput>cp -v config.sub{,.orig}
sed 's/linux-gnu/linux-uclibc/' config.sub.orig > config.sub</userinput></screen>

    <para>Maintenant préparez la compilation de Expect&nbsp;:</para>

<screen><userinput>./configure --prefix=/tools --with-tcl=/tools/lib \
    --with-tclinclude=/tools/include --with-x=no</userinput></screen>

    <variablelist>
      <title>Voici la signification des options de configure&nbsp;:</title>

      <varlistentry>
        <term><parameter>--with-tcl=/tools/lib</parameter></term>
        <listitem>
          <para>Ceci nous assure que le script configure trouve l'installation
					Tcl dans l'emplacement des outils temporaires à la place d'un résidant
					sur le système hôte.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--with-tclinclude=/tools/include</parameter></term>
        <listitem>
          <para>Ceci indique explicitement à Expect où trouver le répertoire
					des sources de Tcl et ses en-têtes internes. Utiliser cette option évi
					certaines conditions d'échec pour
					<command>configure</command> s'il ne peut
					pas découvrir automatiquement l'emplacement des en-têtes de Tcl.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--with-x=no</parameter></term>
        <listitem>
          <para>Ceci indique au script configure de ne pas chercher Tk (le
					composant interface de Tcl) ou les bibliothèques d'X Window System, 
					les deux pouvant résider sur le système hôte mais n'existant pas sur 
					l'environnement temporaire.</para>
        </listitem>
      </varlistentry>

    </variablelist>

    <para condition="uclibc">uClibc n'a pas l'en-tête 
    <filename class="headerfile">stropts.h</filename> mais elle peut être 
		trouvée sur le système hôte. La commande suivante va désactiver son
		utilisation afin que Expect puisse se construire avec uClibc&nbsp;:</para>

<screen condition="uclibc"><userinput>cp -v expect_cf.h{,.orig}
sed 's/#define HAVE_STROPTS_H 1/#undef HAVE_STROPTS_H/' \
    expect_cf.h.orig > expect_cf.h</userinput></screen>

    <para>Compilez le paquet&nbsp;:</para>

<screen><userinput>make</userinput></screen>

    <para>Installez le paquet&nbsp;:</para>

<screen><userinput>make SCRIPTS="" install</userinput></screen>

    <variablelist>
      <title>Voici la signification du paramètre de make&nbsp;:</title>

      <varlistentry>
        <term><parameter>SCRIPTS=""</parameter></term>
        <listitem>
          <para>Ceci empêche l'installation de scripts Expect supplémentaires
          qui ne sont pas nécessaires.</para>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

  <sect2 id="contents-expect" role="content">
    <title>Contenu de Expect</title>

    <segmentedlist>
      <segtitle>Programme installé</segtitle>
      <segtitle>Bibliothèque installée</segtitle>

      <seglistitem>
        <seg>expect</seg>
        <seg>libexpect-&expect-lib-version;.a</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="expect">
        <term><command>expect</command></term>
        <listitem>
          <para>Communique avec les autres programmes interactifs suivant un
					script.</para>
          <indexterm zone="ch-tools-expect expect">
            <primary sortas="b-expect">expect</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libexpect">
        <term><filename class="libraryfile">libexpect&expect-lib-version;.a</filename></term>
        <listitem>
          <para>Contient des fonctions qui permettent à Expect d'être utilisé comme
					extension Tcl ou d'être utilisé directement à partir du langage C ou de
					C++ (sans Tcl)</para>
          <indexterm zone="ch-tools-expect libexpect">
            <primary sortas="c-libexpect-&expect-lib-version;">libexpect-&expect-lib-version;</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
