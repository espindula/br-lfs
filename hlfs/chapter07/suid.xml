<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="bootable-suid">
  <?dbhtml filename="suid.html"?>

  <title>Paramétrer les identifieurs utilisateur/groupe (suid) des programmes</title>

  <para>Certains paquets installent des programmes en suid par défaut. Cela 
  autorise les utilisateurs normaux à changer de mot de passe et que ceci soit 
  écrit dans <filename>/etc/shadow</filename>. Cela peut autoriser des 
  utilisateurs à monter des disques. On suggère que GnuPG soit en suid afin que
  les clés puissent être décryptées dans la ram et non dans la partition
  d'échange du disque où un attaquant peut la récupérer. Dans certains cas, il y a
  des programmes en suid dont vous n'avez pas besoin qu'ils le soient. La 
  commande suivante va rechercher dans tout le système les programmes en 
  suid&nbsp;:</para>

<screen><userinput>find / -perm -4000</userinput></screen>

  <para>La commande ci-dessus peut prendre beaucoup de temps si vous avez 
  beaucoup de fichiers. La commande suivante ne vérifiera que votre 
  <envar>PATH</envar>. Si votre <envar>PATH</envar> est complet, cette commande
  devrait être efficace pour trouver tous les programmes en suid&nbsp;:</para>

<screen role="nodump"><userinput>find `echo $PATH | sed -e 's/:/ /g'` -perm -4000</userinput></screen>

  <para>À vous de voir quels programmes vous avez besoin d'avoir en suid. Ce
  qui suit n'est qu'une suggestion. Vous pouvez supprimer le bit suid de ces 
  programmes et la plupart des gens n'y manqueront pas&nbsp;:</para>

<screen role="nodump"><userinput>chmod -v -s /bin/{mount,umount}</userinput></screen>

  <para>Certaines personnes les utilisent, d'autres non&nbsp;:</para>

<screen role="nodump"><userinput>chmod -v -s /usr/bin/{chfn,chsh,chage,newgrp,expiry}</userinput></screen>

  <para>Si vous n'utilisez pas les mots de passe de groupe, désactivez
  <command>gpasswd</command>:</para>

<screen role="nodump"><userinput>chmod -v -s /usr/bin/gpasswd</userinput></screen>

  <para>Vous devriez régulièrement lancer la commande <command>find</command>(1),
  surtout après l'installation de beaucoup de paquets. Par exemple, un script 
  cron <filename>/etc/weekly</filename> peut écrire la sortie de la commande
  <command>find</command>(1) dans
  <filename class="directory">/var/cache</filename>. Le script hebdomadaire
  peut alors comparer la sortie d'une semaine à l'autre puis vous avertir s'il y
  a un changement.</para>

  <para>Si vous avez utilisé toutes les suggestions ci-dessus, vous ne devriez 
  avoir que trois programmes en suid&nbsp;: <command>/bin/su</command>,
  <command>/bin/ping</command>, <command>/bin/passwd</command> et avec Glibc
  <command>/usr/lib/glibc/pt_chown</command>..</para>

  <para>Vous devriez restreindre <command>su</command> aux utilisateurs 
  autorisés à utiliser <command>su</command>. L'utilisation des droits Unix
  fonctionne très bien pour ça. Ajoutez un groupe <emphasis>suers</emphasis>,
  changez le groupe propriétaire de <command>su</command> vers ce groupe et
  supprimez le droit pour tout le monde de <command>su</command>:</para>

<screen><userinput>groupadd suers
chgrp -v suers /bin/su
chmod -v 4710 /bin/su</userinput></screen>

  <para>Maintenant, <command>ls -l /bin/su</command> devrait ressembler à  
  ceci&nbsp;:</para>

<screen><computeroutput> -rws--x---  1 root suers 31088 2004-12-18 02:19 /bin/su</computeroutput></screen>

  <para>Les utilisateurs autorisés à utiliser <command>su</command> doivent
  être ajoutés au groupe <emphasis>suers</emphasis>.</para>

</sect1>
