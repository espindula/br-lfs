<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="space-creatingfilesystem">
  <?dbhtml filename="creatingfilesystem.html"?>

  <title>Créer un système de fichiers sur la partition</title>

  <para>Maintenant qu'une partition vierge est prête, le système de
  fichiers peut
  être créé. LFS peut utiliser n'importe quel système de fichiers reconnu par
  le noyau Linux, mais les types les plus classiques sont
  ext3 et ext4. Le choix d'un système de
  fichiers peut être complexe et il dépend des caractéristiques des fichiers
  et de la taille de la partition. Par exemple&nbsp;:</para>

  <variablelist>
    <varlistentry>
      <term>ext2</term>
      <listitem><para>convient aux petites partitions rarement renouvelées
      telles que /boot.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>ext3</term>
      <listitem><para>mise à jour de l'ext2 comprenant un journal aidant à
      récupérer l'état de la partition en cas d'arrêt brutal. On l'utilise
      en général dans une perspective généraliste.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>ext4</term>
      <listitem><para>est la dernière version  des systèmes de
      fichiers ext de la famille de ce type de partitions. Il offre de nouvelles
      possibilités, notamment l'horodatage à la nanosecondes,  la création et
      l'utilisation de très gros fichiers (16 To), et des améliorations de
      vitesse.</para>
      </listitem>
    </varlistentry>
  </variablelist>

  <para>D'autres systèmes de fichiers comme FAT32, NTFS, ReiserFS, JFS et XFS
  servent à des fins plus spécifiques. Vous pouvez trouver plus d'informations
  sur ces systèmes de fichiers sur <ulink
  url="http://en.wikipedia.org/wiki/Comparison_of_file_systems"/>.</para>


  <para>LFS suppose que le système de fichiers racine (/) est de type ext4. Pour
  créer un système de fichiers <systemitem class="filesystem">ext4</systemitem>
  sur la partition LFS, lancez ce qui suit&nbsp;:</para>

<screen role="nodump"><userinput>mkfs -v -t ext4 /dev/<replaceable>&lt;xxx&gt;</replaceable></userinput></screen>
  

<!--
  <para>Remplacez <replaceable>&lt;xxx&gt;</replaceable> par le nom de
  la partition LFS (<filename class="devicefile">sda5</filename> dans
  notre exemple précédent).</para>

  <note>
    <para>Quelques distributions hôtes utilisent des fonctionnalités
    personnalisées dans leur outil de création de systèmes de fichiers
    (e2fsprogs). Ceci peut poser des problèmes lors du démarrage dans
    votre nouveau LFS au chapitre 9 car toutes ces fonctionnalités ne
    seront pas supportées par la version d'e2fsprogs installée par LFS&nbsp;;
    vous aurez une erreur du type <quote>unsupported filesystem
    features, upgrade your e2fsprogs</quote>. Pour
    voir si votre système hôte utilise des améliorations
    personnalisées, utilisez la commande suivante&nbsp;:</para>

<screen role="nodump"><userinput>debugfs -R feature /dev/<replaceable>&lt;xxx&gt;</replaceable></userinput></screen>

    <para>Si la sortie contient des fonctionnalités autres que
    <option>has_journal</option>, <option>ext_attr</option>,
    <option>resize_inode</option>, <option>dir_index</option>,
    <option>filetype</option>, <option>sparse_super</option>,
    <option>large_file</option> ou <option>needs_recovery</option>,
    alors votre système hôte pourrait avoir des améliorations personnalisées.
    Dans ce cas, pour éviter tout problème ultérieur, vous devez compiler le paquet e2fsprogs et
    utiliser les binaires résultant de cette compilation pour re-créer
    le système de fichiers sur votre partition LFS&nbsp;:</para>

<screen role="nodump"><userinput>cd /tmp
tar -xzvf /path/to/sources/e2fsprogs-&e2fsprogs-version;.tar.gz
cd e2fsprogs-&e2fsprogs-version;
mkdir -v build
cd build
../configure
make #note that we intentionally don't 'make install' here!
./misc/mke2fs -jv /dev/<replaceable>&lt;xxx&gt;</replaceable>
cd /tmp
rm -rfv e2fsprogs-&e2fsprogs-version;</userinput></screen>
  </note>
-->

  <para>Si vous utilisez une partition de <systemitem class="filesystem">swap
  </systemitem> existante, il n'est pas nécessaire de la formater. Si vous avez créé une nouvelle
  partition <systemitem class="filesystem">swap</systemitem>, elle devra être initialisée,
  pour pouvoir être utilisée, en exécutant la commande&nbsp;:</para>

<screen role="nodump"><userinput>mkswap /dev/<replaceable>&lt;yyy&gt;</replaceable></userinput></screen>

  <para>Remplacez <replaceable>&lt;yyy&gt;</replaceable> par le nom de
  la partition de <systemitem
  class="filesystem">swap</systemitem>.</para>

</sect1>
