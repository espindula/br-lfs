<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="space-creatingfilesystem">
  <?dbhtml filename="creatingfilesystem.html"?>

  <title>Créer un système de fichiers sur la partition</title>

  <para>Maintenant qu'une partition vierge est prête, le système de
  fichiers peut
  être créé. Le système le plus communément utilisé dans le monde Linux
  est le système de fichiers étendu, deuxième version, plus connu sous
  son acronyme (<systemitem class="filesystem">ext2</systemitem>, mais
  avec les nouveaux disques haute capacité, les systèmes de fichiers
  journalisés deviennent de plus en plus populaires. Le système de
  fichiers étendu, troisième version
  (<systemitem class="filesystem">ext3</systemitem>) est une
  amélioration couramment utilisée de
  <systemitem class="filesystem">ext2</systemitem>, qui ajoute des
  options de journalisation et qui est compatible avec les utilitaires
  de E2fsprogs. Nous créerons un système de fichiers <systemitem
  class="filesystem">ext3</systemitem>. Les instructions de construction
  d'autres systèmes de fichiers sont disponibles dans
  <ulink url="&blfs-root;postlfs/filesystems.html"/>.</para>

  <para>Pour créer un système de fichiers
  <systemitem class="filesystem">ext3</systemitem> sur la partition LFS,
  lancez ce qui suit&nbsp;:</para>

<screen role="nodump"><userinput>mke2fs -jv /dev/<replaceable>&lt;xxx&gt;</replaceable></userinput></screen>

  <para>Remplacez <replaceable>&lt;xxx&gt;</replaceable> par le nom de
  la partition LFS (<filename class="devicefile">sda5</filename> dans
  notre exemple précédent).</para>

  <note>
    <para>Quelques distributions hôtes utilisent des fonctionnalités
    personnalisées dans leur outil de création de systèmes de fichiers
    (e2fsprogs). Ceci peut poser des problèmes lors du démarrage dans
    votre nouveau LFS au chapitre 9 car toutes ces fonctionnalités ne
    seront pas supportées par la version d'e2fsprogs installée par LFS&nbsp;;
    vous aurez une erreur du type <quote>unsupported filesystem
    features, upgrade your e2fsprogs</quote>. Pour
    voir si votre système hôte utilise des améliorations
    personnalisées, utilisez la commande suivante&nbsp;:</para>

<screen role="nodump"><userinput>debugfs -R feature /dev/<replaceable>&lt;xxx&gt;</replaceable></userinput></screen>

    <para>Si la sortie contient des fonctionnalités autres que
    <option>has_journal</option>, <option>ext_attr</option>,
    <option>resize_inode</option>, <option>dir_index</option>,
    <option>filetype</option>, <option>sparse_super</option>,
    <option>large_file</option> ou <option>needs_recovery</option>,
    alors votre système hôte pourrait avoir des améliorations personnalisées.
    Dans ce cas, pour éviter tout problème ultérieur, vous devez compiler le paquet e2fsprogs et
    utiliser les binaires résultant de cette compilation pour re-créer
    le système de fichiers sur votre partition LFS&nbsp;:</para>

<screen role="nodump"><userinput>cd /tmp
tar -xzvf /path/to/sources/e2fsprogs-&e2fsprogs-version;.tar.gz
cd e2fsprogs-&e2fsprogs-version;
mkdir -v build
cd build
../configure
make #note that we intentionally don't 'make install' here!
./misc/mke2fs -jv /dev/<replaceable>&lt;xxx&gt;</replaceable>
cd /tmp
rm -rfv e2fsprogs-&e2fsprogs-version;</userinput></screen>
  </note>

  <para>Si vous utilisez une partition de <systemitem class="filesystem">swap
  </systemitem> existante, il n'est pas nécessaire de la formater. Si vous avez créé une nouvelle
  partition <systemitem class="filesystem">swap</systemitem>, elle devra être initialisée,
  pour pouvoir être utilisée, en exécutant la commande&nbsp;:</para>

<screen role="nodump"><userinput>mkswap /dev/<replaceable>&lt;yyy&gt;</replaceable></userinput></screen>

  <para>Remplacez <replaceable>&lt;yyy&gt;</replaceable> par le nom de
  la partition de <systemitem
  class="filesystem">swap</systemitem>.</para>

</sect1>
