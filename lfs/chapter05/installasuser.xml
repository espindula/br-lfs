<sect1 id="ch05-installasuser">
<title>Installer tous les logiciels en tant qu'utilisateur non privilégié</title>
<?dbhtml filename="installasuser.html" dir="chapter05"?>

<para>Quand vous êtes connecté en tant que root dans le chapitre 5,
il est possible que certains fichiers de votre système hôte soient
écrasés par ceux que vous allez construire dans le chapitre 5. Il
existe beaucoup de raisons pour que ceci puisse arriver, par exemple parce
que la variable d'environnement $LFS n'est pas renseignée. Ecraser
des fichiers de votre système de base entraînerait certainement toutes
sortes de problèmes, c'est donc une bonne idée d'être connecté
en tant qu'utilisateur non privilégié pendant le chapitre 5. Pour
être sûr que l'environnement soit aussi propre que possible, nous
allons créer un nouvel utilisateur "lfs" qui pourra être utilisé lors de
la construction de l'installation statique. Lancer cette commande en tant
que rootcréera un nouvel utilisateur "lfs" :</para>
	
<para><screen><userinput>useradd -s /bin/bash -m lfs &amp;&amp;
passwd lfs</userinput></screen></para>
	
<para>Maintenant, nous devons donner les bonnes permissions au répertoire
<filename class="directory">$LFS/static</filename>, pour que l'utilisateur
"lfs" puisse y écrire :</para>
	
<para><screen><userinput>chown -R lfs $LFS/static</userinput></screen></para>
	
<para>Maintenant vous devez vous connecter en tant qu'utilisateur
<emphasis>lfs</emphasis> pour continuer ce chapitre. Vous pouvez faire ceci de
deux façons: soit de la façon normale par la console ou l'interface graphique,
soit avec <userinput>su - lfs</userinput>. Lorsque vous travaillez en tant
qu'utilisateur <emphasis>lfs</emphasis>, tapez la commande suivante pour
configurer un bon environnement de travail:</para>

<para><screen><userinput>cat &gt; ~lfs/.bash_profile << "EOF"
umask 022

LFS=/mnt/lfs
LC_ALL=POSIX
CC='gcc -s'
export LFS LC_ALL
EOF
source ~/.bash_profile</userinput></screen></para>

<para>Ce profil assure que le masque umask est positionné à 022 pour que
les nouveaux fichiers et répertoires soient créés avec les bonnes
permissions. Il est préférable de conserver ce paramétrage pendant
l'installation de LFS. De la même manière, les variables $LFS, $LC_ALL et $CC
sont définies. $LFS a déjà été expliquée dans les chapitres précédents.
$LC_ALL est une variable utilisée pour l'internationalisation.</para>

<para> Si votre distribution hôte utilise une version de glibc antérieure
à 2.2.4, et a une variable LC_ALL définie à autre chose que "C" ou "POSIX",
pour le travail effectué au chapitre 5, vous pouvez rencontrer des problèmes
au chapitre 6, lorsque vous quittez l'environnement chroot et essayez d'y
retourner.  En indiquant "POSIX" ("C" est un alias pour "POSIX"), nous nous
assurons que tout fonctionnera comme prévu dans l'environnement chroot.</para>

<para>$CC est une variable que nous initialisons pour empêcher les symboles
de debuggage d'être compilés dans les packages statiques. En oubliant ces
symboles lors de l'étape de l'édition de liens de la compilation, nous
sauvons de l'espacedisque et diminuons le temps de construction.</para>

</sect1>
