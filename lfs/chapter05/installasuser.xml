<sect1 id="ch05-installasuser">
<title>Installer tous les logiciels en tant qu'utilisateur normal</title>
<?dbhtml filename="installasuser.html" dir="chapter05"?>

<para>Quand vous êtes connecté en tant que root dans le chapitre 5,
il est possible que certains fichiers de votre système de base soient
écrasés par ceux que vous allez construire dans le chapitre 5. Il
existe beaucoup de raisons pour que ceci arrive, par exemple parce
que la variable d'environnement $LFS n'est pas renseignée. Ecraser
des fichiers de votre système de base va sûrement poser toutes
sortes de problèmes, c'est donc une bonne idée d'être connecté
en tant qu'utilisateur sans privilèges pendant le chapitre 5. Pour
être sûr que l'environnement soit aussi propre que possible, nous
allons créer un nouvel utilisateur "lfs" que sera utilisé pour
construire l'installation statique. Lancer cette commande en tant que root
créera un nouvel utilisateur "lfs":</para>
	
<para><screen><userinput>useradd -s /bin/bash -m lfs &amp;&amp;
passwd lfs</userinput></screen></para>
	
<para>Maintenant, nous devons donner les bonnes permissions au répertoire
<filename class="directory">$LFS/static</filename>, pour que l'utilisateur
"lfs" puisse y écrire:</para>
	
<para><screen><userinput>chown -R lfs $LFS/static</userinput></screen></para>
	
<para>Maintenant vous pouvez vous connecter en tant qu'utilisateur "lfs".
Vous pouvez faire ceci de deux façons: soit de la façon normale par la
console ou l'interface graphique, soit avec <userinput>su - lfs</userinput>.
Lorsque vous travaillez en tant qu'utilisateur "lfs", taper la commande
suivante pour configurer un bon environnement de travail:</para>

<para><screen><userinput>cat > ~/.bash_profile << "EOF"
umask 022

LFS=/mnt/lfs
LC_ALL=POSIX
CC='gcc -s'
export LFS LC_ALL
EOF
source ~/.bash_profile</userinput></screen></para>

<para>Ce profil assure que le masque umask est positionné à 022 pour que
les nouveaux fichiers et répertoires soient créés avec les bonnes
permissions. Il est préférable de conserver ce paramétrage pendant
l'installation de LFS. De la même manière, les variables $LFS, $LC_ALL et $CC
sont positionnées. $LFS a déjà été expliqué dans les chapitres précédents.
$LC_ALL est une variable utilisée pour l'internationalisation.</para>

<para>Quand votre distribution de base utilise glibc en version antérieure 
à la 2.2.4, en ayant LC_ALL valant autre chose que "C" ou "POSIX", lors du
travail du chapitre 5, peut poser des problèmes entre le moment où vous 
sortez de l'environnement chroot du chapitre 6 et que vous essayez d'y
retourner. En indiquant "POSIX" ("C" est un alias pour "POSIX"), vous vous
assurez que tout fonctionnera comme prévu dans l'environnement chroot.</para>

<para>$CC est une variable que nous initialisons pour empecher les symboles
de debuggage d'etre compilés dans les packages statiques. En oubliant ces
symboles lors de l'étape de liens de la compilation, nous sauvons de l'espace
disque et diminuons le temps de construction.</para>

</sect1>
