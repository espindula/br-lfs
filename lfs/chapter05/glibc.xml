<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-tools-glibc" role="wrap">
  <?dbhtml filename="glibc.html"?>

  <title>Glibc-&glibc-version;</title>

  <indexterm zone="ch-tools-glibc">
    <primary sortas="a-Glibc">Glibc</primary>
    <secondary>outils</secondary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <xi:include xmlns:xi="http://www.w3.org/2003/XInclude"
    href="../chapter06/glibc.xml"
    xpointer="xpointer(/sect1/sect2[1]/para[1])"/>

    <segmentedlist>
      <segtitle>&buildtime;</segtitle>
      <segtitle>&diskspace;</segtitle>

      <seglistitem>
        <seg>&glibc-ch5-sbu;</seg>
        <seg>&glibc-ch5-du;</seg>
      </seglistitem>
    </segmentedlist>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Glibc</title>

    <para>La documentation de Glibc recommande de construire Glibc en dehors du
    répertoire des sources, c'est-à-dire dans un répertoire dédié&nbsp;:</para>

<screen><userinput>mkdir -v ../glibc-build
cd ../glibc-build</userinput></screen>

    <para>Ensuite, préparez la compilation de Glibc&nbsp;:</para>

<screen><userinput>../glibc-&glibc-version;/configure --prefix=/tools \
    --disable-profile --enable-add-ons \
    --enable-kernel=2.6.0 --with-binutils=/tools/bin \
    --without-gd --with-headers=/tools/include \
    --without-selinux</userinput></screen>

    <variablelist>
      <title>Voici la signification des options de configure&nbsp;:</title>

      <varlistentry>
        <term><parameter>--disable-profile</parameter></term>
        <listitem>
          <para>Ceci construit les bibliothèques sans les informations de
          profilage. Enlevez cette option si le profilage sur les outils 
          temporaires est nécessaire.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--enable-add-ons</parameter></term>
        <listitem>
          <para>>Ceci indique à Glibc d'utiliser le composant NPTL comme
          bibliothèque de threads.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--enable-kernel=2.6.0</parameter></term>
        <listitem>
          <para>Ceci indique à Glibc de compiler la bibliothèque avec le support
          des noyaux 2.6.x.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--with-binutils=/tools/bin</parameter></term>
        <listitem>
          <para>Bien que pas nécessaire, ce commutateur nous assure qu'il ne
          reste aucune erreur provenant des programmes Binutils lors de la construction
          de Glibc.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--without-gd</parameter></term>
        <listitem>
          <para>Ce commutateur empêche la construction du programme
          <command>memusagestat</command>, qui insiste pour être lié avec les
          bibliothèques de l'hôte (libgd, libpng, libz et ainsi de suite)..</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--with-headers=/tools/include</parameter></term>
        <listitem>
          <para>Ceci dit à Glibc de se compiler contre les en-têtes qui
          viennent d'être installés dans le répertoire tools, afin qu'il sache
          exactement quelles options a le noyau et qu'il puisse s'optimiser en
          conséquence.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term><parameter>--without-selinux</parameter></term>
        <listitem>
          <para>Lors de la construction à partir d'hôtes qui incluent la
          fonctionnalité SELinux (par exemple Fedora Core 3), Glibc construira 
          le support pour SELinux. Comme l'environnement d'outils LFS ne 
          contient pas de support
          pour SELinux, une Glibc compilée avec ce support ne fonctionnera pas
          correctement.</para>
        </listitem>
      </varlistentry>

    </variablelist>

    <para>Lors de cette étape, le message d'avertissement suivant peut
    apparaître&nbsp;:</para>

    <blockquote>
<screen><computeroutput>configure: WARNING:
*** These auxiliary programs are missing or
*** incompatible versions: msgfmt
*** some features will be disabled.
*** Check the INSTALL file for required versions.</computeroutput></screen>
    </blockquote>

    <para>Le programme <command>msgfmt</command>, manquant ou incompatible, ne
    pose généralement pas de problème mais certaines personnes pensent qu'il 
    peut poser problème lors de l'exécution de la suite de tests. Ce programme
    <command>msgfmt</command> fait partie du paquet Gettext que la distribution hôte
    devrait fournir. Si <command>msgfmt</command> est présent mais semble
    incompatible, mettez à jour le paquet Gettext du système hôte ou continuez sans
    et voyez si la suite de tests continue son exécution sans problèmes.</para>

    <para>Compilez le paquet&nbsp;:</para>

<screen><userinput>make</userinput></screen>

    <para>La compilation est maintenant terminée. Comme dit plus tôt, lancer les
    suites de tests pour les outils temporaires de ce chapitre n'est pas nécessaire.
    Pour exécuter la suite de tests Glibc, si désiré, lancez la commande
    suivante&nbsp;:</para>

<screen><userinput>make check</userinput></screen>

    <para>Pour une discussion sur les échecs de tests qui ont une importance
    particulière, merci de voir <xref linkend="ch-system-glibc" role="."/></para>

    <para>Dans ce chapitre, certains tests peuvent être perturbés par des outils
    existants ou par des problèmes d'environnement sur le système hôte. Les échecs
    de la suite de tests de Glibc dans ce chapitre ne portent typiquement pas à
    conséquence. La bibliothèque Glibc installée dans
    <xref linkend="chapter-building-system"/> est celle qui sera utilisée à 
    la fin, donc c'est celle qui aura besoin de passer la plupart des tests (y 
    compris dans <xref linkend="chapter-building-system"/>, certains échecs pourraient survenir, par
    exemple celui des mathématiques)..</para>

    <para>Si vous rencontrez un échec, prenez-en note puis continuez en
    ré-exécutant la commande <command>make check</command>. La suite de tests devrait
    reprendre là où elle a quitté précédemment. Cette séquence d'arrêt/relancement
    est annulée en lançant la commande <command>make -k check</command>.
    En utilisant cette option, assurez-vous de tracer la sortie pour que le 
    journal des traces puisse être examiné plus tard pour les différents échecs.</para>

    <para>L'étape d'installation de Glibc affichera un message d'avertissement sans
    conséquence pour l'absence de 
    <filename>/tools/etc/ld.so.conf</filename>.
    Supprimez ce message avec&nbsp;:</para>

<screen><userinput>mkdir -v /tools/etc
touch /tools/etc/ld.so.conf</userinput></screen>

    <para>Installez le paquet&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

    <para>Différents pays et cultures ont des conventions variables sur la 
    façon de communiquer. Ces conventions vont du très simple, telle que la 
    représentation de la date et de l'heure à du très compliqué, telle que le 
    langage parlé. 
    L'<quote>internationalisation</quote> des programmes GNU fonctionne en 
    utilisant les locales.</para>

    <note>
      <para>Si les suites de tests ne seront pas exécutés dans ce chapitre
      (suivant ainsi notre recommandation), il y a peu d'intérêts à installer les
      locales maintenant. Les bonnes locales seront installées dans le chapitre
      suivant.
      Néanmoins, pour installer les locales Glibc, utilisez les instructions de
      la section <xref linkend="ch-system-glibc" role="."/></para>
    </note>

  </sect2>

  <sect2 role="content">
    <title/>

    <para>Les détails sur ce paquet sont situés dans
    <xref linkend="contents-glibc" role="."/></para>

  </sect2>

</sect1>
