<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-preps-addinguser">
  <?dbhtml filename="addinguser.html"?>

  <title>Ajouter l'utilisateur LFS</title>

  <para>Lorsque vous êtes connecté en tant qu'utilisateur <systemitem
class="username">root</systemitem>, faire une simple erreur peut endommager
voire dévaster votre système. Donc, les paquets dans les deux prochains
chapitres sont construits en tant qu'utilisateur non privilégié. Vous pouvez
bien sûr utiliser votre propre nom d'utilisateur mais, pour faciliter
l'établissement d'un environnement de travail propre, créez un nouvel
utilisateur <systemitem class="username">lfs</systemitem> comme membre d'un
nouveau groupe (aussi nommé <systemitem class="groupname">lfs</systemitem>)
et utilisez cet utilisateur lors du processus d'installation. En tant que
<systemitem class="username">root</systemitem>, lancez les commandes
suivantes pour créer le nouvel utilisateur&nbsp;:</para>

<screen><userinput>groupadd lfs
useradd -s /bin/bash -g lfs -m -k /dev/null lfs</userinput></screen>

  <variablelist>
    <title>Voici la signification des options de la ligne de commande&nbsp;:</title>

    <varlistentry>
      <term><parameter>-s /bin/bash</parameter></term>
      <listitem>
        <para>Ceci fait de <command>bash</command> le shell par défaut de l'utilisateur
<systemitem class="username">lfs</systemitem>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><parameter>-g lfs</parameter></term>
      <listitem>
        <para>Cette option ajoute l'utilisateur <systemitem
class="username">lfs</systemitem> au groupe <systemitem
class="groupname">lfs</systemitem>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><parameter>-m</parameter></term>
      <listitem>
        <para>Ceci crée un répertoire personnel pour l'utilisateur <systemitem
class="username">lfs</systemitem>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><parameter>-k /dev/null</parameter></term>
      <listitem>
        <para>Ce paramètre empêche toute copie possible de fichiers provenant du
répertoire squelette (par défaut, <filename
class="directory">/etc/skel</filename>) en modifiant son emplacement par le
périphérique spécial null.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term><parameter>lfs</parameter></term>
      <listitem>
        <para>Ceci est le nom réel pour l'utilisateur créé.</para>
      </listitem>
    </varlistentry>

  </variablelist>

  <para>Pour vous connecter en tant qu'utilisateur <systemitem
class="username">lfs</systemitem> (et non pas de passer à l'utilisateur
<systemitem class="username">lfs</systemitem> alors que vous êtes connecté
en tant que <systemitem class="username">root</systemitem>, ce qui ne
requiert pas de mot de passe pour l'utilisateur <systemitem
class="username">lfs</systemitem>), donnez un mot de passe à <systemitem
class="username">lfs</systemitem>&nbsp;:</para>

<screen role="nodump"><userinput>passwd lfs</userinput></screen>

  <para>Donnez à <systemitem class="username">lfs</systemitem> un accès complet aux
répertoires de <filename class="directory">$LFS</filename> en indiquant que
<systemitem class="username">lfs</systemitem> est le propriétaire du
répertoire&nbsp;:</para>

<screen><userinput>chown -v lfs $LFS/{usr{,/*},lib,var,etc,bin,sbin,tools}
case $(uname -m) in
  x86_64) chown -v lfs $LFS/lib64 ;;
esac</userinput></screen>

  <para>Si un répertoire de travail séparé a été créé comme suggéré, faites en sorte
que l'utilisateur <systemitem class="username">lfs</systemitem> soit aussi
le propriétaire de ce répertoire&nbsp;:</para>

<screen><userinput>chown -v lfs $LFS/sources</userinput></screen>

  <note><para>Sur certains systèmes hôtes, la commande suivante ne termine pas
correctement et place la connexion vers l'utilisateur lfs en tâche de
fond. Si l'invite de commande «&nbsp;lfs:~$&nbsp;» n'apparaît pas
immédiatement, saisissez la commande <command>fg</command> pour corriger le
problème.</para></note>

  <para>Ensuite, connectez-vous en tant que <systemitem
class="username">lfs</systemitem>. Ceci peut se faire via une console
virtuelle, avec le gestionnaire d'affichage ou avec la commande suivante de
substitution d'utilisateur&nbsp;:</para>

<screen role="nodump"><userinput>su - lfs</userinput></screen>

  <para>Le <quote><parameter>-</parameter></quote> indique à <command>su</command>
de lancer un shell de connexion. Vous trouverez la différence entre un shell
de connexion et un autre dans la page de manuel <filename>bash(1)</filename>
et <command>info bash</command>.</para>

</sect1>
