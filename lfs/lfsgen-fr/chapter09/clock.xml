<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-config-clock" revision="systemd">
  <?dbhtml filename="clock.html"?>

  <title>Configuration de l'horloge système</title>

  <indexterm zone="ch-config-clock">
    <primary sortas="d-clock">clock</primary>
  <secondary>configuration</secondary></indexterm>

  <para>Cette section parle de la manière de configurer le service système
<command>systemd-timedated</command>, qui configure l'horloge et le fuseau
horaire système.</para>

  <para>Si vous ne vous souvenez pas si l'horloge matérielle est configurée en UTC
ou non, trouvez le en lançant la commande <userinput>hwclock --localtime
--show</userinput>. Cela va afficher l'heure actuelle d'après l'horloge
matérielle. Si l'heure correspond à celle de votre montre, alors votre
horloge système est configurée à l'heure locale. Si la sortie de
<command>hwclock</command> n'est pas l'heure locale, il y a des chances
qu'elle soit configurée en UTC. Vérifiez cela en ajoutant ou retirant le bon
nombre d'heures par rapport à l'heure affichée par
<command>hwclock</command>. Par exemple si vous êtes dans le fuseau horaire
MST, qui est aussi connu comme GMT -7, ajoutez 7 heures à l'heure locale.</para>

  <para><command>systemd-timedated</command> lit <filename>/etc/adjtime</filename>,
et en fonction de ce qui est écrit dans le fichier, met l'horloge en UTC ou
en heure locale.</para>

  <para>Créez le fichier <filename>/etc/adjtime</filename> avec le contenu suivant
si votre horloge matérielle est configurée en heure locale&nbsp;:</para>

<screen><userinput>cat &gt; /etc/adjtime &lt;&lt; "EOF"
<literal>0.0 0 0.0
0
LOCAL</literal>
EOF</userinput></screen>

  <para>Si le fichier <filename>/etc/adjtime</filename>  n'est pas présent au
premier démarrage, <command>systemd-timedated</command> va considérer que
l'horloge matérielle est configurée en UTC et ajuster le fichier en accord
avec cela.</para>

  <para>Vous pouvez également utiliser l'utilitaire <command>timedatectl</command>
pour signaler à <command>systemd-timedated</command> si votre horloge
matérielle est initialisée en UTC ou en temps local&nbsp;:</para>

<screen role="nodump"><userinput>timedatectl set-local-rtc 1</userinput></screen>

  <para><command>timedatectl</command> peut également être utilisé pour changer
l'heure système et le fuseau horaire.</para>

  <para>Pour changer l'heure actuelle du système, tapez&nbsp;:</para>

<screen role="nodump"><userinput>timedatectl set-time YYYY-MM-DD HH:MM:SS</userinput></screen>

  <para>L'horloge matérielle sera également mise à jour en conséquence.</para>

  <para>Pour changer de fuseau horaire, tapez:</para>

<screen role="nodump"><userinput>timedatectl set-timezone TIMEZONE</userinput></screen>

  <para>Vous pouvez avoir une liste des fuseaux horaires disponibles en
tapant&nbsp;:</para>

<screen role="nodump"><userinput>timedatectl list-timezones</userinput></screen>

  <note><para>Merci de noter que la commande <command>timedatectl</command> peut être
utilisée seulement sur un système démarré avec systemd.</para></note>

  <sect2>
    <title>Synchronisation réseau du temps</title>

    <para>Depuis la version 213, systemd livre un démon appelé
<command>systemd-timesyncd</command> qui peut être utilisé pour synchroniser
l'heure système avec les serveurs NTP distants.</para>

    <para>Le démon n'est pas prévu pour remplacer le démon bien établit NTP, mais
comme client du protocole SNTP qui peut être utilisé pour les tâches moins
avancées et sur les systèmes à ressources limitées.</para>

    <para>Depuis la version 216, le démon <command>systemd-timesyncd</command> est
activé par défaut. Si vous voulez le désactiver, tapez la commande
suivante&nbsp;:</para>

<screen role="nodump"><userinput>systemctl disable systemd-timesyncd</userinput></screen>

    <para>Le fichier <filename>/etc/systemd/timesyncd.conf</filename> peut être
utilisé pour changer les serveurs NTP avec lesquels
<command>systemd-timesyncd</command> se synchronisent</para>

    <para>Merci de noter que quand l'horloge système est initialisée en temps local,
<command>systemd-timesyncd</command> ne mettra pas à jour l'horloge système.</para>

  </sect2>

</sect1>
