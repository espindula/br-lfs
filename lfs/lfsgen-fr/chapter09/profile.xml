<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-config-profile" revision="sysv">
  <?dbhtml filename="profile.html"?>

  <title>Fichiers de démarrage du shell Bash</title>

  <indexterm zone="ch-config-profile">
    <primary sortas="e-/etc/profile">/etc/profile</primary>
  </indexterm>

  <para>Le programme shell <command>/bin/bash</command> (dénommé ci-après <quote>le
shell</quote>) utilise une collection de fichiers de démarrage pour aider à
la création d'un environnement d'exécution.  Chaque fichier a une
utilisation spécifique et pourrait avoir des effets différents sur les
environnements de connexion et interactif.  Les fichiers du répertoire
<filename class="directory">/etc</filename> fournissent un paramétrage
global. Si un fichier équivalent existe dans le répertoire personnel, il
pourrait surcharger les paramétrages globaux.</para>

  <para>Un shell interactif de connexion est lancé après une connexion réussie, en
utilisant <command>/bin/login</command>, par la lecture du fichier
<filename>/etc/passwd</filename>. Un shell interactif sans connexion est
lancé en ligne de commande (c'est-à-dire
<prompt>[prompt]$</prompt><command>/bin/bash</command>). Un shell non
interactif est habituellement présent quand un script shell est en cours
d'exécution. Il est non interactif parce qu'il traite un script et n'attend
pas une saisie de l'utilisateur entre les commandes.</para>

  <para>Pour plus d'informations, voir <command>info bash</command> sous la section
<emphasis>Bash Startup Files and Interactive Shells</emphasis> (Fichiers de
démarrage de Bash et shells interactifs).</para>

  <para>Les fichiers <filename>/etc/profile</filename> et
<filename>~/.bash_profile</filename> sont lus quand le shell est appelé en
tant que shell interactif de connexion.</para>

  <para>Le fichier <filename>/etc/profile</filename> de base ci-dessous configure
quelques variables d'environnement nécessaires à la prise en charge native
des langues. Les configurer convenablement permet ce qui suit&nbsp;:</para>

  <itemizedlist>
    <listitem>
      <para>La sortie des programmes traduite dans la langue maternelle&nbsp;;</para>
    </listitem>
    <listitem>
      <para>Un classement correct des caractères en lettres, chiffres et autres
classes. Ceci est nécessaire pour que <command>bash</command> accepte
correctement les caractères non-ASCII dans les lignes de commandes pour les
locales autres que l'anglais&nbsp;;</para>
    </listitem>
    <listitem>
      <para>L'ordre de tri alphabétique correct pour le pays&nbsp;;</para>
    </listitem>
    <listitem>
      <para>Taille de papier par défaut appropriée</para>
    </listitem>
    <listitem>
      <para>Le bon formatage des valeurs monétaires, d'heure et de dates.</para>
    </listitem>
  </itemizedlist>

  <para>Remplacez <replaceable>&lt;ll&gt;</replaceable> ci-dessous par le code à
deux lettres de la langue désirée (par exemple, <quote>fr</quote>) et
<replaceable>&lt;CC&gt;</replaceable> avec le code à deux lettres du pays
approprié (par exemple, <quote>FR</quote>).
<replaceable>&lt;charmap&gt;</replaceable> devra être remplacé avec le jeu
de caractères canonique de la locale choisie. Des modificateurs optionnels
comme <quote>@euro</quote> peuvent aussi être présents.</para>

  <para>La liste de toutes les locales prises en charge par Glibc peut être obtenue
en exécutant la commande suivante&nbsp;:</para>

<screen role="nodump"><userinput>locale -a</userinput></screen>

  <para>Les locales peuvent avoir plusieurs synonymes. Par exemple,
<quote>ISO-8859-1</quote> est aussi appelée <quote>iso8859-1</quote> et
<quote>iso88591</quote>. Quelques applications ne peuvent pas gérer les
différents synonymes correctement (elles nécessitent par exemple l'écriture
de <quote>UTF-8</quote> sous la forme <quote>UTF-8</quote> et non
<quote>utf8</quote>), donc il est plus sûr de choisir le nom canonique pour
une locale particulière. Pour déterminer le nom canonique, lancez la
commande suivante, où <replaceable>&lt;nom locale&gt;</replaceable> est
l'affichage donné par <command>locale -a</command> pour votre locale
préférée (<quote>fr_FR.iso88591</quote> dans notre exemple).</para>

<screen role="nodump"><userinput>LC_ALL=<replaceable>&lt;nom_de_la_locale&gt;</replaceable> locale charmap</userinput></screen>

  <para>Pour la locale <quote>fr_FR.iso88591</quote>, la commande ci-dessus
affichera&nbsp;:</para>

<screen><computeroutput>ISO-8859-1</computeroutput></screen>

  <para>Ceci résulte en un paramétrage final de locale avec
<quote>fr_FR.ISO-8859-1</quote>. Il est important que la locale trouvée
utilisant l'heuristique ci-dessus soit testée avant d'être ajoutée aux
fichiers de démarrage de Bash&nbsp;:</para>

<screen role="nodump"><userinput>LC_ALL=&lt;nom_de_la_locale&gt; locale language
LC_ALL=&lt;nom_de_la_locale&gt; locale charmap
LC_ALL=&lt;nom_de_la_locale&gt; locale int_curr_symbol
LC_ALL=&lt;nom_de_la_locale&gt; locale int_prefix</userinput></screen>

  <para>Les commandes ci-dessus devraient afficher le nom de la langue, le codage
des caractères utilisé par le paramètre régional, la monnaie et le préfixe
du pays à composer avant de saisir un numéro de téléphone. Si une des
commandes ci-dessus échoue avec un message similaire à un de ceux montrés
ci-dessous, cela signifie que votre paramètre linguistique n'a pas été
installé au chapitre <xref linkend="ch-system-glibc"/> ou qu'il n'est pas
pris en charge par l'installation par défaut de Glibc.</para>

<screen><computeroutput>locale: Cannot set LC_* to default locale: No such file or directory</computeroutput></screen>

  <para>Si cela arrive, vous pouvez soit installer la locale désirée en utilisant la
commande <command>localedef</command> soit considérer l'utilisation d'une
locale différente. Les instructions suivantes supposent qu'il n'y a pas eu
de tels messages de Glibc.</para>

  
  
  <!-- FIXME: the xlib example will became obsolete real soon -->
<!--<para>
Some packages beyond LFS may also lack support for your chosen locale. One
  example is the X library (part of the X Window System), which outputs the
  following error message if the locale does not exactly match one of the character
  map names in its internal files:</para>

<screen><computeroutput>Warning: locale not supported by Xlib, locale set to C</computeroutput></screen>

  <para>In several cases Xlib expects that the character map will be listed in
  uppercase notation with canonical dashes. For instance, "ISO-8859-1" rather
  than "iso88591". It is also  possible to find an appropriate specification by
  removing the charmap part of the locale specification.  This can be checked
  by running the <command>locale charmap</command> command in both locales.
  For example, one would have to change "de_DE.ISO-8859-15@euro" to
  "de_DE@euro" in order to get this locale recognized by Xlib.</para>
-->
<para>D'autres paquets peuvent aussi mal fonctionner (mais pourraient ne pas
nécessairement afficher de messages d'erreurs) si le nom de la locale ne
correspond pas à leur attente. Dans de tels cas, vous pouvez obtenir des
informations utiles en cherchant comment les autres distributions Linux
prennent en charge votre locale.</para>

  <para>Une fois que les bons paramètres de locale ont été déterminés, créez le
fichier <filename>/etc/profile</filename>&nbsp;:</para>

<screen><userinput>cat &gt; /etc/profile &lt;&lt; "EOF"
<literal># Début de /etc/profile

export LANG=<replaceable>&lt;ll&gt;_&lt;CC&gt;.&lt;charmap&gt;&lt;@modifiers&gt;</replaceable>

# Fin de /etc/profile</literal>
EOF</userinput></screen>

  <para>Les paramètres régionaux <quote>C</quote> (par défaut) et
<quote>en_US.utf8</quote> (celle recommandée pour les utilisateurs de langue
anglaise vivant aux États-Unis) sont différentes. <quote>C</quote> utilise
le codage US-ASCII 7-bit et traite les octets utilisant le bit de poids le
plus fort comme des caractères invalides. C'est pourquoi, par exemple, la
commande <command>ls</command> les remplace par des points d'interrogation
sous ce paramètre. De même, essayer d'envoyer un courriel avec de tels
caractères depuis Mutt ou Pine envoi des messages non compatibles avec la
RFC (le codage du mail sortant est indiqué comme <quote>8-bit
inconnu</quote>). Donc, vous ne pouvez utiliser le paramètre
<quote>C</quote> que si vous êtes sûr de ne jamais avoir besoin de
caractères 8-bit.</para>

  <para>Les locales basées sur UTF-8 ne sont pas bien prises en charge par certains
programmes. Le travail progresse pour documenter et, si possible, réparer de
tels problèmes, voir <ulink
url="&blfs-book;introduction/locale-issues.html"/>.</para>

</sect1>
