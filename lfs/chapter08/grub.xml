<sect1 id="ch08-grub">
<title>Rendre le système LFS démarrable</title>
<?dbhtml filename="grub.html" dir="chapter08"?>

<para>Maintenant que notre nouveau système LinuxFromScratch est terminé, nous devons
nous assurer qu'il puisse se lancer. Pour cela, nous allons lancer le programme grub.
</para>

<para><screen><userinput>grub</userinput></screen></para>

<para>Grub utilise sa propre structure de nommage des lecteurs, sous la forme hd(a,b),
où a est le numéro du disque dur et b le numéro de la partition, les deux commençant
à partir de zéro. Donc, la partition hda1 serait (hd0,0) pour grub et hdb2 serait
hd(1,1). De même, Grub ne prêt pas du tout attention aux lecteurs de CDROM, donc si,
par exemple, vous avez un CD sur hdb et un deuxième disque dur sur hdc, les partitions
du deuxième disque dur seront toujours (hd1,b).</para>

<para>Donc, en utilisant l'information ci-dessus, sélectionnez la bonne désignation
pour votre partition racine. Dans ce contexte, nous supposerons (hd0,3) comme étant
votre partition racine. Tout d'abord, indiquons à grub où il peut trouver ses
fichiers:</para>

<para><screen><userinput>root (hd0,3)
setup (hd0)
quit</userinput></screen></para>

<para>Ceci indique à grub de rechercher ses fichiers sur hda4 (hd0,3) et de
s'installer sur le MBR (Master Boot Record) de hda.</para>

<para>De même, nous aurons besoin de créer le fichier <filename>menu.lst</filename>
que Grub utilise pour désigner son menu de démarrage:</para>

<para><screen><userinput>cat &gt; /boot/grub/menu.lst &lt;&lt; "EOF"
# Début /boot/grub/menu.lst

# Par défaut, la première entrée
default 0

# Autorise 30 secondes avant de démarrer suivant la valeur par défaut
timeout 30

# Utilise de plus jolies couleurs
color green/black light-green/black

# Entrée par défaut pour LFS
title LFS 5.0
root (hd0,3)
kernel /boot/lfskernel root=/dev/hda4 ro
EOF</userinput></screen></para>

<para>Vous pourriez aussi vouloir ajouter une entrée pour votre distribution hôte.
Cela devrait ressembler à ceci:</para>

<para><screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"
# Redhat Linux
title Redhat
root (hd0,2)
kernel /boot/kernel-2.4.20 root=/dev/hda3 ro
initrd /boot/initrd-2.4.20
EOF</userinput></screen></para>

<para>De même, si vous utilisez aussi Windows sur cette machine, l'entrée suivante
devrait vous permettre de le lancer:</para>

<para><screen><userinput>cat &gt;&gt; /boot/grub/menu.lst &lt;&lt; "EOF"
# Windows
title Windows
rootnoverify (hd0,0)
chainloader +1
EOF</userinput></screen></para>

<para>Vous pouvez trouver plus d'informations concernant Grub sur son site web situé
sur <ulink url="http://www.gnu.org/software/grub"/>, ainsi que sur l'astuce LFS Grub
disponible sur : <ulink url="http://www.linuxfromscratch.org/hints/downloads/files/grub-howto.txt"/>.</para>

</sect1>

