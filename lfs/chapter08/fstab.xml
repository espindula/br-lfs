<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-bootable-fstab">
  <?dbhtml filename="fstab.html"?>

  <title>Créer le fichier /etc/fstab</title>

  <indexterm zone="ch-bootable-fstab">
    <primary sortas="e-/etc/fstab">/etc/fstab</primary>
  </indexterm>

  <para>Le fichier <filename>/etc/fstab</filename> est utilisé par
    quelques programmes pour déterminer les systèmes de fichiers à monter par
    défaut, dans quel ordre, et lesquels doivent être vérifiés
    (recherche d'erreurs d'intégrité) avant le montage.
    Créez une nouvelle table des systèmes de fichiers comme ceci&nbsp;:</para>

<screen><userinput>cat &gt; /etc/fstab &lt;&lt; "EOF"
<literal># Début de /etc/fstab

# file system  mount-point  type     options             dump  fsck
#                                                              order

/dev/<replaceable>&lt;xxx&gt;</replaceable>     /            <replaceable>&lt;fff&gt;</replaceable>    defaults            1     1
/dev/<replaceable>&lt;yyy&gt;</replaceable>     swap         swap     pri=1               0     0
proc           /proc        proc     nosuid,noexec,nodev 0     0
sysfs          /sys         sysfs    nosuid,noexec,nodev 0     0
devpts         /dev/pts     devpts   gid=5,mode=620      0     0
tmpfs          /run         tmpfs    defaults            0     0
devtmpfs       /dev         devtmpfs mode=0755,nosuid    0     0

# Fin de /etc/fstab</literal>
EOF</userinput></screen>

  <para>Remplacez <replaceable>&lt;xxx&gt;</replaceable>,
  <replaceable>&lt;yyy&gt;</replaceable> et <replaceable>&lt;fff&gt;</replaceable>
  par les valeurs appropriées pour votre système, par exemple
  <filename class="partition">sda2</filename>,
  <filename class="partition">sda5</filename> et
  <systemitem class="filesystem">ext4</systemitem>.
  Pour tous les détails sur les six champs de cette table,
  voyez <command>man 5 fstab</command>.</para>

<!--
  <para>The <filename class="directory">/dev/shm</filename> mount point
  for <systemitem class="filesystem">tmpfs</systemitem> is included to
  allow enabling POSIX-shared memory. The kernel must have the required
  support built into it for this to work (more about this is in the next
  section). Please note that very little software currently uses
  POSIX-shared memory.  Therefore, consider the <filename
  class="directory">/dev/shm</filename> mount point optional. For more
  information, see
  <filename>Documentation/filesystems/tmpfs.txt</filename> in the kernel
  source tree.</para>
-->

  <para>Les systèmes de fichiers ayant pour origine MS-DOS ou Windows
  (c-à-d vfat, ntfs, smbfs, cifs, iso9660, udf) ont besoin de
  l'option de montage <quote>iocharset</quote> afin d'interpréter
  correctement les caractères non ASCII dans les noms de fichier. La
  valeur de cette option devrait être la même que le jeu de caractères de votre
  locale, ajustée de telle sorte que le noyau la comprenne. Cela fonctionne si
  la définition du codage adéquat (que vous trouvez sous File systems
  -&gt; Native Language Support) a été compilée en dur dans le noyau ou en module.
  L'option <quote>codepage</quote> est aussi nécessaire aux systèmes de fichiers vfat et smbfs.
  Elle devrait être paramétrée pour correspondre à la page de code utilisée sous MS-DOS dans votre pays.
  Par exemple, pour monter des lecteurs flash USB, un utilisateur ru_RU.KOI8-R aurait besoin de ce qui suit
  dans la partie des options de sa ligne de montage dans <filename>/etc/fstab</filename>&nbsp;:</para>

<screen><literal>noauto,user,quiet,showexec,iocharset=koi8r,codepage=866</literal></screen>

  <para>Le fragment d'options correspondantes pour les utilisateurs ru_RU.UTF-8 est&nbsp;:</para>

<screen><literal>noauto,user,quiet,showexec,iocharset=utf8,codepage=866</literal></screen>

  <note>
    <para>Dans ce dernier cas, le noyau émet le message suivant&nbsp;:</para>

<screen><computeroutput>FAT: utf8 is not a recommended IO charset for FAT filesystems,
    filesystem will be case sensitive!</computeroutput></screen>

    <para>Vous devriez ignorer cette recommandation négative, puisque toutes
    les autres valeurs de l'option <quote>iocharset</quote> aboutissent à
    un mauvais affichage des noms de fichier avec les locales UTF-8.</para>
  </note>

  <para>Il est aussi possible de spécifier les valeurs de page de code
  et de codage entrée/sortie (iocharset) par défaut pour certains
  systèmes de fichiers pendant la configuration du noyau. Les paramètres
  pertinents sont nommés
  <quote>Default NLS Option</quote> (<option>CONFIG_NLS_DEFAULT)</option>,
  <quote>Default Remote NLS Option</quote> (<option>CONFIG_SMB_NLS_DEFAULT</option>),
  <quote>Default codepage for FAT</quote> (<option>CONFIG_FAT_DEFAULT_CODEPAGE</option>) et
  <quote>Default iocharset for FAT</quote> (<option>CONFIG_FAT_DEFAULT_IOCHARSET</option>).
  Il n'y a aucun moyen de spécifier ces paramètres pour les systèmes de fichiers
  ntfs au moment de la compilation du noyau.</para>
  <!-- Personally, I find it more foolproof to always specify the iocharset and
  codepage in /etc/fstab for MS-based filesystems - Alexander E. Patrakov -->

  <para>Il est possible de rendre le système de fichiers ext3 résistant aux coupures de courant
   pour certains types de disques durs.
   Pour cela, ajoutez l'option de montage <option>barrier=1</option> à l'entrée appropriée dans
  <filename>/etc/fstab</filename>. Pour vérifier si le périphérique supporte cette option, lancez
  <ulink url="&blfs-root;cvs/general/hdparm.html">hdparm</ulink>
  sur le périphérique où elle s'appliquera. Par exemple, si&nbsp;:</para>

<screen role="nodump"><userinput>hdparm -I /dev/sda | grep NCQ</userinput></screen>

  <para>ne retourne pas une sortie non vide, l'option est supportée.</para>

  <para>Remarque&nbsp;: Les partitions basées sur <foreignphrase>Logical Volume Management</foreignphrase> (LVM)
  ne peuvent pas utiliser l'option <option>barrier</option>.</para>

</sect1>
