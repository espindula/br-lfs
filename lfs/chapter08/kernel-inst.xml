<sect2><title>&nbsp;</title><para>&nbsp;</para></sect2>

<sect2>
<title>Installation du noyau</title>

<para>Construire le noyau implique un certain nombre d'étapes: configuration,
compilation et installation. Si vous n'aimez pas la façon dont ce livre
configure le noyau, jetez un oeil sur le fichier <filename>README</filename>
contenu dans les sources du noyau pour d'autres méthodes.</para>

<para>Préparez la compilation en lançant la commande suivante:</para>

<screen><userinput>make mrproper</userinput></screen>

<para>Ceci nous assure que le répertoire du noyau est complètement nettoyé.
L'équipe du noyau recommande que cette commande soit lancée avant
<emphasis>chaque</emphasis> compilation du noyau. Vous ne devez pas penser
que le répertoire des sources soit propre juste après avoir été déballé.</para>

<para>Configurez le noyau via une interface par menu:</para>

<screen><userinput>make menuconfig</userinput></screen>

<para><userinput>make oldconfig</userinput> peut être plus approprié dans
certaines situations. Voir le fichier <filename>README</filename> pour plus
d'informations.</para>

<para>Si vous le souhaitez, vous pouvez éviter la configuration du noyau en
copiant le fichier de configuration du noyau, <filename>.config</filename>, à
partir de votre système hôte (en supposant qu'il soit disponible) vers le
répertoire <filename
class="directory">$LFS/usr/src/linux-&kernel-version;</filename>. Néanmoins,
nous ne recommendons pas cette option. Vous ferez bien mieux d'explorer tous les
menus de configuration et de créer la configuration de votre propre noyau à
partir de rien.</para>

<para>Pour le support de la mémoire partagée POSIX, assurez-vous que l'option de
configuration du noyau "Virtual memory file system support" est activée. Elle
réside dans le menu "File systems" et est normalement activée par défaut.</para>

<para>Il est important de noter que pour être conforme avec les réquisitions de
la mémoire partagée POSIX, nous devons active l'option du système de fichiers
tmpfs et nous devons monter un système de fichiers tmpfs à partir de
<filename>/dev/shm</filename>.</para>

<para>Vérifiez les dépendances et créez les fichiers d'information sur
dépendances:</para>

<screen><userinput>make CC=/opt/gcc-2.95.3/bin/gcc dep</userinput></screen>

<para>Compilez l'image du noyau:</para>

<screen><userinput>make CC=/opt/gcc-2.95.3/bin/gcc bzImage</userinput></screen>

<para>Compilez les pilotes qui ont été configurés comme modules:</para>

<screen><userinput>make CC=/opt/gcc-2.95.3/bin/gcc modules</userinput></screen>

<para>Si vous avez l'intention d'utiliser des modules du noyau, vous aurez
besoin d'un fichier <filename>/etc/modules.conf</filename>. L'information sur
les modules et sur la configuration du noyau sont disponibles en général dans la
documentation du noyau, qui est stockée dans
<filename>linux-&kernel-version;/Documentation</filename>. La page man
modules.conf et le HOWTO du noyau (<ulink
url="&tldp-root;HOWTO/Kernel-HOWTO.html"/> peuvent aussi vous intéresser.</para>

<para>Installez les modules:</para>

<screen><userinput>make CC=/opt/gcc-2.95.3/bin/gcc modules_install</userinput></screen>

<para>Comme rien n'est terminé sans documentation, construisez les pages man
venant avec le noyau:</para>

<screen><userinput>make mandocs</userinput></screen>

<para>Et installez ces pages:</para>

<screen><userinput>cp -a Documentation/man /usr/share/man/man9</userinput></screen>

<para>La compilation du noyau est terminée, mais certains des fichiers créés
résident toujours dans le répertoire des sources. Pour terminer l'installation,
deux fichiers doivent être copiés dans le répertoire <filename>/boot</filename>.
</para>

<para>Le chemin vers le fichier du noyau peut varier suivant la plateforme que
vous utilisez. Lancez la commande suivante pour installer le noyau:</para>

<screen><userinput>cp arch/i386/boot/bzImage /boot/lfskernel</userinput></screen>

<para><filename>System.map</filename> est un fichier de symbôles du noyau.
Il indique les points d'entrées de chaque fonction dans l'API du noyau, mais
aussi les adresses des structures de données propres noyau en cours
d'exécution. Lancez la commande suivante pour installer le fichier map:</para>

<screen><userinput>cp System.map /boot</userinput></screen>

</sect2>
