<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.4//EN" "http://www.oasis-open.org/docbook/xml/4.4/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-hotplug" xreflabel="Hotplug" role="wrap">
<title>Hotplug-&hotplug-version;</title>
<?dbhtml filename="hotplug.html"?>

<indexterm zone="ch-system-hotplug"><primary sortas="a-Hotplug">Hotplug</primary></indexterm>

<sect2 role="package"><title/>
<para>Le paquetage Hotplug contient des scripts qui réagissent aux événements
hotplug générés par le noyau. De tels événements correspondent à chaque
modification de l'état du noyau, visible dans le système de fichiers <systemitem
class="filesystem">sysfs</systemitem>, c'est-à-dire l'ajout et la suppression
de matériels. Ce paquetage détecte aussi le matériel existant lors du démarrage
et insère les modules adéquats dans le noyau en cours d'exécution.</para>

<segmentedlist>
<segtitle>&buildtime;</segtitle>
<segtitle>&diskspace;</segtitle>
<seglistitem><seg>0,01&nbsp;SBU</seg><seg>460&nbsp;Ko</seg></seglistitem>
</segmentedlist>

<segmentedlist>
<segtitle>&dependencies;</segtitle>
<seglistitem><seg>Bash, Coreutils, Find, Gawk et Make</seg></seglistitem>
</segmentedlist>
</sect2>

<sect2 role="installation">
<title>Installation de Hotplug</title>

<para>Installez le paquetage Hotplug&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

<para>Copiez un fichier que la cible <quote>install</quote> oublie.</para>

<screen><userinput>cp -v etc/hotplug/pnp.distmap /etc/hotplug</userinput></screen>

<para>Supprimez le script de démarrage qu'Hotplug installe car nous allons
utiliser le script inclus dans le paquetage LFS-Bootscripts&nbsp;:</para>

<screen><userinput>rm -rfv /etc/init.d</userinput></screen>

<para>La découverte via Hotplug des périphériques réseau n'est pas encore
supportée par le paquetage LFS-Bootscripts. Pour cette raison, supprimez l'agent
hotplug pour le réseau&nbsp;:</para>

<screen><userinput>rm -fv /etc/hotplug/net.agent</userinput></screen>

<para>Créez un répertoire pour stocker les <foreignphrase>firmware</foreignphrase>
pouvant être chargés par <command>hotplug</command>&nbsp;:</para>

<screen><userinput>mkdir -v /lib/firmware</userinput></screen>

</sect2>

<sect2 id="contents-hotplug" role="content"><title>Contenu de Hotplug</title>

<segmentedlist>
<segtitle>Programme installé</segtitle>
<segtitle>Scripts installés</segtitle>
<segtitle>Fichiers installés</segtitle>
<seglistitem><seg>hotplug</seg>
<seg>/etc/hotplug/*.rc, /etc/hotplug/*.agent</seg>
<seg>/etc/hotplug/hotplug.functions, /etc/hotplug/blacklist, /etc/hotplug/{pci,usb},
/etc/hotplug/usb.usermap, /etc/hotplug.d et /var/log/hotplug/events</seg></seglistitem>
</segmentedlist>

<beginpage/>

<variablelist><bridgehead renderas="sect3">Descriptions courtes</bridgehead>
<?dbfo list-presentation="list"?>
<?dbhtml list-presentation="table"?>

<varlistentry id="hotplug">
<term><command>hotplug</command></term>
<listitem>
<para>Ce script est appelé par défaut par le noyau Linux lorsque quelque chose
modifie son état interne (par exemple, un nouveau périphérique est ajouté ou
un périphérique existant est supprimé)</para>
<indexterm zone="ch-system-hotplug hotplug"><primary
sortas="b-hotplug">hotplug</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-rc">
<term><command>/etc/hotplug/*.rc</command></term>
<listitem>
<para>Ces scripts sont utilisés pour le branchement à froid, par exemple détecter
et agir avec le matériel déjà présent lors du démarrage du système. Ils sont
appelés par le script de démarrage <filename>hotplug</filename> inclus dans le
paquetage LFS-Bootscripts. Les scripts <command>*.rc</command> essaient de récupérer
les événements hotplug qui ont été perdus lors du démarrage du système parce que,
par exemple, le système de fichiers root n'a pas été monté par le noyau</para>
<indexterm zone="ch-system-hotplug hotplug-rc"><primary
sortas="d-/etc/hotplug/*.rc">/etc/hotplug/*.rc</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-agent">
<term><command>/etc/hotplug/*.agent</command></term>
<listitem>
<para>Ces scripts sont appelés par <command>hotplug</command> en réponse à
différents types d'événements hotplug générés par le noyau. Leur action revient
à insérer les modules correspondant du noyau et à appeler les scripts fournis
par l'utilisateur</para>
<indexterm zone="ch-system-hotplug hotplug-agent"><primary
sortas="d-/etc/hotplug/*.agent">/etc/hotplug/*.agent</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-blacklist">
<term><filename>/etc/hotplug/blacklist</filename></term>
<listitem>
<para>Ce fichier contient la liste des modules qui ne devraient jamais être
insérés dans le noyau par les scripts Hotplug</para>
<indexterm zone="ch-system-hotplug hotplug-blacklist"><primary
sortas="e-/etc/hotplug/blacklist">/etc/hotplug/blacklist</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-functions">
<term><filename>/etc/hotplug/hotplug.functions</filename></term>
<listitem>
<para>Ce fichier contient les fonctions communes utilisées par d'autres scripts
dans le paquetage Hotplug</para>
<indexterm zone="ch-system-hotplug hotplug-functions"><primary
sortas="e-/etc/hotplug/hotplug.functions">/etc/hotplug/hotplug.functions</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-subdirs">
<term><filename class="directory">/etc/hotplug/{pci,usb}</filename></term>
<listitem>
<para>Ces répertoires contiennent des gestionnaires d'événements hotplug écrits
par les utilisateurs</para>
<indexterm zone="ch-system-hotplug hotplug-subdirs"><primary
sortas="e-/etc/hotplug/{pci,usb}">/etc/hotplug/{pci,usb}</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-usb.usermap">
<term><filename>/etc/hotplug/usb.usermap</filename></term>
<listitem>
<para>Ce fichier contient des règles pour déterminer quel gestionnaire défini
par l'utilisateur appeler pour chaque périphérique USB, suivant l'identifieur
du vendeur et d'autres attributs</para>
<indexterm zone="ch-system-hotplug hotplug-usb.usermap"><primary
sortas="e-/etc/hotplug/usb.usermap">/etc/hotplug/usb.usermap</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-hotplug.d">
<term><filename class="directory">/etc/hotplug.d</filename></term>
<listitem>
<para>Ce répertoire contient des programmes (ou des liens symboliques vers ces
programmes) intéressés pour recevoir des événements hotplug. Par exemple, Udev
place son lien symbolique ici lors de l'installation</para>
<indexterm zone="ch-system-hotplug hotplug-hotplug.d"><primary
sortas="e-/etc/hotplug.d">/etc/hotplug.d</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-firmware">
<term><filename class="directory">/lib/firmware</filename></term>
<listitem>
<para>Ce répertoire contient le firmware pour les périphériques qui ont besoin
que leur firmware soit chargé avant d'être utilisable</para>
<indexterm zone="ch-system-hotplug hotplug-firmware"><primary
sortas="e-/lib/firmware">/lib/firmware</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="hotplug-events">
<term><filename>/var/log/hotplug/events</filename></term>
<listitem>
<para>Ce fichier contient tous les événements que <command>hotplug</command> a
appelé depuis le démarrage</para>
<indexterm zone="ch-system-hotplug hotplug-events"><primary
sortas="e-/var/log/hotplug/events">/var/log/hotplug/events</primary></indexterm>
</listitem>
</varlistentry>

</variablelist>
</sect2>
</sect1>
