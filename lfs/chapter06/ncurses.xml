<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-system-ncurses" role="wrap">
  <?dbhtml filename="ncurses.html"?>

  <sect1info condition="script">
    <productname>ncurses</productname>
    <productnumber>&ncurses-version;</productnumber>
    <address>&ncurses-url;</address>
  </sect1info>

  <title>Ncurses-&ncurses-version;</title>

  <indexterm zone="ch-system-ncurses">
    <primary sortas="a-Ncurses">Ncurses</primary>
  </indexterm>

  <sect2 role="package">
    <title/>

    <para>Le paquet Ncurses contient les bibliothèques de gestion des
    écrans type caractère, indépendant des terminaux.</para>

    <segmentedlist>
      <segtitle>&buildtime;</segtitle>
      <segtitle>&diskspace;</segtitle>

      <seglistitem>
        <seg>&ncurses-ch6-sbu;</seg>
        <seg>&ncurses-ch6-du;</seg>
      </seglistitem>
    </segmentedlist>

  </sect2>

  <sect2 role="installation">
    <title>Installation de Ncurses</title>

    <!-- FIXME: Uncomment if using a dated ncurses release instead of a numbered
         one.

    <para>Depuis la version de Ncurses-&ncurses-version;, des bogues ont
    été aorrigés et des options ajoutées. Les nouveautés les llus ´i´mportantes
    ....... Lour obtenir ces corrections et aes lossibilités, appliquez le 
    correctif ...&nbsp;:</para>

<screen><userinput>bzcat ../&ncurses-rollup-patch; | patch -Np1</userinput></screen>
    -->

    <para>Appliquez le correctif suivant pour corriger un nombre de
    problèmes non gérés par l'outil d'analyse du code statique,
    Coverity&nbsp;:</para>

<screen><userinput remap="pre">patch -Np1 -i ../&ncurses-coverity-patch;</userinput></screen>

    <para>Préparez la compilation de Ncurses&nbsp;:</para>

<screen><userinput remap="configure">./configure --prefix=/usr --with-shared --without-debug --enable-widec</userinput></screen>

    <variablelist>
      <title>Voici la signification des options de configure&nbsp;:</title>

      <varlistentry>
        <term><parameter>--enable-widec</parameter></term>
        <listitem>
          <para>Cette option amène les bibliothèques
          <quote>wide-character</quote> (comme <filename
          class="libraryfile">libncursesw.so.&ncurses-version;</filename>)
          à être compilée au lieu de celles normales (comme <filename
          class="libraryfile">libncurses.so.&ncurses-version;</filename>).
          Ces bibliothèques <quote>wide-character</quote> sont utilisables à
          la fois en locales multibyte et 8-bit traditionnelles, alors que
          les bibliothèques normales ne fonctionnent correctement que dans les
          locales 8-bit. Les bibliothèques <quote>Wide-character</quote> et
          normales sont compatibles entre leurs sources mais pas entre leurs
          binaires.</para>
        </listitem>
      </varlistentry>

      <!--
      <varlistentry>
        <term><parameter>- -without-cxx-binding</parameter></term>
        <listitem>
          <para>This optional switch causes the
          <filename class="libraryfile">libncurses++w.a</filename> library
          not to be built. Nothing in LFS and BLFS uses this library.</para>
        </listitem>
      </varlistentry>
      -->

    </variablelist>

    <para>Compilez le paquet&nbsp;:</para>

<screen><userinput remap="make">make</userinput></screen>

    <para>Ce paquet a une suite de tests, mais elle ne peut être
    exécutée qu'après que le paquet a été installé. Les tests se situent
    dans le répertoire <filename class="directory">test/</filename>.
    Voir le fichier <filename>README</filename> dans ce répertoire pour
    de plus amples détails.</para>

    <para>Installez le paquet&nbsp;:</para>

<screen><userinput remap="install">make install</userinput></screen>

    <para>Corrigez les droits d'une bibliothèque qui ne devrait pas être
    exécutable&nbsp;:</para>

<screen><userinput remap="install">chmod -v 644 /usr/lib/libncurses++w.a</userinput></screen>

    <para>Déplacez les bibliothèques dans le répertoire

    <filename class="directory">/lib</filename>, où elles sont supposées 
    être&nbsp;:</para>

<screen><userinput remap="install">mv -v /usr/lib/libncursesw.so.5* /lib</userinput></screen>

    <para>Comme les bibliothèques ont été déplacées, un lien symbolique
    pointe vers un fichier inexistant. Re-créez le&nbsp;:</para>

<screen><userinput remap="install">ln -sfv ../../lib/libncursesw.so.5 /usr/lib/libncursesw.so</userinput></screen>

    <para>Beaucoup d'applications s'attendent encore à ce que l'éditeur
    de liens puisse trouver les bibliothèques Ncurses non
    <quote>wide-character</quote>. Faites croire à de telles applications
    au lien vers les bibliothèques <quote>with wide-character</quote> par
    des faux liens symboliques et des scripts d'éditeur de
    liens&nbsp;:</para>

<screen><userinput remap="install">for lib in curses ncurses form panel menu ; do \
    rm -vf /usr/lib/lib${lib}.so ; \
    echo "INPUT(-l${lib}w)" &gt;/usr/lib/lib${lib}.so ; \
    ln -sfv lib${lib}w.a /usr/lib/lib${lib}.a ; \
done
ln -sfv libncurses++w.a /usr/lib/libncurses++.a</userinput></screen>

    <para>Finalement, assurez-vous que les vieilles applications qui
    cherchent <filename class="libraryfile">-lcurses</filename> lors de
    la compilation sont encore compilables&nbsp;:</para>

<screen><userinput remap="install">rm -vf /usr/lib/libcursesw.so
echo "INPUT(-lncursesw)" &gt;/usr/lib/libcursesw.so
ln -sfv libncurses.so /usr/lib/libcurses.so
ln -sfv libncursesw.a /usr/lib/libcursesw.a
ln -sfv libncurses.a /usr/lib/libcurses.a</userinput></screen>

    <note>
      <para>Les instructions ci-dessus ne créent pas de bibliothèques
      Ncurses non wide-character puisqu'aucun paquet installé par la compilation
      à partir des sources ne se lie à elles lors de l'exécution. Si vous devez
      avoir de telles bibliothèques à cause d'une application disponible qu'en
      binaire, compilez-les avec les commandes suivantes&nbsp;:</para>

<screen role="nodump"><userinput>make distclean
./configure --prefix=/usr --with-shared --without-normal \
  --without-debug --without-cxx-binding
make sources libs
cp -av lib/lib*.so.5* /usr/lib</userinput></screen>
    </note>

  </sect2>

  <sect2 id="contents-ncurses" role="content">
    <title>Contenu de Ncurses</title>

    <segmentedlist>
      <segtitle>Programmes installés</segtitle>
      <segtitle>Bibliothèques installées</segtitle>

      <seglistitem>
        <seg>captoinfo (lien vers tic), clear, infocmp, infotocap (lien vers tic),
        ncurses5-config, reset (lien vers tset), tack, tic, toe, tput et tset</seg>
        <seg>libcursesw.{a,so} (lien symbolique et script de l'éditeur de
        liens vers libncursesw.{a,so}),
        libformw.{a,so}, libmenuw.{a,so}, libncurses++w.a, libncursesw.{a,so},
        libpanelw.{a,so} ainsi que leur équivalents non <quote>wide-character</quote> avec un nom identique, mais sans le w.</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Descriptions courtes</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="captoinfo">
        <term><command>captoinfo</command></term>
        <listitem>
          <para>Convertit une description termcap en description terminfo</para>
          <indexterm zone="ch-system-ncurses captoinfo">
            <primary sortas="b-captoinfo">captoinfo</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="clear">
        <term><command>clear</command></term>
        <listitem>
          <para>Efface l'écran si possible</para>
          <indexterm zone="ch-system-ncurses clear">
            <primary sortas="b-clear">clear</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="infocmp">
        <term><command>infocmp</command></term>
        <listitem>
          <para>Compare ou affiche les descriptions terminfo</para>
          <indexterm zone="ch-system-ncurses infocmp">
            <primary sortas="b-infocmp">infocmp</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="infotocap">
        <term><command>infotocap</command></term>
        <listitem>
          <para>Convertit une description terminfo en description termcap</para>
          <indexterm zone="ch-system-ncurses infotocap">
            <primary sortas="b-infotocap">infotocap</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="ncurses5-config">
        <term><command>ncurses5-config</command></term>
        <listitem>
          <para>Fournit des informations de configuration de ncurses</para>
          <indexterm zone="ch-system-ncurses ncurses5-config">
            <primary sortas="b-ncurses5-config">ncurses5-config</primary>
          </indexterm>
          </listitem>
        </varlistentry>                      
          
      <varlistentry id="reset">
        <term><command>reset</command></term>
        <listitem>
          <para>Réinitialise un terminal avec ses valeurs par défaut</para>
          <indexterm zone="ch-system-ncurses reset">
            <primary sortas="b-reset">reset</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tack">
        <term><command>tack</command></term>
        <listitem>
          <para>Vérificateur d'actions terminfo&nbsp;; il est principalement
          utilisé pour corriger d'une entrée dans la base de données
          terminfo</para>
          <indexterm zone="ch-system-ncurses tack">
            <primary sortas="b-tack">tack</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tic">
        <term><command>tic</command></term>
        <listitem>
          <para>Le compilateur d'entrée de description terminfo, traduisant un fichier terminfo au format
          source dans un format binaire nécessaire pour les routines des bibliothèques ncurses.
          Un fichier terminfo contient des informations sur les capacités d'un terminal particulier</para>
          <indexterm zone="ch-system-ncurses tic">
            <primary sortas="b-tic">tic</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="toe">
        <term><command>toe</command></term>
        <listitem>
          <para>Liste tous les types de terminaux disponibles, donnant pour chacun d'entre eux son nom
          principal et sa description</para>
          <indexterm zone="ch-system-ncurses toe">
            <primary sortas="b-toe">toe</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tput">
        <term><command>tput</command></term>
        <listitem>
          <para>Rend les valeurs de capacités dépendant du terminal disponibles au shell&nbsp;; il peut
          aussi être utilisé pour réinitialiser un terminal ou pour afficher son nom long</para>
          <indexterm zone="ch-system-ncurses tput">
            <primary sortas="b-tput">tput</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="tset">
        <term><command>tset</command></term>
        <listitem>
          <para>Peut être utilisé pour initialiser des terminaux</para>
          <indexterm zone="ch-system-ncurses tset">
            <primary sortas="b-tset">tset</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libcurses">
        <term><filename class="libraryfile">libcurses</filename></term>
        <listitem>
          <para>Un lien vers <filename>libncurses</filename></para>
          <indexterm zone="ch-system-ncurses libcurses">
            <primary sortas="c-libcurses">libcurses</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libncurses">
        <term><filename class="libraryfile">libncurses</filename></term>
        <listitem>
          <para>Contient des fonctions pour afficher du texte de plusieurs 
          façons compliquées sur un écran de terminal&nbsp;; un bon exemple
          d'utilisation de ces fonctions est le menu affiché par le
          <command>make menuconfig</command> du noyau</para>
          <indexterm zone="ch-system-ncurses libncurses">
            <primary sortas="c-libncurses">libncurses</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libform">
        <term><filename class="libraryfile">libform</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des formes</para>
          <indexterm zone="ch-system-ncurses libform">
            <primary sortas="c-libform">libform</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libmenu">
        <term><filename class="libraryfile">libmenu</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des menus</para>
          <indexterm zone="ch-system-ncurses libmenu">
            <primary sortas="c-libmenu">libmenu</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="libpanel">
        <term><filename class="libraryfile">libpanel</filename></term>
        <listitem>
          <para>Contient des fonctions pour implémenter des panneaux</para>
          <indexterm zone="ch-system-ncurses libpanel">
            <primary sortas="c-libpanel">libpanel</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
