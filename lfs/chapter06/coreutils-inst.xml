<sect2><title>&nbsp;</title><para>&nbsp;</para></sect2>

<sect2>
<title>Installation de Coreutils</title>

<para>Actuellement, <userinput>uname</userinput> est quelque peu cassé car
l'option <userinput>-p</userinput> renvoit toujours "inconnu". Ce correctif
fixe ce comportement pour les architectures Intel:</para>

<para><screen><userinput>patch -Np1 -i ../coreutils-&coreutils-uname-patch-version;.patch</userinput></screen></para>

<para>Nous ne voulons pas que Coreutils installe sa version du programme
<userinput>hostname</userinput> parce qu'il est moins bon que la version
apportée avec Net-tools. Empêchez cette installation avec ce correctif:</para>

<para><screen><userinput>patch -Np1 -i ../coreutils-&coreutils-hostname-patch-version;.patch</userinput></screen></para>

<para>Maintenant, préparez la compilation de Coreutils:</para>

<para><screen><userinput>./configure --prefix=/usr</userinput></screen></para>

<para>Compilez le package:</para>

<para><screen><userinput>make</userinput></screen></para>

<para>Ce package dispose d'une suite de tests pouvant tester un certain nombre
de points pour s'assurer qu'il est construit correctement. Néanmoins, cette
suite particulière fait quelques suppositions qui ne sont pas forcément valides
à ce moment du chapitre 6. Nous allons donc faire quelques ajustements, aller à
la section "Installer le package". Les commandes suivantes nous prépareront pour
la suite de tests. Créez deux groupes et un utilisateur dummy:</para>

<para><screen><userinput>echo "dummy1:x:1000" >> /etc/group
echo "dummy2:x:1001:dummy" >> /etc/group
echo "dummy:x:1000:1000:::/bin/bash" >> /etc/passwd</userinput></screen></para>

<para>Le programme <userinput>su</userinput> de Coreutils n'était pas installé
au chapitre 5 car il nécessite les droits de <emphasis>root</emphasis> pour
cela. Nous allons contourner ce problème en l'installant maintenant:</para>

<para><screen><userinput>make install-root</userinput></screen></para>

<para>Quelques tests doivent être lancés en tant que <emphasis>root</emphasis>:
</para>

<para><screen><userinput>make check-root</userinput></screen></para>

<para>Le reste des tests est lancé est tant que <emphasis>dummy</emphasis>
user:</para>

<para><screen><userinput>su dummy -c "make RUN_EXPENSIVE_TESTS=yes check"</userinput></screen></para>

<para>Supprimez les groupe et utilisateur dummy:</para>

<para><screen><userinput>sed -i.bak '/dummy/d' /etc/passwd /etc/group</userinput></screen></para>

<para>Installez le package:</para>

<para><screen><userinput>make install</userinput></screen></para>

<para>Et déplacez les fichiers aux bons emplacements:</para>

<para><screen><userinput>mv /usr/bin/{basename,cat,chgrp,chmod,chown,cp,dd,df} /bin
mv /usr/bin/{dir,dircolors,du,date,echo,false,head} /bin
mv /usr/bin/{install,ln,ls,mkdir,mkfifo,mknod,mv,pwd} /bin
mv /usr/bin/{rm,rmdir,shred,sync,sleep,stty,su,test} /bin
mv /usr/bin/{touch,true,uname,vdir} /bin
mv /usr/bin/chroot /usr/sbin</userinput></screen></para>

<para>Enfin, créez les quelques liens symboliques nécessaires:</para>

<para><screen><userinput>ln -s test /bin/[
ln -s ../../bin/install /usr/bin</userinput></screen></para>

</sect2>

