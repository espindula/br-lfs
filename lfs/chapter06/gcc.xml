<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-gcc" role="wrap">
<title>GCC-&gcc-version;</title>
<?dbhtml filename="gcc.html"?>

<indexterm zone="ch-system-gcc"><primary sortas="a-GCC">GCC</primary></indexterm>

<sect2 role="package"><title/>
<para>Le paquet GCC contient la collection de compilateurs GNU, qui inclut les
compilateurs C et C++.</para>

<segmentedlist>
<segtitle>&buildtime;</segtitle>
<segtitle>&diskspace;</segtitle>
<seglistitem><seg>11,7&nbsp;SBU</seg><seg>451&nbsp;Mo</seg></seglistitem>
</segmentedlist>

<segmentedlist>
<segtitle>&dependencies;</segtitle>
<seglistitem><seg>Bash, Binutils, Coreutils, Diffutils, Findutils,
Gawk, Gettext, Glibc, Grep, Make, Perl, Sed et Texinfo</seg></seglistitem>
</segmentedlist>
</sect2>

<sect2 role="installation">
<title>Installation de GCC</title>

<para>Ce paquet est connu pour avoir des soucis quand les options d'optimisation
par défaut (en incluant les options <parameter>-march</parameter> et
<parameter>-mcpu</parameter>) sont modifiées. Donc, si des variables d'environnement
qui surchargent les optimisations par défaut, telles que <envar>CFLAGS</envar>
et <envar>CXXFLAGS</envar>, ont été définies, supprimez cette initialisation
pour la construction de GCC.</para>

<para>Appliquez seulement le correctif No-Fixincludes (et pas Specs) utilisé
aussi dans le chapitre précédent&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../&gcc-no_fixincludes-patch;</userinput></screen>

<para>La compilation de GCC échoue pour certains paquets en dehors d'une
installation LFS de base (par exemple, Mozilla et kdegraphics) si GCC est utilisé
avec les dernières versions de Binutils. Appliquez le correctif suivant pour
corriger ce problème&nbsp;:</para>

<screen><userinput>patch -Np1 -i ../&gcc-linkonce-patch;</userinput></screen>

<para>Appliquez une substitution <command>sed</command> qui supprimera
l'installation de <filename class="libraryfile">libiberty.a</filename>. À la
place, la version de <filename class="libraryfile">libiberty.a</filename> fournie
par Binutils sera utilisée&nbsp;:</para>

<screen><userinput>sed -i 's/install_to_$(INSTALL_DEST) //' libiberty/Makefile.in</userinput></screen>

<para>La documentation de GCC recommande de construire GCC en dehors du
répertoire source, c'est-à-dire dans un répertoire dédié&nbsp;:</para>

<screen><userinput>mkdir -v ../gcc-build
cd ../gcc-build</userinput></screen>

<para>Préparez la compilation de GCC&nbsp;:</para>

<screen><userinput>../gcc-&gcc-version;/configure --prefix=/usr \
    --libexecdir=/usr/lib --enable-shared \
    --enable-threads=posix --enable-__cxa_atexit \
    --enable-clocale=gnu --enable-languages=c,c++</userinput></screen>

<para>Compilez le paquet&nbsp;:</para>

<screen><userinput>make</userinput></screen>

<beginpage/>

<important><para>Dans cette section, la suite de tests pour GCC est considérée
critique. Ne pas la laisser passer quelque soient les circonstances.</para></important>

<para>Testez les résultats mais ne vous arrêtez pas aux erreurs&nbsp;:</para>

<screen><userinput>make -k check</userinput></screen>

<para>Quelques erreurs sont connues et ont été indiquées dans le chapitre
précédent. Les notes de la suite de tests sur <xref
linkend="ch-tools-gcc-pass2"/> sont toujours très appropriées ici. Assurez-vous
de vous y référer si nécessaire.</para>

<para>Installez le paquet&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

<para>Quelques paquets s'attendent à ce que le préprocesseur C soit installé
dans le répertoire <filename class="directory">/lib</filename>. Pour supporter
ces paquets, créez ce lien symbolique&nbsp;:</para>

<screen><userinput>ln -sv ../usr/bin/cpp /lib</userinput></screen>

<para>Beaucoup de paquets utilisent le nom <command>cc</command> pour appeler
le compilateur C. Pour satisfaire ces paquets, créez un lien
symbolique&nbsp;:</para>

<screen><userinput>ln -sv gcc /usr/bin/cc</userinput></screen>

<note><para>À ce moment, il est fortement recommandé de répéter les vérifications
réalisées plus tôt dans ce chapitre. Référez-vous à <xref
linkend="ch-system-readjusting"/> et répétez la vérification. Si les résultats
sont mauvais, alors il y a des chances pour que le correctif GCC Specs ait été
mal appliqué à partir de <xref linkend="chapter-temporary-tools"/>.</para></note>

</sect2>

<sect2 id="contents-gcc" role="content"><title>Contenu de GCC</title>

<segmentedlist>
<segtitle>Programmes installés</segtitle>
<segtitle>Bibliothèques installées</segtitle>
<seglistitem><seg>c++, cc (lien vers gcc), cpp, g++, gcc, gccbug et gcov</seg>
<seg>libgcc.a, libgcc_eh.a, libgcc_s.so, libstdc++.[a,so] et libsupc++.a</seg></seglistitem>
</segmentedlist>

<variablelist><bridgehead renderas="sect3">Descriptions courtes</bridgehead>
<?dbfo list-presentation="list"?>
<?dbhtml list-presentation="table"?>

<varlistentry id="cc">
<term><command>cc</command></term>
<listitem>
<para>Le compilateur C</para>
<indexterm zone="ch-system-gcc cc"><primary sortas="b-cc">cc</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="cpp">
<term><command>cpp</command></term>
<listitem>
<para>Le préprocesseur C&nbsp;; il est utilisé par le compilateur pour
l'extension des instructions #include, #define et d'autres instructions similaires
dans les fichiers sources</para>
<indexterm zone="ch-system-gcc cpp"><primary sortas="b-cpp">cpp</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="c">
<term><command>c++</command></term>
<listitem>
<para>Le compilateur C++</para>
<indexterm zone="ch-system-gcc c"><primary sortas="b-c++">c++</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="g">
<term><command>g++</command></term>
<listitem>
<para>Le compilateur C++</para>
<indexterm zone="ch-system-gcc g"><primary sortas="b-g++">g++</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="gcc">
<term><command>gcc</command></term>
<listitem>
<para>Le compilateur C</para>
<indexterm zone="ch-system-gcc gcc"><primary sortas="b-gcc">gcc</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="gccbug">
<term><command>gccbug</command></term>
<listitem>
<para>Un script shell utilisé pour aider à la création de bons rapports de bogues</para>
<indexterm zone="ch-system-gcc gccbug"><primary sortas="b-gccbug">gccbug</primary></indexterm>
<beginpage/></listitem>
</varlistentry>

<varlistentry id="gcov">
<term><command>gcov</command></term>
<listitem>
<para>Un outil de tests&nbsp;; il est utilisé pour analyser les programmes et
savoir où des optimisations seraient suivies du plus d'effet</para>
<indexterm zone="ch-system-gcc gcov"><primary sortas="b-gcov">gcov</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="libgcc">
<term><filename class="libraryfile">libgcc</filename></term>
<listitem>
<para>contient un support en exécution pour <command>gcc</command></para>
<indexterm zone="ch-system-gcc libgcc"><primary sortas="c-libgcc*">libgcc*</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="libstdc">
<term><filename class="libraryfile">libstdc++</filename></term>
<listitem>
<para>La bibliothèque C++ standard</para>
<indexterm zone="ch-system-gcc libstdc"><primary sortas="c-libstdc++">libstdc++</primary></indexterm>
</listitem>
</varlistentry>

<varlistentry id="libsupc">
<term><filename class="libraryfile">libsupc++</filename></term>
<listitem>
<para>Fournit des routines de support pour le langage de programmation C++</para>
<indexterm zone="ch-system-gcc libsupc"><primary sortas="c-libsupc++">libsupc++</primary></indexterm>
</listitem>
</varlistentry>
</variablelist>

</sect2>

</sect1>
