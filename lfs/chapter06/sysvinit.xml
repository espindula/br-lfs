<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-sysvinit" xreflabel="Sysvinit">
<title>Sysvinit-&sysvinit-version;</title>
<?dbhtml filename="sysvinit.html"?>

<indexterm zone="ch-system-sysvinit"><primary sortas="a-Sysvinit">Sysvinit</primary></indexterm>

<para>The Sysvinit package contains programs for controlling the startup,
running, and shutdown of your system.</para>

<screen>&buildtime; 0.1 SBU
&diskspace; 0.9 MB</screen>

<para>Sysvinit installation depends on: Binutils, Coreutils, GCC, Glibc, Make.</para>



<sect2>
<title>Installation of Sysvinit</title>

<para>When run-levels are changed (for example, when halting the system),
<command>init</command> sends termination signals to those processes that
<command>init</command> itself started and that shouldn't be running in the new
run-level. While doing this, <command>init</command> outputs messages like
<quote>Sending processes the TERM signal</quote> which seem to imply that it is sending these signals to all currently running processes. To avoid this
misinterpretation, you can modify the source so that these messages read like
<quote>Sending processes started by init the TERM signal</quote> instead:</para>

<screen><userinput>cp src/init.c{,.backup}
sed 's/Sending processes/&amp; started by init/g' \
    src/init.c.backup &gt; src/init.c</userinput></screen>

<para>Compile Sysvinit:</para>

<screen><userinput>make -C src</userinput></screen>

<para>Then install it:</para>

<screen><userinput>make -C src install</userinput></screen>

</sect2>


<sect2 id="conf-sysvinit"><title>Configuring Sysvinit</title>
<indexterm zone="conf-sysvinit">
<primary sortas="a-Sysvinit">Sysvinit</primary>
<secondary>configuring</secondary></indexterm>

<indexterm zone="conf-sysvinit"><primary sortas="e-/etc/inittab">/etc/inittab</primary></indexterm>

<para>Create a new <filename>/etc/inittab</filename> file by running the
following:</para>

<screen><userinput>cat &gt; /etc/inittab &lt;&lt; "EOF"</userinput>
# Begin /etc/inittab

id:3:initdefault:

si::sysinit:/etc/rc.d/init.d/rc sysinit

l0:0:wait:/etc/rc.d/init.d/rc 0
l1:S1:wait:/etc/rc.d/init.d/rc 1
l2:2:wait:/etc/rc.d/init.d/rc 2
l3:3:wait:/etc/rc.d/init.d/rc 3
l4:4:wait:/etc/rc.d/init.d/rc 4
l5:5:wait:/etc/rc.d/init.d/rc 5
l6:6:wait:/etc/rc.d/init.d/rc 6

ca:12345:ctrlaltdel:/sbin/shutdown -t1 -a -r now

su:S016:once:/sbin/sulogin

1:2345:respawn:/sbin/agetty tty1 9600
2:2345:respawn:/sbin/agetty tty2 9600
3:2345:respawn:/sbin/agetty tty3 9600
4:2345:respawn:/sbin/agetty tty4 9600
5:2345:respawn:/sbin/agetty tty5 9600
6:2345:respawn:/sbin/agetty tty6 9600

# End /etc/inittab
<userinput>EOF</userinput></screen>

</sect2>


<sect2 id="contents-sysvinit"><title>Contents of Sysvinit</title>

<para><emphasis>Installed programs</emphasis>: halt, init, killall5, last,
lastb (link to last), mesg, pidof (link to killall5), poweroff (link to halt),
reboot (link to halt), runlevel, shutdown, sulogin, telinit (link to init),
utmpdump and wall</para>

</sect2>


<sect2><title>Short descriptions</title>

<indexterm zone="ch-system-sysvinit halt"><primary sortas="b-halt">halt</primary></indexterm>
<para id="halt"><command>halt</command> normally invokes shutdown with the -h flag,
except when already in run-level 0, then it tells the kernel to halt the system.
But first it notes in the file <filename>/var/log/wtmp</filename> that the
system is being brought down.</para>

<indexterm zone="ch-system-sysvinit init"><primary sortas="b-init">init</primary></indexterm>
<para id="init"><command>init</command> is the mother of all processes. It reads its
commands from <filename>/etc/inittab</filename>, which normally tell it which
scripts to run for which run-level, and how many gettys to spawn.</para>

<indexterm zone="ch-system-sysvinit killall5"><primary sortas="b-killall5">killall5</primary></indexterm>
<para id="killall5"><command>killall5</command> sends a signal to all processes, except
the processes in its own session -- so it won't kill the shell running the
script that called it.</para>

<indexterm zone="ch-system-sysvinit last"><primary sortas="b-last">last</primary></indexterm>
<para id="last"><command>last</command> shows which users last logged in (and out),
searching back through the file <filename>/var/log/wtmp</filename>. It can
also show system boots and shutdowns, and run-level changes.</para>

<indexterm zone="ch-system-sysvinit lastb"><primary sortas="b-lastb">lastb</primary></indexterm>
<para id="lastb"><command>lastb</command> shows the failed login attempts, as logged
in <filename>/var/log/btmp</filename>.</para>

<indexterm zone="ch-system-sysvinit mesg"><primary sortas="b-mesg">mesg</primary></indexterm>
<para id="mesg"><command>mesg</command> controls whether other users can send
messages to the current user's terminal.</para>

<indexterm zone="ch-system-sysvinit pidof"><primary sortas="b-pidof">pidof</primary></indexterm>
<para id="pidof"><command>pidof</command> reports the PIDs of the given programs.</para>

<indexterm zone="ch-system-sysvinit poweroff"><primary sortas="b-poweroff">poweroff</primary></indexterm>
<para id="poweroff"><command>poweroff</command> tells the kernel to halt the system and
switch off the computer. But see halt.</para>

<indexterm zone="ch-system-sysvinit reboot"><primary sortas="b-reboot">reboot</primary></indexterm>
<para id="reboot"><command>reboot</command> tells the kernel to reboot the system.
But see halt.</para>

<indexterm zone="ch-system-sysvinit runlevel"><primary sortas="b-runlevel">runlevel</primary></indexterm>
<para id="runlevel"><command>runlevel</command> reports the previous and the current
run-level, as noted in the last run-level record in
<filename>/var/run/utmp</filename>.</para>

<indexterm zone="ch-system-sysvinit shutdown"><primary sortas="b-shutdown">shutdown</primary></indexterm>
<para id="shutdown"><command>shutdown</command> brings the system down in a secure way,
signaling all processes and notifying all logged-in users.</para>

<indexterm zone="ch-system-sysvinit sulogin"><primary sortas="b-sulogin">sulogin</primary></indexterm>
<para id="sulogin"><command>sulogin</command> allows the superuser to log in. It is
normally invoked by init when the system goes into single user mode.</para>

<indexterm zone="ch-system-sysvinit telinit"><primary sortas="b-telinit">telinit</primary></indexterm>
<para id="telinit"><command>telinit</command> tells init which run-level to enter.</para>

<indexterm zone="ch-system-sysvinit utmpdump"><primary sortas="b-utmpdump">utmpdump</primary></indexterm>
<para id="utmpdump"><command>utmpdump</command> displays the content of the given login
file in a friendlier format.</para>

<indexterm zone="ch-system-sysvinit wall"><primary sortas="b-wall">wall</primary></indexterm>
<para id="wall"><command>wall</command> writes a message to all logged-in users.</para>

</sect2>



</sect1>
