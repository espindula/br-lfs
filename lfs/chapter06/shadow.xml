<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-shadow" xreflabel="Shadow">
<title>Shadow-&shadow-version;</title>
<?dbhtml filename="shadow.html"?>

<indexterm zone="ch-system-shadow"><primary sortas="a-Shadow">Shadow</primary></indexterm>

<para>Le package Shadow contient des programmes de gestion de mots de passe
d'uen façon sécurisée.</para>

<screen>&buildtime; 0,4&nbsp;SBU
&diskspace; 11&nbsp;Mo</screen>

<para>L'installation de Shadow dépend de Bash, Binutils, Bison, Coreutils,
Diffutils, GCC, Gettext, Glibc, Grep, Make, Sed.</para>



<sect2>
<title>Installation de Shadow</title>

<para>Shadow code en dur le chemin vers le binaire <command>passwd</command>
dans le binaire lui-même mais le fait de la mauvaise façon. Si un binaire
<command>passwd</command> n'est pas présent avant l'installation de Shadow, le
package suppose qu'il sera <filename>/bin/passwd</filename> mais il l'installe
ensuite dans <filename>/usr/bin/passwd</filename>. Ceci amène des problèmes
lors de la recherche de <filename>/bin/passwd</filename>. Pour contourner ce
bogue, créez un fichier <filename>passwd</filename> de façon à ce que son
chemin soit codé en dur correctement&nbsp;:</para>

<screen><userinput>touch /usr/bin/passwd</userinput></screen>

<para>Maintenane, préparez la compilation de Shadow&nbsp;:</para>

<screen><userinput>./configure --libdir=/usr/lib --enable-shared</userinput></screen>

<para>Contournez un problème empêchant l'internationalisation de
Shadow&nbsp;:</para>

<screen><userinput>echo '#define HAVE_SETLOCALE 1' &gt;&gt; config.h</userinput></screen>

<para>Compilez le package&nbsp;:</para>

<screen><userinput>make</userinput></screen>

<para>Puis, installez-le&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

<para>Shadow utilise deux fichiers pour configurer les paramètrages
d'authentification du système. Installez ces deux fichiers de
configuration&nbsp;:</para>

<screen><userinput>cp etc/{limits,login.access} /etc</userinput></screen>

<para>Au lieu d'utiliser la méthode <emphasis>crypt</emphasis> par défaut, nous
voulons utiliser la méthode <emphasis>MD5</emphasis> plus sécurisée pour le
cryptage des mots de passe, qui autorise aussi une taille de mot de passe de
plus de huit caractères. Nous allons aussi avoir besoin de modifier
l'emplacement obsolète <filename class="directory">/var/spool/mail</filename>
des boîtes de courrier électronique des utilisateurs que Shadow utilise par
défaut par le nouveau <filename class="directory">/var/mail</filename> utilisé
maintenant. Nous accomplissons ces deux points en changeant le fichier de
configuration adéquat tout en le copiant à sa destination (il est certainement
mieux de couper/coller ceci plutôt que d'essayer de le taper)&nbsp;:</para>

<screen><userinput>sed -e 's%#MD5_CRYPT_ENAB.no%MD5_CRYPT_ENAB yes%' \
    -e 's%/var/spool/mail%/var/mail%' \
    etc/login.defs.linux &gt; /etc/login.defs</userinput></screen>

<para>Déplacez quelques liens symboliques mal placés aux bons
emplacements&nbsp;:</para>

<screen><userinput>mv /bin/sg /usr/bin
mv /bin/vigr /usr/sbin</userinput></screen>

<para>Et déplacez les bibliothèques partagées de Shadow au bon
emplacement&nbsp;:</para>

<screen><userinput>mv /usr/lib/lib{shadow,misc}.so.0* /lib</userinput></screen>

<para>Comme certains packages s'attendent à trouver les bibliothèques que
nous venons de déplacer dans <filename>/usr/lib</filename>, créez les liens
symboliques suivants&nbsp;:</para>

<screen><userinput>ln -sf ../../lib/libshadow.so.0 /usr/lib/libshadow.so
ln -sf ../../lib/libmisc.so.0 /usr/lib/libmisc.so</userinput></screen>

<para>L'option -D du programme <filename>useradd</filename> requiert ce
répertoire pour fonctionner correctement&nbsp;:</para>

<screen><userinput>mkdir /etc/default</userinput></screen>

<para>Coreutils a déjà installé un meilleur programme <command>groups</command>
dans <filename class="directory">/usr/bin</filename>. Supprimez celui installé
par Shadow&nbsp;:</para>

<screen><userinput>rm /bin/groups</userinput></screen>

</sect2>


<sect2 id="conf-shadow"><title>Configurer Shadow</title>
<indexterm zone="conf-shadow">
<primary sortas="a-Shadow">Shadow</primary>
<secondary>configuration</secondary></indexterm>

<para>Ce package contient des outils pour ajouter, modifier, supprimer 
des utilisateurs et des groupes, initialiser et changer leur mots de
passe, et bien d'autres tâches administratives. Pour une explication complète
de ce que signifie <emphasis>password shadowing</emphasis>, jetez un &oelig;il
au fichier <filename>doc/HOWTO</filename> à l'intérieur du répertoire source.
Il reste une chose à garder à l'esprit si vous décidez d'utiliser le support de
Shadow&nbsp;: les programmes qui ont besoin de vérifier les mots de passe
(gestionnaires d'affichage, programmes FTP, démons pop3 et ainsi de suite) ont
besoin d'être <emphasis>compatible avec shadow</emphasis>, c'est-à-dire qu'ils
ont besoin d'être capables de fonctionner avec des mots de passe shadow.</para>

<para>Pour activer les mots de passe shadow, lancez la commande
suivante&nbsp;:</para>

<screen><userinput>pwconv</userinput></screen>

<para>Pour activer les mots de passe shadow pour les groupes,
lancez&nbsp;:</para>

<screen><userinput>grpconv</userinput></screen>

<para>Sous des circonstances normales, vous n'avez pas encore créé de mots
de passe. Néanmoins, si vous revenez plus tard dans cette section pour activer
les mots de passe shadow, vous pouvez réinitialiser tous les mots de passe des
utilisateurs actuels avec la commande <command>passwd</command> et les mots de
passe des groupes avec la commande <command>gpasswd</command>.</para>

</sect2>


<sect2>
<title>Configurer le mot de passe de root</title>

<para>Choisissez un mot de passe pour l'utilisateur root et initialisez-le
avec&nbsp;:</para>

<screen><userinput>passwd root</userinput></screen>

</sect2>


<sect2 id="contents-shadow"><title>Contenu de Shadow</title>

<para><emphasis>Programmes installés</emphasis>&nbsp;: chage, chfn, chpasswd,
chsh, dpasswd, expiry, faillog, gpasswd, groupadd, groupdel, groupmod, groups,
grpck, grpconv, grpunconv, lastlog, login, logoutd, mkpasswd, newgrp, newusers,
passwd, pwck, pwconv, pwunconv, sg (lien vers newgrp), useradd, userdel,
usermod, vigr (lien vers vipw) et vipw</para>

</sect2>

<sect2><title>Courtes descriptions</title>

<indexterm zone="ch-system-shadow chage"><primary sortas="b-chage">chage</primary></indexterm>
<para id="chage"><command>chage</command> est utilisé pour modifier le nombre
maximum de jours pour obliger un changement de mot de passe.</para>

<indexterm zone="ch-system-shadow chfn"><primary sortas="b-chfn">chfn</primary></indexterm>
<para id="chfn"><command>chfn</command> est utilisé pour modifier le nom
complet de l'utilisateur et quelques autres informations.</para>

<indexterm zone="ch-system-shadow chpasswd"><primary sortas="b-chpasswd">chpasswd</primary></indexterm>
<para id="chpasswd"><command>chpasswd</command> est utilisé pour mettre à jour
les mots de passe d'une série de compte en une fois.</para>

<indexterm zone="ch-system-shadow chsh"><primary sortas="b-chsh">chsh</primary></indexterm>
<para id="chsh"><command>chsh</command> est utilisé pour modifier le shell de
connexion par défaut d'un utilisateur.</para>

<indexterm zone="ch-system-shadow dpasswd"><primary sortas="b-dpasswd">dpasswd</primary></indexterm>
<para id="dpasswd"><command>dpasswd</command> est utilisé pour modifier l
e mots de passe pour les connexions par modem.</para>

<indexterm zone="ch-system-shadow expiry"><primary sortas="b-expiry">expiry</primary></indexterm>
<para id="expiry"><command>expiry</command> vérifie et renforce la politique 
d'expiration des mots de passe.</para>

<indexterm zone="ch-system-shadow faillog"><primary sortas="b-faillog">faillog</primary></indexterm>
<para id="faillog"><command>faillog</command> est utilisé pour examiner les
traces d'échecs de connexions, pour configurer le nombre maximum d'échecs avant
qu'un compte ne soit bloqué ou pour réinitialiser le nombre d'échecs.</para>

<indexterm zone="ch-system-shadow gpasswd"><primary sortas="b-gpasswd">gpasswd</primary></indexterm>
<para id="gpasswd"><command>gpasswd</command> est utilisé pour ajouter et
supprimer des membres et des administrateurs aux groupes.</para>

<indexterm zone="ch-system-shadow groupadd"><primary sortas="b-groupadd">groupadd</primary></indexterm>
<para id="groupadd"><command>groupadd</command> crée un groupe avec le nom
donné.</para>

<indexterm zone="ch-system-shadow groupdel"><primary sortas="b-groupdel">groupdel</primary></indexterm>
<para id="groupdel"><command>groupdel</command> supprime le groupe ayant le nom
donné.</para>

<indexterm zone="ch-system-shadow groupmod"><primary sortas="b-groupmod">groupmod</primary></indexterm>
<para id="groupmod"><command>groupmod</command> est utilisé pour modifier le
nom ou le GID du groupe.</para>

<indexterm zone="ch-system-shadow groups"><primary sortas="b-groups">groups</primary></indexterm>
<para id="groups"><command>groups</command> indique les groupes d'appartenance
des utilisateurs indiqués.</para>

<indexterm zone="ch-system-shadow grpck"><primary sortas="b-grpck">grpck</primary></indexterm>
<para id="grpck"><command>grpck</command> vérifie l'intégrité des fichiers 
<filename>/etc/group</filename> et <filename>/etc/gshadow</filename>.</para>

<indexterm zone="ch-system-shadow grpconv"><primary sortas="b-grpconv">grpconv</primary></indexterm>
<para id="grpconv"><command>grpconv</command> crée ou met à jour le fichier
shadow à aprtir du fichier group standard.</para>

<indexterm zone="ch-system-shadow grpunconv"><primary sortas="b-grpunconv">grpunconv</primary></indexterm>
<para id="grpunconv"><command>grpunconv</command> met à jour
<filename>/etc/group</filename> à partir de from
<filename>/etc/gshadow</filename> et supprime ce dernier.</para>

<indexterm zone="ch-system-shadow lastlog"><primary sortas="b-lastlog">lastlog</primary></indexterm>
<para id="lastlog"><command>lastlog</command> indique les connexions les plus
récentes de tous les utilisateurs ou d'un utilisateur donné.</para>

<indexterm zone="ch-system-shadow login"><primary sortas="b-login">login</primary></indexterm>
<para id="login"><command>login</command> est utilisé par le système pour
permettre aux utilisateurs de se connecter.</para>

<indexterm zone="ch-system-shadow logoutd"><primary sortas="b-logoutd">logoutd</primary></indexterm>
<para id="logoutd"><command>logoutd</command> est un démon utilisé pour
renforcer les restrictions sur les temps et ports de connexion.</para>

<indexterm zone="ch-system-shadow mkpasswd"><primary sortas="b-mkpasswd">mkpasswd</primary></indexterm>
<para id="mkpasswd"><command>mkpasswd</command> crypte les mots de passe donnés
en utilisant la perturbation donnée.</para>

<indexterm zone="ch-system-shadow newgrp"><primary sortas="b-newgrp">newgrp</primary></indexterm>
<para id="newgrp"><command>newgrp</command> est utilisé pour modifier le GID
courant pendant une session de connexion.</para>

<indexterm zone="ch-system-shadow newusers"><primary sortas="b-newusers">newusers</primary></indexterm>
<para id="newusers"><command>newusers</command> est utilisé pour créer ou mettre
à jour toute une série de comptes utilisateur en une fois.</para>

<indexterm zone="ch-system-shadow passwd"><primary sortas="b-passwd">passwd</primary></indexterm>
<para id="passwd"><command>passwd</command> est utilisé pour modifier le mot de
passe d'un utilisateur ou d'un groupe.</para>

<indexterm zone="ch-system-shadow pwck"><primary sortas="b-pwck">pwck</primary></indexterm>
<para id="pwck"><command>pwck</command> vérifie l'intégrité des fichiers de mots
de passe, <filename>/etc/passwd</filename> et
<filename>/etc/shadow</filename>.</para>

<indexterm zone="ch-system-shadow pwconv"><primary sortas="b-pwconv">pwconv</primary></indexterm>
<para id="pwconv"><command>pwconv</command> crée ou met à jour le fichier de 
mots de passe shadow à partir du fichier password habituel.</para>

<indexterm zone="ch-system-shadow pwunconv"><primary sortas="b-pwunconv">pwunconv</primary></indexterm>
<para id="pwunconv"><command>pwunconv</command> met à
jour<filename>/etc/passwd</filename> à partir de from
<filename>/etc/shadow</filename> puis supprime ce dernier.</para>

<indexterm zone="ch-system-shadow sg"><primary sortas="b-sg">sg</primary></indexterm>
<para id="sg"><command>sg</command> exécute une commande donnée lors de
l'initialisation du GID de l'utilisateur à un groupe donné.</para>

<indexterm zone="ch-system-shadow useradd"><primary sortas="b-useradd">useradd</primary></indexterm>
<para id="useradd"><command>useradd</command> crée un nouvel utilisateur avec le
nom donné ou met à jour les informations par défaut du nouvel
utilisateur.</para>

<indexterm zone="ch-system-shadow userdel"><primary sortas="b-userdel">userdel</primary></indexterm>
<para id="userdel"><command>userdel</command> supprime le compte utilisateur 
indiqué.</para>

<indexterm zone="ch-system-shadow usermod"><primary sortas="b-usermod">usermod</primary></indexterm>
<para id="usermod"><command>usermod</command> est utilisé pour modifier le nom
de connexion de l'utilisateur, son UID (<foreignphrase>User
Identification</foreignphrase>, soit Identification Utilisateur), shell,
groupe initial, répertoire personnel et ainsi de suite.</para>

<indexterm zone="ch-system-shadow vigr"><primary sortas="b-vigr">vigr</primary></indexterm>
<para id="vigr"><command>vigr</command> est utilisé pour éditer les fichiers
<filename>/etc/group</filename> ou <filename>/etc/gshadow</filename>.</para>

<indexterm zone="ch-system-shadow vipw"><primary sortas="b-vipw">vipw</primary></indexterm>
<para id="vipw"><command>vipw</command> est utilisé pour éditer les fichiers
<filename>/etc/passwd</filename> ou <filename>/etc/shadow</filename>.
</para>

<indexterm zone="ch-system-shadow libmisc"><primary sortas="c-libmisc">libmisc</primary></indexterm>
<para id="libmisc"><command>libmisc</command>...</para>

<indexterm zone="ch-system-shadow libshadow"><primary sortas="c-libshadow">libshadow</primary></indexterm>
<para id="libshadow"><command>libshadow</command> contient des fonctions
utilisées par la plupart des programmes dans ce package.</para>

</sect2>



</sect1>
