<sect2>
<title>Installation du noyau Linux</title>

<para>Nous ne compilerons pas encore un nouveau noyau -- nous le ferons quand
nous aurons fini l'installation de tous les packages. Mais comme certains
packages ont besoin des fichiers d'entête du noyau, nous allons déballer
l'archive du noyau maintenant, le configurer et copier les fichiers d'entête
où ils pourront être trouvés par ces packages.</para>

<para>Il est important de noter que les fichiers du répertoire source du noyau
n'appartiennent pas à <emphasis>root</emphasis>. A chaque fois que vous déballez
un package en tant qu'utilisateur <emphasis>root</emphasis> (ce qui est notre
cas lorsque nous sommes dans le chroot), les fichiers appartiennent aux
identifiant utilisateur et groupe de l'utilisateur ayant créé l'archive. Ceci
n'est habituellement pas un problème pour tout package que vous installez parce
que vous supprimez les sources à la fin de l'installation. Mais les sources du
noyau Linux sont souvent conservés longtemps, donc il existe une chance pour,
quelque soit l'uid utilisé, celui-ci sera assigné à quelqu'un sur la machine,
et cette personne disposera des droits d'écriture sur les sources du noyau.
</para>

<para>A la lumière de ceci, vous pouvez lancer
<userinput>chown -R 0:0</userinput> sur le répertoire
<filename>linux-&kernel-version;</filename> pour s'assurer que tous les fichiers
appartiennent à l'utilisateur <emphasis>root</emphasis>.</para>

<para>L'installation des entêtes du noyau requiert le programme
<filename>pwd</filename>. Dans les sources du noyau, le chemin vers le programme
<filename>pwd</filename> est lié à <filename>/bin/pwd</filename>. Créez un lien
symbolique pour en tenir compte:</para>

<para><screen><userinput>ln -s /static/bin/pwd /bin/pwd</userinput></screen></para>

<para>Préparez l'installation des entêtes:</para>

<para><screen><userinput>make mrproper</userinput></screen></para>

<para>Ceci s'assure que l'arbre du noyau est complètement propre. L'équipe du
noyau recommande que cette commande soit lancée avant
<emphasis>chaque</emphasis> compilation du noyau. Vous ne devez pas supposer que
l'arbre des sources soit propre après l'avoir déballé.</para>

<para>Créez le fichier <filename>include/linux/version.h</filename>:</para>

<para><screen><userinput>make include/linux/version.h</userinput></screen></para>

<para>Créez le lien symbolique spécifique à la plateforme
<filename>include/asm</filename>:</para>

<para><screen><userinput>make symlinks</userinput></screen></para>

<para>Installez les fichiers d'entête spécifique à la plateforme:</para>

<para><screen><userinput>cp -HR include/asm /usr/include &amp;&amp;
cp -R include/asm-generic /usr/include</userinput></screen></para>

<para>Installez les fichiers d'entête du noyau non spécifiques à la
plateforme:</para>

<para><screen><userinput>cp -R include/linux /usr/include</userinput></screen></para>

<para>Certains fichiers d'entête du noyau font usage du fichier d'entête
<filename>autoconf.h</filename>. Comme nous n'avons pas encore configuré le
noyau, nous avons besoin de créer ce fichier nous-même pour éviter des erreurs
de compilation. Créez un fichier autoconf.h vide:</para>

<para><screen><userinput>touch /usr/include/linux/autoconf.h</userinput></screen></para>

<para>Comme le lien symbolique <filename>/bin/pwd</filename> que nous avons
créé précédemment était seulement temporaire, il peut maintenant être supprimé:
</para>

<para><screen><userinput>rm /bin/pwd</userinput></screen></para>

</sect2>

