<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-glibc" xreflabel="Glibc">
<title>Glibc-&glibc-version;</title>
<?dbhtml filename="glibc.html"?>

<indexterm zone="ch-system-glibc"><primary sortas="a-Glibc">Glibc</primary></indexterm>

<para>Le package Glibc contient la bibliothèque C principale. Cette bibliothèque
fournit toutes les routines basiques pour allouer de la mémoire, rechercher d
es répertoires, ouvrir et fermer des fichiers, les lire et les écrire, gérer
les chaînes, faire correspondre des modèles, faire de l'arithmétique et
ainsi de suite.</para>

<screen>&buildtime; 12,3&nbsp;SBU
&diskspace; 784&nbsp;Mo</screen>

<para>L'installation de Glibc dépend de Bash, Binutils, Coreutils, Diffutils,
Gawk, GCC, Gettext, Grep, Make, Perl, Sed, Texinfo.</para>



<sect2>
<title>Installation de Glibc</title>

<para>Le système de construction de la Glibc est très bien fait et s'installera
parfaitement, même si notre fichier specs pour le compilateur et l'éditeur de
liens pointent toujours vers <filename>/tools</filename>. Nous ne pouvons pas
ajuster specs et éditeur de liens avant l'installation de la Glibc parce que
les tests d'autoconf de Glibc donneraient alors des résultats faussés,
défaussant ainsi notre but d'achever une construction propre.</para>

<para>Avant de commencer à construire Glibc, rappelez-vous de ré-initialiser
toutes les variables d'environnements qui surchargent les options
d'optimisation par défaut.</para>

<para>La documentation de Glibc recommende de construire Glibc en dehors du
répertoire des sources dans un répertoire de construction dédié&nbsp;:</para>

<screen><userinput>mkdir ../glibc-build
cd ../glibc-build</userinput></screen>

<para>Maintenant, préparez la compilation de Glibc&nbsp;:</para>

<screen><userinput>../glibc-&glibc-version;/configure --prefix=/usr \
    --disable-profile --enable-add-ons=linuxthreads \
    --libexecdir=/usr/lib --with-headers=/usr/include \
    --without-cvs</userinput></screen>

<para>Voici la signification des options de configure&nbsp;:</para>

<itemizedlist>
<listitem><para><userinput>--libexecdir=/usr/lib</userinput>&nbsp;: ceci
modifie l'emplacement du programme <filename>pt_chown</filename>, dont la valeur
par défaut est <filename class="directory">/usr/libexec</filename>, par
<filename class="directory">/usr/lib</filename>. L'utilisation de
<emphasis>libexec</emphasis> n'est pas considéré compatible avec le FHS parce 
que FHS ne le mentionne même pas.</para></listitem>

<listitem><para><userinput>--with-headers=/usr/include</userinput>&nbsp;: ceci
nous assure que les en-têtes du noyau situés dans
<filename>/usr/include</filename> sont utilisés pour cette construction. Si
vous ne passez pas cette option, alors les en-têtes provenant de
<filename>/tools/include</filename> sont utilisés ce qui n'est pas idéal (bien
qu'ils soient identiques). Utiliser cette option a l'avantage que vous serez
immédiatement informé si vous avez oublié d'installer les en-têtes du noyau dans
<filename>/usr/include</filename>.</para></listitem>
</itemizedlist>

<para>Compilez le package&nbsp;:</para>

<screen><userinput>make</userinput></screen>

<important><para>La suite de tests de Glibc dans cette section est considérée
comme <emphasis>critique</emphasis>. Notre conseil est de ne pas la laisser
passer quelque soit les circonstances.</para></important>

<para>Testez les résultats&nbsp;:</para>

<screen><userinput>make check</userinput></screen>

<para>Les notes sur la suite de tests, disponibles sur <xref
linkend="ch-tools-glibc"/> sont toujours très appropriées ici. Assurez-vous de
vous y référer si vous avez un doute.</para>

<para>Bien que ce ne soit qu'un simple message, l'étape d'installation de
Glibc se plaindra de l'absence de <filename>/etc/ld.so.conf</filename>.
Supprimez ce petit message bien ennuyant avec&nbsp;:</para>

<screen><userinput>touch /etc/ld.so.conf</userinput></screen>

<para>Et, installez le package&nbsp;:</para>

<screen><userinput>make install</userinput></screen>

<para>Les locales qui permettent à votre système de répondre en un langue
différente n'ont pas été installées avec la commande ci-dessus. Faites-le avec
ceci&nbsp;:</para>

<screen><userinput>make localedata/install-locales</userinput></screen>

<para>Une alternative à la commande précédente est d'installer uniquement les 
locales que vous souhaitez. Ceci se fait en utilisant la commande
<command>localedef</command>. Des informations là-dessus sont disponibles dans
le fichier <filename>INSTALL</filename> des sources de Glibc. Néanmoins, il
existe un certain nombre de locales essentielles pour réussir les tests des 
packages futurs, en particulier les tests de <emphasis>libstdc++</emphasis>.
Les instructions suivantes, contrairement à la cible install-locales ci-dessus,
installeront l'ensemble minimal des locales nécessaires pour que les tests
se passent dans de bonnes conditions&nbsp;:</para>

<screen><userinput>mkdir -p /usr/lib/locale
localedef -i de_DE -f ISO-8859-1 de_DE
localedef -i de_DE@euro -f ISO-8859-15 de_DE@euro
localedef -i en_HK -f ISO-8859-1 en_HK
localedef -i en_PH -f ISO-8859-1 en_PH
localedef -i en_US -f ISO-8859-1 en_US
localedef -i es_MX -f ISO-8859-1 es_MX
localedef -i fa_IR -f UTF-8 fa_IR
localedef -i fr_FR -f ISO-8859-1 fr_FR
localedef -i fr_FR@euro -f ISO-8859-15 fr_FR@euro
localedef -i it_IT -f ISO-8859-1 it_IT
localedef -i ja_JP -f EUC-JP ja_JP</userinput></screen>

<para>Enfin, construisez les pages man de linuxthreads&nbsp;:</para>

<screen><userinput>make -C ../glibc-&glibc-version;/linuxthreads/man</userinput></screen>

<para>Et installez ces pages&nbsp;:</para>

<screen><userinput>make -C ../glibc-&glibc-version;/linuxthreads/man install</userinput></screen>

</sect2>


<sect2 id="conf-glibc"><title>Configurer Glibc</title>
<indexterm zone="conf-glibc"><primary sortas="e-/etc/nsswitch.conf">/etc/nsswitch.conf</primary></indexterm>
<indexterm zone="conf-glibc"><primary sortas="e-/etc/localtime">/etc/localtime</primary></indexterm>

<para>Nous allons créer le fichier <filename>/etc/nsswitch.conf</filename>
parce que, bien que Glibc en fournisse un par défaut lorsque ce fichier est
manquant ou corrompu, les valeurs par défaut de Glibc ne fonctionnent pas bien
avec le réseau. De plus, notre zone horaire a besoin d'être configuré.</para>

<para>Créez un nouveau fichier <filename>/etc/nsswitch.conf</filename> en
lançant ce qui suit&nbsp;:</para>

<screen><userinput>cat &gt; /etc/nsswitch.conf &lt;&lt; "EOF"</userinput>
# Début /etc/nsswitch.conf

passwd: files
group: files
shadow: files

hosts: files dns
networks: files

protocols: files
services: files
ethers: files
rpc: files

# Fin   /etc/nsswitch.conf
<userinput>EOF</userinput></screen>

<para>Pour trouver dans quelle zone horaire vous vous trouvez, lancez le
script suivant&nbsp;:</para>

<screen><userinput>tzselect</userinput></screen>

<para>Lorsque vous aurez répondu à quelques questions sur votre emplacement, le
script affichera le nom de votre zone horaire, quelque chose comme
<emphasis>EST5EDT</emphasis> ou <emphasis>Canada/Eastern</emphasis>. Ensuite,
créez le fichier <filename>/etc/localtime</filename> en lançant&nbsp;:</para>

<screen><userinput>cp --remove-destination /usr/share/zoneinfo/Canada/Eastern /etc/localtime</userinput></screen>

<para>Voici la signification de l'option&nbsp;:</para>

<itemizedlist>
<listitem><para><userinput>--remove-destination</userinput>&nbsp;: ceci est
nécessaire pour forcer la supprimer le lien symbolique déjà existant. La raison
pour laquelle nous copions plutôt que de simplement créer un lien symbolique
est de se couvrir de la situation où <filename>/usr</filename> serait une
partition séparée. Ceci pourrait arriver, par exemple, en démarrant en mode
simple utilisateur.</para></listitem>
</itemizedlist>

<para>Bien sur, au lieu de <emphasis>Canada/Eastern</emphasis>, placez le nom
de votre zone horaire que le script <command>tzselect</command> vous a
donné.</para>

</sect2>


<sect2 id="conf-ld">
<title>Configurer le chargeur dynamique</title>
<indexterm zone="conf-ld"><primary sortas="e-/etc/ld.so.conf">/etc/ld.so.conf</primary></indexterm>

<para>Par défaut, le chargeur dynamique
(<filename>/lib/ld-linux.so.2</filename>) cherche les bibliothèques partagées,
nécessaires aux programmes lors de leur exécution, dans <filename 
class="directory">/lib</filename> et <filename
class="directory">/usr/lib</filename>. Néanmoin,s s'il existe des bibliothèques
dans d'autres répertoires que <filename class="directory">/lib</filename> et
<filename class="directory">/usr/lib</filename>, vous avez besoin de les
ajouter dans le fichier <filename>/etc/ld.so.conf</filename> pour que le
chargeur dynamique les trouve. Deux répertoires connus pour contenir des
bibliothèques supplémentaires sont <filename
class="directory">/usr/local/lib</filename> et <filename
class="directory">/opt/lib</filename>, donc nous ajoutons ces deux répertoires
au chemin de recherche du chargeur dynamique.</para>

<para>Créez un nouveau fichier <filename>/etc/ld.so.conf</filename> en lançant
ce qui suit&nbsp;:</para>

<screen><userinput>cat &gt; /etc/ld.so.conf &lt;&lt; "EOF"</userinput>
# Début /etc/ld.so.conf

/usr/local/lib
/opt/lib

# Fin   /etc/ld.so.conf
<userinput>EOF</userinput></screen>

</sect2>


<sect2 id="contents-glibc"><title>Contenu de Glibc</title>

<para><emphasis>Programmes installés</emphasis>&nbsp;: catchsegv, gencat,
getconf, getent, glibcbug, iconv, iconvconfig, ldconfig, ldd, lddlibc4, locale,
localedef, mtrace, nscd, nscd_nischeck, pcprofiledump, pt_chown, rpcgen,
rpcinfo, sln, sprof, tzselect, xtrace, zdump et zic</para>

<para><emphasis>Bibliothèques installées</emphasis>&nbsp;: ld.so,
libBrokenLocale.[a,so], libSegFault.so, libanl.[a,so], libbsd-compat.a,
libc.[a,so], libc_nonshared.a, libcrypt.[a,so], libdl.[a,so], libg.a, libieee.a,
libm.[a,so], libmcheck.a, libmemusage.so, libnsl.a, libnss_compat.so,
libnss_dns.so, libnss_files.so, libnss_hesiod.so, libnss_nis.so,
libnss_nisplus.so, libpcprofile.so, libpthread.[a,so], libresolv.[a,so],
librpcsvc.a, librt.[a,so], libthread_db.so et libutil.[a,so]</para>

</sect2>


<sect2><title>Courtes descriptions</title>

<indexterm zone="ch-system-glibc catchsegv"><primary sortas="b-catchsegv">catchsegv</primary></indexterm>
<para id="catchsegv"><command>catchsegv</command> est utilisé pour créer une
trace de la pile lorsqu'un programme s'arrête avec une erreur de
segmentation.</para>

<indexterm zone="ch-system-glibc gencat"><primary sortas="b-gencat">gencat</primary></indexterm>
<para id="gencat"><command>gencat</command> génère des catalogues de
messages.</para>

<indexterm zone="ch-system-glibc getconf"><primary sortas="b-getconf">getconf</primary></indexterm>
<para id="getconf"><command>getconf</command> affiche les valeurs de
configuration du système pour les variables spécifiques du système de
fichiers.</para>

<indexterm zone="ch-system-glibc getent"><primary sortas="b-getent">getent</primary></indexterm>
<para id="getent"><command>getent</command> récupère les entrées à partir
d'une base de données administrative.</para>

<indexterm zone="ch-system-glibc glibcbug"><primary sortas="b-glibcbug">glibcbug</primary></indexterm>
<para id="glibcbug"><command>glibcbug</command> crée un rapport de bogue et
l'envoie à l'adresse électronique bug.</para>

<indexterm zone="ch-system-glibc iconv"><primary sortas="b-iconv">iconv</primary></indexterm>
<para id="iconv"><command>iconv</command> réalise une conversion de
l'ensemble de caractères.</para>

<indexterm zone="ch-system-glibc iconvconfig"><primary sortas="b-iconvconfig">iconvconfig</primary></indexterm>
<para id="iconvconfig"><command>iconvconfig</command> crée un fichier de
configuration pour le module iconv fastloading.</para>

<indexterm zone="ch-system-glibc ldconfig"><primary sortas="b-ldconfig">ldconfig</primary></indexterm>
<para id="ldconfig"><command>ldconfig</command> configure les liens du chargeur
dynamique.</para>

<indexterm zone="ch-system-glibc ldd"><primary sortas="b-ldd">ldd</primary></indexterm>
<para id="ldd"><command>ldd</command> indique les bibliothèques partagées
requises pour chaque programme ou bibliothèque partagée.</para>

<indexterm zone="ch-system-glibc lddlibc4"><primary sortas="b-lddlibc4">lddlibc4</primary></indexterm>
<para id="lddlibc4"><command>lddlibc4</command> assiste ldd avec les fichiers
objets.</para>

<indexterm zone="ch-system-glibc locale"><primary sortas="b-locale">locale</primary></indexterm>
<para id="locale"><command>locale</command> est un programme Perl indiquant au
compilateur d'activer ou de désactiver l'utilisation des locales POSIX pour
les opérations internes.</para>

<indexterm zone="ch-system-glibc localedef"><primary sortas="b-localedef">localedef</primary></indexterm>
<para id="localedef"><command>localedef</command> compile les sépcifications de
locale.</para>

<indexterm zone="ch-system-glibc mtrace"><primary sortas="b-mtrace">mtrace</primary></indexterm>
<para id="mtrace"><command>mtrace</command>...</para>

<indexterm zone="ch-system-glibc nscd"><primary sortas="b-nscd">nscd</primary></indexterm>
<para id="nscd"><command>nscd</command> est un démon pour les services de noms
fournissant un cache pour les requêtes les plus communes.</para>

<indexterm zone="ch-system-glibc nscd_nischeck"><primary sortas="b-nscd_nischeck">nscd_nischeck</primary></indexterm>
<para id="nscd_nischeck"><command>nscd_nischeck</command> vérifie si le mode
sécurisé est nécessaire pour les recherches NIS+.</para>

<indexterm zone="ch-system-glibc pcprofiledump"><primary sortas="b-pcprofiledump">pcprofiledump</primary></indexterm>
<para id="pcprofiledump"><command>pcprofiledump</command> affiche des
informations générées par un profilage du PC.</para>

<indexterm zone="ch-system-glibc pt_chown"><primary sortas="b-pt_chown">pt_chown</primary></indexterm>
<para id="pt_chown"><command>pt_chown</command> est un programme d'aide de
grantpt pour initialiser les droits des propriétaires, groupes et autres d'un
pseudo-terminal esclave.</para>

<indexterm zone="ch-system-glibc rpcgen"><primary sortas="b-rpcgen">rpcgen</primary></indexterm>
<para id="rpcgen"><command>rpcgen</command> génère du code C pour implémenter
le protocole RPC.</para>

<indexterm zone="ch-system-glibc rpcinfo"><primary sortas="b-rpcinfo">rpcinfo</primary></indexterm>
<para id="rpcinfo"><command>rpcinfo</command> fait un appel RPC à un serveur
RPC.</para>

<indexterm zone="ch-system-glibc sln"><primary sortas="b-sln">sln</primary></indexterm>
<para id="sln"><command>sln</command> est utilisé pour créer des liens
symboliques. Le programme est lié statiquement, donc il est utile pour créer des
liens symboliques vers des bibliothèques dynamiques si le système de liens
dynamiques n'est pas fonctionnel.</para>

<indexterm zone="ch-system-glibc sprof"><primary sortas="b-sprof">sprof</primary></indexterm>
<para id="sprof"><command>sprof</command> lit et affiche les données de
profilage des objets partagés.</para>

<indexterm zone="ch-system-glibc tzselect"><primary sortas="b-tzselect">tzselect</primary></indexterm>
<para id="tzselect"><command>tzselect</command> demande à l'utilisateur
l'emplacement géographique du système et donne la description de la zone horaire
correspondante.</para>

<indexterm zone="ch-system-glibc xtrace"><primary sortas="b-xtrace">xtrace</primary></indexterm>
<para id="xtrace"><command>xtrace</command> trace l'exécution d'un programme 
en affichant la fonction en cours d'exécution.</para>

<indexterm zone="ch-system-glibc zdump"><primary sortas="b-zdump">zdump</primary></indexterm>
<para id="zdump"><command>zdump</command> est un afficheur de zone
horaire.</para>

<indexterm zone="ch-system-glibc zic"><primary sortas="b-zic">zic</primary></indexterm>
<para id="zic"><command>zic</command> est le compilateur de zone horaire.</para>

<indexterm zone="ch-system-glibc ld.so"><primary sortas="c-ld.so">ld.so</primary></indexterm>
<para id="ld.so"><command>ld.so</command> est le programme d'aide des
bibliothèques partagées exécutables.</para>

<indexterm zone="ch-system-glibc libBrokenLocale"><primary sortas="c-libBrokenLocale">libBrokenLocale</primary></indexterm>
<para id="libBrokenLocale"><command>libBrokenLocale</command> est utilisé par
des programmes comme Mozilla pour résoudre les locales cassées.</para>

<indexterm zone="ch-system-glibc libSegFault"><primary sortas="c-libSegFault">libSegFault</primary></indexterm>
<para id="libSegFault"><command>libSegFault</command> est un gestionnaire
de signaux d'erreurs de segmentation. Il essaie de capturer ce type
d'erreurs.</para>

<indexterm zone="ch-system-glibc libanl"><primary sortas="c-libanl">libanl</primary></indexterm>
<para id="libanl"><command>libanl</command> est une bibliothèque asynchrone de
recherche de noms.</para>

<indexterm zone="ch-system-glibc libbsd-compat"><primary sortas="c-libbsd-compat">libbsd-compat</primary></indexterm>
<para id="libbsd-compat"><command>libbsd-compat</command> fournit la portabilité
nécessaire pour faire fonctionner certains programmes BSD sous Linux.</para>

<indexterm zone="ch-system-glibc libc"><primary sortas="c-libc">libc</primary></indexterm>
<para id="libc"><command>libc</command> est la principale bibliothèque C -- une
collection des fonctions utilisées habituellement.</para>

<indexterm zone="ch-system-glibc libcrypt"><primary sortas="c-libcrypt">libcrypt</primary></indexterm>
<para id="libcrypt"><command>libcrypt</command> est la bibliothèque 
de cryptographie.</para>

<indexterm zone="ch-system-glibc libdl"><primary sortas="c-libdl">libdl</primary></indexterm>
<para id="libdl"><command>libdl</command> est la bibliothèque d'interface du 
chargeur dynamique.</para>

<indexterm zone="ch-system-glibc libg"><primary sortas="c-libg">libg</primary></indexterm>
<para id="libg"><command>libg</command> est la bibliothèque d'exécution de
g++.</para>

<indexterm zone="ch-system-glibc libieee"><primary sortas="c-libieee">libieee</primary></indexterm>
<para id="libieee"><command>libieee</command> est la bibliothèque des nombres
flottants IEEE.</para>

<indexterm zone="ch-system-glibc libm"><primary sortas="c-libm">libm</primary></indexterm>
<para id="libm"><command>libm</command> est la bibliothèque mathématique.</para>

<indexterm zone="ch-system-glibc libmcheck"><primary sortas="c-libmcheck">libmcheck</primary></indexterm>
<para id="libmcheck"><command>libmcheck</command> contient du code à
lancer au démarrage.</para>

<indexterm zone="ch-system-glibc libmemusage"><primary sortas="c-libmemusage">libmemusage</primary></indexterm>
<para id="libmemusage"><command>libmemusage</command> est utilisé par memusage
pour collecter des informations sur l'utilisation mémoire d'un programme.</para>

<indexterm zone="ch-system-glibc libnsl"><primary sortas="c-libnsl">libnsl</primary></indexterm>
<para id="libnsl"><command>libnsl</command> est la bibliothèque de services
réseau.</para>

<indexterm zone="ch-system-glibc libnss"><primary sortas="c-libnss*">libnss*</primary></indexterm>
<para id="libnss"><command>libnss*</command> sont les bibliothèques <quote>Name
Service Switch</quote>, contenant des fonctions de résolution de noms d'hôtes,
de noms d'utilisateurs, de noms de groupes, d'alias, de services, de protocoles
et ainsi de suite.</para>

<indexterm zone="ch-system-glibc libpcprofile"><primary sortas="c-libpcprofile">libpcprofile</primary></indexterm>
<para id="libpcprofile"><command>libpcprofile</command> contient des fonctions
de profilage utilisées pour tracer le temps CPU dépensé sur les lignes de code
source.</para>

<indexterm zone="ch-system-glibc libpthread"><primary sortas="c-libpthread">libpthread</primary></indexterm>
<para id="libpthread"><command>libpthread</command> est la bibliothèque threads
POSIX.</para>

<indexterm zone="ch-system-glibc libresolv"><primary sortas="c-libresolv">libresolv</primary></indexterm>
<para id="libresolv"><command>libresolv</command> contient des fonctions de 
création, d'envoi et d'interprétation de paquets pour les serveurs de noms de
domaine Internet.</para>

<indexterm zone="ch-system-glibc librpcsvc"><primary sortas="c-librpcsvc">librpcsvc</primary></indexterm>
<para id="librpcsvc"><command>librpcsvc</command> contient des
fonctions apportant différents services RPC.</para>

<indexterm zone="ch-system-glibc librt"><primary sortas="c-librt">librt</primary></indexterm>
<para id="librt"><command>librt</command> copntient des fonctions fournissant la
plupart des interfaces spécifiées par l'extension temps réel de POSIX.1b.</para>

<indexterm zone="ch-system-glibc libthread_db"><primary sortas="c-libthread_db">libthread_db</primary></indexterm>
<para id="libthread_db"><command>libthread_db</command> contient des
fonctions utiles pour contruire des débogueurs de programmes
multi-threads.</para>

<indexterm zone="ch-system-glibc libutil"><primary sortas="c-libutil">libutil</primary></indexterm>
<para id="libutil"><command>libutil</command> contient du code pour les
fonctions "standards" utilisées par de nombreux outils Unix.</para>

</sect2>



</sect1>
