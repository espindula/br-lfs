<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-chroot">
<title>Entrer dans l'environnement chroot</title>
<?dbhtml filename="chroot.html"?>

<para>Il est temps d'entrer dans l'environnement chroot pour commencer la
construction et l'installation de votre système final LFS. Toujours en tant que
<emphasis>root</emphasis>, lancez la commande suivante pour entrer dans petit
monde peuplé seulement, pour le moment des outils temporaires&nbsp;:</para>

<screen><userinput>chroot "$LFS" /tools/bin/env -i \
    HOME=/root TERM="$TERM" PS1='\u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin \
    /tools/bin/bash --login +h</userinput></screen>

<para>L'option <emphasis>-i</emphasis> donnée à la commande
<command>env</command> effacera toutes les variables de l'environnement chroot.
Après cela, seules les variables HOME, TERM, PS1 et PATH sont toujours
initialisées. La construction TERM=$TERM initialisera la variable TERM à
l'intérieur du chroot avec la même valeur qu'à l'extérieur&nbsp;; cette
variable est nécessaire pour que les programmes comme <command>vim</command> et
<command>less</command> fonctionnent correctement. Si vous avez besoin de la
présence d'autres variables, telles que CFLAGS ou CXXFLAGS, c'est le bon moment
pour les initialiser de nouveau.</para>

<para>À partir de maintenant, il n'est plus nécessaire d'utiliser la
variable LFS parce que tout ce que vous ferez sera restreint au système de
fichiers LFS car le shlle pense que <filename
class="directory">$LFS</filename> est réellement <filename
class="directory">/</filename>.</para>

<para>Notez que <filename class="directory">/tools/bin</filename> arrive
dernier dans le PATH. Ceci signifie qu'un outil temporaire ne sera plus utilisé
une fois que la version finale sera utilisée. En fait, ceci est vrai tant que le
shell ne se rappelle plus les emplacements des binaires exécutés. Pour cette
raison, le hachage est désactivé en passant l'option <emphasis>+h</emphasis> à
<command>bash</command>.</para>

<para>Vous devez vous assurer que toutes les commandes pour le reste de ce
chapitre et les chapitres suivants sont lancés à l'intérieur de
l'environnement chroot. Si vous devez quitter cet environnement quelqu'en soit
la raison (un redémarrage par exemple), vous devez vous rappeller de commencer
par monter les systèmes de fichiers proc et devpts (discutés dans la section
précédente) <emphasis>et</emphasis> d'entrer de nouveau dans chroot avant de
continuer les installations.</para>

<para>Notez que l'invite bash dira <quote>I have
no name!</quote> (Je n'ai pas de nom&nbsp;!). C'est normal car lefichier
<filename>/etc/passwd</filename> n'existe pas encore.
</para>

</sect1>
