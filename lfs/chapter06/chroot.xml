<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-system-chroot">
<title>Entrer dans l'environnement chroot</title>
<?dbhtml filename="chroot.html"?>

<para>Il est temps d'entrer dans l'environnement chroot pour commencer la
construction et l'installation du système final LFS. En tant que
<emphasis>root</emphasis>, lancez la commande suivante pour entrer dans ce
petit monde peuplé seulement, pour le moment, des outils temporaires&nbsp;:
</para>

<screen><userinput>chroot "$LFS" /tools/bin/env -i \
    HOME=/root TERM="$TERM" PS1='\u:\w\$ ' \
    PATH=/bin:/usr/bin:/sbin:/usr/sbin:/tools/bin \
    /tools/bin/bash --login +h</userinput></screen>

<para>L'option <parameter>-i</parameter> donnée à la commande
<command>env</command> effacera toutes les variables de l'environnement chroot.
Après cela, seules les variables <envar>HOME</envar>, <envar>TERM</envar>,
<envar>PS1</envar> et <envar>PATH</envar> sont toujours initialisées. La
construction <parameter>TERM=$TERM</parameter> initialisera la variable
<envar>TERM</envar> à l'intérieur du chroot avec la même valeur qu'à
l'extérieur&nbsp;; cette variable est nécessaire pour que les programmes comme
<command>vim</command> et <command>less</command> fonctionnent correctement. Si
vous avez besoin de la présence d'autres variables, telles que
<envar>CFLAGS</envar> ou <envar>CXXFLAGS</envar>, c'est le bon moment pour les
initialiser de nouveau.</para>

<para>À partir de maintenant, il n'est plus nécessaire d'utiliser la variable
<envar>LFS</envar> parce que tout le travail sera restreint au système de
fichiers LFS car le shell pense que <filename class="directory">$LFS</filename>
est maintenant la racine (<filename class="directory">/</filename>.</para>

<para>Notez que <filename class="directory">/tools/bin</filename> arrive
dernier dans le <envar>PATH</envar>. Ceci signifie qu'un outil temporaire ne
sera plus utilisé une fois que la version finale sera utilisée. Ceci survient
quand le shell ne se rappelle plus les emplacements des binaires exécutés. Pour
cette raison, le hachage est désactivé en passant l'option
<emphasis>+h</emphasis> à <command>bash</command>.</para>

<para>Il est important que toutes les commandes pour le reste de ce
chapitre et les chapitres suivants sont lancés à l'intérieur de
l'environnement chroot. Si vous devez quitter cet environnement quelqu'en soit
la raison (un redémarrage par exemple), vous devez vous rappeler de commencer
par monter les systèmes de fichiers <systemitem
class="filesystem">proc</systemitem> et <systemitem
class="filesystem">devpts</systemitem> (discutés dans la section précédente) et
d'entrer de nouveau dans chroot avant de continuer les installations.</para>

<para>Notez que l'invite de <command>bash</command> dira <quote>I have no
name!</quote> (Je n'ai pas de nom&nbsp;!). C'est normal car le fichier
<filename>/etc/passwd</filename> n'existe pas encore.</para>

</sect1>
