<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
  "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>

<sect1 id="ch-scripts-console">
  <?dbhtml filename="console.html"?>

  <title>Configurer la Console Linux</title>

  <indexterm zone="ch-scripts-console">
    <primary sortas="d-console">console</primary>
    <secondary>configuration</secondary>
  </indexterm>

  <para>Cette section discute de la configuration du script de démarrage
  <command>console</command>, initialisant
  la disposition du clavier, la police de la console et le niveau de journalisation du noyau.
  Si des caractères non ASCII (par exemple, les symboles copyright, livre anglaise et Euro) ne seront pas utilisés et que le
  clavier est américain, passez cette section. Sans le fichier de configuration, (ou
  son équivalent dans <filename>rc.site</filename>), le script de démarrage
  <command>console</command> ne fera rien.</para>
 
  <sect2 id="ch-scripts-sysv-console">
    <title>System V</title>

  <para>Le script <command>console</command>  lit les informations de configuration du fichier
  <filename>/etc/sysconfig/console</filename>.
  Il décide du plan de codage et de la police de la
  console à utiliser. Différents guides pratiques spécifiques aux
  langues peuvent aussi être d'une grande aide (voir
  <ulink url="http://www.tldp.org/HOWTO/HOWTO-INDEX/other-lang.html"/>).
  Si vous avez toujours des doutes, jetez un &oelig;il dans les
  répertoires <filename class="directory">/usr/share/keymaps</filename> et
  <filename class="directory">/usr/share/consolefonts</filename> pour des plans de
  codage valides et des polices d'écran. Lisez les pages de manuel
  <filename>loadkeys(1)</filename> et <filename>setfont(8)</filename>
  pour déterminer les bons arguments pour ces programmes.</para>

  <para>Le fichier <filename>/etc/sysconfig/console</filename> devrait
  contenir des lignes de la forme&nbsp;: VARIABLE="valeur". Les
  variables suivantes sont reconnues&nbsp;:</para>

  <variablelist>

    <varlistentry>
      <term>LOGLEVEL</term>
      <listitem>
        <para>Cette variable spécifie le niveau de traçage pour les messages du
        noyau envoyés à la console, selon le paramétrage de
        <command>dmesg</command>. Les niveaux valides vont de <quote>1</quote> (aucun
        message) à <quote>8</quote>. Le niveau par défaut est <quote>7</quote>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>KEYMAP</term>
      <listitem>
        <para>Cette variable spécifie les arguments du programme
        <command>loadkeys</command>, en général le nom du plan de codage à
        charger, comme <quote>es</quote>. Si cette variable n'est pas réglée,
        le script de démarrage ne lancera pas le programme <command>loadkeys</command>
	    et le plan de codage du noyau par défaut sera utilisé.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>KEYMAP_CORRECTIONS</term>
      <listitem>
        <para>Cette variable (rarement utilisée) spécifie les arguments du
        second appel au programme <command>loadkeys</command>. C'est
        utile si le plan de codage stocké n'est pas totalement satisfaisant
        et que vous devez faire un petit ajustement. Par exemple, pour inclure le
		signe Euro dans un plan de codage qui ne l'a normalement pas, réglez
		cette variable à <quote>euro2</quote>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>FONT</term>
      <listitem>
        <para>Cette variable spécifie les arguments du programme
        <command>setfont</command>. En principe, ceci inclut le nom de la police,
        <quote>-m</quote> et le nom du plan de caractères de l'application
        à charger. Par exemple, pour charger la police <quote>lat1-16</quote>
        avec le plan de caractères de l'application <quote>8859-1</quote>, (comme
        il convient aux États-Unis),
        <!-- because of the copyright sign -->
        réglez cette variable à <quote>lat1-16 -m 8859-1</quote>.
        En mode UTF-8, le noyau utilise le plan de caractères de l'application
        pour la conversion de codes de touche 8-bits composés dans le plan de
        codage en UTF-8, et ainsi vous devriez initialiser l'argument du
        paramètre "-m" à l'encodage des codes de touche composés dans le plan de codage.</para>

      </listitem>
    </varlistentry>

    <varlistentry>
      <term>UNICODE</term>
      <listitem>
        <para>Réglez cette variable à <quote>1</quote>, <quote>yes</quote> ou
	    <quote>true</quote> afin de mettre la console en mode UTF-8. Ceci
        est utile pour les locales basées sur UTF-8 et nuisible sinon.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>LEGACY_CHARSET</term>
      <listitem>
        <para>Pour beaucoup de types de clavier, il n'y a pas de plan de codage
        pour le stock Unicode dans le paquet Kbd. Le script de démarrage
        <command>console</command> convertira un plan de codage disponible en
        UTF-8 au vol si cette variable est réglée à l'encodage du plan de codage non UTF-8 disponible.</para>
      </listitem>
    </varlistentry>

  </variablelist>

  <para>Quelques exemples&nbsp;:</para>

  <itemizedlist>

    <listitem>
      <para>Pour une initialisation non Unicode, en général seules les
      variables KEYMAP et FONT sont nécessaires. Par exemple, pour
      l'initialisation en polonais, on utiliserait&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<literal># Début de /etc/sysconfig/console

KEYMAP="pl2"
FONT="lat2a-16 -m 8859-2"

# Fin de /etc/sysconfig/console</literal>
EOF</userinput></screen>
    </listitem>

    <listitem>
      <para>Comme mentionné ci-dessus, il est parfois nécessaire d'ajuster
      légèrement un plan de codage stocké. L'exemple suivant ajoute le symbole
      Euro au plan de codage allemand&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<literal># Début de /etc/sysconfig/console

KEYMAP="de-latin1"
KEYMAP_CORRECTIONS="euro2"
FONT="lat0-16 -m 8859-15"

# Fin de /etc/sysconfig/console</literal>
EOF</userinput></screen>
    </listitem>

    <listitem>
      <para>Ce qui suit est un exemple avec l'Unicode activé pour le bulgare, où
      un plan de codage UTF-8 stocké existe&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<literal># Début de /etc/sysconfig/console

UNICODE="1"
KEYMAP="bg_bds-utf8"
FONT="LatArCyrHeb-16"

# Fin de /etc/sysconfig/console</literal>
EOF</userinput></screen>
    </listitem>

    <listitem>
      <para>Du fait de l'utilisation d'une police 512-glyph LatArCyrHeb-16 dans
      l'exemple précédent, les couleurs brillantes ne sont plus disponibles
      sur la console Linux à moins qu'un framebuffer soit utilisé. Si vous
      voulez avoir les couleurs brillantes sans framebuffer et que vous pouvez
     vivre sans caractère n'appartenant pas à votre langue, il est encore
      possible d'utiliser une police 256-glyph spécifique à votre langue,
      comme illustré ci-dessous&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<literal># Début de /etc/sysconfig/console

UNICODE="1"
KEYMAP="bg_bds-utf8"
FONT="cyr-sun16"

# Fin de /etc/sysconfig/console</literal>
EOF</userinput></screen>
    </listitem>

    <listitem>
      <para>L'exemple suivant illustre l'auto-conversion du plan de clavier
      d'utf-85 vers UTF-8 et l'activation des touches mortes en mode Unicode&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/sysconfig/console &lt;&lt; "EOF"
<literal># Début de /etc/sysconfig/console

UNICODE="1"
KEYMAP="de-latin1"
KEYMAP_CORRECTIONS="euro2"
LEGACY_CHARSET="iso-8859-15"
FONT="LatArCyrHeb-16 -m 8859-15"

# Fin de /etc/sysconfig/console</literal>
EOF</userinput></screen>
    </listitem>

    <listitem>
      <para>Certains plans de codage ont des touches mortes (c-à-d que
      les touches qui ne produisent pas un caractère en elles-mêmes, mais mettent
       un accent sur le caractère produit par la touche suivante) ou définissent
      des règles de comportement (comme&nbsp;: <quote>Appuyez sur Ctrl+. A E pour
      obtenir &AElig;</quote> dans le plan de codage par défaut).
      Linux-&linux-version; n'interprète correctement les touches mortes et les règles de
      composition que quand les caractères source qui seront composés ensembles
      sont multi-octet. Ce défaut n'affecte pas les plans de clavier pour les
      langues européennes, car il y a des accents ajoutés à des caractères
      ASCII non accentués, ou deux caractères ASCII sont composés ensemble.
      Néanmoins en mode UTF-8, c'est un problème, comme pour la langue grecque,
      où on a parfois besoin de mettre un accent sur la lettre
      <quote>alpha</quote>.
      La solution consiste soit à éviter d'utiliser UTF-8, soit à installer le système de fenêtrage X
      qui n'a pas cette limitation dans sa gestion de l'entrée.</para>
    </listitem>

    <listitem>
      <para>Pour le Chinois, le Japonais, le Coréen et certaines autres langues,
      la console Linux ne peut pas être configurée pour afficher les caractères
      nécessaires. Les utilisateurs qui ont besoin de telles langues devraient
      installer le système de fenêtrage X, dont les polices couvrent la plage de
      caractères nécessaire et qui a la bonne méthode d'entrée (par exemple
      SCIM prend en charge une large variété de langues).</para>
    </listitem>

  </itemizedlist>

  <!-- Added because folks keep posting their console file with X questions
  to blfs-support list -->
  <note>
    <para>Le fichier <filename>/etc/sysconfig/console</filename> ne contrôle
     que la localisation de la console texte de Linux. Cela n'a rien à voir
     avec le bon paramétrage du type de clavier et des polices du terminal dans
    le système de fenêtrage X, avec les sessions ssh ou une console série. Dans de
    telles situations, les limitations mentionnées dans les deux derniers points
    de la liste ci-dessus ne s'appliquent pas.</para>
  </note>

  </sect2>

  <sect2 id="ch-scripts-systemd-console">
    <title>Systemd</title>

  <indexterm zone="ch-scripts-systemd-console">
    <primary sortas="d-console">systemd console</primary>
    <secondary>configuration</secondary>
  </indexterm>

  <para>Cette section traite de la manière de configurer le service système
  <command>systemd-vconsole-setup</command> qui configure la police de la
  console virtuelle et la disposition du clavier dans la console.</para>

  <para>Le service <command>systemd-vconsole-setup</command> lit les informations
  de configuration dans le fichier <filename>/etc/vconsole.conf</filename>. Décidez
  de la disposition du clavier et de la police à l'écran qui seront utilisées.
  Il existe divers guides pratiques spécifiques à chaque langue qui peuvent vous
  aider. Voir <ulink
  url="http://www.tldp.org/HOWTO/HOWTO-INDEX/other-lang.html"/>.
  Observez la sortie de <command>localectl list-keymaps</command> pour une liste
  des dispositions de clavier valides sur la console. Regardez le répertoire
  <filename class="directory">/usr/share/consolefonts</filename> pour une liste
  des polices d'écran valides.</para>

  <para>Le fichier <filename>/etc/vconsole.conf</filename> devrait contenir
  des lignes de la forme&nbsp;: VARIABLE="valeur". Les variables suivantes sont
  reconnues&nbsp;:</para>

  <variablelist>

    <varlistentry>
      <term>KEYMAP</term>
      <listitem>
        <para>Cette variable spécifie la table de disposition du clavier. Si vous
        ne la définissez pas, elle est par défaut <literal>us</literal>.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>KEYMAP_TOGGLE</term>
      <listitem>
        <para>Vous pouvez utiliser cette variable pour configurer une disposition
        alternative par défaut où vous pouvez basculer.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>FONT</term>
      <listitem>
        <para>Cette variable spécifie la police utilisée par la
        console virtuelle.</para>
      </listitem>
    </varlistentry>
    <varlistentry>
      <term>FONT_MAP</term>
      <listitem>
        <para>Cette variable spécifie la présentation de la console.</para>
      </listitem>
    </varlistentry>

    <varlistentry>
      <term>FONT_UNIMAP</term>
      <listitem>
        <para>Cette variable spécifie la police de l'unicode.</para>
      </listitem>
    </varlistentry>

  </variablelist>

  <para>Voici un exemple pour un clavier allemand&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt; /etc/vconsole.conf &lt;&lt; "EOF"
<literal>KEYMAP=de-latin1
FONT=Lat2-Terminus16</literal>
EOF</userinput></screen>

  <para>Vous pouvez modifier la valeur de KEYMAP lors de l'exécution en utilisant
  l'outil <command>localectl</command>&nbsp;:</para>

<screen role="nodump"><userinput>localectl set-keymap MAP</userinput></screen>

  <note><para>Merci de remarquer que la commande <command>localectl</command>
  n'est utilisable que sur un système démarré avec Systemd.</para></note>

  </sect2>

</sect1>
