<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../general.ent">
  %general-entities;
]>
<sect1 id="ch-scripts-console">
<title>Configurer la console Linux</title>
<?dbhtml filename="console.html"?>

<indexterm zone="ch-scripts-console">
<primary sortas="d-console">console</primary>
<secondary>configurer</secondary></indexterm>

<para>Cette section discute de la configuration du script de démarrage
<command>console</command>, initialisant le plan de codage du clavier et la
police de la console. Si des caractères non ASCII (par exemple, la livre
anglaise et le caractère Euro) ne seront pas utilisés et que le clavier est
un clavier US, passez cette section. Sans le fichier de configuration, le
script de démarrage <command>console</command> ne fera rien.</para>

<para>Le script <command>console</command> lit le fichier
<filename>/etc/sysconfig/console</filename> pour des informations de configuration.
Il décide du plan de codage et de la police de la console à utiliser.
Différents guides pratiques spécifiques aux langues peuvent aussi être d'une
grande aide (voir <ulink url="http://www.tldp.org/HOWTO/HOWTO-index/other-lang.html"/>).
Un fichier <filename>/etc/sysconfig/console</filename> déjà rempli avec des paramétrages
déjà connus pour différents pays a été installé avec la paquet LFS-Bootscripts,
pour que la section adéquate puisse être décommentée si le pays est supporté.
Si vous avez toujours des doutes, jetez un &oelig;il dans le répertoire
<filename class="directory">/usr/share/kbd</filename> pour des plans de codage
valides et des polices pour écran. Lisez les pages man de
<filename>loadkeys(1)</filename> et <filename>setfont(8)</filename> pour
déterminer les bons arguments pour ces programmes. Une fois décidé, créez le
fichier de configuration avec les commandes suivantes&nbsp;:</para>

<screen><userinput>cat &gt;/etc/sysconfig/console &lt;&lt;"EOF"
<literal>KEYMAP="<replaceable>[arguments pour loadkeys]</replaceable>"
FONT="<replaceable>[arguments pour setfont]</replaceable>"</literal>
EOF</userinput></screen>

<para>Par exemple, pour les utilisateurs espagnols qui souhaitent aussi utiliser
le caractère Euro (accessible avec la combinaison de touches AltGr+E), les
paramétrages suivants sont corrects&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt;/etc/sysconfig/console &lt;&lt;"EOF"
<literal>KEYMAP="es euro2"
FONT="lat9-16 -u iso01"</literal>
EOF</userinput></screen>

<note><para>La ligne <envar>FONT</envar> ci-dessus est correct seulement pour
l'ensemble de caractères ISO 8859-15. Si vous utilisez ISO 8859-1 et, du coup,
un symbole de livre à la place de l'Euro, la ligne <envar>FONT</envar> correcte
devrait être&nbsp;:</para>

<screen role="nodump"><userinput>FONT="lat1-16"</userinput></screen></note>

<para>Si la variable <envar>KEYMAP</envar> ou <envar>FONT</envar> n'est pas
configurée, le script de démarrage <command>console</command> n'exécutera pas
le programme correspondant.</para>

<para>Dans certains plans de codage, les touches Backspace et Delete envoient
des caractères différents de ceux du plan de codage par défaut intégré au noyau.
Ceci est une source de confusion pour certaines applications. Par exemple,
<application>Emacs</application> affiche son aide (au lieu de supprimer le
caractère situé avant le curseur) lors d'un appui sur Backspace. Pour vérifier
si le plan de codage utilisé est pris en compte (ceci ne fonctionne qu'avec
les plans de codage i386)&nbsp;:</para>

<screen role="nodump"><userinput>zgrep '\W14\W' <replaceable>[/path/to/your/keymap]</replaceable></userinput></screen>

<beginpage/>

<para>Si le code de touche 14 est Backspace au lieu de Delete, créez le code
supplémentaire suivant au plan de codage pour corriger ce problème&nbsp;:</para>

<screen role="nodump"><userinput>mkdir -pv /etc/kbd &amp;&amp; cat &gt; /etc/kbd/bs-sends-del &lt;&lt;"EOF"
<literal>                  keycode  14 = Delete Delete Delete Delete
              alt keycode  14 = Meta_Delete
        altgr alt keycode  14 = Meta_Delete
                  keycode 111 = Remove
    altgr control keycode 111 = Boot
      control alt keycode 111 = Boot
altgr control alt keycode 111 = Boot</literal>
EOF</userinput></screen>

<para>Indiquez au script <command>console</command> de charger ce code après
le plan de codage principal&nbsp;:</para>

<screen role="nodump"><userinput>cat &gt;&gt;/etc/sysconfig/console &lt;&lt;"EOF"
<literal>KEYMAP_CORRECTIONS="/etc/kbd/bs-sends-del"</literal>
EOF</userinput></screen>

<para>Pour compiler le plan de codage directement dans le noyau au lieu de le
configurer à chaque fois avec le script de démarrage <command>console</command>,
suivez les instructions données dans <xref linkend="ch-bootable-kernel" role="."/>.
Le faire vous assure que le plan de codage fonctionnera toujours comme attendu,
même si vous démarrez en mode maintenance (en passant
<parameter>init=/bin/sh</parameter> au noyau), parce que le script de démarrage
<command>console</command> ne sera pas lancé dans cette situation. De plus, le
noyau ne configurera plus la police de l'écran automatiquement. Ceci ne devrait
pas poser beaucoup de problèmes car les caractères ASCII seront gérés correctement
et il est improbable qu'un utilisateur aura besoin de caractères non ASCII en mode
maintenance.</para>

<para>Comme le noyau configurera le plan de codage, il est possible d'omettre
la variable <envar>KEYMAP</envar> à partir du fichier de configuration
<filename>/etc/sysconfig/console</filename>. Il peut aussi aussi être laissé à
sa place, si désiré, sans conséquence. Le garder pourrait être bénéfique si vous
utilisez différents noyaux et qu'il est difficile d'être sûr que le plan de
codage est bien compilé dans chacun d'entre eux.</para>

</sect1>

